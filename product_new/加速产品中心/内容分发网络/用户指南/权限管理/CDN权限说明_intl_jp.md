Content Delivery NetworkはTencent CloudのCloud Access Managementシステムを導入しています。 [アクセス管理](https://console.cloud.tencent.com/cam/overview) コンソールでユーザーグループ、ユーザー、ロール、ポリシー等一連の関連管理操作を行うことができます。

現在、CDNは権限システムのアップグレードの過渡期にあるため、お客様は下記のような幾つかの方式でサブユーザーとロールに対しCDN管理権限をアサインできます。

## プリセットポリシー
現在、CDNに対応できるプリセットポリシーは下記の通りです。
- AdministratorAccess：当該ポリシーにアソシエイトされたサブユーザーは、アカウントにおけるすべてのクラウドサービス資産（CDNサービスを含む）、財務関連情報、ユーザー及び権限を管理することができます。
- QCloudResourceFullAccess：当該ポリシーにアソシエイトされたサブユーザーは、アカウントにおけるすべてのクラウドサービス資産（CDNサービスを含む）を管理することができます。

サブユーザーが上記2種類のポリシーにアソシエイトされている場合は、CDNのすべてのドメイン名のリード/ライト権限を備えています。

## プロジェクトポリシー
アサインされたプロジェクトによりサブユーザーに権限付与し、当該サブユーザーにプロジェクトにおけるドメイン名の完全なリード/ライト権限を持たせるには、プロジェクトポリシーの作成により実現することが可能です。
1.  [アクセス管理コンソール](https://console.cloud.tencent.com/cam/overview) にログインし、左側のディレクトリの【ポリシー】をクリックします。
2. 【カスタマイズポリシーを作成する】をクリックしてから、【製品の機能又はプロジェクト権限に基づき作成する】を選択します：
![](https://main.qcloudimg.com/raw/59c8c89263412208344bd071430db23d.png)
3. 提示通りにポリシー名称を記入し、下のサービスタイプで【プロジェクト管理】を選択します：
![](https://main.qcloudimg.com/raw/f0c7a068257c3f4ab8e734791d6ceeb2.png)
4. 【CDNサービスプロジェクトにおけるクラウドリソースを管理する】をオンにしてから、授権する必要のあるプロジェクトにアソシエイトした後、プロジェクト管理者ポリシーの作成が完了します：
![](https://main.qcloudimg.com/raw/f9e5762bcae1dfe0cc77044cc3441122.png)

## 機能セットポリシー
プロジェクトレベルの授権操作を細分化したい場合は（例えばデータクエリー、更新予熱、ドメイン名管理操作をそれぞれ異なるサブアカウントに授権する）、下記手順に従いポリシーを作成します：
1.  [アクセス管理コンソール](https://console.cloud.tencent.com/cam/overview) にログインし、左側のディレクトリの【ポリシー】をクリックします。
2. 【カスタマイズポリシーを新規作成する】をクリックしてから、【製品の機能又はプロジェクト権限に基づき作成する】を選択します：
![](https://main.qcloudimg.com/raw/59c8c89263412208344bd071430db23d.png)
3. 提示通りにポリシー名称を記入し、下のサービスタイプで【Content Delivery Network】を選択します：
![](https://main.qcloudimg.com/raw/e057955abd823f0b92ff6cc13a016c4c.png)
4. 必要に応じ、授権する必要のある操作セットを開き、プロジェクトにアソシエイトしてから（デフォルトプロジェクトは授権できない）、サブユーザーにアソシエイトすればよいです：
![](https://main.qcloudimg.com/raw/961dfce5817ba690b554f12dfa22d7c9.png)

現在、操作セットの分類及び対応するOPEN API 2.0 と OPEN API 3.0インターフェースは下記の通りです。操作セット権限を持つサブユーザーは、権限を持つプロジェクトの任意ドメイン名に対し下記インターフェースを呼び出すことが可能です。

| 権限集合              | API2.0                                                       | API3.0                                                       | 授権する必要があるか |
| :-------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :----------- |
| 消費データ及び統計量をクエリー  | DescribeCdnHostInfo <br/>DescribeCdnHostDetailedInfo<br/>GetCdnStatusCode<br/> GetCdnStatTop<br/> GetCdnProvIspDetailStat | DescribeCdnData<br/> DescribeOriginData<br/> ListTopData<br/>DescribeIpVisit | はい           |
| ドメイン名情報をクエリー          | GetHostInfoById<br/>GetHostInfoByHost                        | オンラインしていない                                                     | はい           |
| CDN ログのダウンロードリンクをクエリー | GenerateLogList<br/>GetCdnLogList                            | オンラインしていない                                                     | はい           |
| ドメイン名を追加する              | AddCdnHost<br/>                                              | オンラインしていない                                                      | はい           |
| ドメイン名のオンライン / オフライン        | OnlineHost<br/>OfflineHost                                   | オンラインしていない                                                      | はい           |
| ドメイン名を削除する              | DeleteCdnHost                                                |オンラインしていない                                                     | はい           |
| ドメイン名の構成を変更する          | UpdateCdnConfig                                              | オンラインしていない                                                     | はい           |
| 更新予熱              | RefreshCdnDir<br/>RefreshCdnUrl<br/>GetCdnRefreshLog<br/>CdnPusherV2<br/>GetPushLogs<br/>CdnOverseaPushser | PurgeUrlsCache<br/>PurgePathCache<br/>DescribePurgeTasks<br/>PushUrlsCache<br/>DescribePushTasks | はい           |
| サービスクエリー              | QueryCdnIp（授権する必要がない）                                       | DescribeCdnIp                                                | はい           |

#### コンソールページ権限の説明：
- 消費データ及び統計量を照会する：ポリシーで【消費データ及び統計量を照会する】をオンにし、プロジェクトにアソシエイトすると、コンソールの下記モジュール情報を確認することができます：
  - 概要ページ
  - 統計分析：リアルタイム監視
  - 統計分析：データ分析
  - ネットワーク全体のデータ監視
- ドメイン名情報をクエリーする：ポリシーで【ドメイン名情報を照会する】をオンにし、プロジェクトにアソシエイトすると、コンソールの【ドメイン名管理】ページで権限を持つプロジェクトのドメイン名リスト及び詳しい構成情報を照会できます。
- CDNログのダウンロードリンクをクエリーする：ポリシーで【CDNログのダウンロードリンクを照会する】をオンにし、プロジェクトにアソシエイトすると、コンソールの【ログ管理】ページで、アクセスログのダウンロードリンクを照会できます。
- ドメイン名を追加する：ポリシーでは【ドメイン名を追加する】をオンにし、プロジェクトにアソシエイトすると、指定したプロジェクトにドメイン名を追加できます。
- ドメイン名のオンライン / オフライン ：ポリシーで【ドメイン名のオンライン / オフライン】をオンにし、プロジェクトにアソシエイトすると、指定したプロジェクトの加速ドメイン名をオンライン / オフラインできます。
- ドメイン名を削除する：ポリシーで【ドメイン名を削除する】をオンにし、プロジェクトにアソシエイトすると、指定したプロジェクトの加速ドメイン名を削除できます。削除されたドメイン名はオフライン状態にある必要があります。そのため、オンライン状態にあるドメイン名を削除するには、【ドメイン名のオンライン / オフライン】権限を有する必要があります。
- ドメイン名の構成を変更する：ポリシーでは【ドメイン名の構成を変更する】をオンにし、プロジェクトにアソシエイトすると、指定されたプロジェクトの加速ドメイン名の構成を変更できます。
- 更新予熱：ポリシーで【更新予熱】をオンにし、プロジェクトにアソシエイトすると、【更新キャッシュ】ページで対応する更新、予熱（ホワイトリスト）タスクをサブミットし、更新予熱タスクの実行状態を確認できます。

## リソース授権

ユーザーがドンメイン名のクエリーや管理権限をより細かく構成できるように、CDNシステムは権限ポリシーのアップグレードを行っています。これからポリシー文法能力を対応するようになると、ユーザーがポリシーセンテンスをカスタマイズすることにより、ドンメイン名レベルの権限アサインを実現することが可能となります。

現在、新規追加したAPI3.0インターフェース及び新しいバージョンの統計分析コンソールは、既にポリシー文法を全面的に対応しています。対応するActionは下記の通りです。
- DescribeCdnData
- DescribeOriginData
- ListTopData
- DescribeIpVisit
- PurgeUrlsCache
- PurgePathCache
- DescribePurgeTasks
- PushUrlsCache
- DescribePushTasks
- DescribeCdnIp

ポリシー文法の例：
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "*"
            ],
            "resource": [
                "qcs::cdn::uin/ルートアカウントUIN:domain/www.test.com"
            ],
            wen"effect": "allow"
        }
    ]
}
```

> !
- ポリシー文法は上記記載の3.0 APIインターフェースの授権しか対応していないため、Action構成が`*`である場合は、上記10個のインターフェースだけを示しています。
- プロジェクトに基づく授権、ポリシー文法に基づくドメイン名レベル授権を同時に行うことが可能です。プロジェクトAのデータアクセス権限を授権したが、ポリシー文法によりプロジェクトAにおけるaドメイン名のデータクエリー権限を拒否した場合は、プロジェクトAの権限を持っていないが、プロジェクトAにおけるほかのドメイン名の権限を持っています。
