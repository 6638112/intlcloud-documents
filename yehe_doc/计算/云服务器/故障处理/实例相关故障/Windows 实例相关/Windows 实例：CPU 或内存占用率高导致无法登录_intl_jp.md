## ユースケース

本ドキュメントは、CPUとメモリの使用率が高いためにWindows CVMにログインできない問題の調査方法と解決策について説明します。
>? 以下の操作手順はWindows server 2012 R2を例に説明します。OSのバージョンによって操作手順の詳細が若干異なります。

## 操作手順

### mstsc 方式利用してCVMにログインする

1. ローカルコンピューターで、**Windows+R** ショートカットを利用して実行ダイアログボックスを開きます。
2. **mstsc** を入力し、**Enter** を押して「リモートデスクトップ接続」インターフェースを開きます。
3. ポップアップの「リモートデスクトップ接続」ウインドウで、CVMのパブリックIPとログインパスワードを入力して、CVMにログインします。
>!  CVMの負荷が高い場合、リモート接続は確立できません。 **VNC 方式**でCVMにログインする必要があります。操作方法は「[CVMコンソール](https://console.cloud.tencent.com/cvm) >右側の【ログイン】をクリックして> VNC方式を選択してCVMにログインする」です。

### プロセスのリソース使用状況を確認する

1. CVMで「タスクバー」を右クリックして、【タスクマネージャー】を選択します。下図に示すように：
![](https://main.qcloudimg.com/raw/a795f4948fae3eab8a44ec0a3a4ee352.png)
2. 開いた「タスクマネージャー」で、リソース使用状況を確認できます。下図に示すように：
>?  CPUまたはメモリをクリックして、プロセスを昇順/降順でソートできます。
>
![](https://main.qcloudimg.com/raw/56a4be427be5046a15a05b02abbacf66.png)

### プロセスを分析する

タスクマネージャー中のプロセスを確認し、問題を分析と調査して、該当の解決策を講じます。
 - 業務プロセスが大量のリソースを消費しています。例えば、IIS 、httpd 、PHP 、Java等。
 	- 現在の業務トラフィックが多い場合、ハイロードは正常状態です。スケールアウトを検討する必要があります。
 	- 現在の業務トラフィックが多くない場合、さらにサービスエラーログを分析する必要があります。不適切なパラメータ設定によるリソースの浪費の可能性があります。
 - システムプロセスが大量のリソースを消費しています。例えば、 `svchost.exe` 等。
 	- ネットワークで当該プロセスがシステムプロセスであるかどうかを確認できます。
 	- システムプロセスは通常 `C:\windows\system32` ディレクトリにあり、完全な署名と説明があります。
 	- システムを再起動するか、不要かつ安全なシステムプロセスを終了します。
 - 業務プロセスとシステムプロセス以外のプロセスが大量のリソースを消費しています。
	 - プロセス名が怪しくて、署名や説明がなく、`C:\windows\system32` ディレクトリにない異常プロセスがリソースを消費している場合、CVMはウイルスに感染された可能性があります。
	 - CVMのセキュリティ状況を確認し、必要に応じてデータをバックアップして、システムを再インストールします。
