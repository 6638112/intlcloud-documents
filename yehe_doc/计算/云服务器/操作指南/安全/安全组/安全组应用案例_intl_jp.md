セキュリティグループの設定は、Cloud Virtual Machines（CVM）へのアクセスを管理するために使用され、セキュリティグループのインバウンドとアウトバウンドルールを設定することにより、お客様のCVMにアクセスできるかまたは他のネットワークリソースにアクセスできるかどうかを設定できます。
デフォルトでは、セキュリティグループのインバウンドルールおよびアウトバウンドルールは次のとおりです：
- **データのセキュリティを確保するために、セキュリティグループのインバウンドルールは拒否ポリシーであり、外部ネットワークからのリモートアクセスを禁止します。**CVMへの外部ネットワークアクセスを有効にするには、対応するポートのインバウンドルールを開放する必要があります。
- セキュリティグループのアウトバウンドルールは、CVMが外部ネットワークリソースにアクセスできるかを設定するために使用されます。「すべてのポートを開放する」または「ポート22、80、443、3389およびICMPプロトコルを開放する」を選択した場合、セキュリティグループのアウトバウンドルールがすべて開放します。 カスタマイズセキュリティグループルールを選択した場合、アウトバウンドルールはデフォルトですべてのポートを拒否します。外部ネットワークリソースにアクセスするには、対応するポートのアウトバウンドルールを開放する必要があります。

## 一般的なユースケース
このドキュメントでは、セキュリティグループのいくつかの一般的なユースケースを紹介します。以下のケースが要件を満たしている場合は、対応するユースケースの推奨設定に従ってセキュリティグループを直接設定できます。

### シナリオ１：SSH経由でLinux CVMにリモート接続する
**事例**：Linux CVMを作成し、SSH経由でCVMにリモート接続できるようにします。
**ソリューション**：セキュリティグループルールを追加する時に、「タイプ」で「Linuxログイン」を選択し、プロトコルポート22を開放し、Linux SSHログインを開きます。
実際のニーズに応じて、すべてのIPアドレスまたは指定されたIPアドレス（IPセグメント）を開放し、SSH経由でCVMのソースIPアドレスにリモート接続できるように設定します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>Linux ログイン</td><td><ul style="margin: 0;"><li>すべてのIP：0.0.0.0/0</li><li>IPを指定：指定したIPまたはIPセグメントを入力します</li></ul></td><td>TCP:22</td><td>許可</td></tr>
</table>

### シナリオ2：RDP経由でWindows CVMにリモート接続する
**事例**：Windows CVMを作成し、RDP経由でCVMにリモート接続できるようにします。
**ソリューション**：セキュリティグループルールを追加する時に、「種類」で「Windowsログイン」を選択し、プロトコルポート3389を開放し、Windowsリモートログインを開きます。
また、実際のニーズに応じて、すべてのIPアドレスまたは指定されたIPアドレス（IPセグメント）を開放し、RDP経由でCVMのソースIPアドレスにリモート接続できるように設定します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>Windows ログイン</td><td><ul style="margin: 0;"><li>すべてのIP：0.0.0.0/0</li><li>IPを指定：指定したIPまたはIPセグメントを入力します</li></ul></td><td>TCP:3389</td><td>許可</td></tr>
</table>

### シナリオ3：パブリックネットワークがCVMにpingできるようにする
**事例**：CVMを作成し、このCVMと他のCVM間の通信状態が正常かどうかをテストしたいとします。
**ソリューション**：pingプログラムを利用してテストします。 つまり、セキュリティグループルールを追加する時に、「種類」を「Ping」に選択し、ICMPプロトコルポートを開放し、他のCVMがICMPプロトコルを通してこのCVMにアクセスできるようにします。
また、実際のニーズに応じて、すべてのIPアドレスまたは指定されたIPアドレス（IPセグメント）を開放し、ICMPプロトコルを介してCVMのソースIPアドレスにアクセスできるように設定します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>Ping</td><td><ul style="margin: 0;"><li>すべての IP：0.0.0.0/0</li><li>IPを指定：指定したIPまたはIPセグメントを入力します</li></ul></td><td>ICMP</td><td>許可</td></tr>
</table>

### シナリオ4：Telnetを介してCVMにリモートログイン
**事例**：Telnetを介してCVMにリモートログインできるようにします。
**ソリューション**：Telnetを介してCVMにリモートログインしたい場合は、セキュリティグループルールを追加するときに、以下のセキュリティグループルールを設定する必要があります。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド方向</td><td>カスタマイズ</td><td><ul style="margin: 0;"><li>すべての IP：0.0.0.0/0</li><li>IPを指定：指定したIPまたはIPセグメントを入力します</li></ul></td><td>TCP:23</td><td>許可</td></tr>
</table>

### シナリオ5：HTTPまたはHTTPSを介してWebサービスへのアクセスを開く
**事例**：一つのウェブサイトを構築し、ユーザーがHTTPまたはHTTPSを介して構築されたウェブサイトにアクセスできるようにします。
**ソリューション**：HTTPまたはHTTPSを介してウェブサイトにアクセスする必要がある場合は、セキュリティグループルールを追加するときに、実際の要件に従って以下のセキュリティグループルールを設定する必要があります。
- パブリックネットワークのすべてのIPがこのウェブサイトへのアクセスを許可します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>HTTP（80）</td><td>0.0.0.0/0</td><td>TCP:80</td><td>許可</td></tr>
<tr><td>インバウンド</td><td>HTTPS（443）</td><td>0.0.0.0/0</td><td>TCP:443</td><td>許可</td></tr>
</table>
- パブリックネットワークの一部のIPアドレスがこのウェブサイトへのアクセスを許可します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>HTTP（80）</td><td>ウェブサイトへのアクセスが許可されているIPアドレスまたはIPアドレスセグメント</td><td>TCP:80</td><td>許可</td></tr>
<tr><td>インバウンド</td><td>HTTPS（443）</td><td>ウェブサイトへのアクセスが許可されているIPアドレスまたはIPアドレスセグメント</td><td>TCP:443</td><td>許可</td></tr>
</table>

### シナリオ6：外部IPが指定ポートにアクセスすることを許可する
**事例**：サービスをデプロイした後、外部から指定されたサービスポート（例えば、1101）にアクセスできるようにします。
**ソリューション**：セキュリティグループルールを追加する時に、「種類」で「カスタマイズ」を選択し、プロトコルポート1101を開放して、外部から指定されたサービスポートへのアクセスを許可します。
また、実際のニーズに応じて、すべてのIPアドレスまたは指定したIPアドレス（IPセグメント）を開放し、指定したサービスポートのソースIPアドレスへのアクセスを許可します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>カスタマイズ</td><td><ul style="margin: 0;"><li>すべてのIP：0.0.0.0/0</li><li>IPを指定：指定したIPまたはIPセグメントを入力します</li></ul></td><td>TCP:1101</td><td>許可</td></tr>
</table>

### シナリオ7：外部IPアドレスから指定したポートへのアクセスを拒否する
**事例**：サービスをデプロイした後、指定したサービスポート（例えば、1102）が外部からアクセスされないようにします。
**ソリューション**：セキュリティグループルールを追加する時に、「種類」で「カスタマイズ」を選択し、プロトコルポート1102を設定し、「ポリシー」を「拒否」に設定し、外部から指定したサービスポートへのアクセスを拒否します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>カスタマイズ</td><td><ul style="margin: 0;"><li>すべてのIP：0.0.0.0/0</li><li>IPを指定：指定したIPまたはIPセグメントを入力します</li></ul></td><td>TCP:1102</td><td>拒否</td></tr>
</table>

### シナリオ8：CVMが特定の外部IPへのアクセスのみを許可
**事例**：CVMが特定の外部IPアドレスのみアクセスできるようにします。
**ソリューション**：以下の設定を参照し、次の2つのアウトバンドのセキュリティグループルールを追加します。
- CVMインスタンスが特定の外部IPアドレスにアクセスできるようにします。
- インスタンスが任意のプロトコルを介してパブリックIPアドレスにアクセスすることを禁止します。

>! アクセスを許可するルールは、アクセスを拒否するルールより優先する必要があります。
>
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>アウトバンド</td><td>カスタマイズ</td><td>CVMがアクセスできる特定のパブリックIPアドレス</td><td>必要なプロトコルとポート</td><td>許可</td></tr>
<tr><td>アウトバンド</td><td>カスタマイズ</td><td>0.0.0.0/0</td><td>ALL</td><td>拒否</td></tr>
</table>

### シナリオ9：CVMが特定の外部IPにアクセスすることを拒否する
**事例**：CVMが外部の特定のIPアドレスにアクセスできないようにします。
**ソリューション**：次の設定を参照し、セキュリティグループルールを追加します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>アウトバンド</td><td>カスタマイズ</td><td>インスタンスからのアクセスを拒否する特定のパブリックIPアドレス</td><td>ALL</td><td>拒否</td></tr>
</table>

### シナリオ10：FTPを利用してファイルをアップロードまたはダウンロードする
**事例**：FTPソフトウェアを利用して、CVMにファイルをアップロードまたはダウンロードする場合。
**ソリューション**：次の設定を参照し、セキュリティグループルールを追加します。
<table>
<tr><th>方向</th><th>種類</th><th>ソース</th><th>プロトコルポート</th><th>ポリシー</th></tr>
<tr><td>インバウンド</td><td>カスタマイズ</td><td>0.0.0.0/0</td><td>TCP:20-21</td><td>許可</td></tr>
</table>

## 複数のセキュリティルールの組み合わせ
実際のシナリオでは、業務要件に基づいて複数のセキュリティグループルールを設定する必要があります。 例えば、同時にインバウンドルールとアウトバウンドルールを設定します。 1つのCVMを複数のセキュリティグループにバインドできます。CVMが複数のセキュリティグループをバインドされている場合、複数のセキュリティグループは上から下へ順番に実行されます。 セキュリティグループの優先度はいつでも調整できます。セキュリティグループルールの優先度の説明については、[ルールの優先度の説明](https://cloud.tencent.com/document/product/213/12452#.E8.A7.84.E5.88.99.E4.BC.98.E5.85.88.E7.BA.A7)をご参照ください。 

