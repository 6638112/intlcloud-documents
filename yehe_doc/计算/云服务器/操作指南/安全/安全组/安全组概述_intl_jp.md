
## セキュリティグループの概要
セキュリティグループは、状態付きのパケットフィルタリング機能を持つ仮想ファイアウォールであり、単一または複数のCVMのネットワークアクセス制御の設定に使用されます。セキュリティグループは、Tencent Cloudから提供する重要なネットワークセキュリティ分離方法です。

- セキュリティグループは、論理的グルーピングであり、同一リージョン内に同じネットワークセキュリティ分離要件を持つ基幹ネットワークCVM、またはENIインスタンスを同じセキュリティグループ内に追加することができます。
- セキュリティグループポリシーを通してインスタンスのインバウンド・アウトバウンドトラフィックをフィルタリングすることができます。このインスタンスは基幹ネットワークCVM又はENIインスタンスにすることができます。
- いつでもセキュリティグループルールを変更することができ、新しいルールはすぐに有効になります。

## セキュリティグループのテンプレート
カスタムセキュリティグループを作成するか、テンプレートからセキュリティグループを作成できます。現段階では三つのテンプレートを提供します：

- Linuxで22ポートを開放する：SSHログイン用のTCP 22ポートのみがパブリックネットワークに開放します。プライベートネットワークのポートは全て開放します。 
- Windows で3389ポートを開放する：MSTSCログイン用のTCP 3389ポートのみがパブリックネットワークに開放します。プライベートネットワークのポートは全て開放します。
- すべてのポートを開放する：全てのポートがパブリックネットワークとプライベートネットワークに開放します。これは、セキュリティリスクがあります。

## セキュリティグループルール
セキュリティグループルールは、セキュリティグループに関連付けられたインスタンスのインバウンドおよびアウトバウンドトラフィックを制御するために使用されます（（上から下までルールに基づいてフィルタリングされます）。デフォルトでは、新規作成したセキュリティグループは全てのトラフィックをAll Drop（拒否）します。したがって、ルールのないセキュリティグループに関連付けられたCVMは、すべてのトラフィックを拒否します。

セキュリティグループの各ルールに対して、下記の内容を指定することができます：

 - プロトコルタイプ：例、TCP、UDPまたICMPなど。
 - ポート：送信元または宛先のポート範囲。
 - ライセンス認証タイプ：アドレスフィールド（ CIDR/IP ）にアクセス、またはセキュリティグループにアクセス（セキュリティグループID）します。
 - 送信元または宛先：トラフィックの送信元（インバウンドルール）又は宛先（アウトバウンドルール）としては、下記選択肢のいずれかを指定してください。
  - CIDR表記で単一のIPアドレスを指定します。
  - CIDR表記でIPアドレス範囲を指定します（例： 203.0.113.0/24 ）。
  - セキュリティグループIDの引用については、次のセキュリティグループIDのいずれかを引用できます。
  	- 使用中のセキュリティグループ。（これは、セキュリティグループに関連付けられたCVMが相互アクセスできるかどうかを示します）
  	- ほかのセキュリティグループ。同じリージョンの別のセキュリティグループ ID です。
 - ポリシー：許可または拒否。
  >**注意事項：**
  > - セキュリティグループIDの引用は高レベルな機能であり、オプションとして利用することができます。引用されたセキュリティグループのルールは、現在のセキュリティグループに追加されません。
  > - セキュリティグループのIDを引用し、かつポリシーを許可に設定する場合：送信元セキュリティグループIDに関連付けられたCVMと元のセキュリティグループに関連付けられたCVMが相互アクセスすることができます。

## セキュリティグループの優先順位の説明
セキュリティグループの優先順位：**数字が小さいほど、優先度が高くなります。**
インスタンスが複数のセキュリティグループにバインドされている場合、優先度はインスタンスのセキュリティルールを評価するための基礎となります。
なお、インスタンスにバインドされた複数のセキュリティグループにある最後のポリシーは【ALL Traffic 拒否】である場合、優先度が最も低いセキュリティグループの最後のポリシー【ALL Traffic 拒否】のみが有効となります。

## セキュリティグループの制限

- セキュリティグループは[ネットワーク環境](/doc/product/213/5227)内のすべてのCVMインスタンスに適用されます。
- 各ユーザーは、各リージョンでの各プロジェクトに最大50個のセキュリティグループを設定することができます。　
- 一つのセキュリティグループには、最大100のインバウンド/アウトバウンドアクセスポリシーを設定できます。
- 一つのCVMは複数のセキュリティグループに関連付けることができ、一つのセキュリティグループが複数のCVMに関連付けることができます。その数量の無制限です。
- **基幹ネットワーク**のCVMに関連付けられているセキュリティグループは、Tencent Cloud上（またはTencent Cloudにアクセス）のCDB 、クラウドキャッシュ（ Redis と Memcached ）のデータパケットを**フィルタリングできません**。必要に応じて、iptablesを使用してそのようなインスタンスのトラフィックをフィルタリングできます。

| 機能説明 | 数量 | 
|---------|---------|
| セキュリティグループ | 50 個/リージョン |
| アクセスポリシー | 100（インバウンド/アウトバウンド）|
| インスタンスに関連付けられているセキュリティグループの数 | 制限なし |
|　セキュリティグループに関連付けられているインスタンスの数 | 制限なし |

>**注意事項：**
> 大量のインスタンスを相互アクセスが必要な場合、それらを複数のセキュリティグループに割り当て、セキュリティグループIDのルールを利用してライセンス認証を行うことにより、相互アクセスが可能になります。

## 操作ガイド
CVMコンソールを利用して、新規作成、確認と削除などの操作でセキュリティグループ及びセキュリティグループルールを管理することができます。

### クイックスタート
[セキュリティグループ](/doc/product/213/500)はTencent Cloudが提供するインスタンスレベルのファイアウォールであり、いかなるCVMにインバウンド/アウトバウンドのトラフィックコントロールを行うことができます。

 1. [CVMコンソール-Cloud Virtual Machine](https://console.cloud.tencent.com/cvm/index)にログインし、左側ナビゲーションバーで、【セキュリティグループ】をクリックします。

 2. 【+New】ボタンをクリックして、セキュリティグループの名を入力して（例 my-security-group）、**テンプレート**作成または**カスタマイズ**作成を選択し、インバウンド・アウトバウンドルールを確認した後、【OK】をクリックします。

 3. セキュリティグループのリストの右側に【Manage Instances】ボタンをクリックして、関連したいインスタンスにチェックを入れて、セキュリティグループがインスタンスに関連する操作を完成します。 

**または**

&nbsp;&nbsp;&nbsp;&nbsp;4\. インスタンスのリストページに入って、あるインスタンスにバインドしたセキュリティグループを表示または変更することもできます。【インスタンス】のリストページでセキュリティグループを調整したいインスタンスを選択して、右側にある【その他】-【セキュリティグループ設定】をクリックして 、セキュリティグループのバインディングを選択します。
（例：ローカルコンピューター（IP：186.23.55.90）からHTTP経由でCVMへのリクエストを許可すると、下図のようなルールを作成できます。）


### セキュリティグループの作成

 1. [コンソール-セキュリティグループ](https://console.cloud.tencent.com/cvm/securitygroup)にアクセスします。

 2. 左側ナビゲーションバーの【セキュリティグループ】をクリックします。

 3. 【+New】ボタンをクリックします。

 4．セキュリティグループの名称（例：my-security-group）を入力するとともに説明を追加します。
 
 5. 【OK】をクリックし、新規作成を完了します。

### セキュリティグループにルールを追加する

 1. [コンソール-セキュリティグループ](https://console.cloud.tencent.com/cvm/securitygroup)にアクセスします。

 2. 左側ナビゲーションバーで【セキュリティグループ】をクリックします。

 3.更新するセキュリティグループを選択して、【セキュリティグループID】をクリックします。ウィンドウでこのセキュリティグループの詳細情報、またインバウンドルールとアウトバウンドルールを使用するためのタブが表示されます。

 4．インバウンド/アウトバウンドルールのタブで、【Edit】をクリックします。タブの中からイン/アウトバウンドルールを選択して、必要な情報を入力した後、【Save】をクリックします。

### CVMインスタンスに関連付けるセキュリティグループを設定する

 1. [コンソール-Cloud Virtual Machine](https://console.cloud.tencent.com/cvm/) にアクセスします。

 2. 左側ナビゲーションバーで、【インスタンス】をクリックします。

 3．セキュリティグループを設定したいインスタンスの右側の操作バーで、【その他】をクリックして、【セキュリティグループ設定】をクリックします。

 4．セキュリティグループ設定のダイアログボックスで、リストから一つまたは複数のセキュリティグループを選択して、【OK】をクリックします。

**または**

 1. [コンソール-セキュリティグループ](https://console.cloud.tencent.com/cvm/securitygroup)にアクセスします。

 2. 左側ナビゲーションバーで、【セキュリティグループ】をクリックします。

 3．関連したいセキュリティグループを選択して、操作バーの【Insert】または【Delete】ボタンをクリックします。

 4．インスタンスの追加/削除のポップアップボックスで、このセキュリティグループに関連したいインスタンスを追加または削除して、【確定】をクリックします。
 

### セキュリティグループルールのインポート・エクスポート
 1. [コンソール-セキュリティグループ](https://console.cloud.tencent.com/cvm/securitygroup)にアクセスします。

 2. 左側ナビゲーションバーで、【セキュリティグループ】をクリックします。

 3. 更新するセキュリティグループを選択して、【セキュリティグループID】をクリックします。ウィンドウでこのセキュリティグループの詳細情報、またインバウンドルールとアウトバウンドルールを使用するためのタブが表示されます。

 4．タブからインバウンド/アウトバウンドルールを選択して、【Inbound rule】ボタンをクリックします。既にルールの設定がある場合、既存のルールを先にエクスポートすることをお勧めし、新しくインポートしたルールは既存ルールに上書きします。ルールの設定がなかった場合、先にテンプレートをエクスポートして、テンプレートファイルを編集してから、ファイルをインポートできます。

### セキュリティグループのクローン

 1. [コンソール-セキュリティグループ](https://console.cloud.tencent.com/cvm/securitygroup)にアクセスします。

 2. 左側ナビゲーションバーで、【セキュリティグループ】をクリックします。

 3. リストの中でセキュリティグループの【Clone】ボタンをクリックします。

 4. Clone security groupのダイアログボックスで、Target project、Target regionを選択した後に、【OK】をクリックします。新しいセキュリティグループをCVMに関連付ける必要がある場合は、セキュリティグループを再設定してください。

### セキュリティグループの削除

 1. [コンソール-セキュリティグループ](https://console.cloud.tencent.com/cvm/securitygroup)にアクセスします。

 2. 左側ナビゲーションバーで、【セキュリティグループ】をクリックします。

 3. リストの中でセキュリティグループの【Delete】ボタンをクリックします。

 4．ポップアップウィンドウで【確定】をクリックします。現在のセキュリティグループにCVMが関連付けられている場合、削除する前にセキュリティグループの関連付けを解除する必要があります。

## セキュリティグループとネットワークACLの区別

| セキュリティグループ | ネットワークACL | 
|---------|---------|
| インスタンスレベルでの操作（第一層防御層）| サブネットレベルでの操作（第二防御層） |
| 許可ルールと拒否ルールがサポートします|  許可ルールと拒否ルールがサポートします |
| ステートフル：返されたトラフィックは自動的に許可され、ルールの影響を受けません | ステートレス： 返されたトラフィックはルールによって明示的に許可される必要があります|
|インスタンスを起動するとともにセキュリティグループを指定されているか、または後ほどインスタンスはセキュリティグループに関連付けられている場合にのみ、操作はインスタンスに適用されます|　操作は、関連付けられたサブネット内のすべてのCVMインスタンスに自動的に適用されます|

## クラウドAPI
クラウドAPIはセキュリティグループの開発者ツールです。クラウドAPIを通してセキュリティグループの操作が可能であり、セキュリティグループとCVMインスタンスに関する設定の管理なども可能です。詳細については、[セキュリティグループに関するインターフェース](/doc/api/229/API%E6%A6%82%E8%A7%88#6.-セキュリティグループに関するインターフェース) をご参照ください。




