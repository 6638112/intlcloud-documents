## 작업 시나리오
본 문서는 Windows 운영 체제의 Tencent Cloud Virtual Machine(CVM)에서 어떤 방법으로 IIS를 통해 FTP 사이트를 구축하는지 소개합니다.

## 소프트웨어 버전(예시)
본 문서에서 구축하는 FTP 서비스 구성 버전은 다음과 같습니다.
 - Windows 운영 체제의 경우, 본 문서는 Windows Server 2012 를 예시로 사용합니다.
 - IIS: Web 서버의 경우, 본 문서는 IIS 8.5를 예시로 사용합니다.

## 작업 순서
### 1단계: CVM 로그인
[RDP 파일을 사용하여 Windows 인스턴스에 로그인(권장)](https://cloud.tencent.com/document/product/213/5435).
실제 작업 스타일에 따라 [데스크탑에 원격 연결하여 Windows 인스턴스에 로그인](https://cloud.tencent.com/document/product/213/35703)할 수 있습니다.

### 2단계: IIS에서 FTP 서비스 설치
1. 운영 체제 인터페이스에서 <img src="https://main.qcloudimg.com/raw/446c1e8cb7da2ce280d710c6a46b693d.png" style="margin:-3px 0px"> 클릭하여 서버 관리자를 엽니다.
2. "서버 관리자" 창에서 [역할 및 기능 추가]를 클릭합니다.
3. "역할 및 기능 추가 가이드" 팝업 창에서 [다음 단계]를 클릭하여 "설치 유형 선택" 인터페이스로 이동합니다.
4. "설치 유형 선택" 인터페이스에서 [역할 또는 기능에 기반하여 설치]를 선택하고 [다음 단계]를 클릭합니다.
5. "타깃 서버 선택" 인터페이스에서 기본 설정을 유지하고 [다음 단계]를 클릭합니다.
6. "서버 역할 선택" 인터페이스에서 [Web 서버(IIS)]를 체크하고 팝업 창에서 [기능 추가]를 클릭합니다.
7. [다음 단계]를 연속 3번 클릭한 후 "역할 서비스 선택" 인터페이스로 이동합니다.
8. "역할 서비스 선택" 인터페이스에서 [FTP 서비스] 및 [FTP 확장]을 체크하고 [다음 단계]를 클릭합니다.
9. [설치]를 클릭하여 FTP 서비스 설치를 시작합니다.
10. 설치 완료 후 [닫기]를 클릭합니다.
<span id="user"></span>
### 3단계: FTP 사용자 이름 및 비밀번호 생성
>다음 순서에 따라 FTP 사용자 이름 및 비밀번호를 설정하세요. 익명 사용자로 FTP 서비스에 액세스하려면 이 단계를 건너뛰세요.
>
1. "서버 관리자" 창에서 우측 상단 내비게이션 바의 [툴]>[컴퓨터 관리]를 선택하여 컴퓨터 관리 창을 엽니다.
2. "컴퓨터 관리" 인터페이스에서 좌측 내비게이션 바의 [시스템 툴]>[로컬 사용자 및 그룹]>[사용자]를 선택합니다.
3. [사용자]의 오른쪽 인터페이스에서 빈 공간에 우클릭 하고 [신규 사용자]를 선택합니다.
4. "신규 사용자" 인터페이스에서 다음 제시에 따라 사용자 이름 및 비밀번호를 설정하고 [생성]을 클릭합니다.
주요 매개변수는 다음과 같습니다.
  - 사용자 이름: 사용자 정의의 경우, 본 문서는 `ftpuser`를 예시로 사용합니다.
  - 비밀번호 및 비밀번호 확인: 사용자 정의의 경우, 비밀번호는 대문자, 소문자 및 숫자를 동시에 포함해야 합니다. 본 문서는 `tf7295TFY` 를 예시로 사용합니다.
  - [다음 로그인 시 비밀번호 변경 필요] 체크를 취소하고 [비밀번호 무기한 유효]에 체크합니다.
  수요에 맞게 체크하며, 본 문서는 비밀번호 무기한 유효를 예시로 사용합니다.
5. [닫기]를 클릭하여 "신규 사용자" 창을 닫은 후 목록에서 이미 생성한 `ftpuser` 사용자를 조회할 수 있습니다.
	
### 4단계: 공유 폴더 권한 설정
>FTP 사이트의 공유 폴더를 설정해야 합니다. 본 문서는 `C:\test` 폴더를 예로 들며, 폴더 안에 공유할 파일 `test.txt`이 미리 포함되어 있습니다.
>
1. 운영 체제 인터페이스에서 <img src="https://main.qcloudimg.com/raw/863967bab67b6cd83ce5f0924e1b19c8.png" style="margin:-3px 0px"> 클릭하여 "해당 PC" 창을 엽니다.
2. C 드라이버에서 `test` 폴더를 선택하고 우클릭 후 [속성]을 선택합니다.
3.  “test 속성” 창에서 [보안] 태그를 선택합니다.
4.  `Everyone` 사용자를 선택하고 [편집]을 클릭합니다. 아래 그림 참조
"그룹 또는 사용자 이름"에 `Everyone`이 없으면 [Everyone 사용자 추가](#add)를 참조하여 추가해주세요.
5. <span id="step5"></span>"test의 권한" 인터페이스에서 수요에 따라 `Everyone` 사용자의 권한을 설정하고 [확인]을 클릭합니다. 아래 그림 참조
본 문서는 예시로 `Everyone` 사용자에게 모든 권한을 부여합니다.
6. "test 속성" 창에서 [확인]을 클릭하여 설정을 완료합니다.


### 5단계: FTP 사이트 추가
1. "서버 관리자" 창에서 우측 상단 내비게이션 바의 [툴]>[Internet Information Services (IIS) 관리자]를 선택합니다.
2. 열린 "Internet Information Sevices (IIS) 관리자" 창에서 좌측 내비게이션 바의 서버 이름을 차례대로 펼치고 [웹 사이트]를 우클릭 후 [FTP 사이트 추가]를 선택합니다.
3. "사이트 정보" 인터페이스에서 다음 정보를 참조하여 설정한 후 [다음 단계]를 클릭합니다.
    - **FTP 사이트 이름**: FTP 사이트 이름을 작성하며, 본 문서는 `ftp`를 예시로 사용합니다.
    - **물리적 경로**: 권한 설정을 완료한 공유 폴더의 경로를 선택하세요. 본 문서는 `C:\test` 를 예시로 사용합니다.
4. "바인딩 및 SSL 설정" 인터페이스에서 다음 정보를 참조하여 설정한 후 [다음 단계]를 클릭합니다.
설정한 주요 매개변수 정보는 다음과 같습니다.
     - **바인딩**: IP 주소는 기본 선택인 [전부 미할당]을 선택하고, 포트는 기본값 21(FTP 기본 포트 번호)입니다. 또한 사용자가 포트를 자체 설정할 수 있습니다.
     - **SSL**: 수요에 따라 선택하세요. 본 문서는 [SSL 없음]을 예시로 사용합니다.
       -  **SSL 없음**: SSL 암호화가 필요하지 않습니다.
       - **SSL 허용**: FTP 서버가 클라이언트와의 비 SSL 및 SSL 연결을 지원하도록 허용합니다.
      -  **SSL 요구**: SSL을 암호화해야만 FTP 서버와 클라이언트 사이에서 통신할 수 있습니다.
   사용자가 [SSL 허용] 또는 [SSL 필요]를 선택한 경우, "SSL 인증서"에서 기존 SSL 인증서를 선택하거나 [서버 인증서 제작](#ssl) 순서를 참조하여 하나의 SSL 인증서를 제작할 수 있습니다.
5. "신원 인증 및 라이선스 정보" 인터페이스에서 다음 정보를 참조하여 설정한 후 [다음 단계]를 클릭합니다.
 - **신원 인증**: 신원 인증 방법 하나를 선택합니다. 본 문서는 [기본]을 예시로 사용합니다.
    - **익명**: 모든 사용자가 익명 또는 FTP 사용자 이름만 제공하는 콘텐츠에 액세스 하도록 허용합니다.
	 - **기본**: 사용자가 유효한 사용자 이름과 비밀번호를 제공해야만 콘텐츠에 액세스할 수 있도록 요구합니다. 기본 신원 인증은 네트워크 전송을 통해 암호화되지 않은 비밀번호이기 때문에 사용자가 클라이언트와 FTP 서버 간의 연결이 안전(예: SSL 사용을 통해)하다고 인지할 때에만 이 신원 인증 방법을 사용할 수 있습니다.
 - **라이선싱**: 액세스가 허용되는 풀다운 목록에서 한 가지 방식을 선택합니다. 본 문서는 지정 사용자 `ftpuser` 를 예시로 사용합니다.
	    - **모든 사용자**: 익명 사용자나 신원이 표시된 사용자에 관계 없이 모든 사용자는 해당 콘텐츠에 액세스할 수 있습니다.
	    - **익명 사용자**: 익명 사용자는 콘텐츠에 액세스할 수 있습니다.
	    - **지정한 역할 또는 사용자 그룹**: 일부 역할 또는 사용자 그룹의 멤버만 콘텐츠에 액세스할 수 있습니다. 이 옵션을 선택하면 역할 또는 사용자 그룹을 지정해야 합니다.
	    - **지정한 사용자**: 지정한 사용자만 콘텐츠에 액세스할 수 있습니다. 이 옵션을 선택하면 사용자 이름을 지정해야 합니다.
 - **권한**: 필요에 따라 권한을 설정합니다. 본 문서는 [읽기]와 [쓰기] 권한 설정을 예시로 사용합니다.
    - **읽기**: 권한이 부여된 사용자의 디렉터리로부터 콘텐츠 읽기를 허용합니다.
    - **쓰기**: 권한이 부여된 사용자의 디렉터리 쓰기를 허용합니다.
7. [완료]를 클릭하면 바로 FTP 사이트를 생성할 수 있습니다.

### 6단계: 보안 그룹 및 방화벽 설정
1. FTP 사이트 구축을 완료한 후 FTP 사이트 추가 시 포트를 바인딩하는 인바운드 규칙을 개방하세요. 예: 21 포트의 인바운드 규칙
FTP 사이트 추가 시 기타 포트를 사용했을 경우, 방화벽에 이 포트의 통과를 허가하는 인바운드 규칙을 한 줄 추가해야 합니다.
2. (선택 가능) FTP 서버가 방화벽으로부터의 수동 연결을 수락할 수 있도록 [Microsoft 공식 문서](https://docs.microsoft.com/en-us/previous-versions/orphan-topics/ws.11/hh831655(v=ws.11))를 참조하여 FTP 사이트의 방화벽 지원을 설정합니다.

### 7단계: FTP 사이트 테스트
귀하는 FTP 클라이언트 소프트웨어, 브라우저 또는 파일 리소스 관리자 등의 툴을 통해 FTP 서비스를 인증할 수 있습니다. 본 문서는 클라이언트의 파일 리소스 관리자를 예시로 사용합니다.
1. 귀하의 실제 상황에 따라 IE 브라우저를 설정하세요.
 - FTP 사이트 방화벽 설정 완료: 클라이언트의 IE 브라우저를 열어 [툴]>[Internet 옵션]>[고급]을 선택하고 [수동 FTP(방화벽과 DSL 모뎀에 사용되는 호환성) 사용]의 체크를 취소한 후 [확인]을 클릭합니다.
 - FTP 사이트 방화벽 미설정:
    1. **FTP 서버**의 IE 브라우저를 열어 [툴]>[Internet 옵션]>[고급]을 선택하고 [수동 FTP(방화벽과 DSL 모뎀에 사용되는 호환성) 사용]의 체크를 취소한 후 [확인]을 클릭합니다.
    2. **클라이언트**의 IE 브라우저를 열어 [툴]>[Internet 옵션]>[고급]을 선택하고 [수동 FTP(방화벽과 DSL 모뎀에 사용되는 호환성) 사용]을 체크한 후 [확인]을 클릭합니다.
2. 클라이언트의 컴퓨터를 열고 경로 창에서 다음 주소에 액세스합니다.
```
ftp://CVM 공인 IP:21
```
3. "로그인 신원" 팝업 창에 [FTP 사용자 이름 및 비밀번호 생성](#user)에서 설정된 사용자 이름 및 비밀번호를 입력합니다.
본 문에서 사용하는 사용자 이름은 `ftpuser`이고, 비밀번호는 `tf7295TFY`입니다.
4. 성공적으로 로그인한 후 바로 파일을 업로드 또는 다운로드할 수 있습니다.

## 부록
<span id="add"></span>
### Everyone 사용자 추가
1. "test 속성" 창에서 [보안] 태그를 선택하고 [편집]을 클릭합니다.
2. "test 의 권한" 인터페이스에서 [추가]를 클릭합니다.
3. "사용자 또는 그룹 선택" 인터페이스에서 [고급]을 클릭합니다.
4. 팝업된 "사용자 또는 그룹 선택" 인터페이스에서 [바로 찾기]를 클릭합니다.
5. 검색 결과에서 `Everyone`을 선택하고 [확인]을 클릭합니다.
6. "사용자 또는 그룹 선택" 인터페이스에서 [확인]을 클릭하면 바로 추가할 수 있습니다.
[5단계](#step5)로 이동하여 `Everyone` 사용자 권한을 설정합니다.
<span id="ssl"></span>
### 서버 인증서 제작
1. "서버 관리자" 창에서 우측 상단 내비게이션 바의 [툴]>[Internet Information Services (IIS) 관리자]를 선택합니다.
2. "Internet Information Services (IIS) 관리자" 팝업 창에서 좌측 내비게이션 바의 서버를 선택하고 오른쪽 인터페이스의 [서버 인증서]를 더블클릭 합니다.
3. 오른쪽 작업 창에서 [자체 서명 인증서 생성]을 선택합니다.
4. "자체 서명 인증서 생성" 팝업 창에서 인증서 명칭 및 스토리지 유형을 설정합니다.
본 문서는 개인 스토리지 유형의 SSL 인증서 생성을 예시로 사용합니다.
5. [확인]을 클릭하면 바로 생성할 수 있습니다.
