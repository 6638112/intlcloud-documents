## 概要
Tencent Cloudが提供するパブリックイメージ、マーケットプレイスイメージに加えて、カスタムイメージを作成することもできます。カスタムイメージを作成した後、Tencent Cloudコンソールでこのカスタムイメージを使用して同じ構成のCVMインスタンスをすばやく作成できます。
>?
>- イメージは、データストレージにCBSスナップショットサービスを使用します。カスタムイメージを作成する場合、イメージに関連付けられるスナップショットがデフォルトで作成されます。カスタムイメージを保持すると、一定のスナップショット費用が発生します。詳細については、[スナップショットの課金方法](https://intl.cloud.tencent.com/document/product/362/32415)をご参照ください。
>- 2018年7月以降にパブリックイメージに基づいて作成されたインスタンス（システムディスクはクラウドディスク）では、イメージのオンライン作成（インスタンスをシャットダウンせずにイメージを作成）がサポートされています。上記以外の場合、カスタムイメージを作成する前に、このインスタンスをシャットダウンしてください。これにより、イメージが現在のインスタンスと同じデプロイ環境を持つようにします。


## 注意事項

- 各リージョンは、最大10個のカスタムイメージをサポートします。
- 以下のディレクトリ/ファイルがクリアされます：
 - `/var/log/`  
 - `/root/.bash_history、/home/ubuntu/.bash_history`（Ubuntu  システム）
- Linuxインスタンスを使用してカスタムイメージを作成する時、`/etc/fstab`にデータディスク構成が含まれていないことを確認してください。そうでなければ、このイメージで作成されたインスタンスを正常に起動できません。カスタムイメージを作成するLinuxインスタンスにデータディスクがマウントされている場合、`/etc/fstab` で関連するデータディスク構成をコメントアウトまたは削除する必要があります。
- 作成プロセスは10分以上かかりますが、具体的な時間はインスタンスのデータサイズによって異なります。業務への影響を避けるためには、事前に関連準備を行ってください。

## 操作手順

### コンソールを介してインスタンスからカスタムイメージを作成

1.  [CVMコンソール](https://console.cloud.tencent.com/cvm)にログインします。
2. インスタンスの管理画面で、イメージを作成するインスタンスを選択し、【その他】>【インスタンス状態】>【シャットダウン】をクリックします。下図に示すように：
![シャットダウン](https://main.qcloudimg.com/raw/cc0bb1c82b96cca94cb7c1c011b664a7.png)
3. インスタンスがシャットダウンされた後、このインスタンス行で、【詳細】>【イメージの作成】をクリックします。下図に示すように：
![](https://main.qcloudimg.com/raw/8e3fc28e1a0b1e9e337ff72e34a9fd01.png)
4. 「カスタムイメージの作成」ダイアログボックスで、「イメージ名」と「イメージ説明」を入力し、【イメージの作成】をクリックして作成します。
>?  コンソールの右上にある <img src="https://main.qcloudimg.com/raw/31b31c7b27848f0378932f17273feff3.png" style="margin: 0;"></img>をクリックし、イメージ作成の進行状況を確認します。
>
5. イメージが作成された後、左側のナビゲーションウィンドウで【[イメージ](https://console.cloud.tencent.com/cvm/image)】をクリックし、イメージの管理画面に入ります。
6. イメージリストで、作成したイメージを選択し、【インスタンスの作成】をクリックし、イメージと同じ構成のサーバーを購入できます。下図に示すように：
![カスタムイメージ](https://main.qcloudimg.com/raw/2d64df77d16b3c26d275770e03a1caf1.png)

### APIを使用してカスタムイメージを作成

CreateImageインターフェースを使用してカスタムイメージを作成することができます。詳細については、[CreateImage](https://intl.cloud.tencent.com/document/product/213/33276)をご参照ください。

## ベストプラクティス

### データディスク上のデータ移行

新しいインスタンスを起動する同時に、元のインスタンスデータディスクのデータを保持する必要がある場合、最初にデータディスクの[スナップショット](https://intl.cloud.tencent.com/document/product/362/31638)を作成してください。 新しいインスタンスを起動する時に、このデータディスクのスナップショットを利用して新しいクラウドデータディスクを作成します。
詳細については、 [スナップショットを使用してクラウドディスクの作成](https://intl.cloud.tencent.com/document/product/362/5757)をご参照ください。