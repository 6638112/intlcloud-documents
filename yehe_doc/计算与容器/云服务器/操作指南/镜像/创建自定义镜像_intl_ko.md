## 작업 시나리오

이미지를 생성할 때 공용 이미지에서 인스턴스를 실행하고, 해당 이미지를 사용자의 인스턴스에 연결하여 소프트웨어 환경을 직접 배포할 수 있습니다. 인스턴스가 정상적으로 실행되면, 실제 수요에 따라 사용자 정의 이미지를 새로 생성할 수 있습니다. 새로운 사용자 정의 이미지를 생성한 후 해당 이미지를 사용하여 기존 인스턴스와 동일한 사용자 정의 항목을 가진 새로운 인스턴스를 실행할 수 있습니다.

> 
> - 사용자 정의 이미지를 생성할 때 시스템은 관련 스냅샷을 기본으로 생성하므로, 해당 스냅샷을 삭제하기 전에 먼저 연결된 이미지를 삭제해야 합니다. 현재 스냅샷은 상용화되어 사용자 정의 이미지를 보관할 경우 일정한 스냅샷 요금이 발생하게 됩니다. 스냅샷 청구 정책에 대한 내용은 [스냅샷 상용화 공지](https://intl.cloud.tencent.com/document/product/362/32413)를 참조 바랍니다.
> - 2018년 7월 이후 공용 이미지를 기반으로 생성된 클라우드 CVM은 온라인 생성 이미지를 지원합니다(인스턴스가 종료되지 않은 상황에서 이미지 생성).
> - 다른 인스턴스에서 사용자 정의 이미지를 생성할 경우, 먼저 인스턴스를 종료한 뒤 이미지가 현재 인스턴스의 배포 환경과 완벽히 일치하는지 확인해 주시기 바랍니다.

## 주의 사항

- 각 리전마다 최대 10개의 사용자 정의 이미지를 지원합니다.
- 다음의 디렉터리/파일은 삭제됩니다.
 - /var/log/  
 - /root/.bash_history, /home/ubuntu/.bash_history(Ubuntu 시스템)
- Linux 인스턴스가 사용자 정의 이미지를 생성할 때 데이터 디스크 구성에 /etc/fstab가 포함되지 않으면 해당 이미지로 생성된 인스턴스가 정상적으로 실행되지 않습니다. 사용자 정의 이미지를 생성한 Linux 인스턴스에 마운트된 데이터 디스크가 있다면, /etc/fstab에서 자체 구성된 데이터 디스크 관련 구성을 주석 처리하거나 삭제해야 합니다.
- 이미지 생성 프로세스는 10분 또는 그 이상의 시간이 소요되며, 구체적인 시간은 인스턴스의 데이터 크기에 따라 다르므로 비즈니스에 영향을 주지 않도록 미리 대비하시기 바랍니다.

## 작업 순서

### 콘솔을 이용하여 인스턴스에서 생성

1. [CVM 콘솔](https://console.cloud.tencent.com/cvm)에 로그인합니다.
2. 인스턴스 관리 페이지에서 이미지를 생성할 인스턴스를 선택하고 [더 보기]>[인스턴스 상태]>[셧다운]을 클릭합니다.
3. 인스턴스가 종료되면 해당 인스턴스 행에서 [더 보기>[이미지 생성]을 클릭합니다.
4. 팝업된 '사용자 정의 이미지 생성' 창에서 '이미지 명칭' 및 '이미지 설명'을 입력한 뒤, [이미지 생성]을 클릭하여 생성합니다.
> 콘솔 우측 상단의 <img src="https://main.qcloudimg.com/raw/31b31c7b27848f0378932f17273feff3.png" style="margin: 0;"></img>를 클릭하면, 이미지 생성 진행도를 조회할 수 있습니다.
>
5. 이미지가 생성된 후 왼쪽 메뉴에서 [[이미지](https://console.cloud.tencent.com/cvm/image)]를 클릭하여 이미지 관리 페이지로 들어갑니다.
6. 이미지 목록에서 생성된 이미지를 선택한 뒤 [인스턴스 생성]을 클릭하여 기존 이미지와 동일한 서버를 구매합니다.

### API를 이용하여 생성

CreateImage 인터페이스를 이용하여 사용자 정의 이미지를 생성할 수 있습니다. 자세한 내용은 [이미지 API 생성](https://intl.cloud.tencent.com/document/product/213/33276)를 참조 바랍니다.

## 모범 사례

### 데이터 디스크의 데이터 마이그레이션

기존 인스턴스 데이터 디스크의 데이터를 유지하면서 신규 인스턴스를 실행하고 싶다면, 데이터 디스크의 [스냅샷](https://intl.cloud.tencent.com/document/product/362/31638)을 생성한 다음, 신규 인스턴스를 실행할 때 해당 데이터 디스크의 스냅샷을 이용하여 새로운 CBS 데이터 디스크를 생성합니다.
더 자세한 정보는 [스냅샷으로 CBS 생성](https://intl.cloud.tencent.com/document/product/362/5757)을 참조 바랍니다.




