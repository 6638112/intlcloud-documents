## 기능 소개

Content Delivery Network(CDN)는 CDN 액세스 로그에 대한 실시간 수집 및 푸시를 지원함으로써, 로그 데이터에 대해 빠르게 인덱스 및 분석할 수 있습니다. 사용자는 CDN 콘솔에서 간편한 원스톱 액세스를 통해 로그 수집 및 저장부터 인덱스까지 안정적이고 신뢰도 높은 Cloud Log Service(CLS)를 전면 이용할 수 있습니다.

>? 현재 CDN 실시간 CLS는 베타 테스트 중이므로 먼저 [CLS를 활성화](https://console.cloud.tencent.com/cls)하고 [CDN 실시간 로그 신청서를 제출](https://intl.cloud.tencent.com/apply/p/f4gs2k0au1i)한 후에 사용할 수 있습니다. 신청서를 제출한 날로부터 7영업일 이내에 심사를 진행합니다.
## 적용 시나리오
사용자 액세스 현황 실시간 조회 / 분석

## 기본 개념
### 로그셋
로그셋(Logset)은 CLS의 프로젝트 관리 단위로, 서로 다른 프로젝트의 로그를 구분하기 위해 사용되며, 한 로그셋에는 하나의 프로젝트 혹은 애플리케이션이 상응하게 됩니다. CDN 로그셋에는 다음과 같은 기본 속성 정보가 포함됩니다.
+ 로그셋 이름: cdn_logset
+ 리전: 로그셋 소속 [리전](https://intl.cloud.tencent.com/document/product/614/18940)
+ 저장 시간: 로그셋 내 데이터의 현재 저장 시간 주기
+ 생성 시간: 로그셋의 생성 시간

### 로그 토픽
로그 토픽(Topic)은 CLS의 기본 관리 단위로, 한 로그셋에 여러 개의 로그 토픽이 포함될 수 있습니다. 한 로그 토픽에는 하나의 애플리케이션 혹은 서비스가 상응하게 되며, 기기는 다르지만 유형은 같은 로그는 동일한 로그 토픽에 수집하시기를 권장합니다. 예시, 한 서비스 프로젝트에 작업 로그, 응용 프로그램 로그, 액세스 로그 이 세 가지 로그가 있다면 유형마다 하나의 로그 토픽을 생성할 수 있습니다.

CLS 시스템은 로그 토픽을 단위로 사용자의 각 로그 데이터를 구분 및 관리하며, 로그 토픽마다 데이터 소스, 인덱스 및 전송 규칙을 다르게 설정할 수 있습니다. 따라서, 로그 토픽은 CLS에서 로그 데이터를 설정 및 관리하는 기본적인 단위이며, 로그 토픽을 생성한 후에는 관련 규칙을 설정해야만 정상적으로 로그를 수집함과 동시에 인덱스 분석, 전송 등의 기능을 사용할 수 있습니다.

시나리오 기능 면에서 로그 토픽은 다음의 기능을 제공합니다.
- 로그 토픽으로 로그 수집
- 로그 토픽을 단위로 로그 저장 및 관리
- 로그 토픽을 단위로 로그 인덱스 및 분석
- 로그 토픽을 단위로 로그를 다른 플랫폼에 전송
- 로그 토픽에서 로그 다운로드 및 소비

## 운영 가이드
[CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인한 후 왼쪽 메뉴에서 [로그 서비스]를 클릭하고 [실시간 로그]를 선택하면 실시간 로그 페이지로 이동하여 실시간 로그 전송을 생성할 수 있습니다.
![](https://main.qcloudimg.com/raw/f9e726354eb74855c507574d9aad5c66.png)

### 신규 로그 토픽 생성
[New]를 클릭하여 로그 토픽을 생성합니다.
>!하나의 로그셋에는 최대 10개의 토픽까지 생성할 수 있습니다.

![](https://main.qcloudimg.com/raw/a2d6566eb6d002218a21223cffa5c447.png)

### 로그 토픽 설정
새 로그 토픽 이름을 입력하고, 해당 로그 토픽에 도메인을 바인딩합니다.
>!
>- 새로운 로그 토픽은 기존 로그 토픽과 같은 이름을 사용할 수 없습니다.
>- 한 도메인은 여러 로그 토픽에 바인딩할 수 없고, 하나의 로그 토픽에만 바인딩할 수 있습니다.
>- 설정 정보를 저장한 이후 설정이 적용되기까지 약 15분 정도 소요됩니다.

![](https://main.qcloudimg.com/raw/e04e398136dc52192752e866041ca109.png)

### 로그 토픽 관리
로그 토픽 설정을 완료한 후에는 로그 토픽을 관리할 수 있습니다. 이는 해당 로그 토픽으로의 로그 전송 중지/시작, 해당 로그 토픽 단위의 로그 인덱스, 해당 로그 토픽 관리 및 삭제를 포함합니다.
![](https://main.qcloudimg.com/raw/1148d492591594000621b167a38182fd.png)

#### 로그 전송 중지 / 시작
로그 토픽으로의 로그 전송을 수동으로 중지/시작할 수 있습니다.
>!
>- 중지한 후에는 해당 로그 토픽에 바인딩된 모든 도메인의 로그를 해당 토픽으로 더는 전송하지 않습니다. 이미 전송된 로그는 계속 보관되며, 적용되기까지 약 5~15분 정도 소요됩니다.
>- 시작한 후에는 해당 로그 토픽에 바인딩된 모든 도메인의 로그를 해당 토픽으로 전송하며, 적용되기까지 약 5~15분 정도 소요됩니다.

#### 인덱스
로그 토픽을 단위로 로그 인덱스를 수행합니다. 인덱스할 로그 토픽을 선택하고 [인덱스]를 클릭하여 로그 인덱스 페이지로 이동합니다.
+ 시간 구간 선택: 오늘, 24시간(최근 7일 중에서 하루 선택 가능), 최근 7일의 로그 데이터를 인덱스할 수 있습니다.
+ 정렬 표시: 로그 시간에 따라 내림 순 / 오름 순으로 정렬할 수 있습니다.
+ 인덱스: 전문 인덱스, 키 값 인덱스와 퍼지(Fuzzy) 키워드 인덱스를 지원합니다. 자세한 내용은 [인덱스 구문](https://intl.cloud.tencent.com/document/product/614/30439)을 참조 바랍니다.

![](https://main.qcloudimg.com/raw/c3d2cdd0a1673ce123fb281c903b5e06.png)

**로그 데이터 설명**

| 로그 필드      | 원시 로그 유형 | CLS 유형 | 설명                                                         |
| ------------- | ------------ | ------------ | ------------------------------------------------------------ |
| app_id        | Integer      | long         | Tencent Cloud 계정 APPID                                             |
| client_ip     | String       | text         | 클라이언트 IP                                                    |
| file_size     | Integer      | long         | 파일 크기                                                     |
| hit           | String       | text         | 캐시 HIT / MISS, CDN 엣지 노드에 히트 혹은 부모 노드에 히트 모두 HIT로 표기   |
| host          | String       | text         | 도메인                                                         |
| http_code     | Integer      | long         | HTTP 상태 코드                                                  |
| isp           | String       | text         | 통신사                                                       |
| method        | String       | text         | HTTP Method                                                  |
| param         | String       | text         | URL에 포함된 매개변수                                               |
| proto         | String       | text         | HTTP 프로토콜 식별자                                                |
| prov          | String       | text         | 통신사의 성                                                   |
| referer       | String       | text         | Referer 정보, HTTP  출처 주소                                 |
| request_range | String       | text         | Range 매개변수. 요청 범위                                         |
| request_time  | Integer      | long         | 응답 시간(ms), 노드가 요청을 받은 후부터 모든 리턴 패킷에 응답하고, 다시 클라이언트로 돌아오기까지 소모한 시간 |
| rsp_size      | Integer      | long         | 리턴한 바이트 수                                                   |
| time          | Integer      | long         | 요청 시간, UNIX 타임스탬프                                        |
| ua            | String       | text         | User-Agent 정보                                              |
| url           | String       | text         | 요청 경로                                                     |
| uuid          | String       | text         | 요청 고유 식별                                               |
| version       | Integer      | long         | CDN 실시간 로그 버전                                                    |

#### 관리
이미 생성한 로그 토픽을 관리하고, 해당 토픽에 바인딩된 도메인의 목록을 갱신할 수 있습니다.
>-? 새로운 설정이 적용되기까지 약 5~15분 정도 소요됩니다.

![](https://main.qcloudimg.com/raw/d9f8f9d09c683ede80e889b100e72d5a.png)

#### 삭제
로그 토픽을 수동으로 삭제할 수 있습니다.
>! 삭제한 후에는 해당 로그 토픽에 바인딩된 모든 도메인의 로그를 해당 토픽으로 더이상 전송하지 않습니다. 이미 전송된 로그는 모두 삭제되며, 적용되기까지 약 5-~15분 정도 소요됩니다.

