## 設定シナリオ
Tencent Cloud CDNは、ビジネスリソースのアクセスソース元を制御するためのIPブラックリスト・ホワイトリスト設定機能を提供します。

ユーザーリクエスト側IPに対してアクセス制御ポリシーを設定することにより、アクセスのソース元を効果的に制御し、悪意のあるIPの盗用や攻撃を防ぐことができます。

## 設定ガイド

### 設定の確認
[CDNコンソール](https://console.cloud.tencent.com/cdn)にログインし、メニューバーで【ドメイン名管理】を選択して、ドメイン名の右側にある【管理】をクリックすると、ドメイン名設定画面に入ります。第2欄の【アクセス制御】でIPブラックリスト/ホワイトリスト設定を確認できます。デフォルト設定は無効です。
![](https://main.qcloudimg.com/raw/d6f183e43bc1c025abe0d293a410630b.png)

### 設定の変更
#### 1. 設定の変更
スイッチをクリックし、ブラックリスト/ホワイトリストを選択して、IPまたはIPセグメントリストに入力し、【OK】をクリックして、IPブラックリスト/ホワイトリスト設定を有効にします。
![](https://main.qcloudimg.com/raw/83c362835899248076c4b4899fa38ac5.png)
**IP ブラックリスト**
クライアントIPがブラックリストのIPまたはIPセグメントに該当する場合、CDNノードにアクセスすると、403ステータスコードを直接返します。
**IPホワイトリスト**
クライアントIPがホワイトリストのIPまたはIPセグメントに該当しない場合、CDNノードにアクセスすると、403ステータスコードを直接返します。
**ブラックリスト/ホワイトリストルール**
+ IPブラックリストまたはIPホワイトリストのいずれかを選択します。両方を同時に設定することはできません。
+ IPセグメントは /8、\/16、\/24 のIPレンジのみをサポートし、他のIPレンジはサポートしません。
+ ブラックリスト/ホワイトリストは`IP：port`形式のエントリをサポートしておらず、最大50エントリを含めることができます。

#### 2. 設定を無効にする
IPブラックリスト/ホワイトリスト設定スイッチでワンクリックでオフにすることができます。スイッチがオフの場合、既存の設定があっても、この機能は実稼働環境では有効になりません。スイッチがオンになると、ネットワーク全体で設定が有効になる前に、この機能を有効にするかどうかを確認するメッセージが表示されます。
![](https://main.qcloudimg.com/raw/905c706c90a33f79e86b139187e1bfbc.png)

>ご利用のアクセラレーションドメイン名のサービスエリアがグローバルアクセラレーションの場合、設定されたIPブラックリスト/ホワイトリストはグローバルに有効になります。中国本土と中国本土以外で個別に設定することはサポートされていません。

## 設定サンプル

アクセラレーションドメイン名`www.test.com`のIPブラックリスト/ホワイトリストの設定が下記の通りです。
![](https://main.qcloudimg.com/raw/0fc7f674d500609ebae87873b3791724.png)
実際のアクセス状況は次のとおりです。
1. クライアントIP が`1.1.1.1`であるユーザーがリソース `http://www.test.com/test.txt`にアクセスし、IPがホワイトリストのIPと一致するため、正常にコンテンツを戻します。
2. クライアントIP が`2.1.1.1`であるユーザーがリソース `http://www.test.com/test.txt`にアクセスし、IPがホワイトリストのどのIPとも一致しないため、403ステータスコードが返されます。

