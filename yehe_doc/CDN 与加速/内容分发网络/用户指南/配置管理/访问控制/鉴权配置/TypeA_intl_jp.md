## アルゴリズムの説明
**URL形式へのアクセス**
`http://DomainName/Filename?sign=timestamp-rand-uid-md5hash`

**アルゴリズムの説明**
- timestamp：10進数（UNIXタイムスタンプ）です。
- rand：ランダム文字列です。大文字と小文字、数字で構成される0～100桁のランダム文字列です。
- uid：0
- md5hash：MD5（ファイルパス-timestamp-rand-uid-カスタマイズキー）。

**リクエスト例**
`http://cloud.tencent.com/test.jpg?sign=1582791032-im1acp76sx9sdqe601v-0-dd63f95e739ed4b47427a129d21ef4e3`

> !MD5を計算する際に、もしリクエストパスが`http://cloud.tencent.com/test.jpg`の場合、MD5を計算する際のパスは`/test.jpg`となります。

## 設定ガイド
### パラメータの説明
TypeAに必要な設定は以下のとおりです。
![](https://main.qcloudimg.com/raw/242bbc36baa0225e38d854714f2296c1.png)
**認証キーをカスタマイズする**：キーは6～32桁の大文字と小文字と数字で構成されています。キーを大切に保管してください。ユーザー側とサーバー側のみ知っている必要があります。
**カスタマイズ認証パラメータ名**：上記例のsignを、1〜100桁の大文字、小文字、数字、またはアンダースコアで構成されるパラメータ名に置き換えます。リクエストを受信すると、CDNは指定された署名パラメータにより対応する値を取り出し、MD5計算を実行します。渡されたmd5hash値にマッチする場合、署名の検証は成功し、検証が失敗した場合は、直接403を返します。
**有効時間をカスタマイズ**：リクエスト中のtimestampと設定された有効時間を介して、現在の時刻と比較し、リクエストが期限切れかどうかを判定します。期限切れの場合、直接403を返します。有効時間の単位は秒です。

### 有効化対象
キー、パラメータ名、および期限切れ時間を設定した後、必要に応じて認証対象を指定でき、以下の3つのモードをサポートします。
![](https://main.qcloudimg.com/raw/656f4ff6cef0e6b2a3022348a8293d4e.png)

+ 指定されたドメイン名配下のすべてのファイルを認証が必要なように設定できます。
+ 指定されたタイプのファイルを認証不要に、他のすべてのファイルを認証が必要なように設定できます。
+ 指定されたタイプのファイルを認証させることができます。

## 注意事項
**キャッシュ命中率**
TypeA認証方式が有効になっているドメイン名は、URLへのアクセスに認証パラメータが保持されます。CDNノードでリソースをキャッシュする時、対応するパラメータが自動的に無視され、ドメイン名キャッシュの命中率には影響しません。
>！対応するパラメータは設定後に自動的に無視されるため、すなわち、設定された認証パラメータがフィルタリングされるため、認証範囲内のファイルのキャッシュキーに影響し、また、ここでの優先順位は【キャッシュ設定 - キャッシュキールール設定】でのキャッシュキールールより高くなります。
たとえば、ここでのTypeAは、「認証パラメータ：sigh - 認証範囲：jpg」に設定されている場合、【キャッシュ設定 - キャッシュキールール設定】で「すべてのファイル - パラメータはフィルタリングされない」と設定されている場合でも、jpgファイルは自動的に「sign」パラメータをフィルタリングします。


**back-to-originのポリシー**
TypeA認証方式が有効になっているドメイン名は、アクセスする際の形式が次のとおりです。
`http://DomainName/Filename?sign=timestamp-rand-uid-md5hash`

認証が完了した後、命中されたCDNノードがない場合、ノードはback-to-originリクエストを送信します。**形式はアクセスリクエストと一致しており、signパラメータは保持されます**。オリジンサーバーは必要に応じて無視されるか、２次検証が行われます。
