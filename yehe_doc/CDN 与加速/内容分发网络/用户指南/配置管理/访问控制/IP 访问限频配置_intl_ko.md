## 설정 시나리오
서비스 리소스의 액세스 출처를 제어할 수 있도록, Tencent Cloud CDN은 IP 액세스 빈도 제한 설정을 제공하고 있습니다. 사용자 IP의 각 노드에서의 초당 액세스 횟수 제한을 통해 고빈도 CC 공격 방어, 악성 사용자의 도용 방지 등을 진행할 수 있습니다.

## 설정 가이드
### 설정 조회
[CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인하여 메뉴에서 [Domain Management]를 선택하고 도메인 오른쪽의 [Manage]를 클릭하면 도메인 설정 페이지로 이동할 수 있습니다. 그중 두 번째 탭인 [Access Control]에서 IP 액세스 빈도 제한 설정을 확인할 수 있고 비활성화 상태로 기본 설정되어 있으며 임계 값은 비어 있는 상태입니다:
![](https://main.qcloudimg.com/raw/b98d9546d6367a69877146edfb4611c2.png)

### 설정 수정
#### 1. 설정 수정
on-off 스위치를 클릭하여 빈도 제어 임계 값을 입력하고 [OK]를 클릭하면 IP 액세스 빈도 제한 제어를 활성화할 수 있습니다:
![](https://main.qcloudimg.com/raw/69862f6a9081574349ba09ed4da9ab56.png)
**설정 설명**
+ 설정을 활성화한 후 QPS 제한을 초과하는 요청은 직접 514를 리턴하고 빈도 제한을 낮게 설정하면 고빈도 사용자의 정상적인 사용에 영향을 미칠 수 있습니다. 서비스 상황, 사용 시나리오에 따라 임계 값을 적절히 설정하시기 바랍니다.
+ 빈도 제한은 단일 IP로 단일 노드를 액세스한 횟수만 제한합니다. 악성 사용자가 대량의 IP로 전체 네트워크 노드를 겨냥해 공격할 경우 이 기능으로는 효과적으로 제어할 수 없습니다.

#### 2. 설정 비활성화
on-off 스위치를 통해 원클릭으로 설정을 비활성화할 수 있습니다. 비활성화 상태일 때 아래에 기존 설정이 존재하더라도 현재 네트워크에 적용되지 않습니다. 다음 차례 활성화 시 전체 네트워크에 배포 및 적용됩니다:
![](https://main.qcloudimg.com/raw/9e7456b978e742f0a1da20baff05cd99.png)

>사용자의 가속 도메인 서비스 지역이 글로벌 가속이면 설정한 IP 액세스 빈도 제한이 글로벌 범위에 적용되며 중국 내, 중국 외를 다르게 설정할 수 없습니다.

## 설정 예시
가속 도메인 `www.test.com`의 IP 액세스 빈도 제한 설정이 다음과 같은 경우
![](https://main.qcloudimg.com/raw/c05f51b3a1acd5f3590e2de66c5b4d16.png)
실제 액세스 상황은 다음과 같습니다
1. 클라이언트 IP가 `1.1.1.1`인 사용자는 1초에 리소스`http://www.test.com/1.jpg`를 10번 요청하고, 모두 CDN 가속 노드 A 중의 한 서버에 액세스합니다. 이때 해당 서버에는 10개의 액세스 로그가 생성되며, 그중 9개는 QPS 제한을 초과하여 상태 코드가 514이 됩니다.
2. 클라이언트 IP가 `2.2.2.2`인 사용자는 1초에 리소스 `http://www.test.com/1.jpg`를 2번 요청합니다. 네트워크 영향을 받아 액세스가 각각 두 개의 CDN 가속 노드로 스케쥴링되어 처리됩니다. 이때 각 가속 노드 모두 정상적으로 콘텐츠를 리턴합니다.

