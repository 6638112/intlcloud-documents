### 캐시 만료 설정이란 무엇입니까?
캐시 만료 설정이란 CDN 가속 노드에서 서비스 콘텐츠를 캐시할 때 준수하는 만료 규칙입니다.
CDN 노드에 캐시된 사용자 리소스에는 "기간 만료" 문제가 존재합니다. 리소스가 만료 상태가 아닌 경우, 사용자 요청이 노드에 전달되면 노드에서 사용자에게 직접 해당 리소스를 리턴해 속도가 향상됩니다. 리소스가 만료 상태인 경우이면(즉, 이미 설정된 유효기간이 지난 경우), 사용자 요청을 노드에서 원본 서버로 전송하고 다시 콘텐츠를 가져와 노드에 캐시하는 동시에 사용자에게 리턴합니다. 캐시 시간을 합리적으로 설정하면 히트율은 향상되고, 원본 요청률은 낮아져 대역폭 비용을 효과적으로 절감할 수 있습니다.

### 고급 캐시 설정이란 무엇입니까?
1. [CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인한 뒤, 왼쪽 메뉴의 [Domain Management]를 클릭해 도메인 관리 페이지에 들어갑니다.
2. 편집할 도메인이 속한 라인을 찾아 Operation란에 있는 [Manage]를 클릭합니다.
![](https://main.qcloudimg.com/raw/53c1171f8b1fdec4ddd2f87f6c47fe12.png)
3. 캐시 만료 설정 모듈에서 **고급 캐시 만료 설정** 버튼을 찾아 클릭하여 활성화합니다.
![](https://main.qcloudimg.com/raw/dcb2baf6f60df8836243778c70e4ee60.png)
4. 고급 캐시 만료 설정의 버튼을 활성화하면, 다음의 효과가 적용됩니다.
사용자가 원본 서버에 특정 리소스를 요청할 때, Response HTTP Header에 Cache-Control 필드가 포함되어 있으며 그 값이 `max-age = xxxx`라면, 노드는 설정된 만료 시간과 max-age 중 작은 값을 해당 리소스의 캐시 시간으로 사용합니다.
 - 사용자의 원본 서버에서 /index.html의 max-age를 200초로 설정하고 CDN에 상응하는 캐시 시간을 600초로 설정한 경우, 파일의 실제 만료 시간은 200초가 됩니다.
 - 사용자의 원본 서버에서 /index.html의 max-age를 800초로 설정하고 CDN에 상응하는 캐시 시간을 600초로 설정한 경우, 파일의 실제 만료 시간은 600초입니다.

>!사용자의 원본 서버 Response Header에 Cache-Control 필드가 존재하지 않는 경우, CDN은 기본적으로 Cache-Control: max-age=600 헤더를 추가합니다.

### 브라우저에서 파일의 캐시 시간은 어떻게 제어합니까?
콘솔에서 브라우저 캐시 만료 시간 설정을 제공하며, 자세한 내용은 [Browser Cache Validity Configuration](https://intl.cloud.tencent.com/document/product/228/38932)을 참조하십시오.

### 캐시 설정의 우선순위는 어떻게 조정합니까?
[노드 캐시 설정](https://intl.cloud.tencent.com/document/product/228/35317) 문서의 작업 설명을 참조하십시오.

### CDN 외부 원본이 특정 파일을 캐시하지 않도록 설정할 수 있습니까? 캐시 시간을 0으로 설정하면 캐시하지 않습니까?
디렉터리 및 파일 유형별로 캐시 시간을 설정할 수 있습니다. 캐시 시간을 0으로 설정하면 CDN 노드는 해당 리소스를 캐시하지 않습니다. 사용자가 CDN 노드로 액세스 요청을 보낼 때마다 CDN 노드는 원본 서버로부터 해당하는 리소스를 불러와야 합니다. 캐시 설정과 관련된 내용은 [노드 캐시 설정](https://intl.cloud.tencent.com/document/product/228/35317)을 참조하십시오.

## Tencent Cloud가 지원하는 캐시 만료 설정에는 무엇이 있습니까?
Tencent Cloud CDN은 다양한 캐시 시간 설정을 지원하며, 사용자 정의 우선순위 조정, Cache 상속 정책(고급 캐시 설정)을 지원합니다. 캐시 시간을 합리적으로 설정하면 히트율은 향상되고, 원본 요청률은 낮아져 대역폭 비용을 효과적으로 절감할 수 있습니다.

### CDN의 캐시 기본 설정은 어떻게 되어 있습니까?
도메인 액세스 시, 아래와 같이 기본 설정되어 있습니다.
- 외부 원본 도메인 액세스: 모든 파일의 캐시 만료 시간 기본값은 30일이지만, 일반적으로 동적 파일(예: .php .jsp .asp .aspx)은 0으로 설정되어 있어 이러한 동적 파일의 요청은 바로 원본을 가져옵니다.
- COS 원본 도메인 액세스: 모든 파일의 캐시 만료 시간 기본값은 30일입니다.
- 고급 캐시 만료 설정은 비활성화로 기본 설정되어 있습니다.

### 캐시 상속 정책은 어떻게 됩니까?
사용자가 귀하에게 서비스 리소스를 요청했을 때, 원본 서버의 상응하는 Response HTTP Header에 Cache-Control 필드가 존재하는 경우 기본 정책은 다음과 같습니다.
- Cache-Control 필드가 max-age인 경우, 해당 리소스의 캐시 시간은 설정된 캐시 시간을 기준으로 하며 Max-age 지정 시간은 상속하지 않습니다.
- Cache-Control 필드가 no-Cache 혹은 no-store인 경우, CDN 노드는 해당 리소스를 캐시하지 않습니다.

### 캐시는 어떤 방식으로 매칭합니까?
여러 캐시 정책을 설정한 경우 서로 간에 중복이 있을 수 있으며, 설정 항목 리스트를 기준으로 하단 우선순위가 상단 우선순위보다 높습니다. 도메인에 다음과 같이 캐시를 설정하는 경우,
```
모든 파일 30일
.php .jsp .aspx 0초
.jpg .png .gif 300초
/test/*.jpg 400초
/test/abc.jpg 200초
```

도메인이 `www.test.com`, 리소스가 `www.test.com/test/abc.jpg`이라고 가정했을 때, 매칭 방식은 아래와 같습니다.
1. 첫 라인 모든 파일 매칭, 히트, 이 때 캐시 시간 30일
2. 두 번째 라인 매칭, 미스
3. 세 번째 라인 매칭, 히트, 이 때 캐시 시간 300초
4. 네 번째 라인 매칭, 히트, 이 때 캐시 시간 400초
5. 다섯 번째 라인 매칭, 히트, 이 때 캐시 시간 200초

따라서 최종 캐시 시간은 200초이며, 마지막 매칭을 기준으로 적용합니다.
