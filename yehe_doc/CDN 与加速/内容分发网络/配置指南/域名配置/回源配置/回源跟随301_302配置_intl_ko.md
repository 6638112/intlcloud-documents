## 설정 시나리오
Tencent Cloud CDN은 기본적으로 301/302 상태 코드를 캐싱하지 않습니다. 원본 서버가 301/302 요청을 리턴하면 CDN 노드는 응답을 클라이언트에 리턴하고, 클라이언트에서 다시 해당 리소스로 리디렉션하여 액세스를 진행합니다.

원본의 301/302 따라가기 설정을 활성화하면, CDN 노드에서 원본 서버로 요청할 때 301/302가 발생할 경우 필요한 리소스를 가져올 때까지 알아서 따라가기를 리디렉션한 뒤(최대 3회까지 따라가기) 실제 리소스를 클라이언트에 리턴하므로, 클라이언트에서는 리디렉션할 필요가 없습니다.
## 설정 가이드
### 설정 조회
[CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인하여 메뉴에서 [도메인 관리]를 선택한 후, 도메인 오른쪽의 [관리]를 클릭하면 도메인 설정 페이지에 접속할 수 있습니다. 네 번째 메뉴인 [원본 설정]에서 원본의 301/302 따라가기 설정을 확인하실 수 있으며, 비활성화 상태로 기본 설정되어 있습니다.
![](https://main.qcloudimg.com/raw/3d431956857ef20b21bb954e481c66e4.png)

### 설정 변경
스위치를 클릭하여 원본의 301/302 따라가기 설정을 활성화하거나 비활성화할 수 있습니다.
![](https://main.qcloudimg.com/raw/cbbd0f472a50287fd425cd093a2dacb9.png)

> !가속 도메인의 서비스 지역이 글로벌 가속일 경우 원본의 301/302 따라가기 설정이 글로벌 범위에 적용되며, 중국 내와 중국 외를 서로 다르게 설정할 수 없습니다.

## 설정 예시
도메인이 'cloud.tencent.com'인 원본의 301/302 따라가기 설정은 다음과 같습니다.
![](https://main.qcloudimg.com/raw/cbbd0f472a50287fd425cd093a2dacb9.png)
사용자 A가 요청한 리소스 'http://cloud.tencent.com/1.jpg'가 노드 캐시 서버에 없을 경우, 노드가 원본 서버에 필요한 리소스를 요청합니다. 이때 원본 서버가 리턴한 HTTP Response의 상태 코드가 302라면, 리디렉션이 가리키는 주소는 'http://cloud.tencent.com/1.jpg'가 됩니다. 따라서,

1. 원본의 301/302 따라가기 설정을 활성화하면, 노드가 상태 코드 301/302의 HTTP Response를 수신한 뒤 리디렉션이 가리키는 주소에 직접 요청을 보냅니다.
2. 필요한 리소스를 가져오면 노드에 캐싱하며, 사용자에게 리턴합니다.
3. 이때 사용자 B도 'http://cloud.tencent.com/1.jpg'에 요청을 보낼 경우, 노드에 직접 도달하여 사용자에게 리턴합니다.
4. 원본 301/302 따라가기 설정을 활성화하면 최대 3번까지 리디렉션되며, 횟수 초과 시 클라이언트에 직접 301/302를 리턴합니다.

도메인이 'cloud.tencent.com'인 원본의 301/302 따라가기 설정은 다음과 같습니다.
![](https://main.qcloudimg.com/raw/3d431956857ef20b21bb954e481c66e4.png)
사용자 A가 요청한 리소스 'http://cloud.tencent.com/1.jpg'가 노드 캐시 서버에 없을 경우, 노드가 원본 서버에 필요한 리소스를 요청합니다. 이때 원본 서버가 리턴한 HTTP Response의 상태 코드가 301/302라면, 리디렉션이 가리키는 주소는 'http://xxx.tencent.com/1.jpg'가 됩니다. 따라서,
1. 노드가 해당 HTTP Response를 사용자에게 바로 리턴합니다.
2. 사용자가 'http://xxx.tencent.com/1.jpg'에 요청을 보내도 해당 도메인이 CDN에 액세스되어 있지 않다면 가속 효과가 발생하지 않습니다.
3. 이때 사용자 B도 'http://cloud.tencent.com/1.jpg'에 요청을 보낼 경우, 위의 과정이 반복됩니다.

