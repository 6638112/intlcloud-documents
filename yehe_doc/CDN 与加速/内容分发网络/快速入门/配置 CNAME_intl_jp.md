ドメイン名がCDNに接続されると、システムは自動的にCNAMEドメイン名`.cdn.dnsv1.com` を割り当てます。詳細はCDNコンソールの[ドメイン名管理ページ](https://console.cloud.tencent.com/cdn/domains)で確認できます。CNAMEドメイン名は直接アクセスできないため、ドメイン名のサービスプロバイダーにてCNAME設定を完了する必要があります。設定が有効になると、CDNアクセラレーションサービスが利用可能になります。
![img](https://main.qcloudimg.com/raw/073b948565743f7947aae8503eef995d.png)

## 設定手順

本章では、Tencent Cloud、Alibaba Cloud、およびXinnetのCNAMEの設定手順について説明します。

- [Tencent Cloudでの設定方法](https://intl.cloud.tencent.com/document/product/228/3121#.E8.85.BE.E8.AE.AF.E4.BA.91.E8.AE.BE.E7.BD.AE.E6.96.B9.E6.B3.95)
- [Alibaba Cloudでの設定方法](https://intl.cloud.tencent.com/document/product/228/3121#.E9.98.BF.E9.87.8C.E4.BA.91.E8.AE.BE.E7.BD.AE.E6.96.B9.E6.B3.95)
- [Xinnetでの設定方法](https://intl.cloud.tencent.com/document/product/228/3121#.E6.96.B0.E7.BD.91.E8.AE.BE.E7.BD.AE.E6.96.B9.E6.B3.95)



<span ID ="m1"></span>
### Tencent Cloudの設定方法

>!ドメイン名の解析では、各種のレコードタイプの間で優先順位に差異があります。同じホストレコードで、同一配線で数種類の異なるレコードタイプは共有できません。競合が生じるからです。CNAMEレコードは、CNAMEレコード以外のすべてのレコードタイプと競合するので、先にその他のレコードタイプは削除してから構成します。

1.  [ドメイン名サービス](https://console.cloud.tencent.com/domain) コンソールにログインし、リストからCNAMEレコードを追加するドメイン名がある行を見つけて、アクションバーの【解析】をクリックします。
2. リダイレクトしたDNSPOD画面で、【レコード追加】をクリックし、以下の手順によってCNAMEレコードを追加します。
![img](https://main.qcloudimg.com/raw/36f84a0d21b51bc56d79544943f0f752.png)

	- **ホストレコード**：サブドメイン名を入力します。例えば、 `www.dnspod.com` の解析の追加は，「ホストレコード」において 「www」を選択します。 `dnspod.com` の解析だけを追加したい場合は、「ホストレコード」において「@」を選択します。「@」のCNAME はMX レコードの正常な解析に影響を与えるため、追加するときは慎重に検討してください。
	- **レコードタイプ**：“CNAME”を選択します。
	- **回線タイプ**：「デフォルト」タイプを選択します。DNSPod は複数の方法で回線の区分をサポートし、指定ユーザーに当該レコードにアクセスしてもらいます。詳細は[回線解析説明](https://docs.dnspod.cn/dns/5f4775898ae73e11c5b01afc/)をご参照ください。
	- **レコード値**：CNAMEが示すドメイン名は、ドメイン名のみを入力可能です。レコードが生成されると、ドメイン名の後ろに「.」が自動的に追加されますが問題ありません。
	- **重み**：ホストレコードが同じ同一回線は、異なったレコード値に重みを設定できます。解析時には設定した重みを基に比例して返送します。入力範囲は0～100の整数です。
	- **MXの優先度**:入力する必要はありません。
	- **TTL**:キャッシュ時間のために、数値が小さいほど、変更レコードの有効時間は速まります。デフォルトは600秒。

### Tencent Cloudの回線分断でのアクセラレーションの有効化

- 単独のホストのレコードラインを「デフォルト」タイプに設定し、すべてのサーバーのアクセラレーションサービスを有効にできます。
	 例えば、全てのユーザーを1.comに方向付けする必要がある場合に、回線タイプをデフォルト、レコード値を‵1.com‵とする1個のCANMEレコードを追加することで実現できます。
![img](https://main.qcloudimg.com/raw/be770e0f8b91c33ae7c41f1e50e633af.png)
-回路を分けてアクセラレーションサービスを有効にもできます。
例えば、チャイナユニコムユーザーを`2.com`に方向付けし、チャイナモバイルユーザーを `1.com`に方向付けする必要がある場合。回線タイプをチャイナモバイル、レコード値を`1.com` とするものと、回線タイプをチャイナユニコム、レコード値を `2.com` とするものの2本のCNAME レコードを追加することで実現できます。設定の詳細説明は[回線解析説明](https://docs.dnspod.cn/dns/5f4775898ae73e11c5b01afc/)をご参照ください。
![](https://main.qcloudimg.com/raw/a10e6be051e2b90a323cb8e07081fb63.png)

<span ID ="m2"></span>
### Alibaba Cloud設定方法

DNSプロバイダがAlibaba Cloudの場合は、下記の手順でCNAMEレコードを追加できます。

1. Alibaba Cloudコンソールのクラウド解析DNSにログインします。
2. 解析するドメイン名をクリックし、解析レコードページに入ります。
3. 解析レコードページに入ってから、【レコード追加】ボタンをクリックし、解析レコードの設定を始めます。
4. CNAME解析レコードを設定する場合は、レコードタイプをCNAMEに選んでください。ホストレコードはすなわちドメイン名のプレフィックスで、任意に入力できます（例えば：`www`）。レコード値は現在のドメイン名のリンク先となる別のドメイン名を入力してください。解析回線とTTLは、デフォルト値のままでかまいません。
   ![img](https://main.qcloudimg.com/raw/6b8bb9ce4f998b8d17ca27fd10512dc6.png)
5. 入力を終えたら、【確定】をクリックして解析の設定を完了します。



<span ID ="m3"></span>
### Xinnetでの設定方法

DNSプロバイダがXinnetの場合は、下記の手順でCNAMEレコードを追加できます。
**エイリアスの設定（CNAMEレコード）**
エイリアスレコードのことです。この種類のレコードによって、複数の名前を一つのコンピュータにマッピングすることが可能になり、一般的には、WWWとMAILサービスの両方を提供するコンピュータに適用されます。例えば、名前が`host.mydomain.com`（Aレコード）で、WWWとMAILサービスを同時に提供しているコンピュータがあります。ユーザーからのアクセスを便利にするために、下図に示すように、そのコンピュータにWWWとMAILの２つのエイリアス（CNAME）を設定します。

## CNAMEのアクティブ化状態を確認

DNSプロバイダによって、CNAMEのアクティブ化にかかる時間が異なりますが、一般的には30分以内に完了します。nslookupまたはdig方式でCNAMEのアクティブ化状態を確認できます。

- `nslookup -qt=cname <アクセラレーションドメイン名>`
  ![img](https://main.qcloudimg.com/raw/ed15d49b7d2fee9cf8830d4bf9ca51a2.png)
- `dig <アクセラレーションドメイン名>`
  ![img](https://main.qcloudimg.com/raw/2ba5ec76f1671c3b8ee345cef896de10.png)
