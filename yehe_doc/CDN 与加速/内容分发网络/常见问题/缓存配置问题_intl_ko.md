### 캐시 만료 설정이란 무엇이나요?
캐시 만료 설정은 CDN의 가속 노드가 비즈니스 콘텐츠를 캐싱할 때 따르는 하나의 기간 만료 규칙을 가리킵니다.
CDN 노드에 캐시된 모든 사용자 리소스에는 "기간 만료"라는 문제가 있습니다. 만약 리소스가 만료 상태가 아니라면, 노드가 사용자의 요청을 받고 해당 리소스를 사용자에게 리턴하여 가져오기 속도를 높여줍니다. 리소스가 만료 상태라면(즉, 설정한 유효 기간이 지난 경우) 사용자의 요청이 노드에 의해 원본 서버로 전송되어 다시 콘텐츠를 받아 노드에 캐시하는 동시에 사용자에게 리턴합니다. 캐시 시간을 합리적으로 설정하여 히트율을 더욱 높이고, 원본 요청률은 낮추어 사용자의 대역폭 비용을 절감할 수 있습니다.

### 고급 캐시 설정이란 무엇이나요?
1. [CDN 콘솔](https://console.cloud.tencent.com/cdn)에 로그인한 다음 왼쪽 메뉴에서 [Domain Management]를 클릭하여 관리 페이지로 이동합니다.
2. 편집해야 하는 도메인이 있는 줄의 메뉴에서 [Manage]를 클릭합니다.

3. 캐시 만료 설정 모듈에서 **고급 캐시 만료 설정**의 스위치를 찾아 클릭하여 활성화합니다.

4. 고급 캐시 만료 설정 스위치를 활성화한 후에는 다음과 같은 효과가 발생합니다.
사용자가 원본 서버에 리소스를 요청할 때, Response HTTP Header에 Cache-Control 필드가 있고 그 값이 `max-age=xxxx`일 때, 노드는 설정한 만료 시간과 max-age 중 최소 값을 해당 리소스의 캐시 시간으로 사용합니다.
 - 사용자의 원본 서버가 /index.html의 max-age를 200초로, CDN에 매칭되는 캐시 시간을 600초로 설정했다면, 파일의 실제 만료 시간은 200초가 됩니다.
 - 사용자의 원본 서버가 /index.html의 max-age를 800초로, CDN에 매칭되는 캐시 시간을 600초로 설정했다면, 파일의 실제 만료 시간은 600초가 됩니다.
>사용자의 원본 서버가 Response Header 에 Cache-Control 필드가 없으면, CDN은 Cache-Control: max-age = 600 헤더를 추가하도록 기본 설정되어 있습니다.

### 브라우저에서의 파일 캐시 시간은 어떻게 제어하나요?
Tencent Cloud CDN은 원본 서버의 Cache-Control 설정을 지원하도록 기본 설정되어 있습니다. 현재 Cache-Control 헤더 설정을 지원하지 않기 때문에 CDN 노드에서 max-age를 설정할 수 없지만, CDN 노드가 원본 서버의 max-age를 상속받으므로 원본 서버와 매칭되기만 하면 됩니다.

### 캐시 설정의 우선순위는 어떻게 조정하나요?
[노드 캐시 설정](https://intl.cloud.tencent.com/document/product/228/35317) 문서의 작업 설명을 참조 바랍니다.

### CDN 외부 원본 서버가 일부 파일을 캐시하지 않도록 설정할 수 있나요? 캐시 시간을 0으로 설정하면 되나요?
디렉터리 및 파일 유형에 따라 해당하는 캐시 시간을 설정할 수 있습니다. 캐시 시간을 0으로 설정하면 CDN 노드는 해당 리소스를 캐시하지 않습니다. 사용자가 CDN 노드로 액세스 요청을 보낼 때마다 CDN 노드는 원본 서버로부터 해당하는 리소스를 불러와야 합니다. 캐시 설정에 관련된 내용은 [노드 캐시 설정](https://intl.cloud.tencent.com/document/product/228/35317)을 참조 바랍니다.

###  Tencent Cloud가 지원하는 캐시 만료 설정에는 어떤 종류가 있나요?
Tencent Cloud CDN은 캐시 시간 설정, 사용자 정의 우선순위 조정, Cache 상속 정책(고급 캐시 설정) 등 모든 설정을 지원합니다. 캐시 시간을 합리적으로 설정하여 히트율을 높이고, 원본 요청률은 낮추어 사용자의 대역폭 비용을 절감할 수 있습니다.

### CDN의 캐시 설정 기본 값은 무엇인가요?
도메인 엑세스 시, 아래와 같이 기본 설정되어 있습니다.
- 외부 원본 도메인 이름 액세스: 모든 파일의 캐시 만료 시간 기본값은 30일이지만, 동적 파일(예 .php .jsp .asp .aspx) 의 기본값은 0이므로 동적 파일의 요청에는 직접 원본 가져오기를 진행합니다.
- COS 원본 도메인 이름 액세스: 모든 파일의 캐시 만료 시간 기본값은 30일입니다.
- 고급 캐시 만료 설정은 비활성화로 기본 설정되어 있습니다.

### 캐시 상속 정책이란 무엇인가요?
사용자로부터 서비스 리소스를 요청 받았을 때, 원본 서버에 해당하는 HTTP Response Header 에 Cache-Control 필드가 존재한다면 기본 플랫폼 정책은 다음과 같습니다.
- Cache-Control 필드를 Max-Age로 설정하면, 해당 리소스의 캐시 시간은 Max-Age가 지정한 시간을 상속받지 않고 설정된 노드 캐시 만료 기간을 기준으로 합니다.
- Cache-Control 필드를 no-cache, no-store로 설정하면, CDN 노드는 해당 리소스를 캐시하지 않습니다.

### 캐시의 매칭 방식은 무엇인가요?
여러 개의 캐시 정책을 설정했을 때, 서로 간에 중복이 있을 수 있습니다. 설정 항목 목록의 아래 부분이 윗부분보다 우선순위가 높게 설정되어 있습니다. 한 도메인의 캐시를 아래와 같이 설정했다고 가정합니다.
```
모든 파일 30일
.php .jsp .aspx 0초
.jpg .png .gif 300초
/test/*.jpg 400초
/test/abc.jpg 200초
```

도메인 이름을 `www.test.com`로, 리소스는 `www.test.com/test/abc.jpg`로 가정했을 때의 매칭 방식은 아래와 같습니다.
1. 첫째 줄의 모든 파일과 매칭, 히트, 이때의 캐시 시간은 30일입니다.
2. 둘째 줄과 매칭, 미히트
3. 셋째 줄과 매칭, 히트, 이때의 캐시 시간은 300초입니다.
4. 넷째 줄과 매칭, 히트, 이때의 캐시 시간은 400초입니다.
5. 다섯째 줄과 매칭, 히트, 이때의 캐시 시간은 200초입니다.

따라서 최종 캐시 시간은 200초이며, 마지막 매칭을 기준으로 적용됩니다.
