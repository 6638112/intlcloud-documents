
Tencent Cloudは、TencentDBをホスティングするフラットフォーム、Tencent Cloud [Virtual Private Cloud（VPC）](https://intl.cloud.tencent.com/document/product/215/535)をご用意しています。これにより、VPCの中でTencent Cloudのリソース（例えば、TencentDBインスタンス）を起動することができます。

同じVPCで実行されているクラウドデータベースインスタンスをWebサーバーとデータ共有するソリューションがよく用いられています。本マニュアルでは、このソリューションに対してVPCを作成し、また、クラウドデータベースをVPCに追加して併用します。
ここでは、同じVPC内に、Cloud Virtual Machine（CVM）とTencentDB for MySQLを追加し、VPCの中で、クラウドリソースのプライベートネットワーク内で相互通信を実現する方法をご紹介します。

## 手順1：VPCの作成
VPCには少なくとも1つのサブネットを含め、サブネットの中にのみクラウドサービスリソースを追加することができます。
1. [VPCコンソール](https://console.cloud.tencent.com/vpc)にログインします。
2. リストの上方で、VPCが所属するリージョンを選択し、【+新規作成】をクリックします。
3. VPCの情報とオリジナルのサブネットの情報を記入し、【OK】をクリックして完了です。このうち、VPCとサブネットのCIDRは作成後の変更はできません。
 - VPC CIDRには以下のIPレンジの中のいずれかの使用をサポートしています。異なるVPC間でプライベートネットワーク通信が必要な場合は、両端のCIDRの設定が重複しないようにしてください。
    - `10.0.0.0` - `10.255.255.255`（マスクの範囲は16 - 28の間）
    - `172.16.0.0` - `172.31.255.255`（マスクの範囲は16 - 28の間）
    - `192.168.0.0` - `192.168.255.255` （マスクの範囲は16 - 28の間）
 - サブネットCIDRはVPC CIDR範囲内または同じにする必要があります。
 例えば、VPCのIPレンジが`192.168.0.0/16`の場合、VPC内のサブネットのIPレンジは`192.168.0.0/16`、`192.168.0.0/17`などになります。  
![](https://main.qcloudimg.com/raw/46b5e21b88d43da6f2697906bb5bfc21.png)

## 手順2：サブネットの作成
同時に1つまたは複数のサブネットを作成することができます。
1. [VPCコンソール](https://console.cloud.tencent.com/vpc)にログインします。
2. 左側のディレクトリの中の【サブネット】をクリックし、管理画面に入ります。
3. サブネットを作成したいリージョンとVPCを選択し、【+新規作成】をクリックします。
4. サブネット名、CIDR、アベイラビリティーゾーン、関連付けるルートテーブルを記入します。
![2](https://main.qcloudimg.com/raw/84bd6ce8469eae5d399ce96a89168299.png)
5. 【+1行追加】をクリックすると、複数のサブネットを作成できます（任意）。
6. 【作成】をクリックすれば完了です。

## 手順3：ルートテーブルとサブネットとの関連付けの作成
カスタムルートテーブルを作成して、ルーティングポリシーを編集し、その後指定するサブネットに関連付けます。サブネットに関連付けるルートテーブルは、該当サブネットのアウトバウンドルートの指定に用いられます。
1.  [VPCコンソール]にログインし、左側の欄から【ルートテーブル】ページを選択します。
2. リストの上方からリージョンとVPCを選択し、【+新規作成】をクリックします。
3. ポップアップしたダイアログボックスの中に名前、所属ネットワーク、新規作成したルーティングポリシーを記入し、【作成】をクリックします。ルートテーブルのリストが返ってきたら新規作成したルートテーブルを確認できます。
![](https://main.qcloudimg.com/raw/4e59f2e780b5296fe85b204bd86b8b73.png)
4. コンソールの左側の欄から【サブネット】のページを選択して、当該のルートテーブルを関連付けたいサブネットを選択し、【操作】の列の【ルートテーブルの変更】をクリックして、関連付けを行います。

## 手順4：Cloud Virtual Machine（CVM）の追加
1. [VPCコンソール](https://console.cloud.tencent.com/vpc)にログインします。
2. 左側のディレクトリの中の【サブネット】をクリックし、管理画面に入ります。
3. CVMを追加したいサブネットの行で、CVMのアイコンをクリックして追加します。
![](https://main.qcloudimg.com/raw/2bafceab2bb6a5a31fe76844e19bb07e.png)
4. 画面の表示にしたがって、CVMを購入すれば完了です。詳細については、CVMのドキュメントの[購入方法](https://intl.cloud.tencent.com/document/product/213/506)をご参照ください。

## 手順5：クラウドデータベースの追加
#### データベースの新規作成
1. [TencentDB for MySQL](https://console.cloud.tencent.com/cdb)にログインし、【新規作成】をクリックすると、購入ページに入ります。
2. 購入ページで【ネットワーク】オプションに、【VPC】を選択し、すでに作成したVPCと対応するサブネットを選択すると、新規に購入したクラウドデータベースをVPCに追加します。
![](https://main.qcloudimg.com/raw/c8f5065a7ceafc763163b4abe82564bf.png)

#### 既存のデータベース
1. インスタンスリストの中で、インスタンス名または操作の列の【管理】をクリックして、インスタンス詳細画面に入ります。
2. 詳細画面の【所属ネットワーク】で、対応するVPCを切り替えることができます。
