
우수한 성능과 확장 능력을 갖춘 데이터베이스로 기존 시스템의 부하 성능을 빠르게 향상할 수 있습니다. 똑같은 규모의 데이터베이스에서도 MySQL의 합리적인 사용으로 데이터베이스의 동시 작업 능력을 향상함으로써 초당 쿼리 횟수가 더 높은 비즈니스를 감당할 수 있습니다.

## 1. 자신에게 적합한 데이터베이스 사양 선택
### 1.1 데이터베이스 버전 선택
TencentDB for MySQL은 현재 네이티브 MySQL의 5.5, 5.6, 5.7, 8.0 버전과 완벽한 호환성을 갖추고 있습니다. 더욱 안정적인 데이터베이스 커널을 제공하고, 5.5 및 그 이전 버전의 레이아웃을 최적화한 5.6 혹은 그 이상의 버전을 선택하시길 권장합니다. 시스템 성능 향상에 도움을 줄 뿐 아니라 새로 추가된 다양한 특성을 이용할 수 있습니다.

본 문서는 MySQL 5.7 버전을 예로 새로운 버전의 특징에 대해 소개합니다. 이미 대중적으로 고성능, 신뢰성 및 용이성을 갖춘 버전으로 알려진 MySQL 5.7의 최적화 부분 및 신규 특성은 아래와 같습니다.

- ** 네이티브 JSON 지원**
MySQL 5.7에는 MySQL 테이블에 JSON 형식의 데이터를 저장할 수 있는 데이터 유형이 새로 추가되었습니다. 네이티브에서 지원하는 JSON 데이터 유형은 아래와 같은 장점을 갖고 있습니다.
 - 문서 인증: JSON 규격에 맞는 데이터 세그먼트만 JSON 유형 칼럼에 입력할 수 있어, JSON 구문을 자동으로 인증하는 기능이라고 볼 수 있습니다.
 - 고효율 액세스: JSON 유형의 칼럼에 JSON 문서를 저장할 때, 플레인 텍스트 데이터가 아닌 일종의 최적화된 이진법 형식으로 저장되어, 더 빠르게 객체 멤버 및 배열 요소에 액세스할 수 있습니다.
 - 성능 향상: JSON 유형 칼럼의 데이터에 인덱스를 생성해 쿼리(query) 성능을 향상할 수 있습니다. 이와 같은 인덱스 기능은 가상 칼럼에 '함수 인덱스'를 생성하여 구현할 수 있습니다.
 - 간편성: JSON 유형 칼럼에 추가된 인라인(Inline) 구문에 대해서는 SQL 명령에서 문서를 통합하여 자연스럽게 쿼리할 수 있습니다. features로 예를 들자면, features는 하나의 JSON 필드로서 아래와 같습니다.
```
 SELECT feature->"$.properties.STREET" AS property_street FROM features WHERE id = 121254;
```
MySQL 5.7을 사용하면 하나의 툴에서 가장 적합한 관계형 및 문서형 사례를 매끄럽게 혼합할 수 있어, 서로 다른 애플리케이션, 사용 사례에서도 관계형 사례 또는 문서형 사례 중 가장 적합한 사례를 사용합니다. 이로써 MySQL의 응용 범위를 한 층 더 확장할 수 있습니다.
- **SYS Schema**
MySQL SYS Schema는 일련의 객체(뷰, 저장 과정, 저장 방법, 테이블 및 트리거)로 구성된 database schema로, Performance Schema와 INFORMATION_SCHEMA에 저장된 각 테이블의 모니터링 데이터 리소스를 간편하고 읽기 가능하며, 데이터베이스 관리자(DBA)와 개발자에게 친화적인 방법으로 액세스할 수 있습니다.
MySQL SYS Schema는 MySQL 5.7에 기본 탑재되어 있으며, 아래와 같이 FAQ에 대한 해결을 위해 요약 뷰를 제공합니다.
 - 데이터베이스 서비스 모든 리소스를 차지하고 있는 사람이 누구인가요?
 - 데이터베이스 서버에 대한 액세스양이 가장 큰 CVM은 무엇인가요?
 - 인스턴스의 메모리가 왜 부족한가요?
- **InnoDB 관련 개선**
 - InnoDB 온라인 작업(Online DDL): MySQL을 재시작하지 않고 Buffer Pool size를 수요에 맞게 동적으로 조정할 수 있습니다. 또한, 이제 InnoDB는 온라인에서도 InnoDB의 UNDO 로그와 테이블 용량을 자동으로 삭제할 수 있어, 흔히 발생하는 대용량 공용 테이블 파일(ibdata1) 문제를 해결했습니다. 마지막으로 MySQL 5.7에서 인덱스 이름 변경과 varchar 사이즈 변경을 지원하게 됨으로써 이전 버전에서 인덱스와 테이블을 새로 생성해야 했던 번거로움을 개선했습니다.
 - InnoDB 네이티브 파티션: MySQL 5.7 InnoDB는 이제 파티션에도 네이티브를 지원합니다. InnoDB 네이티브 파티션으로 부하를 낮출 수 있으며, 메모리 수요를 최대 90%까지 해소할 수 있습니다.
 - InnoDB 캐시 프리패치: MySQL을 재시작할 때 InnoDB가 캐시 풀에서 가장 마지막 데이터의 25%를 보관하므로, 데이터 캐시 작업을 사전에 로딩하거나 프리패치하지 않아도 되며 MySQL 재시작 시의 손실을 방지할 수 있습니다.

MySQL 5.7의 최적화 및 새로운 특성에 대한 더 자세한 내용은 [MySQL 공식 자료](https://dev.mysql.com/doc/refman/5.7/en/mysql-nutshell.html)를 참고하시기 바랍니다.

### 1.2 인스턴스 사양 선택(데이터베이스 메모리)
현재 MySQL은 단독적인 CPU 옵션을 제공하지 않고, 메모리 사양에 따라 비율적으로 할당하고 있으니 자신의 비즈니스 특징에 따라 해당하는 데이터베이스 사양을 구매할 수 있습니다. 유형 선택 시 성능 참고를 위해 각 인스턴스를 기준으로 상세한 표준화 검사를 제공합니다.
단, Sysbench 표준화 검사의 경우 모든 비즈니스 시나리오를 대변하지 못하므로, 자신의 비즈니스 시나리오에 적용했을 때의 MySQL 성능을 확인할 수 있도록, 서비스를 정식으로 실행하기 이전에 데이터베이스 스트레스 테스트를 진행하시길 권장합니다. 자세한 내용은 [ MySQL 성능 설명](https://intl.cloud.tencent.com/document/product/236/8842)을 참고하시기 바랍니다.

디스크보다 훨씬 빠른 액세스 속도를 가진 메모리는 인스턴스에 있어 가장 중요한 지표 중의 하나이며, 일반적으로 메모리에 캐싱된 데이터가 많을수록 데이터베이스의 응답이 더 빨라집니다. 메모리가 비교적 작아 데이터가 일정량을 초과하면 디스크로 플러시(Flush)되고, 새로운 요청이 또다시 해당 데이터에 액세스할 경우 디스크에서 메모리 데이터를 직접 읽으며 디스크 IO를 소모합니다. 이에 따라 데이터베이스의 응답이 느려질 수 있습니다.

**동시 읽기 작업이 비교적 많거나 읽기 딜레이에 민감한 비즈니스에서는 데이터베이스의 성능을 위해 메모리 사양이 너무 작지 않도록 하시기를 권장합니다.**

### 1.3 디스크 선택(데이터 스토리지 용량)
TencentDB for MySQL 인스턴스의 디스크 용량에는 MySQL 데이터 디렉터리만 포함되며, binlog, relaylog, undolog, errorlog, slowlog 등의 로그 용량은 포함되지 않습니다. 입력한 데이터의 양이 인스턴스 디스크의 용량을 초과했을 때 제때 업그레이드하지 않았다면 인스턴스에 락(Lock)이 걸릴 수 있습니다. 따라서, 디스크 용량 부족으로 인한 인스턴스 락(Lock) 또는 잦은 업그레이드를 방지하기 위해 디스크 용량을 구매할 때 향후 데이터 증가량을 고려해 여유 공간을 남겨두시기 바랍니다.

### 1.4 적합한 데이터 복제 방식 선택
TencentDB for MySQL은 비동기화, 반동기화, 강제 동기화 세 가지 복제 방식을 제공하며, 자세한 내용은 [데이터베이스 인스턴스 복제 방식](https://intl.cloud.tencent.com/document/product/236/7913)을 참고하시기 바랍니다. 만약 자신의 비즈니스가 입력 딜레이 시간이나 데이터베이스 성능에 비교적 민감하다면 비동기화 복제를 선택하시기를 권장합니다.

### 1.5 CDB의 고가용성
TencentDB for MySQL은 고가용 마스터 슬레이브 M-S(마스터/슬레이브 모드) 아키텍처를 사용하며, 마스터 슬레이브 간의 데이터 동기화는 로그 binlog 방식을 기반으로 합니다. 이와 동시에 백업 및 로그를 바탕으로 인스턴스를 아무 시점으로 복구할 수 있도록 지원합니다. 따라서, 일반적으로 백업 및 복구 시스템을 다시 구축하거나 다른 부가적인 지출 없이도 인스턴스의 고가용성을 보장합니다.

### 1.6 CDB의 확장성
TencentDB for MySQL의 데이터베이스 버전과 메모리/디스크 사양 모두 온라인 동적 업그레이드를 지원합니다. 업그레이드하는 동안 비즈니스가 중단되지 않기에, 비즈니스 규모 확장에 따른 데이터베이스 병목 현상을 우려할 필요가 없습니다.

### 1.7 CVM과 MySQL의 조합 사용
일반적으로 구매를 완료한 후에는 CVM과 MySQL을 조합해서 사용해야 합니다. 자세한 내용은 [CVM을 사용하여 MySQL 액세스](https://intl.cloud.tencent.com/document/product/236/37788)를 참고하십시오.

## 2. 읽기 전용 인스턴스를 읽기 확장 시에 사용
흔히 보는 인터넷 비즈니스에서 데이터베이스의 읽기와 쓰기 비율은 일반적으로 4:1에서 10:1 사이입니다. 이러한 유형의 비즈니스 시나리오에서는 데이터베이스의 읽기 부하가 쓰기 부하보다 훨씬 높기 때문에 성능 병목 현상이 발생했을 때 가장 보편적인 해결 방법은 바로 읽기 부하를 증가하는 것입니다.
MySQL 읽기 전용 인스턴스는 읽기 확장 솔루션을 제공합니다. 자세한 내용은 [읽기 전용 인스턴스](http://intl.cloud.tencent.com/document/product/236/7270)를 참고하시기 바랍니다.
읽기 전용 인스턴스는 또한 다양한 비즈니스에서 읽기 전용 액세스에 사용할 수 있습니다. 이는 마스터 인스턴스에서 온라인 비즈니스 읽기 및 쓰기 액세스를 담당하고, 읽기 전용 인스턴스에서는 내부 비즈니스나 데이터 분석 플랫폼에 읽기 전용 쿼리를 제공하는 것으로 예를 들 수 있습니다.

## 3. CDB의 재해 복구 솔루션
TencentDB for MySQL은 타 리전에 데이터베이스를 간편하게 구축하여 재해 복구에 사용할 수 있도록 [재해 복구 인스턴스](https://intl.cloud.tencent.com/document/product/236/7272)를 제공합니다.

재해 복구 인스턴스를 통해 여러 리전에 있는 각 데이터 센터끼리 서로 여분이 되도록 하여, 한 데이터 센터에서 장애가 발생하거나 불가항력으로 인해 서비스를 제공할 수 없을 때 빠르게 다른 데이터 센터로 변경할 수 있습니다. 재해 복구 인스턴스는 Tencent의 내부 네트워크 전용선을 사용한 데이터 동기화 및 MySQL 커널급 복제 최적화를 통해 재난 상황 시 비즈니스에 영향이 없도록 동기화 딜레이를 최소화합니다. 또한, 타 리전의 비즈니스 로직이 준비된 상태라면 재해 복구 변경을 몇 초안에 실현할 수 있습니다.

## 4. 2리전 3데이터센터 프로그램
TencentDB for MySQL을 사용하면 페이지에서 몇 가지 간단한 설정만으로 2리전 3데이터센터를 구현할 수 있습니다.
- MySQL 도시 내 일관성이 높은 클러스터를 구매하고 [멀티 가용존 배포](https://intl.cloud.tencent.com/document/product/236/8459)(베타 테스트 오픈)를 선택하면 1리전 2데이터센터의 성능을 이용할 수 있습니다.
- 해당 클러스터에 타 리전 재해 복구 노드를 추가하면 즉시 2리전 3데이터센터 아키텍처를 구현할 수 있습니다.

## 5. 재해 복구 인스턴스로 근거리 액세스 가능
재해 복구 인스턴스는 독립 M-S(마스터/스레이브 모드)의 고가용성 아키텍처를 사용하는 동시에 외부적으로는 읽기 전용 액세스 성능을 제공합니다. 따라서, 타 리전의 사용자가 가까운 곳의 비즈니스에 액세스해야 하는 시나리오에서도 안심하고 재해 복구 인스턴스를 사용할 수 있습니다.
