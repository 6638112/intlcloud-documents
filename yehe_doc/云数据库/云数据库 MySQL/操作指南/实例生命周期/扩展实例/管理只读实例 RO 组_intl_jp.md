## 操作シナリオ
MySQLは、ユーザーによる1つ又は複数の読取専用インスタンスROグループ作成をサポートし、また、リード・ライト分離と1マスター対複数スレーブのユースケースに適用することで、ユーザーデータベースの読取負荷能力をめざましく向上させることができます。

## 前提条件
- 読取専用インスタンスを作成する前に、CDBマスターインスタンスを作成する必要があります。[購入ガイド](https://intl.cloud.tencent.com/document/product/236/5160)をご参照ください。
- MySQLを使用する前に、データベースを初期化する必要があります。[MySQLデータベースの初期化](/doc/product/236/3128)をご参照ください。

##　操作手順

### 読取専用インスタンスROグループの作成
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb/ )にログインし、インスタンスリストでインスタンス名又は「操作」列の【管理】をクリックして詳細ページに進みます。
2. インスタンス詳細ページで、【インスタンスアーキテクチャ図】中の【読取専用インスタンスの追加】をクリックして、読取専用インスタンスの管理ページに進みます。
![](https://main.qcloudimg.com/raw/83e817ae1b9205d6cdf061684f7d3c12.png)
3. 読取専用インスタンスページで、【新規作成】をクリックし、読取専用インスタンスを作成します。
4. 購入ページに進み、CDB読取専用インスタンスに対応する構成を選択します。問題ないことを確認してから【今すぐ購入】をクリックし、読取専用インスタンスを購入します。
>ROグループを指定して【ROグループの新規作成】にオプション構成する場合、購入インターフェースで新規作成するROグループの以下の基本情報を入力する必要があります。
>- ROグループ名称の設定：ROグループ名は一意であることが要求されません。長さが60未満の日本語/英数字/-/_/.をサポートします。
>- 時間遅延/超過の除去：除去ポリシーを有効にするか。除去されたインスタンスの重みは自動的に0に設定されます。読取専用インスタンスの時間遅延/超過しきい値が除去された場合、ユーザーに警告が出され、またインスタンス状態がサービス停止同期中、重みが0になります。読取専用インスタンスの遅延時間がしきい値未満の時、ROグループに新たに入ります。同時に、インスタンスが時間遅延/超過の除去機能を有効にしているかに関わらず、読取専用インスタンスの障害が除去された後、インスタンスが修復されてからもROグループに新たに入ります。
>- 遅延しきい値：読取専用インスタンスに時間遅延/超過しきい値を設定し、しきい値を超えた読取専用インスタンスはROグループが除去されます。
>- 最小保留インスタンス数：グループ内で保証する必要のあるインスタンスの下限数。既存の読取専用インスタンス数がこの下限以下であり、かつ遅延時間がしきい値を超えた場合、既存の読取専用インスタンスはいずれも除去されません。
>
>[](https://main.qcloudimg.com/raw/080eae0860b13115d0151f4414c4b63a.png)
>
 - ROグループを指定。
 <table>
  <tr>
    <th width="25%">ROグループを指定</th>
    <th width="75%">説明</th>
  </tr>
  <tr>
    <td>システム自動割り当て（指定しない）</td>
    <td>1回で複数のインスタンスを購入した場合、それぞれのインスタンスに1つの独立したROグループが割り当てられます。重みの割り当て方法は、デフォルトでシステム自動割り当てになります。</td>
  </tr>
  <tr>
    <td>ROグループの新規作成</td>
    <td>ROグループを1つ新規作成し、1回で複数のインスタンスを購入した場合、いずれもこのROグループに割り当てられます。重みの割り当て方法は、デフォルトでシステム自動割り当てになります。</td>
  </tr>
  <tr>
    <td>既存のROグループ</td>
    <td>1つの既存のROグループを指定し、1回で複数のインスタンスを購入した場合、いずれもこのROグループに割り当てられます。重みの割り当て方法はROグルプの設定と同じです。ROグループがシステム自動割り当てに設定された場合、購入の規格に基づき自動的にROグループを追加します。カスタム割り当ての場合、デフォルトの重みは0です。<b>同一ROグループのプライベートネットワークアドレスは同じであるため、VPCネットワークの場合、同一セキュリティグループの設定を共有します。ROグループを指定する場合、購入時にセキュリティグループを再度カスタマイズできません。</b></td>
  </tr>
</table>
 - 課金モード：読取専用インスタンスは、現在、使用量による料金請求の課金モードをサポートします。
 - インスタンス規格と必要なディスクを選択します。
5. インスタンスリストに戻ると、作成されたインスタンスステータスは「出荷中」になっています。ステータスが「実行中」に切り換わると、読取専用インスタンスの作成が完了したことを意味します。


### 読取専用インスタンスROグループの設定
読取専用インスタンスROグループの設定インターフェースで、読取専用インスタンスROグループの名称、時間遅延/超過ポリシー、時間遅延しきい値、最小保留インスタンス、読込重みなどの基本情報を設定することができます。
>
>- ROグループ内の読取専用インスタンスは異なる規格を使用することができ、トラフィック読込の重みを設定することができます。
>- 同一ROグループ内の読取専用インスタンスは、異なる有効期限と課金方法をサポートすることできます。
>
1. インスタンスリストで、設定する必要のある読取専用インスタンスROグループのCDBのマスターインスタンスを選択し、【操作】列で【管理】をクリックします。
2. 【読取専用インスタンス】タブ中のROグループ管理ページで【設定】をクリックし、読取専用インスタンスROグループ設定ページに進みます。
![](https://main.qcloudimg.com/raw/f03a6fc7e5460181e1e933157b4922cb.png)
3. 読取専用インスタンスROグループ設定ページで、読取専用インスタンスROグループについて詳細な設定を行うことができます。
![](https://main.qcloudimg.com/raw/94a42aa7ed813d8ba68560c40749998f.png)
   - ROグループ名称：ROグループ名は一意であることが要求されません。長さが60未満の日本語/英数字/-/_/.をサポートします。
   - インスタンスの時間遅延/超過の除去：除去ポリシーを有効にするか。除去されたインスタンスの重みは自動的に0に設定されます。読取専用インスタンスの時間遅延/超過しきい値が除去された場合、ユーザーに警告が出されます。
   - 遅延しきい値：読取専用インスタンスに時間遅延/超過しきい値を設定し、しきい値を超えた読取専用インスタンスはROグループが除去されます。
   - 最小保留インスタンス数：グループ内で保証する必要のあるインスタンスの下限数。既存の読取専用インスタンス数がこの下限以下であり、かつ遅延時間がしきい値を超えた場合、既存の読取専用インスタンスはいずれも除去されません。
   - 読込重みの割り当て：ROグループはシステムによる重みの自動割り当てと重みのカスタマイズの2種類の重み設定方法をサポートします。重み入力範囲は0～100で、整数でなければなりません。システムによる高IOバージョンMySQLインスタンス自動設定の読込重み値リスト：
<table>
  <tr>
    <th>インスタンスの規格</th>
    <th>重み</th>
  </tr>
  <tr>
		<td>メモリ1000MB</td>
		<td>1</td>
  </tr>
  <tr>
		<td>メモリ2000MB</td>
		<td>1</td>
  </tr>
  <tr>
		<td>メモリ4000MB</td>
		<td>2</td>
  </tr>
	  <tr>
		<td>メモリ8000MB</td>
		<td>2</td>
  </tr>
	  <tr>
		<td>メモリ12000MB</td>
		<td>4</td>
  </tr>
	  <tr>
		<td>メモリ16000MB</td>
		<td>4</td>
  </tr>
	  <tr>
		<td>メモリ24000MB</td>
		<td>8</td>
  </tr>
	  <tr>
		<td>メモリ32000MB</td>
		<td>8</td>
  </tr>
	  <tr>
		<td>メモリ48000MB</td>
		<td>10</td>
  </tr>
	  <tr>
		<td>メモリ64000MB</td>
		<td>12</td>
  </tr>
	  <tr>
		<td>メモリ96000MB</td>
		<td>14</td>
  </tr>
	  <tr>
		<td>メモリ128000MB</td>
		<td>16</td>
  </tr>
	  <tr>
		<td>メモリ244000MB</td>
		<td>26</td>
  </tr>  <tr>
		<td>メモリ488000MB</td>
		<td>50</td>
  </tr>
</table> 
 ### 負荷再分散：
 負荷再分散を無効にした時、重みを変更した時に新規の負荷だけに反映され、元の長接続がアクセスする読取専用インスタンスは変更されず、データベースの切断につながりません。
  負荷再分散を有効にした時、データベースの接続が数秒間切断されることにより、すべての接続が切断されます。新規の接続は設定された重みに従い負荷分散を行います。

### 読取専用インスタンスROグループの終了と削除
- ROグループは手動による削除機能を提供していません。
- ROグループはグループ内の最後の読取専用インスタンスの完全終了に伴い、自動的に削除されます。
- ブランクのROグループ保留をサポートしません。
