## 操作シナリオ

ここでは、主にTEMコンソールでアプリケーションを作成してデプロイする具体的な手順について説明します。

## 前提条件

1. すでに[環境の作成](https://intl.cloud.tencent.com/document/product/1094/40358)を行っていること。
2. すでに[環境リソースの追加](https://intl.cloud.tencent.com/document/product/1094/40361)（必要に応じてCloud Log Service、Storage Service、レジストリを選択）を行っていること。

## 操作手順

1. [TEMコンソール](https://console.cloud.tencent.com/tem)にログインします。
2. 左側のナビゲーションバーで、【アプリケーション管理】をクリックしてアプリケーションリストページに移動し、アプリケーションデプロイのリージョンを選択します。

| リージョン | デプロイがサポートされているアベイラビリティーゾーン       |
| ---- | ---------------------- |
| 広州 | 3区、4区、6区       |
| 上海 | 2区、3区、4区、5区 |

3. 【新規作成】をクリックして、アプリケーションの新規作成ページに進み、アプリケーション情報を入力します。
      ![](https://main.qcloudimg.com/raw/fbf88fef630b27b88fa0a4f2ddaff25c.png)

   - 名称：アプリケーション名を入力します。45文字以内で、アルファベットの小文字、数字および区切り文字(「-」)のみ使用できます。区切り文字で開始または終了することはできません
   - 開発言語：自分の開発言語を選択します。
   - パッケージのアップロード方法：パッケージのアップロード方法を選択します。Java言語はイメージ、JARパッケージおよびWARパッケージのアップロードをサポートしていますが、他の言語はイメージのアップロードのみをサポートしています。JARパッケージまたはWARパッケージ方式を選択する場合、TEMは自動的にコンテナイメージを構築し、TEMが作成したパーソナル版のコンテナイメージレジストリにプッシュします。

4. 【サブミット】をクリックし、ポップアップウィンドウで【確定】を選択して、デプロイアプリケーションページに進みます。【キャンセル】を選択した場合、続いてアプリケーションリストの【新しい環境にデプロイ】をクリックすれば、アプリケーションのデプロイを完了することができます。
      <img src="https://main.qcloudimg.com/raw/2cfd50d64227a7ae589eb8203f512c58.png">

5. アプリケーションのデプロイページで、アプリケーションの具体的な状況に応じて関連パラメータを設定します。
      ![](https://main.qcloudimg.com/raw/a84a9d3b433b6fa8d3e9ed297ed4b178.png)

   パラメータの説明は次のとおりです。


| パラメータ            | 説明                                                         |
| --------------- | ------------------------------------------------------------ |
| 環境の公開        | アプリケーションが存在する環境を選択します。適切な環境がない場合は、[環境ページ](https://console.cloud.tencent.com/tem/env)に移動して新規作成を実行します（[環境の作成](https://intl.cloud.tencent.com/document/product/1094/40358)を参照）。 |
| JDKバージョン        | OpenJDK 8やKonaJDK 8をサポートするJDKバージョンを選択します。                        |
| パッケージ/イメージのアップロード | パッケージやイメージをアップロード、またはコンソール上の体験Demoをダウンロードしてアプリケーションのデプロイを実行します。デプロイ後、TEMのすべての機能をご体験ください。 |
| バージョン番号          | アプリケーションのバージョン番号を設定します。バージョン番号を入力するか、**タイムスタンプをバージョン番号として使用する**をクリックすると、タイムスタンプをアプリケーションのバージョン番号として使用することができます。 |
| バージョンの説明        | バージョンの説明を入力します。                                                 |
| 起動パラメータ        | 起動パラメータを設定します。                                                 |

>?お客様のアプリケーションがJava言語であり、レジストリに関連付けられている場合、TEMはレジストリ情報を自動的に挿入することができます。詳細については、[サービスの登録と検出](https://intl.cloud.tencent.com/document/product/1094/40960)をご参照ください。

6. （オプション）必要に応じて、次の詳細オプションを設定できます。


| パラメータ                    | 入力必須かどうか | 説明                                                         |
| ----------------------- | -------- | ------------------------------------------------------------ |
| リソース構成                | 必須       | 手動で設定またはエラスティックルールを設定して自動スケーリングすることができます。                   |
| アクセス設定                | 必須ではない       | <li>アクセス方法：環境内のアクセス、パブリックネットワークアクセスの場合、[環境](https://console.cloud.tencent.com/tem/env)のグローバル構成に移動します。[アプリケーションアクセスとルートの設定](https://intl.cloud.tencent.com/document/product/1094/40359)をご参照ください。</li><li>プロトコル：TCPプロトコルとUDPプロトコルをサポートします。パブリックネットワーク/プライベートネットワークのCLBを使用する場合、TCPプロトコルとUDPプロトコルを混在させることはできません。 </li> |
| アプリケーションのライフサイクル管理        | 必須ではない       | 起動前と終了後のアプリケーションプロセスの処理タスクを設定します（例：環境の準備、アプリケーションの終了など）。 |
| 設定の構成                | 必須ではない       | 設定の使用と管理。                                           |
| 環境変数                | 必須ではない       | 環境変数を構成します。                                               |
| ヘルスチェック                | 必須ではない       | <li> 存在チェック(Liveness)：アプリケーションインスタンスが正常に実行されていることをチェックし、正常でない場合はインスタンスを再起動します。</li><li> 完了チェック (Readiness)：アプリケーションインスタンスが完了しているかをチェックし、完了していない場合は現在のインスタンスへの転送トラフィックを停止します</li>具体的な操作については、[ヘルスチェック](https://intl.cloud.tencent.com/document/product/1094/42080)をご参照ください。 |
| <nobr>永続ストレージ</nobr> | 必須ではない       | 永続ストレージ：コンテナにストレージを提供します。現在、Tencent CloudのCloud File Storage(CFS)がサポートされており、コンテナの指定されたパスにマウントする必要があります。<li>  データ量：[環境リソースの追加](https://intl.cloud.tencent.com/document/product/1094/40361)に関連付けられているCFSストレージリソースに追加します。</li><li> マウントポイント：この手順で追加したデータ量を選択し、対象パスにマウントします。バージョンの説明を入力します。</li> |
| セキュリティグループ                  |必須ではない       |セキュリティグループルールを設定することによって、セキュリティグループ内のインスタンスのアウトバウンドトラフィックとインバウンドトラフィックを許可または禁止することができます。業務ニーズにより他のポートを開放する必要がある場合は、[セキュリティグループを新規作成](https://console.cloud.tencent.com/vpc/securitygroup)することができます。 |
| ログ構成                |必須ではない       |「CLSへの永続ストレージ」を有効にすると、標準出力「stdout」と`*`構成パスをサポートします。`/logs/*`などのように、半角記号で区切ります。標準出力はデフォルトで収集されます。 |

7. 【サブミット】をクリックして、アプリケーションのデプロイを完了します。
8. マイクロサービスアプリケーションの場合、コンシューマーアプリケーションとサーバーアプリケーションのデプロイは手順3～7と同様なので、ここでは繰り返しての説明はいたしません。

## アプリケーションへのアクセス

TEMはマイクロサービス環境内とパブリックネットワークアクセスという2種類の方式を提供しています。

- 環境内のアクセス：同じ環境内のマイクロサービスは、登録されたサービス名を介して相互に呼び出すことができます。consul、eurekaなどのレジストリに基づくサービスの登録と検出、およびkubernetesに基づくサービスディスカバリをサポートします。
- パブリックネットワークアクセス：環境カードの下にある【詳細の表示】をクリックすると、【CAM】ページでパブリックネットワークLBとHTTP/HTTPSプロトコル転送ルールを作成して、アプリケーションにアクセスできます。

例としてパブリックネットワークへのアクセスを取り上げます。操作手順は次のとおりです。

1. [アプリケーションアクセスとルートの設定](https://intl.cloud.tencent.com/document/product/1094/40359)を参照して、パブリックネットワークアクセスルートを構築します。

2. アプリケーションのパブリックネットワークアクセスIPは、環境詳細ページの【CAM】で確認できます。
   	![](https://main.qcloudimg.com/raw/bfb77deab6549a5c2f4ef908fc7ef133.png)

3. ブラウザのアドレスバーに次のURLを入力します。
  ```xml
 <パブリックネットワークアクセスアドレス/ドメイン名> + <パス>
  ```
   例：`http://xx.xx.xx.xx/ping-provider`と入力し、次の結果が返された場合は、アプリケーションが正常にデプロイされたことを意味します。
   ```
	Hello World!
   ```
