## Overview

MQTT.fx is a mainstream MQTT desktop client. Compatible with Windows, macOS, and Linux, it can quickly verify whether it is possible to connect to IoT Hub and publish or subscribe to messages. For more information on the MQTT protocol, please see [MQTT Introduction](https://mcxiaoke.gitbooks.io/mqtt-cn/content/mqtt/01-Introduction.html). This document describes how MQTT.fx can interact with IoT Hub with MQTT.fx 1.7.0 for macOS as an example.

## Directions

### Connecting to IoT Hub

1. Download an appropriate version of MQTT.fx client on the [MQTT.fx download page](http://mqttfx.jensd.de/index.php/download) and install it.
2. Open the MQTT.fx client program and click the **Settings** icon.
3. Click **+** to create a profile.
   ![](https://main.qcloudimg.com/raw/245072a611287b1ec54c5f81780e0a57.png)
4. Enter the **Connection Profile** and **General** information.
   ![](https://main.qcloudimg.com/raw/b6c0fbb65bac4a922ed0541576bd461e.png)

#### Parameter description

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Profile Name</td>
<td>Name of the profile</td>
</tr>
<tr>
<td>Broker Address</td>
<td>MQTT server connection address. For more information, see <a href="https://cloud.tencent.com/document/product/634/61228">Device Connection Regions</a>. `PRODUCT_ID` in the domain is a variable parameter, and you should replace it with the product ID automatically generated when you create the product, such as `9****ZW2EZ.iotcloud.tencentdevices.com`.</td>
</tr>
<tr>
<td>Broker Port</td>
<td>MQTT server connection port. For certificate authentication, enter `8883`. For key authentication, enter `1883`.</td>
</tr>
<tr>
<td>Client ID</td>
<td>MQTT protocol field. Enter product ID + device name according to IoT Hub's requirement, such as `9****ZW2EZgate_dev01`, where `9****ZW2EZ` is the product ID, and `gate_dev01` is the device name.</td>
</tr>
<tr>
<td>Connection Timeout</td>
<td>Connection timeout period in seconds</td>
</tr>
<tr>
<td>Keep Alive Interval</td>
<td>Heartbeat interval in seconds</td>
</tr>
<tr>
<td>Auto Reconnect</td>
<td>Automatic reconnection after network disconnection</td>
</tr>
</tbody></table>

5. Enter the **User Credentials** information.
	- **User Name**	: MQTT protocol field. Enter product ID + device name + SDKAppID + connid according to IoT Hub's requirement, such as `9****ZW2EZgate_dev01;12010126;12345` (the `ProductID` can be viewed on the product list or product details page after the product is created). It is sufficient to replace only the product ID and device name in the example. As the last two parameters are automatically generated by the connection SDK of IoT Hub, fixed test values are entered here.
	- **Password**	: the password is required.
		- **Certificate authentication**: as MQTT.fx sets the password flag to `true` by default, you need to enter a random non-empty string as the password; otherwise, you will not be able to connect to IoT Hub's backend. When actually accessing IoT Hub's backend, the authentication is based on the certificate, and the random password entered here will not be used as the access credential.
		- **Key authentication**: you can access the corresponding device list in the IoT Hub console to view and get the password (on the page as described in the key authentication steps below). You can also manually generate a password as instructed [MQTT-Based Device Connection over TCP](https://intl.cloud.tencent.com/document/product/1105/41824).
![](https://main.qcloudimg.com/raw/61195a191b05704ea560e2477578e2a5.png)
6. (Optional) certificate verification: select **Enable SSL/TLS**, check **Self signed certificates**, and upload related files.
![](https://main.qcloudimg.com/raw/ec4b93f69598d1c625abc5b42573ee0e.png)

#### File description

<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>CA File</td>
<td>Root certificate. Click the <a href="https://main.qcloudimg.com/raw/9aa774ea8c09f98811df361c741df38c/ca.crt" target="_blank">ca.crt</a> link to download the file.</td>
</tr>
<tr>
<td>Client Certificate File</td>
<td>Client certificate file, i.e., the device certificate which can be downloaded if the device is created in a certificate-authenticated product. For more information, please see <a href="https://intl.cloud.tencent.com/document/product/1105/41476" target="_blank">Device Connection Preparations</a>.</td>
</tr>
<tr>
<td>Client Key File</td>
<td>Client key file, i.e., the device key which can be downloaded if the device is created in a certificate-authenticated product. For more information, please see <a href="https://intl.cloud.tencent.com/document/product/1105/41476" target="_blank">Device Connection Preparations</a>.</td>
</tr>
<tr>
<td>PEM Formatted</td>
<td>The IoT Hub root certificate, device certificate, and device key are all generated by OpenSSL, and they are all in PEM format. MQTT.fx is a Java client, so it does not recognize PEM certificates. You need to select this option to enable the client to automatically convert the certificates into Java-recognized JKS format.</td>
</tr>
</tbody></table>

7. (Optional) Key authentication:
   ![](https://main.qcloudimg.com/raw/555608dcb2b2adb66db3a598f8459cf6.png)
    You can go to the console to get the username and password of the corresponding device: ![](https://main.qcloudimg.com/raw/e875f3b7ebe4d239238d235b18c72066.png)
    ![](https://main.qcloudimg.com/raw/ece7e8466c67e2abaf2c2d8f0639dddb.png)
8. After completing the above steps, click **Apply** > **OK** to save. Then, select the name of the file just created in the profile box and click **Connect**.
9. If the round icon in the top-right corner is green, the connection to IoT Hub is successful, and publishing and subscribing operations can be performed.
   ![](https://main.qcloudimg.com/raw/d9bba6a0731a3fda4f80b395233c677c.png)



### Publishing a message

Select the **Publish** tab in the client, enter a topic name, select a QoS level, and click **Publish** to publish the message. The publishing result can be queried through [Cloud Log](https://intl.cloud.tencent.com/document/product/1105/41482).
![](https://main.qcloudimg.com/raw/3c2ae1e8b4290c6015ce36235f78840b.png)

### Subscribe to a topic

Select the **Subscribe** tab in the client, enter a topic name, select a QoS level, and click **Subscribe** to subscribe to the topic. The subscribing result can be queried through [Cloud Log](https://intl.cloud.tencent.com/document/product/1105/41482).
![](https://main.qcloudimg.com/raw/05dd43e7f9d93195809e440cbfe67117.png)
