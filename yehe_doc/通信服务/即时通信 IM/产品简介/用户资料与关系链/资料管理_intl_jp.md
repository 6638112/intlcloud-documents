## データシステムの紹介
インスタントメッセージIMはユーザデータのホスティング機能をオープンにし、データと関連する完全なソリューション一式を提供しています。各ユーザに自身のデータを持たせ、かつデータの設定とプル機能を気軽に実現したい場合、インスタントメッセージIMのデータホスティングサービスを選択できます。
- インスタントメッセージIMはデータの保存機能を提供し、お客様のデータがリモートによる災害復帰、複数の場所への展開および自動拡張/縮小の機能を有することを確保し、お客様がサーバーのクラッシュ、マルチコピー、マスタースレーブレプリケーションと拡張/縮小などの複雑な処理フローから完全に解放されるようサポートします。
- インスタントメッセージIMは業界で一般的なサービス処理フローを提供し、お客様がユーザデータのサービスロジックにおいて完全に解放されるようサポートします。
- インスタントメッセージIMは専門的な運用フローと運営チームを提供し、年間99.99%の安定したサービス品質で、お客様がユーザに安定した口コミのサービスを提供するようサポートします。
- インスタントメッセージIMは簡単で使いやすいサービスインターフェースとクイックアクセスのヘルプガイドを提供し、トータルでお客様にトップクラスのサービスを提供します。

インスタントメッセージIMのデータホスティングサービスを使用すると、以下の機能が得られます。
- スタンダード仕様のデータフィールドの保存、読み取り/書き込み機能。
- カスタムのデータフィールドの保存、読み取り/書き込み機能。

## データフィールド
データはユーザの属性を説明するための1組のデータで、インスタントメッセージIMデータシステムはスタンダード仕様のデータフィールドとカスタムのデータフィールドをサポートします。データフィールドには以下の特性があります。
- データフィールドはKey-Valueにより表されます。
- KeyはStringタイプで、その命名はアルファベットの大文字小文字、数字、アンダーバーのみをサポートしています。
- Valueには以下の数種類のタイプがあります。
   a. uint32_tタイプの整数（カスタムのデータフィールドはサポートしません）。
   b. uint64_tタイプの整数（カスタムのデータフィールドはサポートしません）。
   c. stringタイプの文字列（stringの長さは500バイトを超えてはいけません）。
   d. bytesタイプのbuffer（bufferの長さは500バイトを超えてはいけません）。

- 各keyの読み取り権限と書き込み権限の構成をサポートし、データフィールドの読み取り/書き込み権限は以下の通りです。

<table style="display:table;width:100%">
		<tbody>
			<tr>
			<th style="width:20%;"> 権限名</th>
				<th style="width:30%;"> 権限のタイプ</th>
				<th> 備考</th>
			</tr>
			<tr>
				<td> 読み取り権限</td>
				<td>
					App読み取り可能<br>
					App管理者読み取り可能<br>
				</td>
				<td> 読み取り権限の1つまたは複数のタイプを選択可能</td>
			</tr>
			<tr>
				<td> 書き込み権限</td>
				<td>
					App書き込み可能<br>
					App管理者書き込み可能<br>
				</td>
				<td> 書き込み権限の1つまたは複数のタイプを選択可能</td>
			</tr>
		</tbody>
	</table>

## スタンダード仕様のデータフィールド

現在、インスタントメッセージIMがサポートするスタンダード仕様のデータフィールドは以下の通りです。

<table style="display:table;width:100%">
		<tbody>
			<tr>
			<th style="width:15%;"> フィールド名</th>
				<th style="width:5%;"> タイプ</th>
				<th style="width:10%;"> 説明</th>
				<th style="width:19%;"> 更新時にPushあり</th>
				<th> 備考</th>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Nick</td>
				<td> string</td>
				<td> ニックネーム</td>
				<td> あり</td>
				<td> 長さは500バイトを超えてはいけません</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Gender</td>
				<td> string</td>
				<td> 性別</td>
				<td> あり</td>
				<td>
					Gender_Type_Unknown：性別を設定していません<br>
					Gender_Type_Female：女性<br>
					Gender_Type_Male：男性<br>
				</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_BirthDay</td>
				<td> uint32</td>
				<td> 誕生日</td>
				<td> あり</td>
				<td>推奨する使い方：20190419</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Location</td>
				<td> string</td>
				<td> 所在地</td>
				<td> あり</td>
				<td>
					長さは16バイトを超えてはいけません。推奨する使い方は以下の通りです。<br>
					Appは数字から場所までのマッピング関係をローカルで定義します<br>
					バックグラウンドで実際に保存するのは4つのuint32_tタイプの数字です<br>
					そのうち、最初のuint32_tは国を表します<br>
					2番目のuint32_tは省を表します<br>
					3番目のuint32_tは都市を表します<br>
					4番目のuint32_tは区と県を表します<br>
				</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_SelfSignature</td>
				<td> string</td>
				<td> 自己署名</td>
				<td> あり</td>
				<td> 長さは500バイトを超えてはいけません</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_AllowType</td>
				<td> string</td>
				<td> 友だち追加の認証方法</td>
				<td> あり</td>
				<td>
					AllowType_Type_NeedConfirm：自身を友だちとして追加するには、自分の確認が必要です<br>
					AllowType_Type_AllowAny：すべての人が自分を友だちとして追加できます<br>
					AllowType_Type_DenyAny：いかなる人も自分を友だちとして追加できません<br>
				</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Language</td>
				<td> uint32</td>
				<td> 言語</td>
				<td> あり</td>
				<td> なし</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Image</td>
				<td> string</td>
				<td> プロファイルフォトのURL</td>
				<td> あり</td>
				<td> 長さは500バイトを超えてはいけません</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_MsgSettings</td>
				<td> uint32</td>
				<td> メッセージの設定</td>
				<td> あり</td>
				<td>
					フラグビット：<br>
					Bit0：0にするとメッセージを受信することを表し、1にするとメッセージを受信しないことを表します <br>
				</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_AdminForbidType</td>
				<td> string</td>
				<td> 管理者が友だち追加を禁止する識別子</td>
				<td> あり</td>
				<td>
					AdminForbid_Type_None：デフォルト値で、友だちを追加できます<br>
					AdminForbid_Type_SendOut：このユーザが友だち追加のリクエストをすることを禁止します<br>
				</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Level</td>
				<td> uint32</td>
				<td> レベル</td>
				<td> あり</td>
				<td> 一般的に1つのUINT-8データで1つのレベル情報を保存できます<br>複数のロールのレベル情報を実現するため、分割して保存することを検討できます</td>
			</tr>
			<tr>
				<td> Tag_Profile_IM_Role</td>
				<td> uint32</td>
				<td> ロール</td>
				<td> あり</td>
				<td> 一般的に1つのUINT-8データで1つのロール情報を保存できます<br>複数のロール情報を保存するため、分割して保存することを検討できます</td>
			</tr>
		</tbody>
	</table>

## カスタムデータフィールド
カスタムデータフィールドは、各Appがそれぞれのサービスのニーズに基づき設定するユーザデータです。カスタムデータフィールドにより、各Appはいくつかの規定外のデータをユーザデータに追加し、かつ既存のインターフェースにより読み取り/書き込み操作を行うことができます。

### カスタムデータフィールドの申請
Appの管理者はインスタントメッセージIMの[コンソール](https://console.cloud.tencent.com/im)＞【アプリケーションの構成】＞【機能の構成】によりカスタムデータフィールドを申請でき、申請のサブミット後、カスタムデータフィールドは5分以内に有効になります。
カスタムデータフィールドを申請する時、それぞれのカスタムデータフィールドに以下のデータを提出する必要があります。
- カスタムデータフィールドの名称（Key）：詳細は[カスタムデータフィールドの命名基準](#.E8.87.AA.E5.AE.9A.E4.B9.89.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5.E7.9A.84.E5.91.BD.E5.90.8D.E8.A7.84.E8.8C.83)をご参照ください。
- カスタムデータフィールドのタイプ（Value）：詳細は[データフィールド](#.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5)をご参照ください。
- カスタムデータフィールドの読み取り権限および書き込み権限：詳細は[データフィールド](#.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5)をご参照ください。

### カスタムデータフィールドの命名基準
カスタムデータフィールドの命名規則は以下の通りです。
- カスタムデータフィールドの名称は、プレフィックスとキーワードの2つの部分を含みます。
- カスタムデータフィールドのプレフィックスはTag_Profile_Customです。
- キーワードはアルファベットでなければならず、長さは8バイトを超えてはならず、英単語または英単語の略称を使用することをお勧めします。
- 例：とあるAppが申請するカスタムフィールドのキーワードがTestの場合、カスタムデータフィールドの名称はTag_Profile_Custom_Testになります。

## 関連ドキュメント

- [ユーザデータとリレーショナルチェーン（Android）](https://intl.cloud.tencent.com/document/product/1047/34332)
- [ユーザデータとリレーショナルチェーン（iOS）](https://intl.cloud.tencent.com/document/product/1047/34333)
- [ユーザデータ（Web & ミニプログラム）](https://intl.cloud.tencent.com/document/product/1047/34334)
