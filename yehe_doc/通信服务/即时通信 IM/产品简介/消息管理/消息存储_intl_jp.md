## ローミングメッセージストレージ

IMは、メッセージのローミングをサポートしています。つまり、ユーザーが端末を変更すると、他のユーザーまたはいずれかのグループとのチャットレコードを取得することもできます。
デフォルトの場合、シングルチャットメッセージとグループチャットメッセージには7日間のローミングがあり、ローミング時間を超えるメッセージは削除されます。IMは、コンソールでのメッセージローミング時間の変更をサポートしています。メッセージのローミング時間の延長は付加価値サービスです。具体的な課金の説明については、[料金説明](https://intl.cloud.tencent.com/document/product/1047/34350)をご参照ください。
[](id:MsgType)
SDKのバージョンが異なる場合、履歴メッセージの保存期間を延長するためのメッセージタイプも異なります。詳細を次の表に示します。

| SDKバージョン | テキスト | カスタムメッセージ | 画像| ファイル | 短い音声 | UGSV | リッチメディアメッセージ | 
|---------|---------|---------|---------|---------|---------|---------|---------|
| Android 5.Xバージョン | &#10003; | &#10003;  | &#10003;| &#10003; | &#10003; | &#10003; | &#10003; |
| Android 4.Xバージョン | &#10003; | &#10003;  | &#10003;| &#10003; | &#10003; | &#10003; | &#10003; |
| Android 3.Xバージョン | &#10003; | &#10003;  | × | × | × | × | × |
| Android 2.Xバージョン | &#10003; |  &#10003; | × | × | × | × | × |
| iOS 5.Xバージョン | &#10003; | &#10003;  | &#10003;| &#10003; | &#10003; | &#10003; | &#10003; |
| iOS 4.Xバージョン | &#10003; | &#10003;  | &#10003;| &#10003; | &#10003; | &#10003; | &#10003; |
| iOS 3.Xバージョン | &#10003; |  &#10003; | × | × | × | × | × |
| iOS 2.Xバージョン | &#10003; |  &#10003; | × | × | × | × | × |
| PC SDK 2.Xバージョン | &#10003; |  &#10003; | × | × | × | × | × |
| WebとミニプログラムSDK 2.Xバージョン| &#10003; | &#10003;  | &#10003;| &#10003; | &#10003; | &#10003; | &#10003; |
| WebとミニプログラムSDK 1.Xバージョン| &#10003; |  &#10003; | × | × | × | × | × |

>?より良いユーザーエクスペリエンスのために、SDKの最新バージョンにアップグレードすることをお勧めします。

## 未読メッセージストレージ

IMは、未読メッセージの保存をサポートします。ユーザーがオフラインの場合、これらの未読メッセージは、次回ログインしたときにも引き続きプルされます。

シングルチャットの場合、未読メッセージはデフォルトで7日間保存されます。各ユーザーの未読メッセージは、最大100件のシングルチャットセッションの未読メッセージを保存でき、各シングルチャットセッションは最大100件の未読メッセージを保存できます。制限を超えた部分は未読数にはカウントされませんが、これらのメッセージはメッセージローミングに保存されます。グループチャットの場合、このような制限はありません。

## 最近の連絡先メッセージ

最近の連絡先メッセージは、QQの最近の連絡先リストに類するもので、最近連絡したユーザーと最新のメッセージを表示できます。

クライアントはデフォルトの場合、ログイン時にSDKを介して最近の連絡先メッセージをプルし、セッションリストの表示に用います。最近の連絡先には、デフォルトで最近100件の連絡先が保存されますが、保存期間は最近の連絡先のうち最後のメッセージの保存期間と同様です。例えば、デフォルトで7日を超えて連絡先のメッセージがない場合、最後のメッセージの有効期限が切れると、最近の連絡先からユーザーを取得できなくなります。

## Appローカルストレージ

デフォルトの場合、SDKは受信したメッセージを内部に保存するので、ユーザーがメッセージを保存する必要はありません。ユーザーはインターフェースを呼び出してローカルメッセージを取得できます（ネットワーク操作なし）。さらに、getMessageインターフェースを介してローカルメッセージを取得することもできます。ローカルメッセージに障害がある場合は、ローミングメッセージによって補完します。
SDKはデフォルトではユーザーメッセージを削除しませんが、ローカルメッセージを削除する機能を提供して、お客様の特別なニーズも満たしています。
>!ローカルストレージを使用すると、ディスクとCPU性能が消費されます。保存を必要としないシナリオ（メッセージ処理性能をより重視し、履歴メッセージを重視しないライブストリーミングなど）では、ローカルストレージの無効を選択できます。





