CDN의 가속 COS로 버킷에 저장된 콘텐츠를 대량 다운로드하여 전송할 수 있습니다. 특히 같은 콘텐츠를 반복적으로 다운로드하는 시나리오에 유용합니다. Origin-pull 인증 기능이 있어 CDN 가속으로 버킷에 저장된 콘텐츠를 개인 읽기할 수 있습니다. 이외에도 CDN 인증을 통해 합법적 사용자만 콘텐츠 다운로드가 가능하기 때문에 공개 다운로드로 인한 데이터 보안 및 트래픽 비용 등 문제를 해결할 수 있습니다.

## 콘텐츠 전송 네트워크 CDN

### CDN의 정의

Content Delivery Network(CDN)는 기존 Internet에 새로운 네트워크 아키텍처를 추가한 것으로 전 세계에 분포한 고성능 가속 노드로 이루어져 있습니다. 고성능 서비스 노드는 정해진 캐시 정책에 따라 서비스 콘텐츠를 저장합니다. 사용자가 서비스 콘텐츠를 요청할 경우, 사용자와 가장 가까운 서비스 노드에서 스케쥴링한 뒤 빠르게 응답하므로 사용자의 액세스 딜레이를 줄이고 가용성을 향상시킬 수 있습니다.

CDN은 캐시와 Origin-pull을 실행합니다. 즉, 사용자가 특정 URL을 액세스하였으나 리졸브된 엣지 노드의 캐시 콘텐츠가 미스되거나 캐시가 만료된 경우, 원본 서버로 반환하여 원하는 콘텐츠의 응답을 획득합니다.

### 적용 시나리오

- 응답 딜레이를 줄이고 다운로드 속도를 높이려는 경우
- 지역, 국가, 대륙 간 GB에서 TB 용량의 데이터를 전송할 때
- 같은 콘텐츠를 짧은 시간에 반복적으로 다운로드할 경우

### 보안 유형

- Origin-pull 인증: 사용자가 요청한 데이터가 엣지 노드에서 캐시 미스된 경우, CDN이 Origin-pull을 실행하여 데이터 콘텐츠를 획득해야 합니다. COS를 원본 서버로 하여 Origin-pull 인증을 활성화하면 개인 액세스로 버킷의 데이터를 획득 및 캐싱하기 위해 CDN 엣지 노드가 특정 서비스 자격으로 COS 원본 서버에 액세스합니다.
  - CDN 서비스 라이선스: CDN 엣지 노드는 CDN 서비스 라이선스를 추가한 뒤 특정 서비스 자격으로 COS 원본 서버에 액세스할 수 있으며, CDN 서비스 라이선스를 추가해야 Origin-pull 인증이 가능합니다.
- CDN 인증 설정: 사용자가 엣지 노드에 액세스하여 캐시 데이터를 획득할 때 엣지 노드는 인증 설정 규칙에 따라 액세스 URL의 본인 인증 필드를 검증합니다. 이런 방법으로 비라이선스 액세스를 차단함으로써 링크 도용을 방지하고, 엣지 노드에 저장된 캐시 데이터의 보안성과 신뢰성을 강화합니다.

## COS 액세스 노드

### 액세스 노드의 정의

액세스 노드는 버킷 생성 시 버킷의 리전과 명칭에 근거해 버킷에 부여한 액세스 도메인이며, 이 도메인으로 버킷에 저장된 데이터에 액세스할 수 있습니다.

정적 웹 사이트 기능을 실행하면 기본 노드와 기능이 상이하며, 특정 설정에 의해 콘텐츠를 응답하는 정적 웹 사이트 액세스 노드 하나를 별도로 확보할 수 있습니다.

### 액세스 노드

- XML 노드: 버킷을 하나 생성하면 COS에서 XML 액세스 노드를 버킷에 바로 할당합니다. 액세스 노드의 형식은 대략 `<bucketname>-<APPID>.cos.<region>.myqcloud.com`이며, RESTful API 호출에 적용됩니다. XML 액세스 노드 이용 시 [API 문서](https://cloud.tencent.com/document/product/436/7751)의 실행 방법에 따라 버킷을 설정하거나 객체를 업로드 및 다운로드할 수 있습니다.
- 정적 웹 사이트 노드: 콘솔의 버킷 기본 설정 인터페이스에서 정적 웹 사이트 호스팅 기능을 실행할 수 있으며, 실행한 뒤 액세스 노드 1개가 부여됩니다. 액세스 노드 형식은 대략 ` <bucketname>-<APPID>.cos-website.<region>.myqcloud.com`이며, 정적 웹 사이트는 특정 인덱스 페이지(IndexPage), 오류 페이지(ErrorPage), 리디렉션 등을 지원합니다. 또 정적 웹 사이트 노드로 콘텐츠를 획득할 수 있도록 객체 다운로드 등 작업을 지원합니다.

### 액세스 권한

- 공개 읽기: 버킷을 공개 읽기로 설정하면 누구나 버킷 액세스 도메인으로 액세스할 수 있습니다. 만약 사용자가 버킷 공개 읽기를 원본 서버로 Origin-pull을 실행하면 CDN 가속이 바로 활성화되기 때문에 CDN 인증과 Origin-pull 인증을 건너뛸 수 있습니다.
- 개인 읽기: 버킷을 개인 읽기로 설정하면 사용자가 CDN 서비스 라이선스 관리 등 액세스 정책을 마련하여 액세스 주체를 관리할 수 있습니다. 만약 사용자가 버킷 개인 읽기를 원본 서버로 Origin-pull을 실행하면 Origin-pull 인증은 진행되지만, CDN 인증은 활성화되지 않습니다. 이로 인해 권한이 없는 자가 CDN으로 버킷에 바로 액세스할 수 있으니 버킷 개인 읽기를 설정한 경우, CDN 인증과 Origin-pull 인증을 동시에 실행하여 데이터 보안을 확보하시길 권장합니다.

## CDN 가속으로 COS 액세스

다음의 두 가지 도메인을 관리하여 COS에 가속 액세스할 수 있습니다.

- 기본 가속 도메인: COS는 사용자에게 기본 CDN 가속 도메인을 제공합니다. 형식은 ` <bucketname>-<APPID>.file.mycloud.com`이며, 사용자가 활성화 및 비활성화를 선택할 수 있습니다.
- 사용자 정의 도메인: 사용자는 COS 버킷 지향의 원본 서버를 가진 사용자 정의 도메인을 직접 등록할 수 있으며, 사용자 정의 도메인으로 버킷에 저장된 객체에 가속 액세스할 수 있습니다.

> **주의사항: **
> 기본 가속 도메인과 사용자 정의 도메인을 CDN 가속 도메인으로 통칭합니다.

### 버킷 공개 읽기

버킷을 공개 액세스로 설정하고, CDN을 COS 액세스 노드에 Origin-pull하는 경우, Origin-pull 인증이 없이도 CDN 엣지 노드에서 버킷에 저장된 객체 데이터를 획득 및 캐싱할 수 있습니다.

CDN 콘솔에서 [인증 설정](https://cloud.tencent.com/document/product/228/13677)을 통해 **제한적으로** 버킷 내 데이터를 보호할 수 있습니다. CDN에서 인증 기능의 실행 여부와 관계 없이 버킷 액세스 도메인을 알고 있는 사용자가 버킷 내의 모든 객체에 액세스할 수 있기 때문입니다. CDN 인증 설정에 따라 도메인으로 공개 읽기 버킷에 액세스할 때, 다음 표와 같이 결과가 상이할 수 있습니다.

| CDN 인증 설정 | CDN 가속 도메인 액세스 | COS 도메인 액세스 | 일반 사례                                        |
| ------------ | ---------------- | ------------ | ----------------------------------------------- |
| 비활성화(디폴트) | 액세스 가능           | 액세스 가능       | 버킷 전체에 공개 액세스를 허용하고 CDN 또는 원본 서버로 액세스 가능       |
| 활성화         | URL 인증 사용 필요  | 액세스 가능       | CDN 액세스에 대해 링크 도용 방지를 활성화하지만 원본 서버 액세스를 보호하지 않아 권장하지 않음 |

### 버킷 개인 읽기

버킷을 개인 읽기로 기본 설정한 경우, CDN을 COS 액세스 노드에 Origin-pull하면 CDN 엣지 노드에서 **데이터 획득 및 캐싱 작업을 수행할 수 없습니다**. 따라서 CDN 서비스 자격을 버킷 액세스 정책(Bucket Policy)에 추가해야 합니다. 해당 자격이 승인되면 다음 작업을 실행할 수 있습니다.

- GET Object - 객체 획득
- HEAD Object - 객체 메타데이터 획득
- OPTIONS Object - 객체 사전 요청 실행

CDN 콘솔과 COS 콘솔은 모두 [CDN 서비스 라이선스 추가] 클릭만으로 라이선스를 받는 간편 라이선스 기능을 지원합니다. 라이선스를 추가한 뒤에는 [Origin-pull 인증] 옵션을 실행해야 하는데, 이때 CDN 엣지에서 해당 서비스 자격으로 COS에 저장된 데이터에 액세스합니다.

> **주의사항: **
> 1. 버킷을 개인 읽기로 설정한 경우, 라이선스를 추가한 뒤 Origin-pull 인증을 실행해야 합니다. 그렇지 않을 경우, COS에 대한 액세스가 차단될 수 있습니다.
> 2. CDN 엣지에서 각 루트 계정의 유일한 서비스 계정을 생성합니다. 따라서 계정 라이선스는 가속 도메인에 속한 루트 계정에 한해 유효하며, 타 계정과 바인딩된 가속 도메인은 액세스가 차단될 수 있습니다.

CDN 서비스 라이선스를 추가한 뒤 Origin-pull 인증을 실행하면 CDN 엣지 노드에서 데이터를 바로 획득하고 캐싱합니다. 따라서 개인 데이터를 보호하려면 [인증 설정](https://cloud.tencent.com/document/product/228/13677)을 실행하여 버킷에 저장된 데이터를 보호하시길 권장합니다. CDN 인증 설정에 따라 도메인으로 개인 읽기 버킷에 액세스할 때, 다음 표와 같이 결과가 상이할 수 있습니다.

| CDN 인증 설정 | CDN 가속 도메인 액세스 | COS 도메인 액세스 | 일반 사례                                        |
| ------------ | ---------------- | --------------- | ----------------------------------- |
| 비활성화(디폴트) | 액세스 가능           | COS 인증 사용 필요 | 직접 CDN 도메인에 액세스하여 원본 서버 데이터 보호 가능   |
| 활성화         | URL 인증 사용 필요  | COS 인증 사용 필요 | 전체 링크에서 액세스를 보호하고 CDN 인증으로 링크 도용 방지 지원 |
