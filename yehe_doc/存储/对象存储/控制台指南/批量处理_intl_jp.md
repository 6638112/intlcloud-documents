## 概要

COSバッチ処理機能により、バケット内のオブジェクトに対して大規模なバッチ操作を実行することができます。現在、以下の操作に対して、バッチ処理を行うことができます。

- オブジェクトのコピー
- アーカイブオブジェクトの復元

処理したいオブジェクトをオブジェクトリストファイルに整理することができます。このリストファイルは、リスト機能によって作成されたリストレポートから取得できます（あらかじめ[リスト機能の有効化](https://intl.cloud.tencent.com/document/product/436/30624)を行う必要があります）。また、指定された形式でご自分で作成することも可能です。COSバッチ処理機能により、このオブジェクトリストファイルを元にバッチ処理を行うことができます。COSバッチ処理タスクの詳細情報については、[バッチ処理の概要](https://intl.cloud.tencent.com/document/product/436/32958)をご参照ください。

## 操作手順

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインし、左側ナビゲーションバーの【バッチ処理】をクリックし、バッチ処理タスク管理インターフェースに進みます。
2. 【タスクの作成】をクリックすると、バッチ処理タスクの作成が開始されます。設定項目についての説明は次のとおりです。
 - **タスクリージョン**：タスクが作成されるリージョンを選択します。タスクリージョンは、リストで処理されるオブジェクトのバケットリージョンと同じである必要があります。同じでない場合、タスクは失敗します。
 >?現在、バッチ処理機能は中国大陸のパブリッククラウドリージョンのみサポートしており、他のリージョンでは現時点ではサポートしていません。
 - **リスト形式**：使用するリストオブジェクトのタイプを選択します。以下の2つの形式があります。
<table>
   <tr>
      <th>リスト形式</th>
      <th>フィールド</th>
      <th>設定説明</th>
   </tr>
   <tr>
      <td nowrap="nowrap">COSリストレポート</td>
      <td>-</td>
      <td>リストファイルが、リスト機能によって発行されたリストレポートからのものである場合は、この項目を選択します</td>
   </tr>
   <tr>
      <td rowspan="3">CSV</td>
      <td>Bucket</td>
      <td>バケット名</td>
   </tr>
   <tr>
      <td>Key</td>
      <td>バケット内のオブジェクト名です。CSVファイル形式を使用する場合、オブジェクト名はURLエンコード形式が用いられているため、デコードが完了することで使用できます</td>
   </tr>
   <tr>
      <td>VersionId</td>
      <td>オブジェクトのバージョンIDです。バケット上でバージョン管理を有効にすると、COSはバケットに追加されたオブジェクトにバージョン番号を割り当てます。最新ではないバージョンのオブジェクトを使用したい場合、リストオブジェクトのバージョンIDを含めて選択することができます</td>
   </tr>
</table>
 - **リストバケット**：リストが配置されているバケットを選択します。
 - **リストファイルパス**：リストファイルまたはCSVファイルが配置されているパスを選択します。形式はそれぞれjsonとcsvです。例えば、バケット`examplebucket-1250000000`のルートディレクトリにリストを保存している場合、リストパスは`manifest.json`となります。 
![](https://main.qcloudimg.com/raw/5544edff70879dbee24dc2e3fef0c36e.png)
3. 【次のステップ】をクリックして操作設定ページに進み、タスクタイプを選択します。設定項目についての説明は次のとおりです。
  - **一括データコピー**：
    - ターゲットバケット：リスト内のオブジェクトをコピーした後に保存したいバケットです。
    - プレフィックス操作：コピーしたオブジェクトに対し、プレフィックスの追加、置き換えまたは削除を選択できます。
    - ストレージタイプ：コピーされたオブジェクトに対しストレージタイプを設定します。標準ストレージ、低頻度ストレージ、アーカイブストレージから選択できます。
    - サーバー側の暗号化：コピーされたオブジェクトに対し暗号化するかどうかを選択します。暗号化なしとSSE-COS暗号化から選択できます。
    - アクセス権限：コピーしたオブジェクトに対しアクセス権限を設定します。すべての権限のコピー、すべての権限の置き換え、新しい権限の追加から選択できます。
    - オブジェクトメタデータ：コピーされたオブジェクトに対しメタデータを設定します。すべてのメタデータのコピー、すべてのメタデータの置き換え、新しいメタデータの追加から選択できます。
    - オブジェクトタグ：コピーされたオブジェクトに対しオブジェクトタグを設定します。すべてのタグのコピー、すべてのタグの置き換え、新しいタグの追加から選択できます。
  - **CASのバッチ復元**：
    - リカバリモード：標準モードとバッチモードから選択できます。リカバリモードについては、[アーカイブオブジェクトの復元](https://intl.cloud.tencent.com/document/product/436/30961)をご参照ください。
    - レプリカの有効期間：レプリカが自動的に期限切れになり、削除されるまでの日数を設定します。設定範囲は、最短で1日、最長で365日です。
      ![](https://main.qcloudimg.com/raw/4a51de0288564cb70ac5249523637e3e.png)
4. 【次のステップ】をクリックしてその他の設定ページに進み、以下の関連設定を入力します。
 - **タスク説明（オプション）**：このタスクの説明です。未入力でもかまいません。
 - **タスクの優先度**：より優先度の高いタスクが先に実行されます。0以外の正の整数を入力でき、数字が大きいほど優先度が高いことを意味します。
 - **タスクレポート**：タスクレポートを発行するかどうかを選択できます。
 - **CAMロール**：CAMロールを作成するか、既存のCAMロールを選択して、COSに操作権限を付与することができます。
![](https://main.qcloudimg.com/raw/3a45c1180a241468084fcff59f1018e8.png)
> !バッチ処理では、CAMロールを作成する方法でCOSバッチ処理の権限を付与する必要があります。CAMロールの詳細については、[CAMロールの概要](https://intl.cloud.tencent.com/document/product/598/19420)をご参照ください。
5. 【次のステップ】をクリックして情報チェックページに進み、入力したバッチ処理タスクの設定をチェックしてください。変更が必要な場合は、対応する【変更】または【前へ戻る】をクリックし、最後に誤りがないことを確認したうえで、【作成】をクリックすれば完了です。
![](https://main.qcloudimg.com/raw/2f84d4dafa2586e6ca9aacae5d5b7d47.png)
6. バッチタスクの作成が完了したら、タスクリストから作成したタスクを見つけ、【確定】をクリックすれば完了です。タスクをキャンセルした場合は、右側の【タスクのキャンセル】をクリックします。
![](https://main.qcloudimg.com/raw/94aed43dc8ca6c02d3149fe12ee3883d.png)


