## 소개

파일압축 해제 기능은 Tencent Cloud 객체 스토리지 COS가 [SCF](https://intl.cloud.tencent.com/document/product/583)를 기반으로 사용자에게 제공하는 데이터 처리 솔루션입니다. 사용자가 버킷에 파일 압축 해제 규칙을 추가한 후, 압축 파일을 COS로 업로드할 경우 COS가 미리 설정된 SCF가 자동 트리거하고, 파일을 자동으로 지정한 버킷 및 경로로 압축 해제합니다. 파일 압축 해제 과정은 다음과 같습니다.

![압축 해제 과정](https://main.qcloudimg.com/raw/4899b5c92bb085a0f18a522dfae344ae.jpg)

> !파일 압축 해제는 ZIP 형식 파일만 지원하며, 압축 패키지 중 단일 파일 크기는 5GB를 초과할 수 없습니다.

## 관련 설명

> - 기존에 COS 콘솔에서 버킷에 파일 압축 해제 규칙을 추가한 경우, [SCF](https://console.cloud.tencent.com/scf/list?rid=1&ns=default) 콘솔에서 생성한 파일 압축 해제 함수를 볼 수 있습니다. 이 파일 압축 해제 함수를 삭제하지 **마십시오.** 삭제할 경우 규칙이 적용되지 않을 수 있습니다.
> - SCF를 런칭한 리전은 모두 ZIP 패키지 압축 해제 기능을 지원합니다. 리전에는 광저우, 상하이, 베이징, 청두, 중국홍콩, 싱가포르, 뭄바이, 토론토, 실리콘밸리 등을 포함하며, 지원 리전에 대한 자세한 내용은 [SCF 제품 문서](https://intl.cloud.tencent.com/document/product/583)를 참조하십시오.
- 압축 패키지에서 디렉터리 또는 파일 이름은 UTF-8 또는 GB 2312 인코딩을 사용하십시오. 그렇지 않을 경우 압축 해제 후 파일 이름 또는 디렉터리 이름에 에러 코드가 나타나거나 압축 해제 과정이 중단되는 등의 상황이 발생할 수 있습니다. 오류가 보고될 경우, 생성된 함수 오른쪽의 [로그 조회]를 클릭해 SCF 콘솔로 리디렉션하여 로그 오류 세부 사항을 조회할 수 있습니다.
- CAS 유형 파일은 압축 해제를 지원하지 않습니다. CAS 유형의 압축 패키지를 압축 해제해야 할 경우, 먼저 복구한 후 진행하시고 복구 작업은 [보관된 객체 복구](https://intl.cloud.tencent.com/document/product/436/30961)를 참조하십시오.
- 단일 압축 패키지의 최대 압축 해제 처리 시간은 900초이며, 900초를 초과하고도 완료되지 않은 압축 해제 작업은 실패합니다. COS의 압축 해제 기능 관련 제한 설명은 SCF 서비스에 기반하며, 기타 제한은 [SCF 제한 설명](https://intl.cloud.tencent.com/document/product/583/11637)을 참조하십시오.
- 압축 패키지 안의 단일 파일 크기는 5G를 초과할 수 없으며, 초과할 경우 압축 해제는 실패합니다.
> - CDN 압축 해제 기능은 SCF 서비스에 종속돼 있습니다. SCF 서비스는 사용자에게 [무료 한도](https://intl.cloud.tencent.com/document/product/583/12282)를 제공하며, 무료 한도를 초과한 부분은 [SCF 제품 가격](https://intl.cloud.tencent.com/document/product/583/12281)에 따라 과금합니다. 압축 해제 기능을 사용할 경우, 압축 패키지가 클수록 더 많은 리소스 사용량이 소모되고, 압축 해제 횟수가 많을수록 더 많은 호출 횟수를 소모하게 됩니다.



## 작업 순서

1. [COS 콘솔](https://console.cloud.tencent.com/cos5)에 로그인합니다.
2. 왼쪽 메뉴에서 [버킷 리스트]를 클릭한 후, 파일 압축 해제 규칙 추가가 필요한 버킷을 선택 및 클릭해 버킷 관리 페이지로 이동합니다.
3. 왼쪽 [함수 계산]을 클릭한 후, **zip 파일 압축 해제 함수** 설정 페이지를 찾습니다.
> !SCF를 아직 활성화하지 않았을 경우, [SCF 콘솔](https://console.cloud.tencent.com/scf)로 이동해 SCF 서비스를 활성화하고 알림에 따라 서비스 라이선스를 완료하십시오.
4. [함수 추가]를 클릭하고 팝업 창에서 다음과 같이 정보를 설정합니다.
   - **함수 이름**: 함수 이름은 함수의 유일한 표시 이름으로, 생성 후 수정할 수 없습니다. [SCF](https://console.cloud.tencent.com/scf/list?rid=1&ns=default) 콘솔에서 이 함수를 조회할 수 있습니다.
   - **이벤트 유형**: 이벤트는 SCF 트리거 작업을 의미합니다. 업로드 작업을 예로 들면, 업로드 방식은 `PUT Object` 인터페이스 호출일 수 있고, `POST Object` 인터페이스 호출일 수도 있습니다. 이벤트를 [PUT 방법 생성]으로 선택할 경우, `PUT Object` 인터페이스를 통해 업로드된 압축 패키지만 압축 해제가 트리거될 수 있습니다.
> !파일이 간편 업로드, 멀티파트 업로드, 리전 간 복제 등 다양한 경로를 통해 버킷으로 업로드할 경우, [전체 생성] 이벤트를 선택하길 권장합니다.
 - **트리거 조건**: 압축 패키지를 어느 경로로 업로드했을 때 SCF가 트리거되는지를 나타냅니다. 지정한 접두사를 선택할 경우, 압축 패키지가 지정 접두사 경로로 업로드됐을 때만 SCF가 트리거되며, 전체 버킷을 선택할 경우, 압축 패키지가 버킷의 임의의 위치로 업로드돼 모두 트리거됩니다.
    !설정된 타깃 파일 접두사와 트리거 조건에 포함관계가 있을 경우, 순환 트리거가 발생할 수 있으니 최대한 이런 상황을 피하십시오. 예를 들어, 타깃의 접두사가 `prefix`, 트리거 조건이 `pre`이고 `pref`의 압축 패키지를 업로드할 경우, 순환 압축 해제가 트리거됩니다.
 - **압축 해제 포맷**: 현재 지원 가능한 압축 포맷을 가리키며, 현재는 ZIP 포맷 압축 패키지의 압축 해제만 지원합니다.
 - **타깃 버킷**: 압축 패키지 압축 해제 후, CFS의 버킷을 의미합니다.
 - **타깃 파일 접두사**: 압축 패키지 압축 해제 후, CFS의 구체적인 경로를 설정하지 않으면 기본 값은 버킷의 루트 디렉터리가 됩니다.
 - ** SCF 라이선스**: 압축을 해제하려면 SCF가 귀하의 버킷에서 압축 패키지를 읽고 압축 해제 후의 파일을 지정한 위치로 업로드할 수 있어야 합니다. 따라서 이 라이선스를 추가해야 합니다.
 ![](https://main.qcloudimg.com/raw/33a0d8b1ded5fbc19342bf63f9df4827.png)
5. 설정 추가 후, [확인]을 클릭하면 함수가 추가 완료된 것을 확인할 수 있습니다. [로그 조회]를 클릭하면 압축 해제된 이전 실행 상황을 조회할 수 있습니다. 압축 해제에 오류 보고가 나타났을 때 [로그 조회]를 클릭하면 SCF 콘솔로 빠르게 리디렉션하여 로그 오류 세부 상황을 조회할 수 있습니다. 불필요한 파일 압축 해제 규칙을 삭제해야 할 경우, [삭제]를 클릭해 관련 설정을 삭제할 수 있습니다.
   ![](https://main.qcloudimg.com/raw/cb968ff99051f2eb1e515dd74000c1ee.png)
