## 소개

파일 압축 해제 기능은 Tencent Cloud COS가 [Serverless Cloud Function(SCF)](https://intl.cloud.tencent.com/document/product/583)을 기반으로 사용자에게 제공하는 데이터 처리 솔루션입니다. 버킷에 파일 압축 해제 규칙 추가 후, COS에 압축 파일을 업로드하면 COS에서 자동으로 설정해 놓은 SCF를 트리거하여 파일을 지정한 버킷 및 경로에 압축 해제합니다. 파일 압축 해제 과정은 다음 이미지와 같습니다.

![압축 해제 과정](https://main.qcloudimg.com/raw/4899b5c92bb085a0f18a522dfae344ae.jpg)


## 주의사항

- 파일 압축 해제는 ZIP 포맷 파일의 압축 해제만 지원하며, 압축 패키지의 단일 파일 크기는 5GB를 초과할 수 없습니다. 압축 패키지 안에 있는 단일 파일 크기가 5GB 보다 큰 경우 압축 해제에 실패합니다.
- 이전에 COS 콘솔에서 버킷에 파일 압축 해제 규칙을 추가한 경우, [SCF 콘솔](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)에서 생성한 파일 압축 해제 함수를 확인할 수 있습니다. 해당 파일 압축 해제 함수는 삭제하지 **마십시오.** 삭제할 경우 규칙이 적용되지 않습니다.
- 이미 런칭된 SCF의 리전에서는 ZIP 패키지 압축 해제를 지원합니다. 이에는 광저우, 상하이, 베이징, 청두, 중국홍콩, 싱가포르, 뭄바이, 토론토, 실리콘밸리 등이 포함되어 있으며, 지원하는 리전에 대한 자세한 내용은 [SCF 제품 문서](https://intl.cloud.tencent.com/document/product/583)를 참조하십시오.
- 압축 패키지의 디렉터리 또는 파일 이름은 반드시 UTF-8 또는 GB 2312 인코딩을 사용하십시오. 그렇지 않을 경우 압축 해제 후 파일 이름 또는 디렉터리 이름이 깨지거나 압축 해제 프로세스가 중단되는 등의 상황이 발생할 수 있습니다. 오류가 발생하는 경우 생성한 함수 오른쪽에 있는 [로그 조회]를 클릭하여 SCF 콘솔로 이동해 로그의 오류 상세 정보를 확인할 수 있습니다.
- CAS 유형의 파일은 압축 해제를 지원하지 않습니다. CAS 유형의 압축 패키지를 압축 해제하려면 복구가 선행되어야 합니다. 복구 방법은 [보관된 객체 복구](https://intl.cloud.tencent.com/document/product/436/30961)를 참조하십시오.
- 단일 압축 패키지의 최대 압축 해제 프로세스 시간은 900초이며, 900초를 초과하여도 압축 해제 작업이 완료되지 않을 경우 실패됩니다. COS의 압축 해제 기능 제한에 대한 설명은 SCF 서비스를 기반으로 하며, 기타 제한에 대한 자세한 내용은 [SCF 제한 설명](https://intl.cloud.tencent.com/document/product/583/11637)을 참조하십시오.
- COS의 압축 해제 기능은 SCF 서비스에 종속되며, SCF 서비스는 사용자에게 [무료 한도](https://intl.cloud.tencent.com/document/product/583/12282)를 제공하고, 무료 한도를 초과한 부분에 대해서는 [SCF 제품 가격](https://intl.cloud.tencent.com/document/product/583/12281)에 따라 과금됩니다. 압축 해제 기능 사용 시 압축 패키지가 너무 큰 경우 더 많은 리소스 사용량이 소모되며, 압축 해제 횟수가 많을수록 더 많은 호출 횟수가 소모됩니다.

## 작업 순서

1. [COS 콘솔](https://console.cloud.tencent.com/cos5)에 로그인합니다.
2. 왼쪽 메뉴에서 [버킷 리스트]를 클릭하고 파일 압축 해제 규칙을 추가할 버킷을 선택하여 클릭해 버킷 관리 페이지로 이동합니다.
3. 왼쪽에 있는 [함수 계산]을 클릭하고 **zip 파일 압축 해제 함수** 설정 페이지를 찾습니다.
>! SCF를 활성화하지 않은 경우 [SCF 콘솔](https://console.cloud.tencent.com/scf)로 이동하여 SCF 서비스를 활성화하고 안내에 따라 서비스 라이선스를 완료합니다.
4. [함수 추가]를 클릭하면 창이 팝업되며, 다음 정보를 설정합니다.
![](https://main.qcloudimg.com/raw/33a0d8b1ded5fbc19342bf63f9df4827.png)
   - **함수 이름**: 함수 이름은 함수의 고유한 식별자로, 생성 후에는 수정할 수 없습니다. [SCF 콘솔](https://console.cloud.tencent.com/scf/list?rid=1&ns=default)에서 해당 함수를 확인할 수 있습니다.
   - **이벤트 유형**: 이벤트란 SCF를 트리거하는 메소드입니다. 업로드 메소드를 예로 들면, 업로드 방식으로 `PUT Object` 인터페이스를 호출하거나 `POST Object` 인터페이스를 호출할 수 있으며, 이벤트를 [Put 방식 생성]으로 선택하면 `PUT Object` 인터페이스를 통해 업로드하는 압축 패키지만 압축 해제를 트리거합니다.
 >!파일을 간편 업로드, 멀티파트 업로드, 리전 간 복제 등 다양한 채널을 통해 버킷에 업로드하는 경우 [모두 생성] 이벤트를 선택하십시오.
 - **트리거 조건**: 압축 패키지를 어떤 경로에 업로드할 때 SCF를 트리거하는 것을 의미합니다. 특정 접두사를 선택하는 경우 압축 패키지를 특정 접두사의 경로에 업로드할 때 SCF가 트리거되며, 모든 버킷을 선택하는 경우 버킷의 임의의 위치에 압축 패키지를 업로드할 때 항상 트리거됩니다.
  >! 설정한 타깃 파일 접두사와 트리거 조건에 포함관계가 있는 경우 트리거 순환이 발생할 수 있으므로 최대한 해당 상황이 발생하지 않도록 주의하십시오. 예를 들어 타깃의 접두사가 `prefix`이고, 트리거 조건이 `pre`이면 `pref` 압축 패키지 업로드 시 압축 해제가 순환 트리거됩니다.
 - **압축 해제 포맷**: 현재는 ZIP 포맷의 압축 패키지 해제만 지원합니다.
 - **타깃 버킷**: 압축 패키지 압축 해제 후 파일이 저장되는 버킷입니다.
 - **타깃 파일 접두사**: 압축 패키지 압축 해제 후 파일을 저장하는 자세한 경로로, 설정하지 않는 경우 기본적으로 버킷의 루트 디렉터리에 저장합니다.
 - **SCF 권한 부여**: 압축 파일 해제 시, 사용자의 버킷에서 압축 패키지를 읽어오고 압축 해제 후 파일을 지정한 위치에 업로드하는 SCF 권한이 필요하므로 해당 권한을 추가해야 합니다.
5. 설정 추가 후 [확인]을 클릭하면 함수가 추가된 것을 확인할 수 있습니다.
![](https://main.qcloudimg.com/raw/cb968ff99051f2eb1e515dd74000c1ee.png)
새로 생성한 함수에 다음 작업을 진행할 수 있습니다.
 - [로그 조회]를 클릭하여 압축 해제한 이전의 실행 상황을 확인할 수 있습니다. 압축 해제 시 오류가 발생한 경우 [로그 조회]를 클릭해 빠르게 SCF 콘솔로 이동해 로그의 오류 상세 정보를 확인할 수 있습니다.
 - [편집]을 클릭하여 파일 압축 해제 규칙을 수정할 수 있습니다.
 - [삭제]를 클릭하여 사용하지 않는 파일 압축 해제 규칙을 삭제할 수 있습니다.
