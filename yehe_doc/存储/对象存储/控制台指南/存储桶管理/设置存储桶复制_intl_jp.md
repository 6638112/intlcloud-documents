## 概要

バケットコピー機能を有効にすると、ソースバケットの**インクリメンタルオブジェクト**を別のリージョンのターゲットバケットに自動的かつ非同期的にコピーすることができます。ソースバケット内のオブジェクトに対して管理操作（例えばオブジェクトの追加や削除など）を実行すると、Cloud Object Storage（COS）は、これらの操作をターゲットバケットに自動的にコピーします。お客様は実際の必要性に応じて、バケットコピーの有効または無効を選択することができます。その他の情報については、[バケットコピーの概要](https://intl.cloud.tencent.com/document/product/436/19237)をご参照ください。

##  前提条件

バケットコピー機能を有効にする前に、ソースバケットとターゲットバケットの両方が、[バージョン管理の有効化](https://intl.cloud.tencent.com/document/product/436/19881)機能が有効になっていることを確認してください。

## バケットコピーの有効化

1. [COSコンソール](https://console.cloud.tencent.com/cos5)にログインします。
2. 左側ナビゲーションバーで、【バケットリスト】をクリックします。
3. バケットコピーを設定したいソースバケットをクリックし、バケット詳細ページに進みます。
4. 左側の【障害復旧管理】>【バケットコピー】をクリックし、下から【バケットコピー】の管理項目を見つけて、【ルールの追加】をクリックし、バケットコピールールの設定ステータスに進みます。
![](https://main.qcloudimg.com/raw/910b0ddbe6f3bb0093544b5c21a07ca0.png)
5. バケットコピールールを設定するには、ソースバケットとターゲットバケットの両方のバージョン管理機能が有効になっている必要があります。ソースバケットとターゲットバケットのどちらもバージョン管理機能が有効でない場合、バージョン管理を有効にしてからバケットコピーのルールを設定してください。ルールの設定が完了したら、【OK】をクリックすれば完了です。
![](https://main.qcloudimg.com/raw/2a167db6422d4de507d3851d9965ab37.png)
設定項目の説明は次のとおりです。
- **ソースリージョン**：お客様のソースバケットが属するリージョンです。
- **適用範囲**：コピーしたいソースバケット内のオブジェクトの範囲です。設定されていない場合、バケット内のすべてのオブジェクトがデフォルトでコピーされます。プレフィックスが指定されている場合、特定のプレフィックスを持つコンテンツがコピーされます（例えば、`logs/`プレフィックスを持つファイルの場合、`logs/`を入力します）。
- **リソースパス**：お客様のソースバケットのパスです。
- **ターゲットバケット**：コピーされたオブジェクトを保存するバケットです。その所属リージョンは、ソースバケットのリージョンと同じにすることができます。現在のアカウント以外のバケットを選択することはサポートされていません。
- **ターゲットストレージタイプ**：ターゲットバケットにコピーされたオブジェクトのストレージタイプです。デフォルトでは、ソースバケット内のオブジェクトのタイプに追従します。他のストレージタイプを選択して、ターゲットバケットにコピーされたオブジェクトのタイプを変更することができます。
- **削除マーカーの同期**：バージョン管理が有効な場合、バージョンIDを指定せずにファイルを削除すると、ソースバケットに削除マーカーが追加されます。削除マーカーの同期を選択した場合、バケットコピーはこのタグをターゲットバケットにコピーします。削除マーカーの非同期を選択した場合、ターゲットバケットは削除マーカーを新たに追加しません。どちらの状況でも、ターゲットバケットは対応するファイルを削除せず、ユーザーはバージョンIDを指定してオブジェクトの旧バージョンにアクセスすることができます。バージョン管理と削除タグの詳細情報については、[バージョン管理の概要](https://intl.cloud.tencent.com/document/product/436/19883)のドキュメントをご参照ください。

>!
> - ルールの設定が完了すると、ルールに対して管理操作を実行することができます。ボタンをクリックすると現在のルールを有効または無効にでき、編集ボタンをクリックすると現在のルールを変更することができます。
> - バケットコピールールを最初に設定したときに、適用範囲をバケットのすべての内容をコピーするように設定した場合、新しいルールを追加することはできません。現在のルールを編集するか、現在のルールを削除して再度追加することで変更することができます。
> - バケットコピールールを最初に設定したときに、適用範囲をいずれかの項目のプレフィックスの内容に設定した場合でも、現在のルールを編集することで、バケットのすべての内容に適用範囲を変更できます。
> 

## バケットコピーの無効化

バケットコピー機能を無効化するには、ステータスボタンを無効にする、ルールを削除するという2種類の方法があります。

- **ステータスボタンの無効化による方法**：いずれかのルールのステータスボタンを無効にして、現在のルールを一時的に使用禁止にします。この操作により、現在のバケットコピー機能が一時停止され、コピーされたデータがターゲットバケット、ソースバケットに保持され、ソースバケットの増分データはターゲットバケットにコピーされなくなります。再度使用する場合は、有効化ボタンをクリックします。
- **ルールの削除**：【バケットコピー】の管理項目で追加したルールを削除します。ルールを削除すると、設定したバケットコピールールは無効になり、コピーしたデータはターゲットバケットに保持され、ソースバケットの増分データのバケットコピー操作は行われなくなります。再度使用する場合は、ルールを再度追加する必要があります。
![](https://main.qcloudimg.com/raw/f26250880b0f298531e66a49ccea8dc5.png)

>!
> - 完了していないバケットコピー操作は、バケットコピーが無効になると中止され、続行できなくなります。
> - バケットに対してバケットコピーを再度有効にすると、有効化が完了した後に追加されたオブジェクトに対してのみバケットコピー操作が実行されます。
> 

