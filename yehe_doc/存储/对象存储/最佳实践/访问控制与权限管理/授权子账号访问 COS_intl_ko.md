## 개요

각 기업 간 또는 한 기업에서의 여러 팀 간에는 Tencent Cloud COS 리소스에 대해 팀별 또는 직원별로 서로 다른 액세스 권한을 부여해야 합니다. 사용자는 CAM(액세스 관리, 이하 CAM)을 통해 버킷 또는 객체에 서로 다른 작업 권한을 설정할 수 있어, 각 팀별 또는 직원별로 상호 간에 협업이 가능합니다.

먼저 루트 계정, 서브 계정(사용자), 사용자 그룹 등 몇 가지 핵심 개념을 이해하고 있어야 합니다. CAM과 관련된 용어 및 설정에 대한 자세한 설명은 CAM [용어집](https://intl.cloud.tencent.com/document/product/598/18564)을 참조하십시오.

#### 루트 계정
루트 계정은 개발사라고도 칭합니다. 사용자가 Tencent Cloud 계정 신청 시, 시스템이 Tencent Cloud 서비스에 로그인하는 루트 계정 자격을 생성합니다. 루트 계정은 Tencent Cloud 리소스의 사용 용량 계산 및 과금의 기본 주체입니다.
루트 계정은 기본적으로 계정 하의 모든 리소스에 대해 청구서 정보 확인, 사용자 비밀번호 변경, 사용자 생성, 사용자 및 사용자 그룹 생성, 기타 클라우드 서비스 리소스 액세스 등을 포함한 완전한 액세스 권한을 보유하고 있습니다. 기본 설정 시 리소스는 루트 계정만 액세스할 수 있으며 기타 사용자는 루트 계정에서 권한을 부여해야만 액세스할 수 있습니다.

#### 서브 계정(사용자) 및 사용자 그룹
- 서브 계정은 루트 계정에서 생성하는 실체로, 확실한 자격 ID 및 자격 증명을 가지고 있고 Tencent Cloud 콘솔에 로그인할 수 있는 권한을 가지고 있습니다.
- 서브 계정은 기본적으로 리소스를 보유하고 있지 않으며, 반드시 소속된 루트 계정에서 권한을 부여해야 합니다.
 - 루트 계정별로 여러 개의 서브 계정(사용자)를 생성할 수 있습니다.
 - 서브 계정은 여러 루트 계정에 소속될 수 있으며, 여러 루트 계정과 협업하여 각 루트 계정별 클라우드 리소스를 관리할 수 있습니다. 단, 한 서브 계정에서 동시에 여러 루트 계정 소속으로 로그인할 수 없으며, 한 루트 계정 소속으로만 로그인하여 해당 루트 계정의 클라우드 리소스만 관리할 수 있습니다.
- 서브 계정은 콘솔을 통해 개발사(루트 계정)를 전환할 수 있으며, 한 루트 계정에서 다른 루트 계정으로 전환할 수 있습니다.
 - 서브 계정은 콘솔에 로그인할 때 자동으로 기본 루트 계정으로 전환되며, 기본 루트 계정에서 부여한 액세스 권한을 가집니다.
 - 개발사를 전환하면 서브 계정은 전환된 루트 계정이 부여한 액세스 권한을 가지며, 전환 전의 루트 계정이 부여한 액세스 권한은 즉시 효력이 사라집니다.
- 사용자 그룹은 동일한 직무의 여러 사용자(서브 계정) 집합체입니다. 업무 필요에 따라 서로 다른 사용자 그룹을 생성할 수 있으며, 사용자 그룹에 적합한 정책을 연결하여 각 권한을 할당할 수 있습니다.
 
## 작업 순서
서브 계정에 COS 액세스 권한을 부여하는 순서는 서브 계정 생성, 서브 계정에 권한 부여, 서브 계정으로 COS 리소스에 액세스, 해당 세 단계로 나뉩니다.

### 1단계: 서브 계정 생성
CAM 콘솔에서 서브 계정을 생성하고 액세스 권한을 설정할 수 있습니다. 자세한 작업 방법은 다음과 같습니다.
1. [CAM 콘솔](https://console.cloud.tencent.com/cam)에 로그인합니다.
2. [사용자]>[사용자 리스트]>[사용자 생성]을 선택하여 사용자 생성 페이지로 이동합니다.
3. [사용자 정의 생성]을 클릭하여 필요에 따라 사용자 관련 정보를 입력합니다.
 - **사용자 이름**: 서브 계정 이름을 입력합니다. 예: Sub_user
 - **이메일**: 서브 계정에 이메일을 추가하여 Tencent Cloud에서 발송하는 바인딩 이메일을 획득해야 합니다.
 - **액세스 방식**: 프로그래밍 액세스 및 Tencent Cloud 콘솔 액세스를 선택합니다.
 ![](https://main.qcloudimg.com/raw/3ca3b1272dc2635e4f275bcd75e83b40.png)
4. 사용자 정보를 모두 작성한 후, [다음 단계]를 클릭하여 자격을 인증합니다.
![](https://main.qcloudimg.com/raw/fa64f48b412a2c9af1ed12c2e961246d.png)
5. 자격 인증 완료 후 서브 계정 권한을 설정합니다. 시스템에서 제공하는 정책에 따라 선택하면 COS의 버킷 리스트 액세스 권한 및 읽기 전용 권한 등의 정책을 간편하게 설정할 수 있습니다. 더 복잡한 정책을 설정할 경우, [2단계: 서브 계정에 권한 부여](#.E6.AD.A5.E9.AA.A42.EF.BC.9A.E5.AF.B9.E5.AD.90.E8.B4.A6.E5.8F.B7.E6.8E.88.E4.BA.88.E6.9D.83.E9.99.90)를 진행합니다.
6. 입력한 사용자 정보가 정확한지 확인하고 [완료]를 클릭하면 서브 계정이 생성됩니다.


<span id="서브 계정에 권한 부여"></span>
### 2단계: 서브 계정에 권한 부여
CAM을 통해 서브 계정에 권한을 부여할 수 있으며, 서브 계정(사용자) 또는 사용자 그룹에 정책을 설정할 수 있습니다.
1. [CAM 콘솔](https://console.cloud.tencent.com/cam)에 로그인합니다.
2. [정책]>[사용자 정의 정책 생성]>[정책 구문에 따른 생성]을 선택하여 정책 생성 페이지로 이동합니다.
3. **빈 템플릿**과 COS와 연결되는 **사전 설정 정책 템플릿**이 선택할 수 있도록 제공되며, 서브 계정에 부여할 정책 템플릿을 선택하고 [다음 단계]를 클릭합니다.
![](https://main.qcloudimg.com/raw/e1d43ba1ae7e2ae8bb22416c8c4b8127.png)
4. 기억하기 쉬운 정책 이름을 입력합니다. **빈 템플릿**을 선택한 경우 정책 구문을 입력해야 하며, 자세한 사항은 [정책 예시](#정책 예시)를 참조하십시오. 정책 내용을 [정책 내용 편집] 입력창에 복사할 수 있으며, [정책 생성]을 클릭합니다.
![](https://main.qcloudimg.com/raw/b3bccfa38400718a5f57c94d0654cc9e.png)
5. 생성 완료 후, 방금 생성한 정책을 서브 계정에 연결합니다.
![](https://main.qcloudimg.com/raw/1495c8b19dfff2aad622b794d8f5bc6a.png)
6. 서브 계정을 선택하여 권한 부여를 확인하면, 서브 계정에서 권한 범위에 따라 COS 리소스에 액세스할 수 있습니다.
![](https://main.qcloudimg.com/raw/3667de5320e99321a78c5d1c22a49157.png)

### 3단계: 서브 계정으로 COS 리소스에 액세스
COS 액세스(API 또는 SDK) 시에는 APPID, SecretId, SecretKey 리소스가 필요합니다.
서브 계정을 사용하여 COS 리소스에 액세스할 때에는 루트 계정의 APPID, 서브 계정의 SecretId와 SecretKey가 필요하며, CAM 콘솔에서 서브 계정의 SecretId와 SecretKey를 생성할 수 있습니다.

1. 루트 계정으로 [CAM 콘솔](https://console.cloud.tencent.com/cam/capi)에 로그인합니다.
2. [사용자 리스트]를 선택하여 사용자 리스트 페이지로 이동합니다.
3. 서브 계정의 사용자 이름을 클릭하여 서브 계정 정보 상세 페이지로 이동합니다.
4. [API 키] 탭을 클릭하고 [키 생성]을 클릭하여 서브 계정에 SecretId와 SecretKey를 생성합니다.


이제 서브 계정의 SecretId와 SecretKey, 루트 계정의 APPID를 사용해 COS 리소스에 액세스할 수 있습니다. 

>!
>- 서브 계정은 XML API 또는 XML API 기반의 SDK를 통해 COS 리소스에 액세스할 수 있습니다.
>- 서브 계정으로 COS 리소스에 액세스할 때에는 루트 계정의 APPID, 서브 계정의 SecretId와 SecretKey를 사용해야 합니다.

#### XML 기반의 Java SDK를 이용한 액세스 예시
XML 기반의 Java SDK 명령 라인 예시이며, 다음과 같이 매개변수를 입력해야 합니다.
```
// 1 자격 정보 초기화
COSCredentials cred = new BasicCOSCredentials("<루트 계정 APPID>", "<서브 계정 SecretId>", "<서브 계정 SecretKey>");
```

인스턴스는 다음과 같습니다.
```
// 1 자격 정보 초기화
COSCredentials cred = new BasicCOSCredentials("1250000000", "AKIDasdfmRxHPa9oLhJp", "e8Sdeasdfas2238Vi");
```

#### COSCMD TCCLI를 이용한 액세스 예시
以 COSCMD `config` 명령 라인 예시이며, 다음과 같이 매개변수를 입력해야 합니다.
```sh
coscmd config -u <루트 계정 APPID> -a <서브 계정 SecretId> -s <서브 계정 SecretKey> -b <루트 계정 bucketname> -r <루트 계정 bucket의 소속 리전>
```
인스턴스는 다음과 같습니다.
```sh
coscmd config -u 1250000000 -a AKIDasdfmRxHPa9oLhJp -s e8Sdeasdfas2238Vi -b examplebucket -r ap-beijing
```


<span id="정책 예시"></span>
## 정책 예시
다음은 몇 가지 전형적인 정책 시나리오 예시입니다. 사용자 정의 정책 설정 시, 아래 참고 정책을 [정책 내용 편집] 입력창에 복사하여 실제 상황에 따라 수정하여 사용할 수 있습니다. 더 많은 COS의 주요 시나리오에서의 정책 구문은 [CAM 제품 문서](https://intl.cloud.tencent.com/document/product/598/11083)의 **비즈니스 사례** 부분을 참조하십시오.

### 서브 계정에 읽기 및 쓰기 권한 설정
서브 계정에 읽기 및 쓰기 권한을 부여하는 자세한 정책 설정 구문은 다음과 같습니다.
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "name/cos:*"
            ],
            "resource": "*",
            "effect": "allow"
        },
        {
            "effect": "allow",
            "action": "monitor:*",
            "resource": "*"
        }
    ]
}
```
### 서브 계정에 읽기 전용 권한 설정
서브 계정에 읽기 전용 권한을 부여하는 자세한 정책 설정 구문은 다음과 같습니다.
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
                "name/cos:List*",
                "name/cos:Get*",
                "name/cos:Head*",
                "name/cos:OptionsObject"
            ],
            "resource": "*",
            "effect": "allow"
        },
        {
            "effect": "allow",
            "action": "monitor:*",
            "resource": "*"
        }
    ]
}
```

### 서브 계정에 특정 IP 대역의 읽기 및 쓰기 권한 설정
아래는 IP 대역이 `192.168.1.0/24` 및 `192.168.2.0/24`인 주소에 읽기 전용 권한을 부여하는 예시입니다.
효력 발생 조건 작성에 대한 더 자세한 정보는 [효력 발생 조건](https://intl.cloud.tencent.com/document/product/598/10608)을 참조하십시오.
```
{
    "version": "2.0",
    "statement": [
        {
            "action": [
    "cos:*"
            ],
            "resource": "*",
            "effect": "allow",
            "condition": {
                "ip_equal": {
                    "qcs:ip": ["192.168.1.0/24", "192.168.2.0/24"]
                }
            }
        }
    ]
}
```
