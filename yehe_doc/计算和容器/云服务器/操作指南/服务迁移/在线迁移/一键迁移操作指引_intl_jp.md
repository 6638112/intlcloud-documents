## ユースケース
ワンクリック移行はサービス移行 - [オンライン移行](https://intl.cloud.tencent.com/document/product/213/35639) を簡潔化したソリューションであり、移行元サーバーへのログインやツールのダウンロードなど繁雑な操作が不要になり、ワンクリックで移行元サーバーリストを表示し、Tencent Cloudへ一括移行することができます。本書では、ワンクリック移行を使用し、クラウドサーバーをTencent Cloud CVMに移行する方法を説明します。

ワンクリック移行はLinux OSとWindows OS両方をサポートします。また、Tencent Cloud CVMコンソールの[オンライン移行](https://console.cloud.tencent.com/cvm/csm/online?rid=1)ページで移行の進捗を確認することもできます。


## 使用制限
 1. 移行元サーバーの環境に対して、ワンクリック移行は次のように要求しています。クラウドアシスタント（Alibaba Cloud ECSクラウドアシスタントなど）がインストールされていること、パブリックネットワークIPが設定されていること、VPCネットワークが使用されていること（クラシックネットワークをサポートしない）。
 2. 現在、ワンクリックはAlibaba CloudのクラウドサーバーをTencent Cloudに移行できるが、他のプラットフォームをサポートしていません。
 3. ワンクリック移行機能は継続的に最適化されているため、現在では、一部の運用シーンで使用できます。要件を満たしていない場合、[オンライン移行](https://intl.cloud.tencent.com/document/product/213/44338)をご使用ください。
>!この機能はカナリアリリースされています。ご利用をご希望される場合は、[チケットを提出](https://console.intl.cloud.tencent.com/workorder/category)してください。



## 準備事項
[](id:TencentAccessKey)
#### Tencent Cloudコンソールからアクセスキーを取得します
Tencent CloudのCAMコンソールの[APIキー管理](https://console.cloud.tencent.com/cam/capi)ページで、**SecretIdとSecretKey**を作成して取得します。詳細な操作手順については、[アクセスキー](https://intl.cloud.tencent.com/document/product/598/34228)ドキュメントをご参照ください。
>?サブアカウントを使用してコンソールによる移行を行う場合、ルートアカウントで[CAMコンソール](https://console.cloud.tencent.com/cam/policy)にログインし、サブアカウントにQcloudCSMFullAccessとQcloudCVMFullAccess権限を付与する必要があります。

[](id:AliAccessKey)
#### 移行元のプラットフォームからアクセスキーを取得します
Alibaba CloudのAccessKeyIDとAccessKeySecretを取得する手順は以下の通りです：

1. Alibaba Cloud RAMコンソールにログインして、**身元管理** > [**ユーザー**](https://ram.console.aliyun.com/users) ページに入ります。
2. **ユーザを作成**をクリックし、アクセス方法は**Open API呼出し（他のアクセス方法を選択しても有効にならない）**を選択して、作成を確認した後、AccessKeyID とAccessKeySecretの情報を保存します。詳細な操作手順については、[RAMユーザの作成](https://help.aliyun.com/document_detail/93720.html)をご参照ください。
3. ユーザリストから作成したユーザに**権限を追加**します。具体的には、ECSの管理権限（AliyunECSFullAccess）とECSクラウドアシスタントの管理権限（AliyunECSAssistantFullAccess）を追加します。詳細な操作手順については、[RAMユーザへの権限追加](https://help.aliyun.com/document_detail/116146.html)をご参照ください。

#### 移行元のアプリケーションの一時停止（オプション）
移行中に既存のアプリケーションへの影響を回避するために、移行元でアプリケーションを一時停止することをお勧めします。

#### 移行元と移行先のデータのバックアップ（オプション）
移行前に、以下の方法でデータをバックアップすることをお勧めします：
- 移行元サーバー：移行元サーバーのスナップショット機能などの方法を選択してデータをバックアップできます。
- 移行先CVM： [スナップショットの作成](https://intl.cloud.tencent.com/document/product/362/5755) などの方法を選択して、移行先CVMのデータをバックアップできます。



## 移行手順

### ワンクリック移行ページに入ります

1. CVMコンソールにログインし、**サービス移行** > [**オンライン移行**](https://console.cloud.tencent.com/cvm/csm/online) ページに入ります。
2. **ワンクリック移行**をクリックし、[ワンクリック移行タスクの新規作成](https://console.cloud.tencent.com/cvm/csm/online/oneClickMigration?rid=1)ページに入ります。  


### ワンクリック移行タスクの新規作成
1. タスクを設定します
タスク名とタスク詳細を入力します。

2. 移行元を設定します
移行元のサービスのプロバイダーはデフォルトではAlibaba Cloud ECSを選択します。*移行元サーバーへのアクセス権限を持っている**ことを確認するために、下図に示すように、Alibaba CloudアカウントのAccessKeyとSecretKey（[取得方法](#AliAccessKey)）を入力して検証する必要があります。
>!キーは大切に保管してください。移行完了後に、キーを削除/無効化することをお勧めします。
>

3. 移行先を設定します
移行元のサービスのプロバイダーはデフォルトではTencent Cloud CVMを選択します。**Tencent Cloud CVMの権限を取得**するために、Tencent Cloud APIのキーのSecretIdとSecretKey（[取得方法](#TencentAccessKey)）を入力する必要があります。[APIキーの管理](https://console.cloud.tencent.com/cam/capi)からキーの情報をそのままコピーできます。APIのキーが正しくなければ、移行に失敗しますので、APIのキーが正しいかを確認してください。    
>!キーは大切に保管してください。移行完了後に、キーを削除/無効化することをお勧めします。
>

4. 移行情報を設定します
（1）移行元情報の検証に成功した後、「**移行元を追加**」をクリックし、ポップアップしたウィンドウで移行するインスタンスを選択します。
（2）ポップアップしたウィンドウの左上側で**リージョン**を選択すると、選択したリージョン配下の**インスタンスリスト**が表示されます。
（3）移行するインスタンスを選択すると、選択したインスタンスが右側の「選択対象」リストに追加されます。
 >?
 >- **マルチインスタンス、マルチリージョン**の一括移行がサポートされます。移行元を複数回追加することができます。
 >- 現在、一括移行はインスタンスを5台まで移行できます。

  （4）**OK**をクリックすると、移行元情報リストに移行待ちのインスタンス情報が表示されます。操作列で**移行先を追加**をクリックし、移行先を設定できます。
  （5）「**移行先の追加**」ウィンドウで、リージョンと移行先のタイプを設定します。

 <table>
<thead>
<tr>
<th>設定オプション</th>
<th>入力項目かどうか</th>
<th>説明</th>
</tr>
</thead>
<tbody><tr>
<td>移行先リージョン</td>
<td>はい</td>
<td>移行先のTencent Cloudリージョンです。リージョンについては、<a href="https://intl.cloud.tencent.com/document/product/213/6091">リージョンとアベイラビリティーゾーン</a>をご参照ください。</td>
</tr>
<tr>
<td>移行先タイプ</td>
<td>はい</td>
<td>移行先のCVMタイプを設定します。<ul><li><strong>CVMイメージ</strong>：移行タスクの実行が完了した後、移行元に対して、移行先のTencent Cloud CVMイメージを作成します。<br>イメージ名：移行元に対して生成する移行先となるTencent Cloud CVMイメージの名前です。イメージ名が移行先のリージョンにすでに存在している場合、移行タスクはタスクIDを自動的にイメージ名に追加します。</li><li><strong>CVMインスタンス</strong>：移行先のリージョンにあるCVMインスタンスを移行先サーバーとして選択します。<br>移行先インスタンス：移行先となるCVMのOSは、移行元サーバーと同じOSタイプを使用することをお勧めします。例えば、OSがCentOS 7の移行元サーバーを移行する時、OSがCentOS 7のCVMを移行先サーバーとして選択します。また、移行先サーバーのシステムディスクの容量とデータディスクの容量両方を移行元サーバーより大きくする必要があります。</li></ul></td>
</tr>
</tbody></table>

5. **新規作成**をクリックし移行タスクを起動すると、**ヒント**が表示されます。以下に注意してください。
	- 移行元でタスクの実行が時間かかりますので、しばらく経ってからコンソールで進捗を確認できます。
	- 移行元の環境に問題があるか情報が正しくないため、移行元をインポートできない場合、Tencent Cloudコンソールに失敗の原因を表示しない可能性があります。この場合、タスクを再作成するか、[オンライン移行](https://intl.cloud.tencent.com/document/product/213/44338)をご利用ください。


### 移行状態と進捗を確認します
タスクの新規作成を確認すると、移行タスクは自動的に実行します。[移行元ページ](https://console.cloud.tencent.com/cvm/csm/online?rid=1)で移行元の情報を確認できます。また、[移行タスクページ](https://console.cloud.tencent.com/cvm/csm/online?rid=1&tab=tasks)でタスクの進捗を確認できます。

- 移行先がCVMインスタンスの場合、移行開始後に、移行先CVMが移行モードになりますので、移行が完了して移行モードが終了するまで、移行先CVMに対して、OSの再インストール、シャットダウン、廃棄、パスワードのリセットなどを行わないでください。
- 移行先がCVMイメージの場合、移行開始後に、ご利用のアカウントの配下に名前が`do_not_delete_csm_instance`の中継インスタンスが作成されます。移行が完了するまで、中継インスタンスに対して、OSの再インストール、シャットダウン、廃棄、パスワードのリセットなどを行わないでください。移行が完了すると、今回作成された中継インスタンスを自動的に廃棄します。



### 移行タスクの実行が完了するまで待ちます
移行タスクの状態が「成功」になると、移行完了となります。
<dx-alert infotype="explain" title="">

- データ転送にかかる時間が移行元のデータサイズ、ネットワーク帯域幅などによります。移行が完了するまでお待ちください。
- 移行タスク開始後に、移行タスクのある行で**一時停止**をクリックすれば、移行タスクを停止できます。
- 移行ツールはデータ転送の再開をサポートします。タスクを一時停止した後、**開始/リトライ**をクリックすると、前回一時停止したところから移行を再開できます。
- 移行タスクはデータ転送の段階でのみ一時停止できます。コンソールの移行タスクで**一時停止**をクリックすると、移行ツールはデータ転送の段階でデータの転送を一時停止します。
- 移行に時間がかかり移行を中止せざるを得ない場合、移行タスクを一時停止してから**削除**をクリックして、今回の移行タスクをキャンセルできます。
</dx-alert>
  

[](id:checkAfter)
### 移行後の確認
- **移行失敗の場合**
ログファイル（デフォルトでは移行ツールディレクトリ配下のログファイル）に出力されたエラーメッセージ、ガイドラインドキュメントまたは[サービス移行に関するよくある質問](https://intl.cloud.tencent.com/document/product/213/32395)を確認し、トラブルシューティングと問題修正を行ってください。修正後、移行タスクの操作列で**開始/リトライ**をクリックすれば、移行タスクを再開できます。
- **移行成功の場合**
 - 移行先がCVMインスタンスの場合、移行先CVMインスタンスが正常に起動できるか、移行先CVMインスタンスのデータが移行元サーバーと一致しているか、ネットワークや他のシステムサービスに問題がないかを確認してください。
 - 移行先がCVMイメージの場合、移行タスクのある行の「CVMイメージID」をクリックし、[CVMイメージページ](https://console.cloud.tencent.com/cvm/image/index)に入ってイメージの情報を確認してください。そのイメージを使用してCVMを作成することができます。

ご不明な点や移行問題についてご質問がありましたら、[サービス移行に関するよくある質問](https://intl.cloud.tencent.com/document/product/213/32395)を参照するか[お問い合わせ](https://intl.cloud.tencent.com/document/product/213/34837)から連絡してください。      

