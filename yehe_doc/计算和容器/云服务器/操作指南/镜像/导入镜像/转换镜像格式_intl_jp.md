## 概要
現在、Tencent Cloud Virtual Machineがインポートをサポートするイメージファイルの形式は、RAW、VHD、QCOW2、VMDKです。その他の形式のイメージファイルはインポートする前に変換する必要があります。ここではqemu-imgツールを介してその他の形式のイメージファイルをVHDまたはRAW形式に変換する方法について説明します。

## 操作手順
実際に使用するオペレーティングシステムに応じて、対応する操作手順を選択します。
<dx-tabs>
::: Windowsオペレーティングシステム[](id:windows)
<dx-alert infotype="explain" title="">
ここではWindows10オペレーティングシステムを例として、イメージ形式を変換する方法を示します。オペレーティングシステムのバージョンによって方法が異なりますので、実際の状況に応じてドキュメントを参考に操作してください。
</dx-alert>


#### qemu-imgのインストール
[qemu-imgダウンロードアドレス](https://qemu.weilnetz.de/w64/?spm=a2c4g.11186623.0.0.52164204ykdbP9)に移動してダウンロードし、インストールを完了します。ここでは`C:\Program Files\qemu`にインストールする方法を例示します。


#### 環境変数の設定
1. **開始**を右クリックし、ポップアップしたメニューで**システム**を選択します。
2. ポップアップしたウィンドウで、**高度なシステム設定**を選択します。
3. ポップアップした「システム属性」ウィンドウで、**アドバンス**タブを選択して、**環境変数**をクリックします。
4. 下図に示すように、「環境変数」ウィンドウで、「システム変数」の`Path`を選択して、**編集**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/d23a111449b96d2f97615bcc5431b9f4.png)
5. ポップアップした「環境変数の編集」ウィンドウで、新規作成をクリックし、qemu-imgのインストールパス`C:\Program Files\qemu`を入力した後、**OK**をクリックします。
6. 「環境変数」ウィンドウで、さらに**OK**をクリックします。

#### 環境変数設定の検証
1. **Win + R**を押して実行ウィンドウを開きます。
2. 「実行」ウィンドウで、**cmd**と入力してコマンドラインを開きます。
3. 次のコマンドを実行し、返された結果に基づき環境変数の設定が成功したかどうかを判断します。
```
qemu-img --help
```

#### イメージ形式の変換
1. コマンドラインで、次のコマンドを実行し、イメージファイルが配置されているディレクトリに切り替えます。
```
cd <ソースイメージファイルが配置されているディレクトリ>
```
2. 次のコマンドを実行し、イメージ形式を変換します。
```
qemu-img convert -f <ソースイメージファイル形式> -O <ターゲットイメージ形式> <ソースイメージファイル名> <ターゲットイメージファイル名>
```
パラメータの説明は次のとおりです。
 - `-f`：パラメータ値はソースイメージファイルの形式です。 
 - `-O`（大文字にする必要があります）：パラメータ値はターゲットイメージ形式、ソースイメージファイル名とターゲットファイル名です。
例えば、次のコマンドを実行し、`test.qcow2` イメージファイルを`test.raw`に変換します。
```
qemu-img convert -f qcow2 -O raw test.qcow2 test.raw
```
変換後、ターゲットファイルがソースイメージファイルの配置されているディレクトリ内に作成されます。

:::
::: Linuxオペレーティングシステム[](id:linux)
<dx-alert infotype="explain" title="">
ここではUbuntu20.04およびCentOS7.8 オペレーティングシステムを例として、イメージ形式の変換を実行する方法を示します。オペレーティングシステムのバージョンによって方法が異なりますので、実際の状況に応じてドキュメントを参考に操作してください。
</dx-alert>

#### qemu-imgのインストール
1. 次のコマンドを実行し、qemu-imgをインストールします。
 - Ubuntu: 
 ```
 apt-get update #パッケージリストの更新
 ```
 ```
 apt-get install qemu-utils #qemu-imgツールのインストール
 ```
 - CentOS: 
 ```
 yum install qemu-img
 ```
2. 次のコマンドを実行し、イメージ形式を変換します。
```
qemu-img convert -f qcow2 -O raw test.qcow2 test.raw
```
パラメータの説明は次のとおりです。
 - `-f`：パラメータ値はソースイメージファイルの形式です。 
 - `-O`（大文字にする必要があります）：パラメータ値はターゲットイメージ形式、ソースイメージファイル名とターゲットファイル名です。
変換後、ターゲットファイルがソースイメージファイルの配置されているディレクトリ内に作成されます。
:::
</dx-tabs>

## 関連ドキュメント
- [イメージのインポートの概要](https://intl.cloud.tencent.com/document/product/213/4945)
- [Windowsイメージの作成](https://intl.cloud.tencent.com/document/product/213/17815)
- [Linuxイメージの作成](https://intl.cloud.tencent.com/document/product/213/17814)



