## オフラインマイグレーション

### COSのアップロードとマイグレーションに時間がかかるのはなぜですか。
アップロードにかかる時間はイメージファイルのサイズと帯域幅に関連しています。転送とマイグレーションの時間を短縮するために、 圧縮イメージフォーマット（qcow2またはvhd）を使用することをお勧めします。

### マイグレーションタスクが失敗したのはなぜですか。
 - 現在、Tencent Cloudサービスマイグレーションでサポートされているイメージ形式はqcow2、vhd、vmdk、rawです。イメージ形式が上記のいずれかを満たしていることを確認してください。
 - イメージファイルがCOSに完全にアップロードされていることを確認し、ファイルが破損していないことを確認してください。
 - ターゲットCVM /クラウドディスクが通常使用されていることを確認してください。 期限切れのデバイスはマイグレーションできません。

### マイグレーションタスクで表示されたエラー原因はどのようにトラブルシューティングすればよいですか。 
 - 「ミラーファイルの検証に失敗しました」というメッセージが表示された場合は、通常、現在のマイグレーションタスクのターゲットシステムディスクまたはデータディスクにソースディスクほどのストレージスペースがなく、ターゲットシステムディスクまたはデータディスクにミラーファイルほどのストレージスペースがないことなどが原因です。この場合、ターゲットシステムディスクまたはデータディスクのサイズを変更して、再試行してください。
 - 「イメージファイルのメタデータの取得に失敗しました」というメッセージが表示された場合は、通常、イメージファイルが破損しているか、イメージファイル形式がサポートされていないことなどが原因です。イメージの作成/エクスポート、アップロードなどの段階でエラーが発生していないか確認してください。またはqcow2、vhd、vmdk、raw形式のイメージファイルを提供して、再試行してください。
 - 「タスクタイムアウト」、「システムエラー」、「その他の原因」などが表示されたり、再試行してもマイグレーションタスクが失敗したりする場合は、[お問い合わせ](https://intl.cloud.tencent.com/document/product/213/34837)から解決することができます。


## オンラインマイグレーションに関するよくあるご質問

### オンラインマイグレーションサはどのようなオペレーティングシステムやディスクタイプをサポートしていますか。
- Linuxの主流のオペレーティングシステム（CentosやUbuntuなど）はすべてサポートされています。
- マイグレーションはディスクの種類や容量とは関係ありません。


### オンラインマイグレーションとミラーイメージのインポートの違いは何ですか。
オンラインマイグレーションは、ミラーイメージのインポートと似ています。これにより、ソースシステムのTencent Cloudへのマイグレーションを実現できます。最も大きな違いとしては、オンラインマイグレーションではクラウドにアップロードするために手動でミラーイメージを作成したり、ミラーイメージをエクスポート/インポートしたりする必要がなく、ソースマシンにおいてシステムとデータを直接転送するだけでクラウドにアップロードできる点です。


### オンラインマイグレーションはソースパブリックIPをマイグレーションしますか。
マイグレーションしません。オンラインマイグレーションでは、ソースシステムとデータのみが同期され、パブリックIPはマイグレーションできません。


### マイグレーションツールは中断からの再開をサポートしていますか。
サポートしています。データ送信フェーズが中断された後、ツールを再度実行することで送信を再開できます。


### マイグレーションが完了した後もツールを保持する必要がありますか。
ツールを保持する必要はありません。マイグレーションが完了したら、ソースサーバー上のツールを直接削除できます。


### マイグレーションの速度と料金はどのくらいかかりますか。
- 速度：主にターゲットスレーブ帯域幅に依存します。測定では1コア1Gメモリを備えた従量課金帯域幅12Mbpsのスレーブを使用し、実際のマイグレーション速率はおよそ9Mbpsです。具体的なコンピューティング方法については、[マイグレーション時間予測チュートリアル](https://intl.cloud.tencent.com/document/product/213/44342)をご参照ください。
- 費用：マイグレーションツール自身は無償です。マイグレーション中、帯域幅などのリソースのためにわずかな料金が発生します。発生した料金は、トラフィックや時間の長さによる課金ルールに基づいて計算できます。詳細については、公式サイトの価格をご参照ください。


### 複数のCVMの同時マイグレーションはサポートしますか。
はい。複数のCVMの同時マイグレーションがサポートされています。異なるターゲットCVMにマイグレーションするため、互いに干渉しません。


### Virtioの検査とインストール方法
Virtioの検査とインストールの詳細な操作については、[LinuxでのVirtioドライバーの確認](https://intl.cloud.tencent.com/document/product/213/9929)をご参照ください。


### Rsyncのインストール方法[](id:installRsync)
ソースサーバーのオペレーティングシステムに応じて、対応するコマンドを選択して、Rsyncをインストールできます。
- CentOS: `yum -y install rsync`
- Ubuntu,Debian: `apt-get -y install rsync`
- SUSE: `zypper install rsync`
 その他のLinuxリリース版については、対応するリリース版の公式インストールドキュメントをご参照ください。


### SELinuxのシャットダウン方法[](id:closeSELinux)
`/etc/selinux/config` ファイルをコンパイルし、`SELINUX=disabled`を設定します。


## コンソールオンラインマイグレーションに関するご質問

### ツールはどこからダウンロードしますか。
[ここをクリックしてダウンロード](https://go2tencentcloud-1251783334.cos.ap-guangzhou.myqcloud.com/latest/go2tencentcloud.zip)で、コンソールオンラインマイグレーションツール圧縮パッケージをダウンロードします。また、[コンソールオンラインマイグレーションツールユーザーガイド](https://intl.cloud.tencent.com/document/product/213/44338)を参照して操作を行います。


### 移行元のインポート方法
1. [コンソールオンラインマイグレーションツール](https://go2tencentcloud-1251783334.cos.ap-guangzhou.myqcloud.com/latest/go2tencentcloud.zip)をダウンロードして解凍します。
2. 移行元サーバーが対応するアーキテクチャの実行可能ファイルを実行すれば、移行元をオンラインマイグレーションコンソールにインポートできます。
 - 32ビット移行元サーバーでは`go2tencentcloud_x32`を実行します
 - 64ビット移行元サーバーでは`go2tencentcloud_x64`を実行します


### 移行元の更新方法、または移行元の再インポート方法
移行元ディスクなどの情報に変更が生じた場合は、移行元の情報を更新するか、または移行元を再インポートする必要があります。まず移行元を削除してから、クライアントを実行して移行元を再インポートしてください。


### 移行元の削除方法
[オンラインマイグレーションコンソール](https://console.cloud.tencent.com/cvm/csm/online?rid=1)にログインし、移行元がある行の右側の**削除**をクリックした後、確認を実行すると削除できます。移行元に未完了の移行タスクがバインドされている場合は、移行タスクを中止し削除してから、移行元を削除してください。


### マイグレーション前に移行先のCVMインスタンスを選択する方法
移行先のCVMのOSはできる限り移行元サーバーのOSタイプと同じにすることをお勧めします。例えば、CentOS7システムの移行元サーバーのマイグレーションの場合は、CentOS7システムのCVMを移行先として選択してください。


### 移行タスクがどのようなステータスの時に完了を意味しますか
移行タスクのステータスが「成功」の場合のみ完了を意味し、その他のステータスはすべて未完了を意味します。


### 移行タスクの削除方法
対応する移行タスクの実際のステータスに応じて次の操作を実行してください。
- 移行タスクが「未開始」または「成功」の場合、移行タスクがある行の右側の**削除**を直接クリックして、移行タスクを直接削除できます。
- 移行タスクが「失敗」のときに、移行タスクを削除したい場合は、移行元をオンラインに維持したまま、移行タスクがある行の右側の**削除**をクリックして移行タスクを削除する必要があります。このとき、タスクは「削除中」となり、マイグレーションツールは移行タスクによって生成されたリソースを自動的にクリアし、移行タスクを削除します。


### マイグレーションに時間が掛かりすぎ、マイグレーションをキャンセルしたい場合はどうすればよいですか。
この場合は、[オンラインマイグレーションコンソール](https://console.cloud.tencent.com/cvm/csm/online?rid=1)にログインして、移行タスクを中止し、移行タスクがある行の右側の**削除**をクリックして移行タスクを削除すれば、そのマイグレーションをキャンセルできます。


### 中継インスタンスが破棄された場合はどうすればよいですか。
移行先のTencent Cloudイメージにマイグレーションするときに、作成された中継インスタンスが誤って破棄された場合は、現在の移行タスクを削除し、移行元にもう一度移行タスクを新規作成して開始することができます。


### コンソールを使用したマイグレーションがエラーまたは失敗した場合はどうすればよいですか。
マイグレーションエラーまたは失敗の原因は多岐にわたりますが、通常、次のいくつかの原因に集約されます。


- 移行先CVMにマイグレーションしたときに、移行先CVMのセキュリティグループが80、443ポートを開放していなかった。
**解決方法**：移行先CVMのセキュリティグループルールを変更し、80、443ポートを開放します。
- 移行先CVMにマイグレーションしたときに、移行先CVMのディスク容量が不足していた。
**解決方法**：サーバーに充分な容量のディスクをマウントし、充分な容量のCVMを選択し直し、移行タスクを再度作成してマイグレーションを開始します。
- 移行先のTencent Cloudイメージにマイグレーションしたときに、 「Failed create transit instance, maybe no available source in target region」ログエラーなどの中継インスタンスのエラーメッセージが発生した。
**解決方法**：移行タスクの移行先エリアに使用可能なリソースがない可能性があります。この場合は、その他エリアを選択してマイグレーションするか、または指定のCVMにマイグレーションすることで解決できます。

依然として問題が解決しない場合、または上記の原因に該当しない場合は、その時点のマイグレーションログファイル（デフォルトはマイグレーションツールディレクトリのlogファイル）を保持し、[お問い合わせ](https://intl.cloud.tencent.com/document/product/213/34837)をして解決することができます。



### マイグレーション完了後に何を得ることができますか。
移行タスクが完了すると、プラットフォームは移行タスクに設定した移行先タイプに応じて、対応するマイグレーション製品を生成します。
- 移行先タイプの選択**CVMイメージ**：マイグレーション完了後に移行元のために移行先のTencent Cloudイメージが生成されます。移行タスクがある行の**CVMイメージID**をクリックし、[CVMイメージページ](https://console.cloud.tencent.com/cvm/image/index)でイメージの詳細を確認でき、このイメージを使用してCVMをすばやく作成できます。CVMイメージの作成後、このイメージにバインドされた**CVMスナップショット**が同期して作成されます。
- 移行先タイプの選択**CVMインスタンス**：マイグレーション完了後に、移行元を移行先のTencent Cloud CVMインスタンスにマイグレーションします。


### Linuxサーバーのマイグレーション後のシステムの確認方法
移行先CVMが正常に起動できるか、移行先CVMのデータが移行元サーバーと一致しているか、ネットワークが正常か、他のシステムサービスが正常かなどを確認してください。


### マイグレーション後、再度マイグレーションする必要がある場合の操作方法
[オンラインマイグレーションコンソール](https://console.cloud.tencent.com/cvm/csm/online?rid=1)にログインし、移行元をもう一度使用し、移行タスクを新規作成して開始します。


## オンラインマイグレーションツールに関するご質問


### ツールはどこからダウンロードしますか。
[ここをクリックしてダウンロード](https://go2tencentcloud-1251783334.cos.ap-guangzhou.myqcloud.com/latest/go2tencentcloud.zip)で、マイグレーションツール圧縮パッケージをダウンロードします。また、[ツールを使用したマイグレーション操作ガイド](https://intl.cloud.tencent.com/document/product/213/35640)を参照して操作を行います。


### ツールの使い方
マイグレーションツールをソースサーバーにダウンロードまたはアップロードし、マシンの実際の状況に応じて設定ファイルを修正した後にマイグレーションツールを実行する必要があります。バッチマイグレーションを実行したい場合は、スクリプトを記述することでバッチ処理を実装できます。


### ツールを使用したマイグレーションがエラーとなった場合、または失敗した場合はどうすればよいですか。

マイグレーションエラーまたは失敗の原因は多岐にわたりますが、通常、次のいくつかの原因に集約されます。
- ターゲットCVMのセキュリティグループで、80ポートと443ポートを開放していなかった。
- ソースのマイグレーション中にデータディスクがあるが、user.jsonの中のDataDisksフィールドがソースデータディスクをマイグレーションするように設定されていないので、すべてのデータがターゲットCVMシステムディスクに送信されるため、ディスク容量が不足していた。
- [プライベートネットワークマイグレーションモード](https://intl.cloud.tencent.com/zh/document/product/213/44340#.E6.94.AF.E6.8C.81.E7.9A.84.E8.BF.81.E7.A7.BB.E6.A8.A1.E5.BC.8F) で、第三段階のマイグレーションが実行されず、移行先のCVMがマイグレーションモデルを終了した。

依然として問題が解決しない場合、または上記の原因に該当しない場合は、その時点のマイグレーションログファイル（デフォルトはマイグレーションツールディレクトリのlogファイル）を保持し、[お問い合わせ](https://intl.cloud.tencent.com/document/product/213/34837)をして解決することができます。



  

