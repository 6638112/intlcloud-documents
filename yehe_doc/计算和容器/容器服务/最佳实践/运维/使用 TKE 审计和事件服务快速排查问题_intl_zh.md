## 使用场景 
容器服务 TKE 的集群审计和事件存储为用户配置了丰富的可视化图表，以多个维度对审计日志和集群事件进行呈现，操作简单且涵盖绝大多数常见集群运维场景，易于发现和定位问题，提升运维效率，将审计和事件数据的价值最大化。
本文结合几个具体使用场景和示例，介绍如何利用审计和事件仪表盘快速定位集群问题。

## 前提条件

已登录 [容器服务控制台](https://console.cloud.tencent.com/tke2/cluster?rid=1)，并已开启 [集群审计](https://intl.cloud.tencent.com/document/product/457/38338) 和 [事件存储](https://intl.cloud.tencent.com/document/product/457/30686)。


## 使用示例

### 示例1：排查工作负载消失问题

1. 登录 [容器服务控制台](https://console.cloud.tencent.com/tke2)。
2. 在左侧导航栏中选择【集群运维】>【审计检索】，进入“审计检索”页面。
3. 选择【K8S 对象操作概览】页签，在过滤项中指定需要排查的操作类型和资源对象。
4. 单击【过滤】开始查询。




### 示例2：排查节点被封锁问题

1. 登录 [容器服务控制台](https://console.cloud.tencent.com/tke2)。
2. 在左侧导航栏中选择【集群运维】>【审计检索】，进入“审计检索”页面。
3. 选择【节点操作概览】页签，在过滤项中指定被封锁的节点名称。
4. 单击【过滤】开始查询。


### 示例3：排查 apiserver 响应变慢问题

1. 登录 [容器服务控制台](https://console.cloud.tencent.com/tke2)。
2. 在左侧导航栏中选择【集群运维】>【审计检索】，进入“审计检索”页面。
3. 选择【聚合检索】页签，进入“聚合检索”页面。该页面提供了 [用户](#user)、[操作类型](#type)、[返回状态码](#statuscode) 等多个维度对于 apiserver 访问的趋势图。 

### 示例4：排查节点异常问题

1. 登录 [容器服务控制台](https://console.cloud.tencent.com/tke2)。
2. 在左侧导航栏中，选择【集群运维】>【事件检索】，进入“事件检索”页面。
3. 选择【事件总览】页签，在资源对象过滤项中输入异常节点 IP。
4. 单击【过滤】开始查询。查询结果显示，有一条“节点磁盘空间不足”的事件记录查询结果。
5. 单击该事件，进一步查看异常事件趋势。

### 示例5：查找触发节点扩容的原因

开启了节点池**弹性伸缩**的集群，CA（cluster-autoscler）组件会根据负载状况自动对集群中节点数量进行增减。如果集群中的节点发生了自动扩（缩）容，用户可通过事件检索对整个扩（缩）容过程进行回溯。


1. 登录 [容器服务控制台](https://console.cloud.tencent.com/tke2)。
2. 在左侧导航栏中，选择【集群运维】>【事件检索】，进入“事件检索”页面。
3. 选择【全局检索】页签，在检索分析栏中输入以下检索命令：
```
event.source.component : "cluster-autoscaler"
```
4. 在左侧“隐藏字段”中选择 “`event.reason`”、“`event.message`”、“`event.involvedObject.name`”、“`event.involvedObject.name`” 进行显示，单击【检索分析】开始检索分析日志并将返回检索结果。
5. 将检索结果按照“日志时间”倒序排列。
