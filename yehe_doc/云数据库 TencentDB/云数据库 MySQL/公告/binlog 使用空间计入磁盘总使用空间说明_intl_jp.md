
TencentDB for MySQLインスタンスでは、大きなタスクまたは大量のDMLを実行する際に、たくさんのbinlogが発生します。binlogは、MySQLのデータ同期のベースであり、データベースの復元性、安定性、高可用性を保障するために使用されます。

今回のアップグレード以前は、ローカルbinlogはTencent Cloudが提供する規定外のストレージキャパシティに保存されていました。binlogの書き込み速度がデータベース稼働時の性能に影響するためです。TencentDB for MySQLの性能および安定性を向上させるため、TencentDB for MySQLでは、binlogのストレージに対するアップグレード実施し、今回のアップグレードによって、インスタンスbinlogのストレージメディアを高性能SSD（ユーザーインスタンスのストレージキャパシティ）に移行します。

## アップグレードの影響
今回のアップグレードは2ノードと3ノードアーキテクチャのTencentDB for MySQLにのみ関係します。

### ストレージ使用容量
- binlogを高性能SSDに移行すると、binlogがお客様の[ストレージ容量](https://intl.cloud.tencent.com/document/product/236/18335)の一部を占有することになります。
- TencentDB for MySQLは、デフォルトで5日間のbinlogをローカルに保留します。すなわちbinlogはまず一次的にディスクの保存領域に保存され、保留期間を過ぎると自動的に削除されます。[ローカルbinlogの保留設定](https://intl.cloud.tencent.com/document/product/236/40186)をご参照ください。
>?binlogは生成されると同時に、自動バックアップ機能によってCOSにアップロードされてバックアップされます。自動バックアップ機能については、[データベースのバックアップ](https://intl.cloud.tencent.com/document/product/236/37796)をご参照ください。

### 監視指標
binlogの高性能SSDへの移行を開始すると、binlogの使用容量がディスク総使用容量に計上され、アラームがトリガーされる恐れがあります。残り容量が20%を超えるようにすることを推奨します。

## アップグレードの時期
- 2021年4月1日0時より、中国香港・中国マカオ・中国台湾地区（中国香港）およびその他の中国本土以外のリージョンの2ノード、3ノードTencentDB for MySQLにおいて、binlogの使用容量をディスク総使用容量に計上し始めます。
- 2021年4月7日0時より、西南地区（成都、重慶）の2ノード、3ノードTencentDB for MySQLにおいて、binlogの使用容量をディスク総使用容量に計上し始めます。
- 2021年4月14日0時より、華北地区（北京）の2ノード、3ノードTencentDB for MySQLにおいて、binlogの使用容量をディスク総使用容量に計上し始めます。
- 2021年4月19日0時より、華東地区（上海）の2ノード、3ノードTencentDB for MySQLにおいて、binlogの使用容量をディスク総使用容量に計上し始めます。
- 2021年4月21日0時より、華南地区（広州）の2ノード、3ノードTencentDB for MySQLにおいて、binlogの使用容量をディスク総使用容量に計上し始めます。
- 2021年4月22日0時以降に追加されるリージョンの2ノード、3ノードTencentDB for MySQLにおいても、binlogの使用容量をディスク総使用容量に計上します。

## ローカルbinlogの占有容量削減についてのアドバイス
ローカル binlogでは保留周期の設定をサポートしていますので、保留周期を短縮してbinlogの保存時間を削減することができます。詳細については、[ローカルbinlogの保留設定](https://intl.cloud.tencent.com/document/product/236/40186)をご参照ください。

## よくあるご質問
#### アップグレードのプロセスはスケーリングに影響しませんか。
影響しません。現在スケーリングはデータファイルの使用容量に基づき判断を行っています。
今後のスケーリングはディスク総使用容量に基づいて判断が行われ、実際にスケーリングとなった場合はサイト内メッセージ、Short Message Serviceなどの方法で通知されます。

#### アップグレード後、その他の機能は影響を受けますか。
現在はアラームのトリガーにのみ影響します。従来はデータファイルの使用容量/ディスク容量を採用して計算していましたが、今はディスク総使用容量/ディスク容量による計算に変更されています。

