
このドキュメントでは、コンソールを介してMySQLインスタンスのbinlog保持期間を設定する方法について説明します。

## binlogの説明
TencentDB for MySQLインスタンスでは、大規模なトランザクションまたは大量のDML操作を実行する際に、たくさんのbinlogが発生します。binlogの書き込みが256MBに達すると1回分割され、分割した後のbinlogファイルはCloud Object Storage（COS）にアップロードされます。その後コンソールのログリストに、COSにアップロードされたbinlogファイルが表示されます。
![](https://main.qcloudimg.com/raw/bcf3d0d2ac291ccebbcfebea05fd11f1.png)

## シナリオ
binlogはCOSにアップロードされる前に、一時的にインスタンスのディスクに保存されるため、ディスク使用容量が増加します。お客様は、コンソールを介してBinlog保持期間を設定して占有容量の比率を制御することも、またディスク容量を拡張することも可能です。ディスク使用率を80%以下にすることを推奨し、その次として、不要なデータの速やかな消去を推奨します。
- binlogは、MySQLのデータ同期のベースであり、データベースの復元性、安定性、高可用性を保障するために使用されます。TencentDB for MySQLではbinlogの無効化をサポートしていません。
- 生成されたbinlogはまずシステムの[自動バックアップ機能](https://intl.cloud.tencent.com/document/product/236/37796)によってCOSにバックアップされ、バックアップ後のbinlogは、設定したローカルのbinlog保留ポリシーに従い削除されます。エラーを防止するため、現在使用中のbinlogを消去することはできません。このため、消去のプロセスでは一定の遅延が発生します。設定した後はしばらくお待ちください。
>?有効期限が切れたbinlogファイルを削除するためのルール
>ローカルbinlogファイルは60秒ごとに1回チェックされます。binlogファイルの開始時間またはスペース使用量が設定された保持ルールを満たしていない場合、削除するファイルのキューに追加されます。キュー内のbinlogファイルは日付順に並べ替えられ、キューがクリアされるまで、最も古いファイルから一つずつ削除されます。

## 操作手順
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストページで、インスタンスIDをクリックして、インスタンス管理ページに入ります。
2. インスタンス管理ページで、【バックアップと復元】タブを選択し、【ローカルBinlogの設定】をクリックします。
3. 表示されるダイアログボックスで、保持期間およびスペース使用量を入力し、内容に間違いがないことを確認してから、【OK】をクリックします。

## よくあるご質問
#### ローカルbinlogファイルの保持期間が短すぎる場合、データベースの復元は影響を受けますか。
いいえ。生成されたbinlogファイルは自動バックアップ機能を介して迅速にCOSにアップロードされます。アップロードされていないbinlogファイルは削除されませんが、ローカルbinlogの保持期間が短すぎるとロールバックの速度に影響します。適切なbinlog保存期間を設定してください。

#### ローカルbinlogファイルのデフォルトの保持ポリシーは何ですか。
ローカルbinlogファイルのデフォルトの保持期間は120時間で、スペース使用率は30％を超えません。

#### binlogファイルはインスタンスのディスク容量を占有しますか。
はい。binlogファイルがCOSにアップロードされ、保持ポリシーに従ってクリアされる前に、それらはインスタンスディスクに保存されます。
