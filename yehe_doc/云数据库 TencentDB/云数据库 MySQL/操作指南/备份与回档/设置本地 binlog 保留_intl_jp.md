
ここでは、コンソールを介してMySQLインスタンスのbinlog保留周期を設定する方法をご紹介します。

## binlogの説明
TencentDB for MySQLインスタンスでは、大きなタスクまたは大量のDMLを実行する際に、たくさんのbinlogが発生します。binlogの書き込みが256MBに達すると1回分割され、分割した後のbinlogファイルはCloud Object Storage（COS）にアップロードされます。その後コンソールのログリストに、COSにアップロードされたbinlogファイルが表示されます。
![](https://main.qcloudimg.com/raw/bcf3d0d2ac291ccebbcfebea05fd11f1.png)

## 操作シナリオ
binlogはCOSにアップロードされる前に、一時的にインスタンスのディスクに保存されるため、ディスク使用容量が増加します。お客様は、コンソールにてBinlog保留周期を設定して占有容量の比率を制御することも、またディスク容量を拡張することも可能です。ディスク使用率を80%以下にすることを推奨し、その次として、不要なデータの速やかな消去を推奨します。
- binlogは、MySQLのデータ同期のベースであり、データベースの復元性、安定性、高可用性を保障するために使用されます。TencentDB for MySQLではbinlogの無効化をサポートしていません。
- 生成されたbinlogはまずシステムの[自動バックアップ機能](https://intl.cloud.tencent.com/document/product/236/37796)によってCOSにバックアップされ、バックアップ後のbinlogは、設定したローカルのbinlog保留ポリシーに従い削除されます。エラーを防止するため、現在使用中のbinlogを消去することはできません。このため、消去のプロセスでは一定の遅延が発生します。設定した後はしばらくお待ちください。

## 操作手順
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストのページで、インスタンス名をクリックして、インスタンス管理ページに入ります。
2. インスタンス管理ページで、【バックアップの復旧】ページを選択し、【ローカルBinlog設定】をクリックします。
3. ポップアップしたダイアログボックスに、保留が必要な時間および容量使用率を入力し、間違いがないことを確認してから、【OK】をクリックします。
>?利用可能な容量の保護を有効にすると、80%超過または残存容量が5GBに満たないときは、強制的にbinlogを消去します。最も早期のものから消去を開始し、全体の容量使用率が80%以下に下がり、残存容量が5GBを超えるまで消去されます。
>

## よくあるご質問
#### ローカルbinlogの保留設定が小さすぎるとデータベースの復元に影響しませんか。
影響しません。生成されたbinlogは自動バックアップ機能によって迅速にCOSにアップロードされます。アップロードされていないbinlogも消去されませんが、ローカルbinlogの保留設定が小さすぎるとロールバックの速度に影響します。適宜設定してください。

#### ローカルbinlog保留のデフォルトの設定時間はどのくらいですか。
ローカルbinlogのデフォルトの保留時間は120時間、容量使用率はデフォルトで30%以下となっています。利用可能な容量の保護はデフォルトで有効になっています。

#### binlogがインスタンスのディスク容量を占有することはありますか。
あります。生成されたbinlogはまずCOSに自動バックアップされ、バックアップ後のbinlogは設定された保留ポリシーにしたがって削除されます。この期間binlogは一時的にインスタンスのディスクに保存されます。
