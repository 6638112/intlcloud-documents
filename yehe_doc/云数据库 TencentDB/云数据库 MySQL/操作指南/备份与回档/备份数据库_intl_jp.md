このドキュメントでは、自動バックアップと手動バックアップの２つの方法を使用してデータベースをバックアップする方法について説明します。

## バックアップの概要
### バックアップモード
TencentDB for MySQLの高可用性エディションとファイナンスエディションは、**自動バックアップ**と**手動バックアップ**の2つの方法でデータベースをバックアップすることをサポートしています。

### バックアップタイプ
TencentDB for MySQLの高可用性エディションとファイナンスエディションは、2種類のバックアップタイプをサポートしています。
- **物理バックアップ**は、物理データを完全コピーすることです（自動バックアップと手動バックアップの両方でサポート）。
- **論理バックアップ**は、SQLステートメントをバックアップすることです（手動バックアップでのみサポート）。
>?
>- 物理バックアップを使用してデータベースを復元するには、xbstreamを利用してパッケージを解凍する必要があります。詳細については、[物理バックアップでデータベースを復元する](https://intl.cloud.tencent.com/document/product/236/31910)をご参照ください。
>- 単一インスタンスのテーブル数が100万を超えた場合は、バックアップの失敗になる恐れがあり、データベースへの監視にも影響を与えます。そのため、単一インスタンスのテーブル数が100万を超えないようにテーブルの数を適切に管理してください。
>- Memoryエンジンテーブルのデータがメモリに格納されているので、Memoryエンジンテーブルの物理バックアップを実行できません。データの紛失を避けるために、MemoryエンジンテーブルをInnoDBテーブルに置き換えることをお勧めします。
>- インスタンスにはプライマリキーのないテーブルが多数存在するため、バックアップに失敗し、インスタンスの高可用性に影響を与える可能性があります。プライマリキーのないテーブルのプライマリキーまたはセカンダリインデックスを適時に作成してください。

| 物理バックアップのメリット | 論理バックアップのデメリット |
|---------|---------|
| <li>バックアップ速度が速いです。<li>ストリーミングバックアップと圧縮をサポートします。<li>バックアップの成功率が高いです。<li>復元は簡単で効率的です。<li>バックアップベースの高速なカップリング操作。例えば、読み取り専用インスタンスやディザスタリカバリインスタンスの追加の速度がより速くなります。<li>物理バックアップにかかる平均時間は論理バックアップの1/8程度です。<li>物理バックアップのインポート速度は論理バックアップより10倍ほど速いです。| <li>復元するにはSQLの実行とインデックスの作成が必要なので、かかる時間が長いです。<li>バックアップ速度が遅いです、大量のデータがある場合は特に速度が低下します。<li>バックアッププロセスは、インスタンスに負荷をかけ、マスター/スレーブの遅延を大きくする可能性があります。<li>単精度浮動小数点数の精度情報が紛失する可能性があります。<li>各種エラー（誤ったビューなど）によって、バックアップの失敗になる可能性があります。<li>バックアップベースのカップリング操作、例えば、 読み取り専用インスタンスやディザスタリカバリインスタンスの追加の速度が遅くなる可能性があります。

### バックアップのオブジェクト
 | データバックアップ | ログバックアップ |
|---------|---------|
 | TencentDB for MySQL 高可用性エディションとファイナンスエディション：<li>自動バックアップは完全な物理バックアップをサポートしています。<li>手動バックアップは完全な物理バックアップ、完全論理バックアップ、単一データベース論理バックアップをサポートしています。<li>自動バックアップと手動バックアップの両方は圧縮とダウンロードをサポートしています。<li>自動バックアップは、手動で削除できませんが、その保持期間が設定できます。<li>手動バックアップは、コンソールで手動で削除できますが、削除されるまで保持されます。 | データベースのbinlogファイルのバックアップはMySQL 5.5、5.6、5.7（高可用性エディションとファイナンスエディション）をサポートしています：<li>binlogファイルはインスタンスのディスク容量を占有します。<li>ログファイルはダウンロードをサポートしていますが、圧縮をサポートしていません。<li>ログファイルの保持期間を設定することが可能です。|　　　

## 注意事項
- MySQLの自動バックアップ機能は、2019年02月26日より、物理バックアップのみサポートされています。自動バックアップは、デフォルトで物理バックアップに設定され、論理バックアップを提供されなくなりました。既存の自動論理バックアップは、自動的に物理バックアップに切り替えられます。
この切り替え作業は、サービスへのアクセスに影響を与えませんが、自動バックアップを使う習慣のある方に若干の影響を与える可能性があります。論理バックアップを実行したい場合、 [MySQLコンソール](https://console.cloud.tencent.com/cdb) の手動バックアップ方法、或いは[APIの呼び出し](https://intl.cloud.tencent.com/document/product/236/15844)で論理バックアップを生成することができます。
- 論理バックアップと物理バックアップを実行する際、ファイルが圧縮処理されるため、一部のファイルはダウンロード後に使用できなくなる場合があります。その場合、手動論理バックアップでテーブルバックアップ機能を使用できます。詳細については、[手動バックアップ](#manual-backup)をご参照ください。
- インスタンスのバックアップファイルはバックアップ容量を占めます。フリークォータを超えたバックアップ容量に対して追加料金が発生する可能性があるため、バックアップサイクルを適切に設定し、バックアップ容量を適切に使用してください。
- サービス量の少ない時期にデータベースをバックアップすることをお勧めします。
- 一定の保持期間を過ぎた場合、ファイルが自動的に削除されますので、適時に必要なバックアップファイルをローカルにダウンロードしてください。
- テーブルロックによるバックアップの失敗を回避するために、バックアップ中は、DDL操作をしないでください。
-  使用済みスペースがフリークォータを超えた場合、料金が発生します。料金の詳細については[バックアップスペースの課金説明](https://intl.cloud.tencent.com/document/product/236/32344)をご参照ください。

## MySQLデータの自動バックアップ
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストのページでインスタンス名をクリックすると、管理ページに進み、【バックアップと復元】>【自動バックアップの設定】を選択します。
![](https://main.qcloudimg.com/raw/69fed1aac393a518bd8cc2ad1fea550f.png)
2. ポップアップダイアログで、バックアップパラメータを選択し、【OK】をクリックします。パラメータは次のように説明されています。
>? [ロールバック機能](https://intl.cloud.tencent.com/document/product/236/7276)は、バックアップサイクルとバックアップ保存日数内のバックアップファイルに基づいています。自動バックアップの頻度と保存日数を短縮すると、インスタンスデータのロールバック機能に影響を与える可能性があります。実際のニーズに基づいて適切にバックアップを構成してください。
>
<table>
<thead>
<tr>
<th>パラメータ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>バックアップサイクル</td>
<td>データの安全性を確保するために、少なくとも１週間に2回バックアップを実行してください。デフォルトは月曜日から日曜日までとします。</td>
</tr>
<tr>
<td>バックアップ時間</td>
<td><ul><li>デフォルトのバックアップの開始時刻は、システムによって自動的に割り当てられます。<li>時間帯をカスタム設定でき、オフピーク期間に設定することをお勧めします。バックアップの開始時刻は、バックアップの終了時刻ではなく、バックアップが開始する時刻を表します。<br>例えば、02:00～06:00時を選択した場合、システムは、02:00～06:00の時間帯にある特定の時刻にバックアップを開始します。具体的な開始時刻は、バックエンドのバックアップポリシーとバックアップシステム状況に依存します。
</td>
</tr>
<tr>
<td>データバックアップの保持期間</td>
<td>データバックアップファイルは7～732日保持でき、デフォルト値は7日です。</td>
</tr>
<tr>
<td>ログバックアップの保持期間</td>
<td>ログバックアップファイルは7～732日保持でき、デフォルト値は7日です。<strong>ログバックアップの保存期間に設定する日数は、データバックアップの保存期間よりも短くする必要があります。</strong>  </td>　　
</tr>
</tbody></table>
<img src="https://main.qcloudimg.com/raw/a371d4ba960264aa5630b59a3bfe5096.png"  style="margin:0;">


<span id = "manual-backup"></span>
##  MySQLデータの手動バックアップ
手動バックアップ機能を使用すると、バックアップタスクを手動で開始できます。
>?
>- 手動バックアップは完全な物理バックアップ、完全論理バックアップ、単一データベース論理バックアップをサポートします。
>- 手動バックアップは、スペースの浪費や占用を避けるために、バックアップリストから自動削除され、バックアップスペースを解放することができます。
>- インスタンスは毎日の自動バックアップタスクを実行する期間内に手動バックアップを開始することができません。
>
1. インスタンスリストページで、インスタンス名をクリックすると、管理ページに進みます。そのページで【バックアップと復元】>【手動バックアップ】タブを選択します。
2. ポップアップダイアログで、バックアップ方法とオブジェクトを選択して【OK】をクリックします。
![](https://main.qcloudimg.com/raw/a16e644f51756b6a98597945e45329cd.png)
>?単一データベース/テーブルの論理バックアップの場合、左側の【データベースとテーブルの選択】でバックアップするデータベース又はテーブルを選択し、データベース又はテーブルを右側のリストに追加します。データベースがない場合は、まずデータベース或いはテーブルを作成してください。
>
![](https://main.qcloudimg.com/raw/76924e2c76ac348b68ed113d679d6907.png)

