## 작업 시나리오
TencentDB for MySQL은 1개 또는 다수의 읽기 전용 인스턴스로 구성된 읽기 전용 인스턴스 RO그룹 생성을 지원합니다. 읽기/쓰기 분리와 원 마스터 멀티 슬레이브 응용 시나리오에 적용되어 사용자의 데이터베이스 읽기 부하 성능을 대폭 강화할 수 있습니다.

RO그룹은 읽기 전용 인스턴스의 집합으로, 하나의 RO그룹은 하나의 주소를 공유하고, 동시에 그룹 중 읽기 전용 인스턴스의 가중치를 설정하여 트래픽 CLB, 딜레이 제거 설정 등을 할 수 있습니다. 사용자는 필요에 따라 RO 그룹을 배포할 수 있으며, 동시에 상응하는 읽기 요청을 일정 규칙에 따라 읽기 전용 인스턴스로 발송할 수 있습니다. 다수의 읽기 전용 인스턴스를 동일한 RO그룹에 설정하면 재해 복구를 할 수 있습니다.  

##  전제 조건
- 읽기 전용 인스턴스를 생성하기 전에 먼저 CDB 마스터 인스턴스를 생성해야 합니다. 자세한 내용은 [구매 가이드](https://intl.cloud.tencent.com/document/product/236/5160)를 참고 바랍니다.
- TencentDB for MySQL을 사용하기 전에 데이터베이스 초기화를 해야 합니다. 자세한 내용은 [MySQL 데이터베이스 초기화](/doc/product/236/3128)를 참고 바랍니다. 

- 작업 순서
### 읽기 전용 인스턴스 RO그룹 생성
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 뒤, 인스턴스 리스트에서 인스턴스 ID 혹은 '작업'열의 [관리]를 클릭하여 인스턴스 관리 페이지에 이동합니다.
2. 인스턴스 상세 페이지에서 “인스턴스 아키텍처”중의 [읽기 전용 인스턴스 추가]를 클릭하거나 읽기 전용 인스턴스 페이지에서 [생성]을 클릭하여 구매 페이지로 이동합니다. 
![](https://main.qcloudimg.com/raw/83e817ae1b9205d6cdf061684f7d3c12.png)
3. 구매 페이지에서 읽기 전용 인스턴스에 상응하는 설정을 선택하고, 착오가 없는지 확인한 뒤 [즉시 구매]를 클릭합니다.
 - **RO그룹 지정**: [RO그룹 생성]을 선택한 뒤, 다수의 인스턴스를 한 번에 구매하시면 선택한 RO그룹으로 할당됩니다. 가중치 할당 방식은 시스템 자동 할당으로 기본 설정되어 있습니다. 
 - **RO그룹 이름 설정**: 이름은 중복 가능하며 60자 미만의 중국어, 영어, 숫자, `-`, `_`, `.`를 지원합니다.
 - **딜레이 초과 제거**: 제거 정책 실행 여부. 제거된 인스턴스 가중치는 0으로 자동 설정됩니다. 
 읽기 전용 인스턴스의 딜레이가 임계값을 초과하여 제거 되면 사용자에게 알람이 발송됩니다. (읽기 전용 인스턴스 제거 알람과 알람 수신 객체 설정은 [알람 기능](https://intl.cloud.tencent.com/document/product/236/8457)을 참고 바랍니다) 또한 인스턴스 상태가 서비스 중지 동기화되며, 가중치는 0이 됩니다. 읽기 전용 인스턴스 딜레이 시간이 임계값보다 작아질 경우, 다시 RO그룹에 추가 됩니다. 
 동시에, 인스턴스 딜레이 초과 제거 기능 활성화 여부와 상관 없이 읽기 전용 인스턴스의 장애가 제거된 후 복구된 인스턴스도 다시 RO그룹에 추가됩니다. 
 - **딜레이 임계값**: 읽기 전용 인스턴스를 위한 딜레이 제한 초과 임계값 설정. 임계값을 초과한 읽기 전용 인스턴스는 RO그룹에서 제거됩니다.
 - **최소 보관 인스턴스 수**: 그룹 내에서 보장되어야 하는 인스턴스 하한치로, 현재 읽기 전용 인스턴스 수가 해당 하한치와 같거나 적고, 딜레이 시간이 임계값을 초과하면 현재의 읽기 전용 인스턴스는 제거되지 않습니다.
 -**읽기 가중치 할당**: 시스템 자동 분할
 -**과금 방식**: 읽기 전용 인스턴스는 현재 종량제 과금 방식만 지원합니다.
![](https://main.qcloudimg.com/raw/a8f80ce3f01cbaa1847978bec455aa0d.png)
5. 인스턴스 리스트로 돌아가면 생성된 인스턴트 상태는 '발송 중'이며, 상태가 '실행 중'으로 전환되면 읽기 전용 인스턴스 생성에 성공한 것입니다.

### 읽기 전용 인스턴스 RO그룹 설정
읽기 전용 RO그룹의 설정 인터페이스에서 읽기 전용 RO그룹의 이름, 딜레이 초과 정책, 초과 임계값, 최소 보관 인스턴스, 읽기 가중치 등 기본 정보를 설정할 수 있습니다.
>?
>- RO그룹 내에서 읽기 전용 인스턴스는 다른 규격을 사용할 수 있으며, 읽기 트래픽 가중치를 설정할 수 있습니다.
>- 동일한 RO그룹 내에서 읽기 전용 인스턴스는 서로 다른 만료 시간과 과금 방식을 지원합니다.
>
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 후, 인스턴스 리스트에서 마스터 인스턴스 이름을 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 [읽기 전용 인스턴스] 페이지를 선택하고 RO그룹 열에서 [설정]을 클릭하여 RO그룹 설정 페이지로 이동합니다. 
![](https://main.qcloudimg.com/raw/f03a6fc7e5460181e1e933157b4922cb.png)
3. RO그룹 설정 페이지에서 RO그룹 정보를 설정하고 [확인]을 클릭합니다. 
   - **인스턴스 딜레이 초과 제거**: 제거 정책 실행 여부. 제거된 인스턴스의 가중치는 0으로 자동 설정됩니다. 읽기 전용 인스턴스의 딜레이가 임계치를 초과하여 제거되면 사용자에게 알람이 발송됩니다. 읽기 전용 인스턴스 제거 알람과 알람 수신 객체 설정은 [알람 기능](https://intl.cloud.tencent.com/document/product/236/8457)을 참고 바랍니다. 
   - ** 딜레이 임계값**: 읽기 전용 인스턴스를 위한 딜레이 임계값 설정. 임계값을 초과한 읽기 전용 인스턴스는 RO그룹에서 제거됩니다.
   - **최소 보관 인스턴스 수**: 그룹 내에서 보장되어야 하는 인스턴스 하한치로, 현재 읽기 전용 인스턴스 수가 해당 하한치와 같거나 적고, 딜레이 시간이 임계값을 초과하면 현재의 읽기 전용 인스턴스는 제거되지 않습니다.
   - **읽기 가중치 할당**: RO그룹은 시스템 가중치 자동 할당과 사용자 정의 가중치, 두 종류의 가중치 설정 방식을 지원합니다. 가중치 입력 범위는 0~100이며, 반드시 정수여야 합니다. 이중 노드, 삼중 노드 버전 MySQL 인스턴스의 읽기 가중치 값의 시스템 자동 설정 리스트는 아래와 같습니다.
<table>
<tr><th>인스턴스 사양</th><th>가중치</th><tr>
<tr><td>메모리1000MB</td><td>1</td></tr>
<tr><td>메모리2000MB</td><td>1</td></tr>
<tr><td>메모리4000MB</td><td>2</td></tr>
<tr><td>메모리8000MB</td><td>2</td></tr>
<tr><td>메모리12000MB</td><td>4</td></tr>
<tr><td>메모리16000MB</td><td>4</td></tr>
<tr><td>메모리24000MB</td><td>8</td></tr>
<tr><td>메모리32000MB</td><td>8</td></tr>
<tr><td>메모리48000MB</td><td>10</td></tr>
<tr><td>메모리64000MB</td><td>12</td></tr>
<tr><td>메모리96000MB</td><td>14</td></tr>
<tr><td>메모리128000MB</td><td>16</td></tr>
<tr><td>메모리244000MB</td><td>26</td></tr>
<tr><td>메모리488000MB</td><td>50</td></tr>
</table> 
 - **부하 리밸런싱**:
    - 부하 리밸런싱을 비활성화하면 가중치 수정 시 신규 부하에만 적용되고, 기존 장기간 연결로 액세스했던 읽기 전용 인스턴스를 바꾸지 않아 데이터베이스가 끊기지 않습니다.
    - 부하 리밸런싱을 활성화하면 데이터베이스 연결이 몇 초간 끊어졌다 다시 연결될 수 있습니다. 새로 추가한 연결은 설정한 가중치 균형에 따라 부하됩니다.
![](https://main.qcloudimg.com/raw/94a42aa7ed813d8ba68560c40749998f.png)

### 읽기 전용 인스턴스 RO그룹 폐기와 삭제
- RO그룹은 수동 삭제 기능을 제공하지 않습니다.
- RO그룹은 그룹 내의 마지막 읽기 전용 인스턴스가 완전히 폐기되면 자동 삭제됩니다.
- 빈 RO그룹 보관은 지원하지 않습니다.
