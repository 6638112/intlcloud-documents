## 操作シナリオ
TencentDB for MySQLは、ユーザーによる1つまたは複数の読み取り専用インスタンスが構成する読み取り専用インスタンスROグループの作成をサポートし、読み取り/書き込み分離と1つのマスターと複数のスレーブのユースケースに適用することで、ユーザーデータベースの読み取り負荷能力を明らかに向上させることができます。

ROグループは読み取り専用インスタンスの集合であり、1つのROグループが1つのアドレスを共有し、同時にその中の読み取り専用インスタンスの重み付けによるトラフィックのロードバランシングの設定や、遅延の排除設定などを行うことができます。ユーザーは必要に応じてROグループをデプロイし、対応する読み取りリクエストを一定のルールによって読み取り専用インスタンスに送信することができます。同一のROグループ内に複数の読み取り専用インスタンスを配置することで、障害復旧の役割を果たすことができます。

## 前提条件
- 読み取り専用インスタンスを作成する前に、クラウドデータベースマスターインスタンスを作成する必要があります。詳細については、[購入ガイドライン](https://intl.cloud.tencent.com/document/product/236/5160)をご参照ください。
- TencentDB for MySQLを使用する前に、データベースを初期化する必要があります。 [MySQLデータベースの初期化](/doc/product/236/3128)をご参照ください。

## 操作手順
### 読み取り専用インスタンスROグループの作成
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb/ )にログインし、インスタンスリストのインスタンスIDまたは「操作」の列の【管理】をクリックし、インスタンス管理ページに進みます。
2. インスタンス詳細ページで、「インスタンスアーキテクチャ図」中の【読み取り専用インスタンスの追加】をクリックし、【新規作成】をクリックして、購入ページに進みます。
![](https://main.qcloudimg.com/raw/83e817ae1b9205d6cdf061684f7d3c12.png)
3. 購入ページで、読み取り専用インスタンスに対応する設定を選択し、間違いないことを確認してから、【今すぐ購入】をクリックします。
 - **ROグループの指定**：【ROグループの新規作成】を選択します。1回で複数のインスタンスを購入した場合、すべてこのROグループに割り当てられます。重みの割り当て方法は、デフォルトでシステム自動割り当てになります
 - **ROグループ名称の設定**：ROグループ名は一意であることが要求されません。長さが60未満の中国語、英語、数字、「-」、「_」、「.」をサポートします。
 - **遅延・超過の排除**：排除ポリシーを起動するかどうか。排除されたインスタンスの重みは自動的に0に設定されます。
 読み取り専用インスタンスの遅延がしきい値を超えて排除された場合、ユーザーにアラームが出され（読み取り専用インスタンス排除アラームと受信対象の設定については、[アラーム機能](https://intl.cloud.tencent.com/document/product/236/8457)をご参照ください）、またインスタンス状態がサービス停止同期中は、重みが0になります。読み取り専用インスタンスの遅延時間がしきい値未満の時、再度ROグループに入ります。
 同時に、インスタンスが遅延・超過の排除機能を有効化しているかどうかに関わらず、読み取り専用インスタンスの障害が排除された後、インスタンスが修復されるのを待って再度ROグループに入ります。
 - **遅延しきい値**：読み取り専用インスタンスに設定する遅延・超過しきい値。しきい値を超えた読み取り専用インスタンスはROグループから排除されます。
 - **最小保留インスタンス数**：グループ内で保証する必要のあるインスタンスの下限数。既存の読み取り専用インスタンス数がこの下限以下であり、かつ遅延時間がしきい値を超えた場合、既存の読み取り専用インスタンスはいずれも排除されません。
 - **読み取り重みの割り当て**：システムが自動的に割り当てます。
 - **課金モード**：読み取り専用インスタンスは現在、従量課金の課金モードをサポートします。
![](https://main.qcloudimg.com/raw/a8f80ce3f01cbaa1847978bec455aa0d.png)
5. インスタンスリストに戻ると、作成されたインスタンスのステータスは「出荷中」になっています。ステータスが「実行中」に切り換わると、読み取り専用インスタンスの作成が成功したことを表わします。

### 読み取り専用インスタンスROグループの設定
読み取り専用インスタンスROグループの設定インターフェースで、読み取り専用インスタンスROグループの名称、遅延・超過ポリシー、遅延しきい値、最小保留インスタンス、読み取りの重みなどの基本情報を設定することができます。
>?
>- ROグループ内の読み取り専用インスタンスは異なる仕様を使用することができ、トラフィック読み取りの重みを設定することができます。
>- 同一ROグループ内の読み取り専用インスタンスは、異なる有効期限と課金方式をサポートすることできます。
>
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb/ )にログインし、インスタンスリストでマスターインスタンス名をクリックして、インスタンス管理ページに進みます。
2. インスタンス管理ページで、【読み取り専用インスタンス】画面を選択し、ROグループリストで【設定】をクリックし、ROグループ設定ページに進みます。
![](https://main.qcloudimg.com/raw/f03a6fc7e5460181e1e933157b4922cb.png)
3. ROグループ設定ページで、ROグループの情報を設定し、【OK】をクリックします。
   - **インスタンスの遅延・超過の排除**：排除ポリシーを起動するかどうか。排除されたインスタンスの重みは自動的に0に設定されます。読み取り専用インスタンスの遅延がしきい値を超えて排除されると、ユーザーにアラームが出されます。読み取り専用インスタンス排除アラームと受信対象の設定については、[アラーム機能](https://intl.cloud.tencent.com/document/product/236/8457)をご参照ください。
   - **遅延しきい値**：読み取り専用インスタンスに設定する遅延・超過しきい値。しきい値を超えた読み取り専用インスタンスはROグループから排除されます。
   - **最小保留インスタンス数**：グループ内で保証する必要のあるインスタンスの下限数。既存の読み取り専用インスタンス数がこの下限以下であり、かつ遅延時間がしきい値を超えた場合、既存の読み取り専用インスタンスはいずれも排除されません。
   - **読み取りの重みの割り当て**：ROグループはシステムによる重みの自動割り当てと重みのカスタマイズの2種類の重み設定方法をサポートします。重み入力範囲は0～100で、整数でなければなりません。システムが自動割り当てする2ノード、3ノードMySQLインスタンスの読み取り重みリスト：
<table>
<tr><th>インスタンスの仕様</th><th>重み</th></tr>
<tr><td>メモリ1000MB</td><td>1</td></tr>
<tr><td>メモリ2000MB</td><td>1</td></tr>
<tr><td>メモリ4000MB</td><td>2</td></tr>
<tr><td>メモリ8000MB</td><td>2</td></tr>
<tr><td>メモリ12000MB</td><td>4</td></tr>
<tr><td>メモリ16000MB</td><td>4</td></tr>
<tr><td>メモリ24000MB</td><td>8</td></tr>
<tr><td>メモリ32000MB</td><td>8</td></tr>
<tr><td>メモリ48000MB</td><td>10</td></tr>
<tr><td>メモリ64000MB</td><td>12</td></tr>
<tr><td>メモリ96000MB</td><td>14</td></tr>
<tr><td>メモリ128000MB</td><td>16</td></tr>
<tr><td>メモリ244000MB</td><td>26</td></tr>
<tr><td>メモリ488000MB</td><td>50</td></tr>
</table> 
 - **リロードバランシング**：
    - リロードバランシングを停止した時は、重みを修正した時に追加の負荷に対してのみ反映され、元の長時間接続がアクセスする読み取り専用インスタンスは変更されず、データベースの瞬断を引き起こすことがありません。
    - リロードバランシングを有効化した時は、データベースが数秒間瞬断されることにより、すべての接続が切断されます。新規の接続は設定された重みに従い負荷のバランスをとります。
![](https://main.qcloudimg.com/raw/94a42aa7ed813d8ba68560c40749998f.png)

### 読み取り専用インスタンスROグループの破棄と削除
- ROグループは手動による削除機能を提供していません。
- ROグループはグループ内の最後の読み取り専用インスタンスの完全破棄に従って、自動的に削除されます。
- ブランクのROグループの保留をサポートしていません。
