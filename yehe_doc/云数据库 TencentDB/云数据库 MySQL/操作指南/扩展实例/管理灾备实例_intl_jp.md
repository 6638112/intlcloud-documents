## 操作シナリオ
ビジネスのサービス継続性とデータの信頼性に対する強いニーズがあるシナリオ、又はモニタリングが必要なシナリオについて、MySQLは地域間災害復旧インスタンスを提供し、ユーザーが低コストでビジネスのサービス継続性を向上させ、データの信頼性を向上させるのに役立ちます。

####　機能特性
- 独立したデータベース接続アドレスを提供し、災害復旧インスタンスは最寄りへのアクセス、データ分析などのシナリオのための読取アクセス機能を提供することができ、デバイスの冗長性コストは低いです。
- プライマリ/セカンダリの高可用性アーキテクチャを使用することにより、データベースの単一障害点リスクを回避します。
- 災害復旧インスタンスはプライベートネットワーク専用回線の同期により低い同期遅延と更に高い安定性を有し、同期のリンク質量はパブリックネットワークより遥かに優れています。
- ただいまのプロモーション期間中は専用回線の費用は無料で、市販化の課金時期については別途お知らせします。

#### 作業原理
- Tencent Cloudデータベースを災害復旧データベースとして使用するシナリオにおいて、災害復旧インスタンスはマスターインスタンスデータベースのコピーバックアップです。
- マスターインスタンスに変化が生じると、変更を記録するログ情報が災害復旧インスタンスにコピーされ、その後、ログの再生を使用してデータの同期が行われます。
- マスターインスタンスに故障が生じた場合、数秒以内に災害復旧インスタンスがアクティベートされ、完全な読取・書込機能を回復することができます。

## 機能制限
- メモリ1GB、ディスク50GB以上の規格で、MySQL 5.6以上、InnoDBエンジンの高IOバージョンのみをサポートし、マスターインスタンスは災害復旧インスタンスを購入します。マスターインスタンスがこの規格より低い場合、先にマスターインスタンスの規格をアップグレードしてください。また、マスターインスタンスはGTID機能を既に有効にしていなければなりません。
>GTIDを有効にしていない場合、[コンソール](https://console.cloud.tencent.com/cdb/)のインスタンス詳細ページでGTIDを有効にすることができます。GTID有効化には長い時間がかかり、また、インスタンスの接続に数秒間の切断があるため、業務のオフピーク期間にに作業するほか、データベースアクセス用のプログラムに再接続機能を追加することをお勧めします。
- 災害復旧インスタンスの規格はメモリ1GB、ディスク50GBが最低限必要で、マスターインスタンス使用済みストレージの規格の1.1倍以上でなければなりません。
- 1つののマスターインスタンスは、最大1つの災害復旧インスタンスを作成できます。災害復旧インスタンスは、隔離状態の間、再び災害復旧インスタンスを作成することができません。
- 災害復旧インスタンスは現在、プロジェクトの移行、ロールバック、SQL操作、パラメーターの設定、文字セットの変更、アカウントの管理、ポートの変更、データのインポート、ロールバックログ、読取専用インスタンス機能をサポートしていません。

##　操作手順
### 災害復旧インスタンスの作成
####ステップ1：災害復旧インスタンスの作成
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb/ )にログインし、インスタンスリストでインスタンス名又は「操作」列の【管理】をクリックして詳細ページに進みます。
2. インスタンス詳細ページの基本情報でGTID機能が有効であることを確認し、インスタンスアーキテクチャ図で【災害復旧インスタンスの追加】をクリックして、災害復旧インスタンスの購入ページに進みます。

4. 購入ページで、災害復旧インスタンスの「課金モード」、「地域」、「同期ポリシー」などの基本情報を設定します。
 - 同期ポリシーが「今すぐ同期する」である時、災害復旧インスタンスを作成し終わると直ちにデータが同期されます。
 - 同期ポリシーが「作成後に同期する」である時、災害復旧インスタンスの作成が完了後、災害復旧同期リンクを構成する必要があります。詳細の操作は、以下の[同期リンクの作成](#cjtblj)をご参照ください。
>
>- 作成時間はデータ量によります。その間、マスターインスタンスのコンソール操作がロックされますので、適切に手配してください。
>- 現在、インスタンス全体データの同期しかサポートていません。ディスクに十分な空き容量があることを確認してください。
>- マスタインスタンスのステータスが実行中であり、実行しているタスクがないことを確認してください。そうしないと、同期タスクが失敗する可能性があります。  
5. 間違いがないことを確認後、【今すぐ購入する】をクリックし、災害復旧インスタンスが出荷されるのを待ちます。

<span id="cjtblj"></span>
#### ステップ2：同期リンクの作成（オプション）
>お客様の購入時に選択した「同期ポリシー」が「作成後に同期する」である場合、災害復旧インスタンスの作成が完了後、災害復旧同期リンクを構成すると、リモート操作による災害復旧が行えます。

1. マスターインスタンスのインスタンス詳細ページで災害復旧インスタンスの同期状態が確認できます。【同期タスクを作成する】をクリックし、災害復旧インスタンスのためにマスターインスタンスのプライベートネットワークとの同期リンクを作成します。

2. タスク名称を入力し、ソースデータベース情報とターゲットデータベース情報を確認し、【保存して次に進む】をクリックします。

3. 同期する必要のあるオブジェクトを選択し、インスタンス全体の同期又は一部のデータベーステーブルのみの同期をサポートします。現在、同期タイプの選択はサポートしていません。

4. 【保存して検証する】をクリックした後、【タスクを検証する】に進み、検証が完了した後、【タスクを始める】をクリックすると、MySQLの「災害復旧の同期」ページでタスクの詳細が見られます。


### 災害復旧インスタンスの管理
- **災害復旧インスタンスの表示**
  災害復旧インスタンスはその所属地域で確認することができ、インスタンスリストでこの地域の全ての災害復旧インスタンスをフィルタリングすることができます。
	
- **依存関係の表示**
  各災害復旧インスタンス又はマスターインスタンス右側のアイコンをクリックすると、依存関係を確認することができます。	
-**同期遅延の表示**
  災害復旧インスタンスのインスタンス詳細ページ上でマスターインスタンスと災害復旧インスタンスの間の同期遅延を確認することができます。

- **災害復旧インスタンスインスタンスの機能**
  災害復旧インスタンスはインスタンス詳細、インスタンス監視、バックアップ管理、ログのスロークエリ機能を提供します。
 
### 災害復旧インスタンスのマスタインスタンスへのアップグレード
1. インスタンスリストでマスターインスタンスにアップグレードする必要のある災害復旧インスタンスを選択し、【管理】をクリックします。
2. 管理ページに進んだ後、右上で【マスターインスタンスに切り換える】をクリックすると、災害復旧インスタンスをマスターインスタンスにアップグレードすることができます。切り替えると、マスターインスタンスとの同期接続が切断され、インスタンスデータベースのデータ書込機能と完全なMySQL機能が回復します。
>同期接続が切断した後は再接続できませんので、慎重に操作してください。
> 


