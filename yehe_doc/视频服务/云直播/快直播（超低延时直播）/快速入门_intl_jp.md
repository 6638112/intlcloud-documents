このチュートリアルにより、ライブイベントストリーミングサービスをすばやく理解することができます。ライブイベントストリーミングサービスをご利用になる前に、ライブイベントストリーミングの[価格一覧](https://intl.cloud.tencent.com/document/product/267/2819)をご覧いただき、誤解を避けるために、**課金項目**と**価格**を確認しておくことをお勧めします。

[](id:step0)
## 準備作業
1. [Tencent Cloudアカウント](https://intl.cloud.tencent.com/register?s_url=https%3A%2F%2Fcloud.tencent.com%2Fproduct%2Flvb)を登録します。
2. [Tencent Cloud CSSサービス有効化ページ](https://console.cloud.tencent.com/live?from=product-banner-use-lvb)に入り、『Tencent Cloudサービス契約』の同意にチェックを入れ、**有効化申請**をクリックすればCSSサービスをアクティブ化できます。
>?  
>- CSSサービスの有効化申請後、国内の再生トラフィック20GBの無料体験を利用できます。
>- ドメイン名の設定は、標準ライブストリーミングと同様です。標準ライブストリーミングにアクセスしている場合は、[手順4：再生アドレスの取得](#step4) 部分でライブイベントストリーミングプルについて直接学ぶことができます。

[](id:step1)
## 手順1：ドメイン名の追加
CSSサービスを使用するには、少なくとも**2つ**のドメイン名が必要です。1つを**プッシュドメイン名**とし、もう1つを**再生ドメイン名**として使用します。プッシュと再生で同じドメイン名を使用することはできません。
[**独自ドメイン名**](https://intl.cloud.tencent.com/document/product/267/35970)を使用して、ICP登録済みの独自ドメイン名を追加することができます。

1. 独自ドメイン名を準備します。中国本土（大陸）で使用する場合はドメイン名のICP登録を済ませている必要があります。

2. CSSコンソールにログインし、[**ドメイン名管理**](https://console.cloud.tencent.com/live/domainmanage)に進みます。

3. 独自ドメイン名の追加ページに進み、**ドメイン名の追加**をクリックします。

   ![](https://main.qcloudimg.com/raw/771bbce97962dcd1cffdd94324941280.png)
>?
>- CSSは、デフォルトでテストドメイン名 `xxxx.livepush.myqcloud.com`を提供しています。このドメイン名でプッシュテストを行うことはできますが、正式なサービスでこのドメイン名をプッシュドメイン名として使用することはお勧めしません。
>- ドメイン名の追加に成功すると、**ドメイン名管理**のドメイン名リストでドメイン名情報を確認することができます。追加したドメイン名の管理を行いたい場合は、[ドメイン名管理](https://intl.cloud.tencent.com/document/product/267/31056)をご参照ください。
>-  ライブブロードキャストドメイン名の詳細については、[Basic CSS Features](https://intl.cloud.tencent.com/document/product/267/7968)をご参照ください。
5. ドメイン名の追加に成功すると、システムが自動的にCNAMEドメイン名（`.tlivecdn.com`または`.tlivepush.com`を拡張子とする）を割り当てます。CNAMEドメイン名は直接アクセスできません。ドメイン名サービスプロバイダのところでCNAME設定を完了させる必要があり、設定が有効になるとCSSサービスを利用できるようになります。例として、DNSサービスプロバイダがTencent Cloudとなる場合のCNAMEレコード追加の操作手順は次のようになります：[](id:step1_1_1)
    1. [ドメイン名サービスコンソール](https://console.cloud.tencent.com/domain)にログインします。
    2. CNAMEを追加する必要のあるドメイン名を選択し、**解析**をクリックします。
    3. ドメイン名解決のページに入り、**レコードの追加**をクリックします。
    4.  新しく追加した列で、ホストレコードとしてドメイン名プレフィックスを入力し、レコードタイプはCNAMEを選択し、レコード値としてCNAMEドメイン名を入力します。
    5. **保存**をクリックするとCNAMEレコードが追加できます。
>!
>- CNAMEが正常に追加された後、通常、有効になるまでに一定時間がかかります。CNAME設定が失敗した場合、CSSは使用できません。
>- ドメイン名のCNAMEに成功すると、CSSコンソールの[**ドメイン名管理**](https://console.cloud.tencent.com/live/domainmanage)リストでドメイン名CNAMEのアドレス状態の記号が![](https://main.qcloudimg.com/raw/0fc346399ae095d69113d4944e511a20.png)に変更されていることが確認できます。
>- CNAME操作後の検出で失敗が続く場合は、ドメイン名登録サービスプロバイダに問い合わせることをお勧めします。
>- 他のDNSサービスプロバイダを使用する場合、その他の操作については、[ドメイン名CNAME設定](https://intl.cloud.tencent.com/document/product/267/31057)をご参照ください。

## 手順2：プッシュアドレスの取得

1. **CSSツールボックス**> [**アドレスジェネレーター**](https://console.cloud.tencent.com/live/addrgenerator/addrgenerator)を選択します。
2. アドレスジェネレーターのページに入り、次の設定を行います：
   1. 生成タイプは**プッシュドメイン名**を選択します。
   2. ドメイン名管理で追加済みのプッシュドメイン名を選択します。
   3. カスタマイズされたカスタムStreamNameを入力します（例：liveteststream）。
   4. アドレス期限を選択します（例：`2021-05-25  23:59:59`）。
   5. **アドレスの発行**をクリックすると、プッシュアドレスを発行することができます。
![](https://main.qcloudimg.com/raw/5a377614d5da22c5193bef68f4a3a6e7.png)

>? 
>- プッシュアドレスの構成は、`live`がデフォルトのAppName、`txSecret`が再生プッシュの署名、`txTime`がプッシュアドレスの有効時間となります。
>- 上記方法以外にも、CSSコンソールの[**ドメイン名管理**](https://console.cloud.tencent.com/live/domainmanage)でプッシュドメイン名を選択して、**管理**をクリックし、**プッシュ設定**を選択して、プッシュアドレスの期限切れ時間とカスタマイズされたStreamNameを入力し、**プッシュアドレスの発行**をクリックすると、プッシュアドレスを発行することができます。
>- 実際の業務のニーズに応じて、プッシュアドレスの発行前に対応する[機能テンプレート](https://intl.cloud.tencent.com/document/product/267/31069)を設定して作成し、プッシュドメイン名に関連付けることができます。付加価値機能の料金については、[価格一覧](https://intl.cloud.tencent.com/document/product/267/2819)をご参照ください。

[](id:step3)
## 手順3：CSSプッシュ


業務シナリオに応じて、生成したプッシュアドレスを対応するプッシュソフトウェアに入力することができます。
- PC端末プッシュの場合、OBSプッシュを推奨します。まず、[OBSプラグイン](https://intl.cloud.tencent.com/document/product/267/42131)を設定してください。プラグインの設定を完了後に、[OBSプッシュ](https://intl.cloud.tencent.com/document/product/267/31569)を参照しながら操作してください。
- Web端末プッシュの場合、**支援ツール** >[**Webプッシュ**](https://console.cloud.tencent.com/live/tools/webpush)の利用を推奨します。プッシュするドメイン名を選択し、カスタムストリーム名StreamNameを入力し、アドレスの有効期限を選択してから、カメラをオンにして、**プッシュ開始**をクリックします。
- ミニプログラムプッシュの場合、WeChatでミニプログラム [Tencent Cloudビデオクラウド](https://intl.cloud.tencent.com/document/product/1071/38147)を検索し、**RTMPプッシュ**を選択してから、**開始**をクリックして、プッシュを開始します。    
- モバイル端末プッシュの場合、[TCToolkit App](https://intl.cloud.tencent.com/document/product/1071/38147)をダウンロードしてインストールします。起動後に**MLVB**>**プッシュデモ（カメラプッシュ）**を選択します。QRコードをスキャンするかプッシュアドレスを手動でアドレス編集ボックスに入力して、**プッシュ開始**をクリックします。

>? 
>
>- カスタマイズしたAppには、Tencent Cloudが提供する[MLVB SDK](https://intl.cloud.tencent.com/document/product/1071)を統合することで、プッシュ機能を実装できます。
- ライブイベントストリーミングWebソリューションは、Bフレームのデコードと再生をサポートしていません。詳細については、[Bフレームについて](#b_frame)をご参照ください。

[](id:step4)
## 手順4：再生アドレスの取得

1. プッシュに成功した後、[**ストリーム管理**](https://console.cloud.tencent.com/live/streammanage)>**オンラインストリーム**を選択して、プッシュアドレスの状態を確認し、**テスト**をクリックしてオンライン再生を視聴します。
2. **CSSツールボックス**>[**アドレスジェネレーター**](https://console.cloud.tencent.com/live/addrgenerator/addrgenerator)を選択して再生アドレスを取得し、このページで次のように設定します：
   1. 生成タイプを選択します（例：再生ドメイン名）。
   2. ドメイン名管理で追加済みの再生ドメイン名を選択します。
   3. プッシュアドレスと同一のStreamNameを入力します。対応するストリームを再生するためには、再生アドレスのStreamNameとプッシュアドレスのStreamNameを一致させる必要があります。
   4. アドレス期限を選択します（例：`2021-05-25  23:59:59`）。
   5. 実際のニーズに応じて、バインドするトランスコードテンプレートを選択します。（トランスコードテンプレートを選択した場合、生成される再生アドレスはトランスコード後のライブストリーミング再生アドレスになります。元のCSSストリームを再生する必要がある場合は、トランスコードテンプレートの選択とアドレスの発行は不要です）
   5. **アドレスの発行**をクリックすると、再生アドレスを発行することができます。ライブイベントストリーミングプルのURL形式は、`webrtc://domain/path/stream_id`です。
![](https://main.qcloudimg.com/raw/5025e22cd8c4c555d7de3e0360e13d11.png)
3. 業務シナリオに応じて、次の方式を用いてCSSストリームが正常に再生できるかどうかテストすることができます。
   - **Web端末CSSストリームテスト**：[WebRTC Live Demo](https://tcplayer.vcube.tencent.com/webrtc-demo/index.html)ツールを使用して再生体験を行うことをお勧めします。
>?
>- WebRTC Live Demoは複数の解像度をサポートし、CSSコンソールの**機能設定**>[**CSSトランスコード**](https://console.cloud.tencent.com/live/config/transcode)でハイビジョン-HD、標準-SDのトランスコードテンプレートを設定し、トランスコードテンプレート付きのWebRTCストリームアドレスをDemo中の該当する項目に入力した後、再生をテストできます（この機能のテストが不要な場合は、DemoにWebRTCオリジナルストリームを入力します）。
>- CSSトランスコードの操作ガイドとトランスコード料金の内容については、ドキュメント[CSSトランスコード](https://intl.cloud.tencent.com/document/product/267/31071)をご参照ください。
   - **モバイル端末ライブストリーミングテスト**：[TCToolkit App](https://intl.cloud.tencent.com/document/product/1071/38147)をダウンロードしてインストールすることを推奨します。起動後に、**ライブイベントストリーミングの再生**を選択します。**プッシュ体験**で取得したライブイベントストリーミング再生アドレスを手動で入力するかスキャンして、再生ボタンをクリックして閲覧します。
>? Appでプッシュする場合、 MLVB SDKを統合してライブイベントストリーミングサービスと合わせて使用してください。利用中に何か不明などがありましたら、 [よくある質問](#que)を参照してください。

## 手順5：ライブイベントストリーミング製品へのアクセス
- **モバイル端末ソリューション**：BフレームデコードとAACオーディオフォーマットをサポートしており、MLVB SDKに統合しています。アクセス方法については、[ライブイベントストリーミングプル](https://intl.cloud.tencent.com/document/product/1071/41875)を参照してください。

[](id:que)
## よくあるご質問
[](id:play_url)
### プルURLの生成
ライブイベントストリーミングプルURLとTencent Cloud CSSプルURLは、基本的に同じです。Tencent Cloud CSSプルURLの前にある`rtmp`を`webrtc`に置き換えるだけで済みます。

ライブイベントストリーミングプルURL形式は、 `webrtc://domain/path/stream_id`です。[ホットリンク防止認証](https://intl.cloud.tencent.com/document/product/267/31560)が必要な場合、プルURL形式は、`webrtc://domain/path/stream_id?txSecret=xxx&txTime=xxx`となります。Tencent Cloud CSSプルURLの生成については、[再生アドレスの取得](#step4)をご参照ください。

>? 異なる解像度とビットレートのストリームをプルする必要がある場合は、トランスコードされたストリームをプルできます。トランスコードされたストリームのURL生成については、[CSSカプセル化とトランスコーディング](https://intl.cloud.tencent.com/document/product/267/31561)をご参照ください。

[](id:b_frame)
### Bフレームについて
ライブイベントストリーミングWebソリューションは、**Bフレームのデコードと再生をサポートしていません**。そのため、元のストリームにBフレームがある場合、バックエンドは自動的にトランスコードしてBフレームを削除しますが、これにより予定外のトランスコード遅延が発生し、**トランスコード料金が発生**します。ですので、Bフレームを含むストリームは、できるだけプッシュしないことをお勧めします。ユーザーは、プッシュストリーミングソフトウェア（OBSなど）のビデオコーデックパラメータを調整することによって、Bフレームを削除することができます。OBSを使用してプッシュする場合は、設定によってBフレームをオフにすることができます。下図のとおりです：
![](https://main.qcloudimg.com/raw/b28d5919589364e6a1f78d62e0b58c47.png)

[](id:a_transcoding)
### オーディオトランスコードテンプレートについて
Web端末のブラウザプルが標準WebRTCプロトコルのみサポートし、AACオーディオ形式をサポートしていない場合は、プッシュされたAACオーディオ形式をOPUSオーディオ形式に変換して再生してください。これにより、[オーディオトランスコード](https://intl.cloud.tencent.com/document/product/267/39604)料金が発生します。
