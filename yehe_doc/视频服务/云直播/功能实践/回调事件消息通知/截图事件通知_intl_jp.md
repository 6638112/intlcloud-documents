CSSスクリーンキャプチャでは、一定の時間間隔でCSSストリームの画像をキャプチャし、画像を生成してCOSの中に保存します。スクリーンキャプチャコールバックは、キャプチャしたものをプッシュして、主に、画像生成イベント、画像サイズ、パス、ダウンロード可能なアドレスなどを含む画像ファイル情報を保存するのに使用します。コールバックテンプレートでスクリーンキャプチャコールバックメッセージ受信サーバーアドレスを設定し、そのテンプレートとプッシュドメイン名をバインドする必要があります。CSSストリームがスクリーンキャプチャイベントをトリガーすると、Tencent Cloud CSSがバックエンドで、お客様が設定した受信サーバーにスクリーンキャプチャ情報をコールバックします。

ここでは、主にスクリーンキャプチャコールバックイベントにトリガーした後、Tencent Cloud CSSがユーザーに送信するコールバックメッセージ通知のフィールドについてご説明します。

## 注意事項

- このドキュメントを読む前に、Tencent Cloud CSSによるコールバック機能の設定方法とコールバックメッセージの受信方法についてご理解下さると幸いです。詳細については、[イベント通知の受信方法](https://intl.cloud.tencent.com/document/product/267/38080)をご参照ください。
- スクリーンキャプチャコールバックイベントがトリガーされた後に取得するスクリーンキャプチャ情報は、CSSポルノ検出、ライブルームのサムネイルなどの多様なシナリオに応用できます。

## スクリーンキャプチャイベントのパラメータ説明
### イベントタイプパラメータ

| イベントタイプ | フィールド設定値の説明           |
| :------- | :------------- |
| CSSスクリーンキャプチャ | event_type = 200 |

### コールバック共通パラメータ
<table>
<tr><th>フィールド名</th><th>タイプ</th><th>説明</th></tr>
<tr>
<td>t</td>
<td>int64</td>
<td>期限、イベント通知サイン期限のUNIXタイムスタンプ。<ul style="margin:0"><li>Tencent Cloudからのメッセージ通知のデフォルトの期限は10分です。メッセージ通知中の t 値が示す時間が期限に達した場合、この通知を無効と判断され、ネットワークのリプレイアタックを防止します。<li>t の形式は10進数UNIXタイムスタンプとなり、1970年1月1日（UTC/GMT 真夜中）から経過した秒数となります。</ul></td>
</tr><tr>
<td>sign</td>
<td>string</td>
<td>イベント通知セキュリティサイン sign = MD5（key + t）。<br>説明：Tencent Cloudが、暗号化 <a href="#key">key</a> と t で文字列を結合した後、MD5でsignの値を算出し、それを通知メッセージに入れます。お客様のバックエンドサーバーは、通知メッセージの受信後、同じアルゴリズムに基づきsignが正確か確認し、さらにメッセージが確実にTencent Cloudバックエンドから来たものかを確認することができます。</td>
</tr></table>

>? <span id="key"></span>keyは、【イベントセンター】>[【ライブストリーミングコールバック】](https://console.cloud.tencent.com/live/config/callback)におけるコールバックキーは、主に認証のために使用します。お客様のデータ情報を安全に保護するため、入力することをお勧めします。
>![](https://main.qcloudimg.com/raw/48f919f649f84fd6d6d6dd1d8add4b46.png)

### コールバックメッセージのパラメータ

| フィールド名     | タイプ   | 説明                        |
| :----------- | :----- | :-------------------------- |
| stream_id    | string | CSSストリーム名                  |
| channel_id   | string | CSSストリーム名と同じ                |
| create_time  | int64  | スクリーンキャプチャ生成のUNIXタイムスタンプ        |
| file_size    | int    | スクリーンキャプチャファイルサイズ。単位：byte   |
| width        | int    | スクリーンキャプチャの幅。単位：ピクセル          |
| height       | int    | スクリーンキャプチャの高さ。単位：ピクセル          |
| pic_url      | string | スクリーンキャプチャのファイルパス `/path/name.jpg` |
| pic_full_url | string | スクリーンキャプチャのダウンロードURL                |

### コールバックメッセージの例
```
{
"event_type":200,

"stream_id":"stream_name",

"channel_id":"stream_name",

"create_time":1545030273,

"file_size":7520,

"width":640,

"height":352,

"pic_url":"/2018-12-17/stream_name-screenshot-19-06-59-640x352.jpg",

"pic_full_url":"http://testbucket-1234567890.cos.region.myqcloud.com/2018-12-17/stream_name-screenshot-19-06-59-640x352.jpg",

"sign":"ca3e25e5dc17a6f9909a9ae7281e300d",

"t":1545030873
}
```










