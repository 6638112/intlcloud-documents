ライブブロードキャストのスクリーンキャプチャは、一定の時間間隔でリアルタイムのライブブロードキャストストリーミングの画像をキャプチャし、画像を生成してCOSに保存することです。スクリーンキャプチャのコールバックは、スクリーンキャプチャをプッシュして、主に、画像生成時間、画像サイズ、パス、ダウンロード可能なアドレスなどを含む画像ファイル情報を保存することに使用します。コールバックテンプレートでスクリーンキャプチャコールバックメッセージの受信サーバーアドレスを設定し、そのテンプレートとプッシュドメイン名をバインドする必要があります。ライブブロードキャストストリーミングがスクリーンキャプチャイベントをトリガーすると、Tencent Cloud Live Video Broadcasting (LVB)がバックエンドで、お客様が設定した受信サーバーにスクリーンキャプチャ情報をコールバックします。

このドキュメントでは、主にスクリーンキャプチャコールバックイベントをトリガーすると、LVBがユーザーに送信するコールバックメッセージ通知のフィールドについて説明します。

## 注意事項

- このドキュメントを読む前に、LVBによるコールバック機能の構成方法とコールバックメッセージの受信方法について理解してください。詳細については、[イベント通知の受信方法](https://intl.cloud.tencent.com/document/product/267/38080)をご参照ください。
- スクリーンキャプチャコールバックイベントがトリガーされた後に取得したスクリーンキャプチャ情報は、ポルノ検出のライブブロードキャスト、ルームサムネイルのライブブロードキャストなどのさまざまなシナリオに適用できます。

## スクリーンキャプチャイベントのパラメータ説明
### イベントタイプパラメータ

| イベントタイプ | フィールド設定値の説明           |
| :------- | :------------- |
| スクリーンキャプチャのライブブロードキャスト | event_type = 200 |

### 共通パラメータのコールバック
<table>
<tr><th>フィールド名</th><th>タイプ</th><th>説明</th></tr>
<tr>
<td>t</td>
<td>int64</td>
<td>期限切れ時間、イベント通知サイン期限のUNIXタイムスタンプ。<ul style="margin:0"><li>Tencent Cloudからのメッセージ通知のデフォルトの期限切れ時間は10分です。メッセージ通知のt値が示す時間は期限切れの場合、この通知を無効と判断され、ネットワークのリプレーアタックを防止できます。<li>tの形式は10進数UNIXタイムスタンプとなり、1970年1月1日（UTC/GMT真夜中）から経過した秒数となります。</ul></td>
</tr><tr>
<td>sign</td>
<td>string</td>
<td>イベント通知セキュリティサインsign = MD5（key + t）。<br>説明：Tencent Cloudが、暗号化<a href="#key">key</a>とtで文字列を結合した後、MD5でsignの値を算出し、それを通知メッセージに入れます。お客様のバックエンドサーバーは、通知メッセージを受信すると、同じアルゴリズムに基づいてsignが正確さを確認でき、さらにメッセージが確実にTencent Cloudバックエンドからきたものかを確認できます。</td>
</tr></table>

>? keyは、**イベントセンター>[CSSコールバック](https://console.cloud.tencent.com/live/config/callback)**の中のコールバックキーとなり、主に認証に使用します。お客様のデータ情報のセキュリティを保護するために、入力することをお勧めします。

![](https://main.qcloudimg.com/raw/48f919f649f84fd6d6d6dd1d8add4b46.png)

### メッセージパラメータのコールバック

| フィールド名     | タイプ   | 説明                        |
| :----------- | :----- | :-------------------------- |
| app           | string | プッシュドメイン名                                                     |
| appname       | string | プッシュパス                                                     |
| stream_param | string | ユーザープッシュURLに付加するパラメータ                                |
| stream_id    | string | ライブブロードキャストストリーミング名                  |
| channel_id   | string | ライブブロードキャストストリーミング名と同じ                |
| create_time  | int64  | スクリーンキャプチャがUNIXタイムスタンプを生成する        |
| file_size    | int    | スクリーンキャプチャのファイルサイズ。単位：byte   |
| width        | int    | スクリーンキャプチャの幅。単位：ピクセル          |
| height       | int    | スクリーンキャプチャの高さ。単位：ピクセル          |
| pic_url      | string | スクリーンキャプチャのファイルパス `/path/name.jpg`  |
| pic_full_url | string | スクリーンキャプチャのダウンロードURL                |

### コールバックメッセージの例
<dx-codeblock>
::: json json
{
    "app":"test.app",
		
    "appname":"live",
    	
    "channel_id":"your_channelid",
    	
    "create_time":1622599925,
    	
    "event_type":200,
    	
    "file_size":30670,
    	
    "height":720,
    
    "pic_full_url":"http://your.cos.region.myqcloud.com/channelid/channelid-screenshot-10-12-05-1280x720.jpg",
    	
    "pic_url":"/channelid/channelid-screenshot-10-12-05-1280x720.jpg",
    	
    "sign":"ca3e25e5dc17a6f9909a9ae7281e300d",
    	
    "stream_id":"your_streamid",
    	
    "stream_param":"txSecret=ca3e25e5dc17a6f9909a9ae7281e300d&txTime=60B83800",
    	
    "t":1622600525,
    	
    「width":1280
}
:::
</dx-codeblock>










