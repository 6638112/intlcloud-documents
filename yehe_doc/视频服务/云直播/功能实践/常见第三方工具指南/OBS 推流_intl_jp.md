## ソリューションの背景
Open Broadcaster Software（略称 OBS）は、オープンソースプログラムのサードパーティ製ライブストリーミングメディアコンテンツ制作ソフトウェアで、使いやすく、ユーザーに無償で提供されています。OS X、Windows、LinuxなどのOSをサポートし、多様なライブブロードキャストのシナリオに適応でき、ライブブロードキャスト行為のほとんどのオペレーションニーズに応えることが可能です。最新版のソフトウェアは、[OBS公式サイトでダウンロード](https://obsproject.com/download?spm=a2c4g.11186623.2.15.6aac1445JPlKR8)できます。

## 準備作業
- [OBS](https://obsproject.com/download?spm=a2c4g.11186623.2.15.6aac1445JPlKR8)ツールをインストールします。
- [CSSサービスの有効化](https://console.cloud.tencent.com/live)が実行され、登録されたドメイン名を準備し、[再生ドメイン名の追加](https://intl.cloud.tencent.com/document/product/267/35970)が実行されます（システムが提供するデフォルトのプッシュドメイン名を使用するか、カスタムドメイン名を追加してプッシュすることもできます）

[](id:step0)
## プッシュアドレスの取得
1. CSSコンソールにログインし、[**アドレスジェネレータ**](https://console.cloud.tencent.com/live/addrgenerator/addrgenerator)を選択し、以下のとおり設定します：
   1. **プッシュドメイン名**または**再生ドメイン名**の生成タイプを選択します。
   2. ドメイン管理下で追加済みのドメイン名を選択します。
   3. AppNameは、同一ドメイン名の複数Appを区別するために使用されるアドレスパスです。デフォルト値はliveです。
   4. カスタマイズされたストリーム名StreamNameを入力します（例：`live`）。
   5. アドレスの期限切れ時間を選択します（例：`2020-06-09 23:59:59`）。
3. **アドレスを生成する**をクリックして、OBSプッシュアドレスを取得できます。


[](id:normal)
## OBSオンラインプッシュ
### 手順1：プッシュアドレスの設定[](id:step1)
1. OBSを開いて、1番下のツールバーの**コントロール**>**設定**ボタンから設定画面に入ることができます。
![](https://main.qcloudimg.com/raw/493a19e0f2bbea80983c341dd742a044.png)
2. **プッシュ**をクリックしてプッシュ設定タブに進み、サービスタイプにカスタムストリームメディアサーバーを選択します。
3. サーバーとストリームパスワードに取得した[プッシュアドレス](#step0)を記入します。
    - サーバー：「OBSプッシュアドレス」である`rtmp://domain/AppName/`とマッピングします。
    - ストリームパスワード：「OBSプッシュ名」である`StreamName?txSecret=xxxxx&txTime=5C1E5F7F`とマッピングします。
![](https://main.qcloudimg.com/raw/55512ddf58bf32014424fa33b6f3d31f.png)
4. **確定**をクリックして設定情報を保存します。

### 手順2：プッシュガイドの設定[](id:step2)
>? ビットレートと録画などの設定が必要である場合は、1番上のツールバーをクリックして、**ツール>ウィザードの自動設定**を選択し、OBSのガイドに従ってプッシュを設定できます。

1. 1番下のツールバーの**ソース**タグを確認します。
![](https://main.qcloudimg.com/raw/f8136fdb794595c8c491c995a74cdfcc.png)
2. **+**ボタンをクリックして、必要に応じて入力ソースを選択します（例：ディスプレイのキャプチャ）。
 ![](https://main.qcloudimg.com/raw/f8136fdb794595c8c491c995a74cdfcc.png)
**よく使用するライブブロードキャスト入力ソースの説明**
<table>
<thead><tr><th width="20%">入力ソース</th><th>説明</th></tr></thead>
<tbody><tr>
<td>画像</td>
<td>単一画像のライブブロードキャストに適しています。</td>
</tr><tr><td>画像のスライドショー</td>
<td>複数の画像をループまたは順番に再生できます。</td>
</tr><tr><td>シーン</td>
<td>各種の大きなライブブロードキャスト効果を実現します。この時、別のシーンをソース元として現在のシーンに追加すれば、シーン全体の挿入を実現できます。</td>
</tr><tr><td>メディアソース</td>
<td>ローカルのビデオをアップロードできます。またローカルのVODビデオファイルに対し、ライブブロードキャスト化の処理を行うことができます。</td>
</tr><tr><td>テキスト</td>
<td>ライブブロードキャストウィンドウにリアルタイムでテキストを追加します。</td>
</tr><tr><td>ディスプレイキャプチャ</td>
<td>デスクトップの操作をリアルタイムかつ動的にキャプチャし、PCデスクトップ上のすべての操作をライブブロードキャストすることができます。</td>
</tr><tr><td>ゲームキャプチャ</td>
<td>指定されたソースからのゲームのライブブロードキャストを許可します。大小ゲームのライブブロードキャストに適しています。</td>
</tr><tr><td>ウィンドウキャプチャ</td>
<td>選択したウィンドウに応じてリアルタイムにキャプチャを行うことができます。ライブブロードキャストは現在のウィンドウのコンテンツのみを表示し、その他ウィンドウはライブストリーミングのキャプチャを行いません。</td>
</tr><tr><td>カラーソース</td>
<td>このソースを使用して1つのカラーブロックを自分のシーンの中に追加し、背景色とすることができます。このカラーブロックは透明度を調整でき、画面全体を透明の色彩にすることができます。</td>
</tr><tr><td>ビデオキャプチャデバイス</td>
<td>ビデオをリアルタイムかつ動的にキャプチャするデバイスです。撮影された画面をリアルタイムにライブブロードキャストできます。</td>
</tr><tr><td>オーディオ入力キャプチャ</td>
<td>オーディオのライブブロードキャストイベントに使用されます（オーディオ入力デバイス）。</td>
</tr><tr><td>オーディオ出力キャプチャ</td>
<td>オーディオのライブブロードキャストイベントに使用されます（オーディオ出力デバイス）。</td>
</tr>
</tbody></table>

### 手順3：スタジオモードをオンにする[](id:step3)
スタジオモードでは、現在のライブブロードキャストコンテンツをリアルタイムに編集し、かつ編集プロセスの中でトランジションアニメーションによるシーン切り替えが可能です。これによりユーザーエクスペリエンスへの影響が極めて少ない状態で、ライブブロードキャストコンテンツの編集を行うことができます。
1. 1番下のツールバーの**コンソール**タブを確認して、**スタジオモード**をクリックします。
2. **トランジションエフェクト**をクリックして、プレビューウィンドウのライブブロードキャスト画面を出力ウィンドウに移動できます。
![](https://main.qcloudimg.com/raw/80e9e902e0e02902d78779ca5505b2f8.png)

### 手順4：ライブブロードキャストプッシュ[](id:step4)
1. 1番下のツールバーの**コンソール**を確認します。
2. **プッシュを開始する**をクリックして、ビデオストリームを設定されたプッシュアドレスにプッシュできます。
![](https://main.qcloudimg.com/raw/80e9e902e0e02902d78779ca5505b2f8.png)

>? 
>- 1番下に![](https://main.qcloudimg.com/raw/a10bafc9eb0895dc4c6b542b61217253.png)緑色のランプが表示されると、プッシュに成功したことを示します。
>- プッシュを停止するには、**プッシュの停止 > プッシュの停止**をクリックします。

## その他のプッシュ設定
- ライブブロードキャストのディレーに影響する関連設定
1. **コンソール>設定>出力**を実行します。
2. **出力モード**を**詳細**として選択すると、**キーフレーム間隔**などを設定できます。設定方法は下図のとおりです：
![](https://main.qcloudimg.com/raw/5f48205da162f1230723729c36369f65.png)
3. 同時に、左側のナビゲーションバーで**詳細**を選択すると、**ストリームディレー**を設定できます。
![](https://main.qcloudimg.com/raw/c3ec9a71a014548eb680009d9798b1ac.png)

- ローカルのライブブロードキャストのレコーディングの関連設定
ライブブロードキャストの際にローカルレコーディングのニーズがある場合は、この時にローカルにレコーディングのバックアップを行う方法を選択できます。設定方法は次のとおりです：
1. **コンソール>設定>出力**をクリックして、出力設定タブに進みます。
2. **録画**設定バーで対応する設定を行い、**確定**をクリックしてレコーディングファイルをローカルに保存できます。
![](https://main.qcloudimg.com/raw/008e1ab02e2d08ee42f3a64e2e09d473.png)
3. **ビデオ**をクリックして、ビデオ解像度とフレームレート情報を設定します。下図のとおりです：
>? 解像度は視聴者が見る画面の精細度を決定し、解像度が高いほど画面は鮮明になります。FPSはビデオフレームレートで、ビデオ視聴のなめらかさを制御します。スタンダードのビデオフレームレートとしては24フレーム - 30フレームがあり、16フレーム未満の画面は見るとラグ感があります。またゲームはフレームレートに求める基準が高いため、通常は30フレーム未満のゲームでは画面の連続性が失われます。

![](https://main.qcloudimg.com/raw/f736ef195b26a81f46d1e26d7935a763.png)

### プッシュトランスコーディングの関連設定
プッシュプロセス中にビデオのビットレートを変更する必要がある場合、具体的な操作は次のとおりです：
1. 1番下の**コントロール**>**設定**ボタンから設定画面に入ります。
2. **出力**タブをクリックして、出力モードに「シンプル」を選択します。
3. ビデオビットレートを記入し、**確定**をクリックします。
![](https://main.qcloudimg.com/raw/008e1ab02e2d08ee42f3a64e2e09d473.png)




## その他の操作の説明
### 純音声プッシュ
OBS公式フォーラムの回答によれば、現在OBS Studio 23.2.1およびそれ以前のバージョンでは純音声プッシュをサポートしていません。
近似する音声プッシュを実現するために、以下の手順を参考に設定を行うことができます。本方法は主に、静的キャンバス（黒画面または画像）を使用して、ビデオを代替します。帯域幅を下げたい場合は、ビデオのフレームレートとビットレートを下げ、これにより純音声プッシュの状態に近づけることができます。ただし、ライブストリーミングの中には依然としてビデオデータがあります。
1. [プッシュガイドの設定](#step2)を参考にして、**オーディオ入力キャプチャ**の入力ソースを入力ソース元として追加します。ビデオ入力ソースまたは画像をビデオ入力ソース元として追加することはできません。

2. **コンソール>設定>ビデオ**ページに進みます。
3. **出力（スケーリング）解像度**を最小に、**共通FPS値（フレームレート）を最小に選択し、**確定**をクリックして設定を保存します。
    ![](https://main.qcloudimg.com/raw/cb77c3deb8d3e9831aaa1421b5b13412.png)
4. **出力**をクリックして出力設定ページに進みます。下図のとおり設定します。ここで、**ビットレート**を最小に設定する必要があります。**確定**をクリックして設定を保存します。
    ![](https://main.qcloudimg.com/raw/008e1ab02e2d08ee42f3a64e2e09d473.png)
5. [OBSプッシュオンラインプッシュ](#normal)の中の手順を参考にしてライブブロードキャストプッシュを開始します。そうすると音声が聞こえ、ビデオのコンテンツは黒画面または画像となります。これと同時に、ビデオのビットレートは最小となり、使用される帯域幅も低下します。

### ビデオの繰り返し再生
- **単独のファイルのループ再生設定方法**
    1. 1番下のツールバーの**ソース**タブでは、**+**をクリックして**メディアソース**を追加し、ポップアップの**ローカルファイル**からループ再生を必要とするビデオファイルを選択し、**ループ**にチェックを入れて、**確定**をクリックします。
    ![](https://main.qcloudimg.com/raw/b41371c6674d4d8a2cd84fe37e3fbab4.png)
    2. [OBSプッシュ設定](#step1) の手順にしたがい、**プッシュ**ページの**サーバー**と**ストリームキー**の項目を設定します。プッシュが開始されると単独のファイルの繰り返し再生が可能です。


プッシュが完了すると、次の方法でプルして再生し、正常にプッシュされたかどうかを確認できます：
- PC端末では、[VLCプレーヤー](https://intl.cloud.tencent.com/document/product/267/32483)を使用したプルをサポートします。
- モバイル端末では、[MLVB](https://intl.cloud.tencent.com/zh/document/product/1071) SDKを使用して再生を実行することをサポートします。
>?MLVB SDKはCSSサービス（LVB）のモバイルシナリオでの拡張です。MLVBは、主にクラウド接続向けのライブブロードキャスト（LVB）サービスと比較して、RTMP SDKに基づく「迅速な統合ソリューション」を提供するだけでなく、標準ライブブロードキャスト（LVB）、ライブイベントブロードキャスト（LEB）、クラウドオンデマンド（VOD）、インスタントメッセージング（IM）、クラウドオブジェクトストレージ（COS）などのマルチクラウドサービスを統合した「オールインワンソリューション」を提供しています。
その中で、[ライブイベントブロードキャスト](https://intl.cloud.tencent.com/document/product/1071/41875)(Live Event Broadcasting、LEB)（超低遅延ライブブロードキャスト）は、超低遅延の再生シナリオにおける標準ライブブロードキャストプロトコルの拡張です。従来のライブブロードキャストプロトコルよりもディレーが低く、視聴者にミリ秒レベルのライブブロードキャスト視聴体験を提供します。eラーニング、スポーツイベントのライブブロードキャスト、オンライン質疑応答など、より高いディレーパフォーマンスを必要とする特定のシナリオのニーズを満たすことができます。





