LVBでは、ライブストリーミングの画面をレコーディングし、ファイルをVODの中に保存する機能を提供しています。VOD経由でレコーディングしたビデオには、ダウンロード、プレビューなどの処理が行えます。ここでは、レコーディングテンプレートの作成、バインド、バインド解除、修正および削除の方法をご紹介します。
レコーディングテンプレートの作成には次の2つの方法があります。
- LVBコンソールによるレコーディングテンプレートの作成。具体的な操作手順は、[レコーディングテンプレートの作成](#C_record)をご参照ください。
-  APIによるレコーディングテンプレートの作成。具体的なパラメータ、サンプル、説明については、 [レコーディングテンプレートの作成](https://intl.cloud.tencent.com/document/product/267/30845)をご参照ください。

## 注意事項
- レコーディングしたビデオファイルは、デフォルトで [VOD](https://console.cloud.tencent.com/vod/overview) コンソールに保存されます。事前にVODのサービスをアクティブ化し、またVOD関連のリソースパックを購入して、VODのサービスの支払い延滞による使用停止を回避することをお勧めします。詳細については、[VODクイックスタート](https://intl.cloud.tencent.com/document/product/266/8757)をご参照ください。
- レコーディング機能を有効にした後、VODサービスが正常な使用状態にあるのを確認してください。VODサービスが非アクティブ状態またはアカウントの支払い延滞によりサービス停止になるなどの状況が起きた場合は、ライブストリーミングに影響して、レコーディングができなくなります。この期間はレコーディングファイルとレコーディングの費用は発生しません。
- ライブストリーミングの過程では、レコーディング終了後5分前後で対応するファイルを取得できます。例えば、あるライブストリーミングを12:00からレコーディング開始した場合は、12:35前後に12:00 - 12:30の対応するフィルムを取得でき、後はこのように類推します。
- 音声/ビデオファイル形式（FLV/MP4/HLS）のコーディックタイプのサポート制限により、ビデオコーディックのタイプはH.264をサポートし、音声のコーディックのタイプはAACをサポートしています。
- レコーディングテンプレートの作成完了後、プッシュドメイン名と関連付けを行います。関連ドキュメントについては、 [レコーディング設定](https://intl.cloud.tencent.com/document/product/267/34224)をご参照ください。関連付け完了の約5分 - 10分後に有効となります。
- 生成されるレコーディングファイルの命名ルールを理解したい場合は、[レコーディングテンプレートパラメータ-VodFileName](https://intl.cloud.tencent.com/document/product/267/30767#RecordParam)をご参照ください。
- テンプレートのバインド、修正、バインド解除はいずれも更新後のライブストリーミングにのみ影響し、すでにライブストリーミング中にあるストリームは影響を受けません。ライブストリーミング中のストリームが新しいルールを使用するには、切断して再度プッシュする必要があります。


## 前提条件
- Tencent LVBサービスをアクティブ化し、[プッシュドメイン名](https://intl.cloud.tencent.com/document/product/267/35970)を追加済みであること。
- [VODサービス](https://intl.cloud.tencent.com/document/product/266/8757#.E6.AD.A5.E9.AA.A41.EF.BC.9A.E5.BC.80.E9.80.9A.E4.BA.91.E7.82.B9.E6.92.AD)をアクティブ化していること。

<span id="C_record"></span>
## レコーディングテンプレートの作成
1. LVBコンソールにログインし、【機能設定】>[【LVBレコーディング】](https://console.cloud.tencent.com/live/config/record)に入ります。
2. 【+】をクリックして基本情報を設定します。設定は以下のとおり行います。
![](https://main.qcloudimg.com/raw/93c0660fe1c5eaf8bfc2a72e7c7944dc.png)
   <table>
   <thead><tr><th>設定項目</th><th>設定の説明</th></tr></thead>
   <tbody><tr>
   <td>デフォルトのテンプレート</td>
   <td>LVBレコーディングファイルのデフォルトのテンプレートは、FLV、MP4、HLSの3タイプが選択できます。</td>
   </tr><tr>
   <td>テンプレート名</td>
   <td>LVBレコーディングのテンプレート名。カスタマイズ可能です（中国語、英語、数字、「_」、「-」のみ対応）。</td>
   </tr><tr>
   <td>テンプレートの説明</td>
   <td>LVBレコーディングのテンプレートの概要説明。カスタマイズ可能です（中国語、英語、数字、「_」、「-」のみ対応）。</td>
   </tr><tr>
   <td>レコーディングファイルタイプ</td>
   <td>ビデオレコーディングは、ライブストリーミングのオリジナルのビットレートをターゲットとしてレコーディングし、出力形式にはHLS、MP4、FLV、AACの4種類があります。そのうちAACは純音声レコーディングです。</td>
   </tr><tr>
   <td>1つのレコーディングファイルの長さ（分）</td>
   <td><ul style="margin-bottom:0px">
       <li> HLS形式の1つのレコーディングファイルのレコーディング時間は無制限です。連続レコーディングタイムアウトの時間を超えた場合はファイルを新規作成し、レコーディングを継続します。</li>
       <li>MP4、FLVまたはAAC形式でレコーディングする1つのファイルの長さ制限は5分 - 120分です。</li>
       </ul></td>
   </tr><tr>
   <td>ファイル保存時間（日）</td>
   <td>1つのレコーディングファイルの最大保存時間はいずれも1080日です。ファイル保存時間：0は、永久です。</td>
   </tr><tr>
   <td>連続レコーディングタイムアウト（秒）</td>
   <td>HLS形式のファイルのみプッシュ中断の連続レコーディングをサポートし、連続レコーディングタイムアウトの時間を0s - 1800sに設定できます。</td>
   </tr><tr>
   <td>サブアプリケーションにレコーディング</td>
   <td>VODの指定 <a href="https://console.cloud.tencent.com/vod/app-manage">するサブアプリケーション</a>にレコーディングする機能をサポートしています。デフォルトはアカウントのメインアプリケーションにレコーディングされ、書き込み状態が有効のサブアプリケーションのみ対応できます。</td>
   </tr>
   </tbody></table>
3. 【保存】をクリックすれば完了です。


<span id="conect"></span>
## ドメイン名の関連付け
1. LVBコンソールにログインし、【機能設定】>[【LVBレコーディング】](https://console.cloud.tencent.com/live/config/record)に入ります。
	- **ドメイン名の直接的関連付け：**左上にある【ドメイン名のバインド】をクリックします。
	![](https://main.qcloudimg.com/raw/bcb6c5da46a3455f94d441134e49825a.png)
	- **新規レコーディングテンプレート作成完了後のドメイン名関連付け：**[レコーディングテンプレートの作成](#C_record)の完了後、プロンプトボックスの中の【ドメイン名のバインドに進む】をクリックします。
	![](https://main.qcloudimg.com/raw/7f26a83d95d0f08ceda1b10e93e30389.png)
1. ドメイン名バインドのウィンドウの中で、バインドしたい**レコーディングテンプレート**および**プッシュドメイン名**を選択し、【OK】をクリックすればバインドが完了します。
![](https://main.qcloudimg.com/raw/a9411818457b4e708fd624f970d92ab6.png)

>? 【追加】をクリックして現在のテンプレートに複数のプッシュドメイン名をバインドする機能をサポートしています。

<span id="unite"></span>
## バインドの解除

1. LVBコンソールにログインし、【機能設定】>[【LVBレコーディング】](https://console.cloud.tencent.com/live/config/record)に入ります。
2. ドメイン名をすでに関連付けているレコーディングテンプレートを選択し、【バインド解除】をクリックします。
   ![](https://main.qcloudimg.com/raw/e8fe04a68c90675cc038ebd51b2d99f5.png)
3. 現在関連付けているドメイン名のバインド解除が行われるかを確認して、【OK】をクリックすればバインドが解除されます。
  ![](https://main.qcloudimg.com/raw/a666387f882584860eaf2c229c2b4769.png)

>? 
>- レコーディングテンプレートのバインド解除後、ライブストリーミング中のストリームには影響しません。
>- バインド解除を有効にしたい場合は、バインド解除後にストリームを停止して再度ライブストリーミングをプッシュしてください。新規ライブストリーミングにレコーディングファイルが生成されなくなります。


<span id="change"></span>
## テンプレートの修正
1. 【機能設定】>[【LVBレコーディング】](https://console.cloud.tencent.com/live/config/record)に入ります。
2. 作成済みのレコーディングテンプレートを選択し、右側の【編集】をクリックすれば、テンプレート情報の修正に入れます。
3. 【保存】をクリックすれば完了です。

![](https://main.qcloudimg.com/raw/68f4dd1a6452a3e97e7ff4dea6493d7b.png)

<span id="delete"></span>
## テンプレートの削除
1. 【機能設定】>【LVBレコーディング】に入ります。
2. 作成済みのレコーディングテンプレートを選択し、上方の削除ボタン![](https://main.qcloudimg.com/raw/220ada95a4b631349543cc8cde96226e.png)をクリックします。
3. 現在のレコーディングテンプレートが削除されるかを確認し、【OK】をクリックすれば削除が完了します。
![](https://main.qcloudimg.com/raw/e25f0566348f69e8c6afb64439c5e40f.png)

>! 
>- テンプレートがすでに関連付けされている場合は、先に[バインドの解除](#unite)を行ってから、削除操作を行うことができます。
>- コンソールのレコーディングテンプレートの管理はドメイン名の次元となり、現在はインターフェース関連付けの作成ルールを取り消しすることができません。レコーディング管理インターフェースの関連付けによってストリームを指定している場合は、[レコーディングルールの削除](https://intl.cloud.tencent.com/document/product/267/30843)を呼び出して、関連付けを解除する必要があります。 


## 関連する操作
**ドメイン名の次元のレコーディングテンプレートのバインド**と**バインド解除**の具体的な操作および関連説明については、[レコーディング設定](https://intl.cloud.tencent.com/document/product/267/34224)をご参照ください。


## 関連する質問
<span id="que1"></span>
#### LVBレコーディング後に生成されるビデオ名はどのようなルールで生成されますか？
コンソールで作成したレコーディングテンプレートにより、コールバック後に生成されるレコーディングファイルは、デフォルトでは接合方式による命名となっています。形式は次のとおりです。
`{StreamID}*{StartYear}-{StartMonth}-{StartDay}-{StartHour}-{StartMinute}-{StartSecond}*{EndYear}-{EndMonth}-{EndDay}-{EndHour}-{EndMinute}-{EndSecond} `

**このうち：**

| プレースホルダー             | 意味          |
| ------------------ | ------------- |
| {StreamID}         | ストリームID          |
| {StartYear}        | 開始時間-年   |
| {StartMonth}       | 開始時間-月   |
| {StartDay}         | 開始時間-日   |
| {StartHour}        | 開始時間-時 |
| {StartMinute}      | 開始時間-分 |
| {StartSecond}      | 開始時間-秒   |
| {EndYear}          | 終了時間-年   |
| {EndMonth}         | 終了時間-月   |
| {EndDay}           | 終了時間-日   |
| {EndHour}          | 終了時間-時 |
| {EndMinute}        | 終了時間-分 |
| {EndSecond}        | 終了時間-秒   |
