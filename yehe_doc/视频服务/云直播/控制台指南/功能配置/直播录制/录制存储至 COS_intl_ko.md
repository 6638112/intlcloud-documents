CSS를 사용하면 라이브 스트림을 녹화하고 녹화 파일을 VOD 또는 COS에 저장할 수 있습니다. 본문은 COS(Cloud Object Storage)에 녹화하는 방법을 보여줍니다.

## 주의 사항

1. COS에 녹화하려면 먼저 COS를 활성화해야 합니다. 연체료 결제로 인한 서비스 중단을 방지하기 위해 사전에 스토리지 패키지를 구입하는 것이 좋습니다. 자세한 내용은 [COS > 시작하기](https://intl.cloud.tencent.com/document/product/436/32955)를 참고하십시오.
2. 녹화 기능을 활성화한 후 COS 서비스가 정상 상태인지 확인하십시오. COS가 활성화되지 않았거나 연체로 인해 일시 중지된 경우 실시간 녹화에 실패합니다. 녹화 파일이 생성되지 않으며, 요금도 발생하지 않습니다.
3. 녹화 파일은 녹화 종료 후 약 5분 후에 사용 가능합니다. 예를 들어 라이브 방송 녹화를 12:00에 시작해서 12:30에 멈추면 12:35 경에 12:00 - 12:30에 해당하는 녹화된 영상을 받을 수 있습니다.
4. 녹화 템플릿을 생성한 후 푸시 도메인에 바인딩해야 합니다. 자세한 사용법은 녹화 구성을 참고하십시오. 템플릿은 바인딩 후 5 - 10분 후에 적용됩니다.
5. 혼합 스트림 녹화는 중국 본토 내부의 스트림과 외부 스트림의 혼합을 지원하지 않습니다. 그렇게 하면 오류가 발생하고 녹음 파일이 재생되지 않습니다.
6. CSS는 COS에 녹화 파일을 저장하기 위한 권한이 필요합니다. COS에 녹화 기능을 사용하기 전에 필요한 권한을 부여했는지 확인하십시오. 권한이 부족하여 COS에 녹화가 실패하면 비디오를 복구할 수 없습니다. 권한을 부여하는 방법은 COS에 녹화 파일을 저장하도록 CSS 권한 부여를 참고하십시오.
7. 녹화 시작 시 녹화 템플릿을 지정하지 않으면 녹화 파일이 VOD로 저장됩니다.

## 전제 조건

-  CSS를 활성화하고 [푸시 도메인](https://intl.cloud.tencent.com/document/product/267/35970)을 추가했습니다.
- [COS](https://intl.cloud.tencent.com/document/product/436/32955)를 활성화했습니다.

## 녹화 템플릿 생성

1. CSS 콘솔에 로그인하여 **기능 구성**>[**라이브 방송 녹화**](https://console.cloud.tencent.com/live/config/record) 페이지로 이동합니다.
2. COS에 저장을 선택합니다.
3. **템플릿 생성**을 클릭하여 다음 설정을 완료합니다.

<table>
   <thead><tr><th width="20%" colspan=2>구성 항목</th><th>설명</th></tr></thead>
   <tbody><tr>
   <tr>
   <td colspan=2>템플릿 이름</td>
   <td>라이브 방송 녹화 템플릿 이름을 자체 정의할 수 있습니다(중국어, 영어, 숫자, _, -만 지원).</td>
   </tr><tr>
   <td colspan=2>템플릿 설명</td>
   <td>라이브 방송 녹화 템플릿 소개 설명을 자체 정의할 수 있습니다(중국어, 영어, 숫자, _, -만 지원).</td>
   </tr><tr>   
   <td rowspan=3 width="10%">콘텐츠 녹화</td>
   <td width="30%">원본 스트림 녹화</td> 
   <td>이 옵션을 선택하면 트랜스코딩, 워터마크 추가, 스트림 믹싱 전에 비디오가 녹화됩니다. 이 옵션을 선택하면 WebRTC 스트림의 오디오를 녹음할 수 없습니다.</ul></td>
   </tr><tr>
   <td>워터마크를 포함한 녹화</td>
   <td>이 설정을 선택하면 워터마크 템플릿에 구성된 워터마크가 추가된 후 라이브 스트림이 녹화됩니다.</td>
   </tr><tr>
   <td>지정 트랜스코딩 스트림 녹화</td>
   <td>지정된 트랜스코딩 템플릿에 따라 트랜스코딩된 비디오를 녹화합니다. 기존 트랜스코딩 템플릿을 선택하거나 템플릿 이름을 클릭하여 구성을 수정할 수 있습니다. 구성된 템플릿이 삭제되면 워터마크와 함께 녹화됩니다.</td>
   </tr><tr>
   <td colspan=2>녹화 형식</td>
   <td>비디오는 HLS, FLV, MP4 및 AAC(오디오 전용) 형식으로 출력할 수 있습니다.</td>
   </tr>
   </tbody></table>

>! 
>- WebRTC 푸시 스트림 녹화 원본 스트림은 오디오가 손실되므로 다른 녹화 콘텐츠를 선택하는 것이 좋습니다.
>- 녹화 및 트랜스 코딩 스트림 기능은 현재 타임 시프트 시나리오의 사용을 지원하지 않습니다. 녹화 템플릿이 타임 시프트 설정과 연결된 경우 원래 스트림에 따라 녹화가 수행됩니다.
>- 지정된 트랜스 코딩 스트림 녹화에서 오디오 전용 트랜스코딩 템플릿을 선택하면 녹화 형식에서 오디오 형식만 선택할 수 있습니다.
>- 트랜스코딩 스트림을 녹화하려면 먼저 트랜스코딩 작업을 시작해야 하며, 별도의 트랜스코딩 비용이 발생합니다. 동일한 트랜스코딩 템플릿으로 재생하는 경우, 중복 과금되지 않습니다.

4. 녹화 내용을 선택하고 원하는 녹화 형식을 확인하면 관련 형식 설정 인터페이스가 나타납니다. 하나 이상의 녹화 형식을 선택하고 동시에 설정할 수 있습니다. 다음 설정을 수행하십시오.

<table><thead><tr><th width="27%" colspan=2>구성 항목</th><th>설명</th></tr></thead><tbody><tr><tr><td colspan=2>파일당 최대 녹화 시간(분)</td><td><ul style="margin-bottom:0px"><li>HLS 형식의 녹화 파일 길이에는 제한이 없습니다. 라이브 스트림이 중단되고 재개 제한 시간이 경과하면 녹화를 계속할 수 있도록 새로운 녹화 파일이 생성됩니다.</li><li>FLV 형식의 녹화 파일 최대 길이 값 범위는 1 - 720분입니다.</li><li>MP4 또는 AAC 형식의 최대 녹화 파일 길이 값 범위는 1 - 120분입니다.</li></ul></td></tr><tr><td colspan=2>녹화 재개 시간 초과(초)</td><td>HLS 형식만 푸시 중단 후 녹화 재개를 지원하며 재개를 위한 제한 시간 값 범위는 1s - 1800s입니다.</td></tr><tr><td colspan=2>저장 기간(일)</td><td><b>영구 저장</b>을 선택하여 녹화 파일을 영구적으로 저장하거나 <b>기간 지정</b>을 선택하여 저장 기간(최대 1500일)을 지정할 수 있습니다. 기간을 0으로 설정하면 녹화 파일이 영구 저장됩니다.</td></tr><tr><td colspan=2>저장 경로</td><td><li><b>COS</b>에서 생성한 Bucket을 선택합니다. 이 Bucket에 대한 CSS 액세스 권한을 부여했는지 확인하십시오.</li><li>Region은 선택한 COS Bucket의 리전 정보를 보여줍니다. 수정할 수 없습니다.</li></td></tr><tr><td colspan=2>백업 저장 경로</td><td>재해 복구 저장 경로를 활성화할 수 있으며, 네트워크 지터로 인해 녹화 파일을 기본 저장 경로에 저장하지 못한 경우 백업 경로를 사용합니다. 기본 경로가 복구되면 백업 경로에 저장된 녹화 파일이 자동으로 기본 경로에 업로드됩니다. 백업 및 기본 경로는 서로 다른 region에 있어야 합니다.</td></tr><tr><td colspan=2>폴더</td><td><li>기본 저장 폴더는 {RecordSource}/{Domain}/{AppName}/{StreamID}/{RecordId}/{StartYear}-{StartMonth}-{StartDay}-{StartHour}-{StartMinute}-{StartSecond}입니다.</li>
<li>{RecordSource}는 콘텐츠 유형을 나타냅니다. 원본 스트림이 기록된 경우 이것이 origin입니다. 트랜스코딩된 스트림이 기록된 경우 이것이 트랜스코딩 템플릿 id입니다.</li><li>{StartYear}: 시작 시간-년</li><li>{StartMonth}: 시작 시간-월</li><li>{StartDay}: 시작 시간-일</li><li>{StartMinute}: 시작 시간-분</li><li>{StartSecond}: 시작 시간-초</li><li>{Domain}: 푸시 도메인</li><li>{AppName}: 푸시 경로</li><li>{StreamID}: 스트림 ID</li><li>{RecordId}: CreateRecordTask API에서 반환되는 녹화 작업 id로 녹화 규칙 or 녹화 작업을 구분</li><li>「/」는 폴더 수준, 「-」는 일반 문자</li></td></tr></tbody></table>

5. **저장**을 클릭합니다.
>? 스트림은 기록되는 동안 업로드되므로 파일 이름에 종료 시간을 나타내는 필드가 포함되지 않습니다.

[](id:conect)

## 바인딩 도메인 이름

1. CSS 콘솔에 로그인하고 왼쪽 사이드바에서 **기능 구성** > [**라이브 방송 녹화**](https://console.cloud.tencent.com/live/config/record)를 선택한 후 COS에 저장을 클릭합니다.
   - **기존 템플릿에 도메인 바인딩:** 왼쪽 상단의 **도메인 이름 바인딩**을 클릭합니다.
   - **신규 녹화 템플릿 생성 완료 후 도메인 연결:** [녹화 템플릿 생성](#C_record) 완료 후 안내 창의 **도메인 바인딩**을 클릭합니다.

2. 도메인 바인딩 창에서 바인딩할 **녹화 템플릿**과 **푸시 도메인**을 선택하고 **확인**을 클릭하면 바인딩이 완료됩니다.

>? **추가**를 클릭하여 현재 템플릿에 여러 개의 푸시 도메인을 추가할 수 있습니다.

[](id:unite)

## 도메인 이름 바인딩 해제

1. CSS 콘솔에 로그인하고 왼쪽 사이드바에서 **기능 구성** > [**라이브 방송 녹화**](https://console.cloud.tencent.com/live/config/record)를 선택한 후 COS에 저장을 클릭합니다.
2. 도메인 이름으로 바인딩된 녹화 템플릿을 선택하고 대상 도메인 이름을 찾은 다음 **바인딩 해제**를 클릭합니다.
3. 현재 연결된 도메인의 바인딩 해제 여부를 확인하고 **확인**을 클릭하면 바인딩 해제가 완료됩니다.

>? 
>- 녹화 템플릿 바인딩을 해제해도 현재 라이브 방송 중인 스트리밍에는 영향을 주지 않습니다.
>- 바인딩 해제 적용이 필요한 경우, 해제 후 스트리밍을 중단하고 다시 푸시 스트리밍 라이브 방송을 시작하면 새로운 라이브 방송부터는 녹화 파일이 생성되지 않습니다.

## 템플릿 수정

1. **기능 구성** > [**라이브 방송 녹화**](https://console.cloud.tencent.com/live/config/record)로 이동하여 COS에 저장을 선택합니다.
2. 대상 녹화 템플릿을 선택하고 오른쪽 **편집**을 클릭하여 템플릿 정보를 수정합니다.
3. **저장**을 클릭합니다.

## 템플릿 삭제

1. CSS 콘솔에 로그인하고 왼쪽 사이드바에서 **기능 구성** > [**라이브 방송 녹화**](https://console.cloud.tencent.com/live/config/record)를 선택한 후 COS에 저장을 클릭합니다.

2. 생성된 녹화 템플릿을 선택하고 오른쪽 상단의 **삭제** 버튼을 클릭합니다.

3. 현재 녹화 템플릿의 삭제 여부를 확인하고 **확인**을 클릭하면 삭제가 완료됩니다.

>! 
>- 템플릿이 이미 연결되어 있는 경우, 먼저 [바인딩 해제](#unite)를 진행한 후 삭제할 수 있습니다.
>- 콘솔의 템플릿 관리에서는 현재 도메인 차원에서 연결 인터페이스 생성 규칙을 취소할 수 없습니다. 녹화 관리 인터페이스를 통해 지정한 스트림과 연결하고 있는 경우, [DeleteLiveRecordRule](https://intl.cloud.tencent.com/document/product/267/30843)을 참고하여 연결을 해제해야 합니다. 

## 관련 작업

도메인 관리 페이지에서 도메인과 녹화 템플릿을 **바인딩 해제** 및 **바인딩**할 수도 있습니다. 자세한 내용은 녹화 구성을 참고하십시오.
