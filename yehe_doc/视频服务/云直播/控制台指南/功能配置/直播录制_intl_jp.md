CSSでは、ライブストリーミングの画面をレコーディングし、ファイルをVODの中に保存する機能を提供しています。VOD経由でレコーディングしたビデオには、ダウンロード、プレビューなどの処理が行えます。ここでは、レコーディングテンプレートの作成、バインド、バインド解除、修正および削除の方法をご紹介します。
レコーディングテンプレートの作成には次の2つの方法があります。
- CSSコンソールによるレコーディングテンプレートの作成。具体的な操作手順は、[レコーディングテンプレート作成](#C_record)をご参照ください。
- APIによレコーディングテンプレートを作成します。パラメータおよびサンプルの詳細は[レコーディングテンプレート作成](https://intl.cloud.tencent.com/document/product/267/30845)をご参照ください。

## 注意事項
- レコーディングしたビデオファイルはデフォルトでは[VOD](https://console.cloud.tencent.com/vod/overview)コンソールに保存されます。事前にVODサービスを有効にしてVOD業務が料金不足で使用停止にならないようにしてください。詳細は[VODクイックスタート](https://intl.cloud.tencent.com/document/product/266/8757)をご参照ください。
- レコーディング機能を有効にした後、VODサービスが正常な使用状態にあることを確認してください。VODサービスが非アクティブ状態またはアカウントの支払い延滞によりサービス停止になるなどの状態が起きた場合は、ライブストリーミングに影響してレコーディングができなくなります。この期間はレコーディングファイルとレコーディングの費用は発生しません。
- ライブストリーミングの過程では、レコーディング終了後5分前後で対応するファイルを取得できます。例えば、あるライブストリーミングを12:00からレコーディング開始、12：30にレコーディング終了とした場合は、12:35前後に12:00 - 12:30の対応するフィルムを取得でき、後はこのように類推します。
- 音声/ビデオファイル形式（FLV/MP4/HLS）のコーデックタイプのサポート制限により、ビデオコーデックのタイプはH.264をサポートし、オーディオコーデックのタイプはAACをサポートしています。
- レコーディングテンプレートの作成が終わると、プッシュドメイン名と関連付けることができます。関連ドキュメントは[レコーディング設定](https://intl.cloud.tencent.com/document/product/267/34224)をご参照ください。関連付けができてから約5分～10分後に有効になります。
- 生成したレコーディングファイルの命名ルールを理解する必要がある場合は、[レコーディングテンプレートパラメータ-VodFileName](https://intl.cloud.tencent.com/document/product/267/30767#RecordParam)をご参照ください。
- テンプレートのバインド、修正、バインド解除はいずれも更新後のライブストリーミングにのみ影響し、すでにライブストリーミング中にあるストリームは影響を受けません。ライブストリーミング中のストリームが新しいルールを使用するには、切断して再度プッシュする必要があります。
- ミクスストリーミングのレコーディングは、レコーディングファイルエラーが発生し、通常の視聴と再生に影響を与えるため、中国内地（大陸）とグローバル/中国香港・マカオ・台湾のライブミクスストリーミングをサポートしていません。


## 前提条件
- Tencent Cloud CSSサービスがすでにアクティブになっていて、[プッシュドメイン名](https://intl.cloud.tencent.com/document/product/267/35970)を追加していること。
- すでに[VODサービス](https://intl.cloud.tencent.com/document/product/266/8757#.E6.AD.A5.E9.AA.A41.EF.BC.9A.E5.BC.80.E9.80.9A.E4.BA.91.E7.82.B9.E6.92.AD)を有効にしていること。

<span id="C_record"></span>
## レコーディングテンプレートの作成
1.CSSコンソールにログインして、【機能設定】>[【CSSレコーディング】](https://console.cloud.tencent.com/live/config/record)に進みます。
2. 【レコーディングテンプレート作成】をクリックしてテンプレート情報を設定します。以下の設定を行います。
![](https://main.qcloudimg.com/raw/74a4ac0636c59ff69c23437e72189567.png)
<table>
   <thead><tr><th>設定項目</th><th>設定説明</th></tr></thead>
   <tbody><tr>
   <td>デフォルトテンプレート</td>
   <td>CSSレコーディングファイルのデフォルトテンプレートのタイプは、FLV、MP4、HLSの3タイプから選択できます。</td>
   </tr><tr>
   <td>テンプレート名</td>
   <td>CSSレコーディングテンプレート名。カスタマイズ可能です（中国語、英語、数字、「_（アンダーバー）」、「-（ハイフン）」のみ対応）。</td>
   </tr><tr>
   <td>テンプレート説明</td>
   <td>CSSレコーディングテンプレートの説明。カスタマイズ可能です（中国語、英語、数字、「_（アンダーバー）」、「-（ハイフン）」のみ対応）。</td>
   </tr><tr>
   <td>レコーディングファイルのタイプ</td>
   <td>ビデオレコーディングは、ライブストリーミングのオリジナルのビットレートをターゲットとしてレコーディングし、出力形式にはHLS、MP4、FLV、AACの4種類があります。そのうちAACは純音声レコーディングです。</td>
   </tr><tr>
   <td>1つのレコーディングファイルの長さ（分）</td>
   <td><ul style="margin-bottom:0px">
       <li> HLS形式の1つのレコーディングファイルのレコーディング時間は無制限です。連続レコーディングタイムアウトの時間を超えた場合はファイルを新規作成し、レコーディングを継続します。</li>
       <li>MP4、FLVまたはAAC形式でレコーディングする1つのファイルの長さ制限は5分 - 120分です。</li>
       </ul></td>
   </tr><tr>
   <td>ファイルの保存期間（日）</td>
   <td>1つのレコーディングファイルの最大保存時間はいずれも1080日です。ファイル保存時間：0は、永久です。</td>
   </tr><tr>
   <td>連続レコーディングタイムアウト時間（秒）</td>
   <td>HLS形式のファイルのみプッシュ中断の連続レコーディングをサポートし、連続レコーディングタイムアウトの時間を0s - 1800sに設定できます。</td>
   </tr><tr>
   <td>サブアプリケーションにレコーティングします</td>
   <td>VODが指定する<a href="https://console.cloud.tencent.com/vod/app-manage">サブアプリケーション</a>へのレコーディングをサポートします。デフォルトではアカウントのメインアプリケーションにレコーディングします。ステータスの書き込みをアクティブにするサブアプリケーションのみをサポートします。</td>
   </tr>
   </tbody></table>
3. 【保存】をクリックすれば完了です。


<span id="conect"></span>
## ドメイン名の関連付け
1.CSSコンソールにログインして、【機能設定】>[【CSSレコーディング】](https://console.cloud.tencent.com/live/config/record)に進みます。
    - **ドメイン名の直接的関連付け：**左上にある【ドメイン名のバインド】をクリックします。
    ![](https://main.qcloudimg.com/raw/bcb6c5da46a3455f94d441134e49825a.png)
    - **新規レコーディングテンプレート作成完了後のドメイン名関連付け：**[レコーディングテンプレートの作成](#C_record)の完了後、プロンプトボックスの中の【ドメイン名のバインドに進む】をクリックします。
    ![](https://main.qcloudimg.com/raw/7f26a83d95d0f08ceda1b10e93e30389.png)
1. ドメイン名バインドのウィンドウの中で、バインドしたい**レコーディングテンプレート**および**プッシュドメイン名**を選択し、【OK】をクリックすればバインドが完了します。
![](https://main.qcloudimg.com/raw/a9411818457b4e708fd624f970d92ab6.png)

>? 【追加】をクリックして現在のテンプレートに複数のプッシュドメイン名をバインドする機能をサポートしています。

<span id="unite"></span>
## バインドの解除

1.CSSコンソールにログインして、【機能設定】>[【CSSレコーディング】](https://console.cloud.tencent.com/live/config/record)に進みます。
2.すでに関連付けしたドメイン名のレコーディングテンプレートを選択し、バインドを解除したいドメイン名を選択して右側の【バインド解除】をクリックします。
   ![](https://main.qcloudimg.com/raw/f7071a4b4f9297124b460ffebcba64d3.png)
3. 現在関連付けているドメイン名のバインド解除が行われるかを確認して、【OK】をクリックすればバインドが解除されます。
    ![](https://main.qcloudimg.com/raw/a666387f882584860eaf2c229c2b4769.png)

>? 
>- レコーディングテンプレートのバインド解除後、ライブストリーミング中のストリームには影響しません。
>- バインド解除を有効にしたい場合は、バインド解除後にストリームを停止して再度ライブストリーミングをプッシュしてください。新規ライブストリーミングにレコーディングファイルが生成されなくなります。


<span id="change"></span>
## テンプレートの修正
1. 【機能設定】>【CSSレコーディング】(https://console.cloud.tencent.com/live/config/record)に進みます。
2. 作成済みのレコーディングテンプレートを選択し、右側の【編集】をクリックすれば、テンプレート情報の修正に入れます。
3. 【保存】をクリックすれば完了です。

![](https://main.qcloudimg.com/raw/68f4dd1a6452a3e97e7ff4dea6493d7b.png)

<span id="delete"></span>
## テンプレートの削除
1. 【機能設定】>【CSSレコーディング】に進みます。
2. 作成済みのレコーディングテンプレートを選択して、上方の![](https://main.qcloudimg.com/raw/220ada95a4b631349543cc8cde96226e.png)削除ボタンをクリックします。
3. 現在のレコーディングテンプレートを削除するかどうか確認し、【OK】をクリックすれば削除が完了します。
![](https://main.qcloudimg.com/raw/c7c3e300488ba332b84bfd61da0fb999.png)

>! 
>- テンプレートがすでに関連付けされている場合は、先に[バインドの解除](#unite)を行ってから、削除操作を行うことができます。
- コンソールのレコーディングテンプレート管理はドメイン名のディメンションで、関連付けインターフェースが作成したルールの取り消しが一時的にできません。レコーディング管理インターフェースで指定したストリームの場合は、[レコーディングルールの削除](https://intl.cloud.tencent.com/document/product/267/30843)を呼び出して関連付けを解除する必要があります。 


## 関連操作
**ドメイン名のディメンションでのバインド**および**バインド解除**のレコーディングテンプレートについて、その操作と関連説明の詳細は、[レコーディング設定](https://intl.cloud.tencent.com/document/product/267/34224)をご参照ください。


## 関連する質問
<span id="que1"></span>

#### CSSレコーディング後に生成されるビデオ名はどのようなルールで生成されますか。
コンソールで作成したレコーディングテンプレートにより、コールバック後に生成されるレコーディングファイルは、デフォルトでは接合方式による命名となっています。形式は次のとおりです。
`{StreamID}*{StartYear}-{StartMonth}-{StartDay}-{StartHour}-{StartMinute}-{StartSecond}*{EndYear}-{EndMonth}-{EndDay}-{EndHour}-{EndMinute}-{EndSecond} `

**このうち：**

| プレースホルダー             | 意味          |
| ------------------ | ------------- |
| {StreamID}         | ストリームID          |
| {StartYear}        | 開始時間-年   |
| {StartMonth}       | 開始時間-月   |
| {StartDay}         | 開始時間-日   |
| {StartHour}        | 開始時間-時 |
| {StartMinute}      | 開始時間-分 |
| {StartSecond}      | 開始時間-秒   |
| {EndYear}          | 終了時間-年   |
| {EndMonth}         | 終了時間-月   |
| {EndDay}           | 終了時間-日   |
| {EndHour}          | 終了時間-時 |
| {EndMinute}        | 終了時間-分 |
| {EndSecond}        | 終了時間-秒   |
