Tencent Cloud CSSコンソールは、プルリツイートツールを提供します。ライブストリーミングソースにプッシュ機能がない場合やオンデマンドのビデオコンテンツをライブストリーミングの形式で配信する必要がある場合に、プルリツイートサービスはコンテンツをプルしプッシュする機能を提供します。CSSプッシュを必要とせず、既存のビデオ/ライブストリーミングを素早くプルし、ターゲットアドレスにプッシュすることができます。
![](https://main.qcloudimg.com/raw/8f0b044ce2104efdc1ed835287b9b683.png)

##  前提条件
1. [Tencent CSSサービス](https://intl.cloud.tencent.com/product/css)をアクティブ化しており、CSSコンソールにログインしていること。
- [プッシュプルドメイン名](https://intl.cloud.tencent.com/document/product/267/35970)を追加済みであること。

## 注意事項
- 最大**20**のプルリツイートタスクの作成をサポートします。
- プルリツイートサービスを使用すると、**プルリツイートタスク時間請求書**が作成されます。料金の詳細については、 [プルリツイート課金説明](https://intl.cloud.tencent.com/document/product/267/41059)をご参照ください。
- プルリツイート機能はコンテンツのプルおよびプッシュサービスのみを提供します。**コンテンツに権限が付与され、かつコンテンツの配信に関する法律、規制に準拠していることを確認してください。版権問題やコンテンツの規則違反がある場合、CSSは関連の機能サービスを停止し、法的責任を追及する権利を留保します**。
- プルリツイートのローカルモードは、**2022年11月23日0時**より正式に課金されます。詳しくは、[付加価値機能の料金](https://www.tencentcloud.com/document/product/267/51555)をご参照ください。

[](id:create)
## タスクの作成
1. **CSSツールボックス** > **[プルリツイート](https://console.cloud.tencent.com/live/tools/relay)**を選択します。**タスク作成**をクリックして、プルリツイートタスクの作成ページに入ります。
![](https://qcloudimg.tencent-cloud.cn/raw/f41c7a329a9fed7a901bca252a973f35.png)
2. 設定するタスクの基本情報を入力します。設定は以下のとおり行います：
![](https://qcloudimg.tencent-cloud.cn/raw/d10fb06aba921e27791441a112039586.png)

<table>
<tr><th width=15%>設定項目</th><th>設定説明</th></tr>
<tr>
<td>タスクノート</td>
<td>カスタムタスクの備考情報です。</td>
</tr><tr>
<td>タスク時間</td>
<td>デフォルトでは、<code>現在の時刻</code>から<code>現在の時刻+24時間</code>までとします。選択可能なタスク時間は、現在の時刻から1年以内の、任意時刻から7日以内です。<br>現在の時刻を2021年03月24日11:50:01とすれば、<ul style="margin:0"><li/>選択可能な時間は2022年03月24日11:50:01から2022年03月30日11:50:01までとなり、<li/>終了時刻が2022年03月30日11:50:01を超えることはできません。</ul></td>
</tr><tr>
<td>イベントコールバック通知</td>
<td>プルリツイートタスクイベントの受信に使用するコールバックアドレスを入力します。</td>
</tr></table>

3. コンテンツソースを入力します。リージョン地域を選択できます。
    - タスクの実行対象となる地域は以下を選択できます。中国国内のランダム地域、華北地区（北京）、華東地区（上海）、華南地区（広州）、アジア太平洋地区東南部（シンガポール）、アジア太平洋地区東南部（バンコク）、アジア太平洋地区東北部（ソウル）、アジア太平洋地区南部（ムンバイ）、香港・マカオ・台湾地区（中国香港）。
    - ランダム地域を選択すると、システムは自動的に最も近い地域を割り当てます。
4. コンテンツソースのタイプを選択します。選択可能なタイプには**ライブストリーミング**、**ビデオアドレスパス**、**画像**があります。具体的な設定は以下のとおりです：
 - コンテンツのタイプが**ライブストリーミング**の場合：
    - ライブストリーミングのソースアドレスを入力します（コンテンツソースのアドレスを**1つ**のみ入力できます）。
   ![](https://qcloudimg.tencent-cloud.cn/raw/6795d964f41e63fa90f0c09e3ddcf060.png)
    - 「バックアップを有効にする」を選択できます。バックアップを有効にした場合、プライマリがコンテンツをプルできなければ、自動的にバックアップに切替てコンテンツをプルします。プライマリがリカバリーした後、手動でバックアップからプライマリに切り替えてください。バックアップソースは、単一ビデオのループ再生のみをサポートします。
 - コンテンツのタイプが**ビデオアドレスパス**の場合：
    - **複数の**コンテンツソースアドレスを入力することができ、その上限は30です。
    - ループ再生回数を設定することができ、**無限ループ**または**ループ回数の指定**を選択できます。1回以上、100回以下で指定回数を選択します。
    - ビデオアドレスパスにMP4フォーマットのビデオがある場合、ローカルモードをオンにすれば、タスクはMP4オンデマンドファイルをタスクノードにキャッシングしてリレーしし、MP4ファイルをスムーズかつ安定して再生できます。
    ![](https://qcloudimg.tencent-cloud.cn/raw/cc30dc26f64d17f90f3e4fc76d2d9cd0.png)
 - コンテンツのタイプが**画像**の場合
    - 画像をアップロードするか画像のURLを入力できます。**プレビュー**をクリックすると画像が表示されます。
    - JPEG、JPG、PNG、BMP画像フォーマットをサポートします。URL入力の場合、画像のサイズが制限されません。アップロードする画像のサイズは2Mより小さくしてください。
 ![](https://qcloudimg.tencent-cloud.cn/raw/506182c6890e8f357177c78b190ff6db.png) 

>? 
>- タスクが設定したループ再生回数またはタスクの終了時間のいずれかの条件に達すると、システムがプルリツイートタスクを停止します。
>- タスク情報を修正したい場合：
   - ループ回数を変更した場合、更新後は新たなループ回数に従って再生され、現在の再生タスクは1回として記録されます。
   - ビデオアドレスパスとループ回数を変更する場合、直ちに更新するか再生後に更新するかを問わず、現在の再生タスクはループ回数としてカウントされず、新たなループ回数に従って再生されます。
   - ターゲットアドレスを変更する場合は、ループ回数がリセットされます。
>- ローカルモードが有効になっている場合、ローカルにキャッシュされたMP4ファイルをリレーすると、ローカルファイルのリレー時間に応じて付加価値機能の料金が計算されます。

5. 受信するコンテンツのターゲットアドレスを入力します。
   1. ターゲットアドレス入力欄下の**アドレスジェネレーター**をクリックし、アドレスジェネレーター設定ページに移動します。
   ![](https://qcloudimg.tencent-cloud.cn/raw/9724d77727e21ba1798485d03d6e3246.png)
   2. 既存のプッシュドメイン名を選択し、 Appname、StreamName および有効期限を入力します。**OK**をクリックし、プッシュアドレスを生成します。このアドレスはターゲットアドレス欄に自動的に入力されます。
   ![](https://qcloudimg.tencent-cloud.cn/raw/b1b6f0b832bacb15b281d71fc653afb0.png)
> !アドレスの有効期間をタスクの終了時間より以降に設定する必要があります。タスク開始後にターゲットプッシュアドレスを更新すれば、タスクが中断し改めてプッシュされます。

6.![](https://qcloudimg.tencent-cloud.cn/raw/b64d8a4343b3a1e340db3adb9002db60.png)ボタンをクリックし、ウォーターマークを有効にします。ウォーターマークは、PNG、JPG、GIFフォーマットをサポートします。
- ウォーターマークのタイプを選択します。カスタム画像アドレスと画像アップロードを選択できます。
    - **カスタム画像アドレス**を選択した場合、画像アドレスの入力ボックスにウォーターマーク画像のURLアドレスを入力し、プレビューをクリックすると、ウォーターマークプレビューに表示されます。
    - **画像アップロード**を選択した場合、画像をクリックで選択し、ウォーターマーク画像をアップロードします。視覚的な見やすさがアップするように、ウォーターマーク画像は、フォーマットがPNGで、サイズが2Mより小さい透明画像を使用することをお薦めします。
- ウォーターマーク画像の表示位置を設定します。以下の2種類の方法で位置を調整できます：
    - ウォーターマーク画像の設定欄上で画像の位置をドラッグします。
    - 表示位置のX軸方向とY軸方向を設定します。
    - **保存**をクリックすると、ウォーターマークの設定が完了します。
![](https://qcloudimg.tencent-cloud.cn/raw/a58673819adbc0d2dff5ecf25406816f.png)
>? 
>- コンテンツソースの情報を入力します。コンテンツソースが画像の場合、ウォーターマークの設定を有効にできません。
>- ウォーターマークを有効にすると、[トランスコーディング料金](https://intl.cloud.tencent.com/document/product/267/39604)が発生します。

7. 入力後に、**保存**をクリックして作成を完了します。

## タスクの管理
[](id:view)
### タスク詳細の確認
[タスクリスト](https://console.cloud.tencent.com/live/tools/relay)で、確認したいプルリツイートタスクを選択し、対応する`タスク備考/ ID`をクリックすると、右側のポップアップウィンドウにタスクの詳細情報が表示されます。
![](https://qcloudimg.tencent-cloud.cn/raw/c2bad33a6a735a218fa79b98f3738275.png)

>?タスクの詳細情報の下で編集、入力ソースの切替、再開、無効ボタンをクリックできます。

### タスク状態の確認
[タスクリスト](https://console.cloud.tencent.com/live/tools/relay)でタスクの状態を確認できます。確認したいプルリツイートタスクを選択し、対応する`タスクノート/ ID`をクリックすると、右側のポップアップウィンドウにこのタスクの実行状態が表示されます。

![](https://qcloudimg.tencent-cloud.cn/raw/cd498cb1fd678e39b0942383c278e82b.png)

<table>
<thead><tr><th>タスク状態</th><th>実行状態</th><th>意味</th></tr></thead>
<tbody><tr>
<td>未開始</td>
<td>インアクティブ</td>
<td>このタスクはまだタスク時間になっていません</td>
</tr><tr>
<td rowspan=2>有效</td>
<td>アクティブ</td>
<td>このタスクはタスク時間になり正常に動作しています</td>
</tr><tr>
<td>インアクティブ</td>
<td>このタスクはタスク時間になったが正常に動作していません</td>
</tr><tr>
<td>無効</td>
<td>インアクティブ</td>
<td>このタスクは無効になっています</td>
</tr><tr>
<td>期間切れ</td>
<td>インアクティブ</td>
<td>このタスクは終了時間を過ぎました</td>
</tr>
</tbody></table>

[](id:change)
### タスクの修正
1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay) で、作成したプルリツイートタスクを選択し、右側の操作欄で**編集**をクリックして、プルリツイートタスクの編集ページに遷移します。
![](https://qcloudimg.tencent-cloud.cn/raw/a0a83bf06f9b5ae9743b68b19e4c40cd.png)
2. 実際のニーズに応じてタスク情報を変更し、**保存**をクリックします。
 > - リージョンおよびコンテンツタイプは変更できません。
 > - タスク終了時間を変更する場合は、タスクが終了するまで、ターゲットアドレスが有効であることを確認してください。ターゲットアドレスを変更すると、タスクが中断し、その後再開されます。
 - ウォーターマークを変更した場合、ソースがライブストリーミングのタスクは直ちに反映され、ソースがオンデマンドライブストリーミングのタスクは次のファイルを再生する時に反映されます。ウォーターマークの変更により、再生中にカクカク動くことがあります。運用シーン：ウォーターマーク機能を備えていないサードパーティオリジンサーバーへのリレーに使用することをお薦めます。例えば、CSSにリレーする場合、CSSオリジンサーバーのウォーターマーク機能を使用することをお薦めします。
![](https://qcloudimg.tencent-cloud.cn/raw/d950a8029e1944e9029445dd8e428933.png)
3.  ポップアップした修正タスク確認ページで、修正前後の比較情報を表示します。
   - 変更した内容に**タスクノート、開始時間、終了時間、バックアップアドレス**が含まれた場合、比較情報に以下の例が表示されます：
![](https://qcloudimg.tencent-cloud.cn/raw/4cadcabeef99828ab4be144040cbfd19.png)
   - 変更したコンテンツに**ビデオアドレスパス**が含まれた場合は、変更前のソースがカスタムビデオパスのコンテンツであることが表示され、更新方法として**現在再生中のビデオが終了した後に更新**/**直ちに更新**を選択することができます。選択しない場合、デフォルトでは**現在再生中のビデオが終了した後に更新**とします。更新後、新しい順番で最初からプルリツイートを行います。
![](https://qcloudimg.tencent-cloud.cn/raw/9591b91b7e5e307860c9ea2244b4e14e.png)
    - 変更するコンテンツに**ターゲットアドレス**が含まれる場合、変更し修正するターゲットアドレスが表示され、修正後の現在のプルリツイートタスクが**中断後に再開**されることを確認します。
![](https://qcloudimg.tencent-cloud.cn/raw/0a7e04f65ae8bbdd9cb7ef3bc0ece656.png)
4. 情報が正しいことを確認し、**OK**をクリックすれば、タスクの内容が正常に変更されます。

[](id:copy)

### タスクのコピー
1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay) で、コピーするプルリツイートタスクを選択し、右側の操作欄で**コピー**をクリックして、プルリツイートタスクの作成ページに遷移します。
![](https://qcloudimg.tencent-cloud.cn/raw/28a0a3542ab9ab838d26dfc565f321d1.png)
2. 現在選択中のタスク情報が新たに作成されたタスクページに入力され、コピーした元のタスク情報で [修正](#create)を実行することができます。
3. **保存**をクリックすれば、新たなプルリツイートタスクが作成されます。

[](id:reboot)
### タスクの再開
タスクを再開した後、タスクの**ステータスは変更されません**。実行中のタスクは**最初から実行を開始します**。タスクを再開したい場合の具体的な操作は次のとおりです：

1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay)で、再開するプルリツイートタスクを選択し、右側の操作欄で**再開**をクリックします。
2. 現在のプルリツイートタスクを再開するかを確認し、**再開**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/d1b03e226297e44cbb7504d57c54af4f.png)

[](id:disable)
### タスクの無効化
タスクを無効にすると、**タスクは直接停止します**。タスクの実施を再開するには、[有効]（＃enable）にする必要があります。 タスクを無効にしたい場合の具体的な操作は次のとおりです：

1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay)で、無効にするプルリツイートタスクを選択し、右側の操作欄で**無効**をクリックします。
2. 現在のプルリツイートタスクを無効にするかを確認し、**無効**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/c3acfb89f425b50ba53a8d63075091d8.png)


[](id:enable)
### タスクの有効化
タスクを有効にすると、**タスクは新たに最初から開始されます**。 タスクを有効にしたい場合の具体的な操作は次のとおりです：

1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay)で、有効にする、無効になっているプルリツイートタスクを選択し、右側の操作欄で**有効**をクリックします。
2. 現在のプルリツイートタスクを有効にするかを確認し、**OK**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/77417a9c8406fe9d763c4d3960d98b21.png)

[](id:delete)
### タスクの削除
タスクの削除は**リカバリをサポートしていません**。タスクを削除する必要がある場合の具体的な操作は次のとおりです：

1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay)で、削除するプルリツイートタスクを選択し、右側の操作欄で**削除**をクリックします。
2. 現在のプルリツイートタスクを削除するかを確認し、**削除**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/44a15ad52bfc81f62c0aa907cdc7eb5c.png)

[](id:batch)
### バッチ操作
プルリツイートはタスクの一括削除、無効化および有効化をサポートしており、バッチ処理は**最大10個のタスク**をサポートします。
1.  [タスクリスト](https://console.cloud.tencent.com/live/tools/relay)で、一括処理するプルリツイートタスクを選択します。
2. 一括処理するプルリツイートタスクを選択して、**一括削除**、**一括無効**または**一括再開**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/7401eade6f5e04b9eadf71e04211f6e0.png)
3. 現在のプルリツイートタスクを削除/無効化/再開するかを確認し、ポップアップウィンドウで**削除**/**無効化**/**再開**をクリックして、一括処理を行います。
![](https://qcloudimg.tencent-cloud.cn/raw/5874636c548a4733281cd33eaca35abe.png)

   
## 期間が切れたタスクのクリアの設定

プルリツイートは定時的にタスクをクリアする設定をサポートします。作成上限に達してタスクの作成に失敗することを防ぐために、タスクが終了時間になると期間切れの状態になります。削除したタスクは復元できません。

1. **CSSツールボックス** > **[プルリツイート](https://console.cloud.tencent.com/live/tools/relay)**を選択します。**設定**をクリックします。
2.![](https://qcloudimg.tencent-cloud.cn/raw/7ed257d05a4283dc233ef406520187b4.png)ボタンをクリックして、定時クリアを有効にします。
3.実際のニーズに応じて、クリア間隔時間を変更します。選択できるクリア間隔時間は1～24時間です。
![](https://qcloudimg.tencent-cloud.cn/raw/4d579b1d0776ea22b5d994e3b7357ea3.png)