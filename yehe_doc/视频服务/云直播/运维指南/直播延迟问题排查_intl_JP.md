正常な場合、RTMPプロトコルでプッシュしてFLVプロトコルで再生すると、遅延は2秒～3秒前後です。長すぎる場合は、一般的に問題があります。ライブストリーミングに特に長い遅延時間が認められた場合は、次の方法に従い、原因調査を行うことができます。

### Step 1. 再生プロトコルのチェック

再生プロトコルに採用するのがHLS（m3u8）プロトコルの場合、遅延が比較的大きいと感じても、これは正常です。HLSプロトコルは、Apple社が中心となって推進する、粒度の大きいTSセグメントをベースとするストリームメディアプロトコルです。各セグメントの長さは通常5秒以上、セグメント数は一般的に3～4個となります。したがって総遅延時間は10秒～30秒前後です。

HLS（m3u8）プロトコルを使用する必要がある場合は、適宜セグメント数を削減または各セグメントの長さを短縮することによってのみ遅延を低減できますが、ラグ指標を総合的に考慮しないと影響が生じます。現在は、[チケットを提出](https://console.cloud.tencent.com/workorder/category)するか、またはTencent Cloudテクニカルサポートのエンジニアにご連絡いただき、調整を行うようになっています。

### Step 2. プレーヤー設定のチェック

Tencent CloudモバイルライブストリーミングSDKのプレーヤーは超高速、スムーズ、自動の3種類のモードをサポートしています。具体的な設定については、[ディレイの調節](https://intl.cloud.tencent.com/zh/document/product/1071/39888)をご参照ください。

- **超高速モード**：ほとんどのシナリオで遅延が2秒～3秒以内であることを保証できます。ビューティーショーにはこのモードが適しています。
- **スムーズモード**：ほとんどのシナリオで遅延が5秒以内です。ゲームのライブストリーミングなど、遅延には敏感ではないものの、スムーズさが要求されるシーンに適しています。

### Step 3. 可能なかぎりクライアントでウォーターマークを追加
Tencent Cloud CSSはクラウドでのウォーターマーク追加をサポートしていますが、ウォーターマークを追加すると規定外に1秒～2秒の遅延が発生します。ご使用になるのがTencent CloudモバイルライブストリーミングSDKの場合は、キャスター側Appでウォーターマークを直接追加する方法を選択できますので、クラウドでの追加が不要となり、ウォーターマークによる遅延を減らすことができます。

### Step 4. サードパーティのプッシュストリーミング装置を使用
Tencent Cloudの統合化したソリューションにおいてのみ理想的な効果の維持をお約束できます。使用するのがサードパーティのプッシュソフトウェアである場合は、Tencent CloudモバイルライブストリーミングSDKの[プッシュDemo](https://intl.cloud.tencent.com/zh/document/product/1071/38147)を使用して比較を行い、サードパーティのプッシュストリーミング装置のエンコードのバッファに大幅な遅延が発生する可能性を排除することをお勧めします。なぜなら、数多くのサードパーティのプッシュストリーミング装置は暴力的ともいえる無制限バッファの方式を採用して上り帯域幅不足の問題を解決しているからです。

### Step 5. OBS設定のチェック
採用しているのがOBSプッシュで、かつ比較的大きな再生側の遅延が認められた場合は、[OBSプッシュ](https://intl.cloud.tencent.com/zh/document/product/267/31569)の説明にしたがって対応するパラメータを設定することを推奨します。キーフレームの間隔は1秒または2秒に設定するように注意してください。

### Step 6. ライブイベントストリーミングに接続
上記のアドバイスでお客様の遅延に対する要求を満たすことができない場合は、Tencent Cloudライブイベントストリーミングに接続することをお勧めします。ライブイベントストリーミングは標準ライブストリーミングに比べて遅延がより少なく、ミリ秒レベルの究極のライブストリーミング視聴体験を提供することができます。具体的な内容は、[ライブイベントストリーミング]ドキュメントの紹介をご参照ください。
