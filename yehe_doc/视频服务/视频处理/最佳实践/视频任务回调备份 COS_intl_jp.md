Media Processing Service（MPS）を経たあと、MPSに発生したコールバックタスクを、SCFを介してCOSにすみやかにバックアップすることが標準的なスキームです。MPSでは、ユーザーが使用できるように、SCFの中でテンプレートを設定しています。MPSとSCFを使用していますが、このうちMPSは主にビデオ処理タスクに使用し、SCFはコールバックメッセージ処理を提供します。そしてCOSによって主にターミナルに永続的なストレージ機能を提供します。

## 操作手順
### 手順1：SCFの作成
1. [SCFコンソール](https://console.cloud.tencent.com/scf/list)にログインし、左側ナビゲーションバーから**[関数サービス](https://console.cloud.tencent.com/scf/list)**を選択します。
![](https://qcloudimg.tencent-cloud.cn/raw/d19e5af310ff9e75498bba4f7d63abc4.png)
2. 関数サービスのページの上方の**北京**リージョンを選択し、**新規作成**をクリックして関数の新規作成ページに進みます。
3. 次のパラメータ情報を下図のとおりに設定します。
  - **作成方式**：テンプレートの作成を選択します。
  - **あいまい検索**：「CLSメッセージをCOSにダンプ」と入力し、検索を行います。
![](https://qcloudimg.tencent-cloud.cn/raw/8b25b3314ee4ad6040a888b48e0ab889.png)
>? テンプレートの中の**詳細の表示**をクリックすると、ポップアップした「テンプレート詳細」のウィンドウに関連情報が表示され、ダウンロードの操作を行うことができます。
4. **次のステップ**をクリックして、関数設定ページに進みます。
![](https://qcloudimg.tencent-cloud.cn/raw/daf1fa4f6c4bb4f402a3db5826b46c9a.png)
5. デフォルトの設定を維持し、**完了**をクリックしてください。これで関数の作成が完了します。

### 手順2：MPSトリガーの設定
1. **[SCFコンソール](https://console.cloud.tencent.com/scf)**のページで、左側ナビゲーションバーから**[関数サービス](https://console.cloud.tencent.com/scf/list)**を選択し、対応する関数名をクリックすると、この関数の詳細ページに移動します。
2. **トリガーの管理**>**トリガーの作成**をクリックすると、トリガー作成のウィンドウがポップアップしますので、トリガーの方法に「MPSトリガー」を選択してください。
主要パラメータの情報は次のとおりです。その他の設定項目はデフォルトを維持してください。
  - **イベントタイプ**：MPSトリガーはアカウント次元のイベントタイプによってEvent（イベント）をプッシュします。現在はワークフロータスク（WorkflowTask）とビデオ編集タスク（EditMediaTask）の2種類のイベントタイプのトリガーをサポートしています。
>?
>- MPSトリガーの初回作成時には、関連サービスのロールステータスの異常が表示されます。プロンプトにしたがって対応するサービス**SCF_QcsRole**、**MPS_QcsRole**をクリックし、権限を与えてください。
- MPSトリガーはサービス次元で発生するイベントをイベントソースとし、リージョン、リソースなどの属性の区分はありません。各アカウントでは、2種類のイベントに対してそれぞれ関数を1つバインドすることが許されます。複数の関数にてタスクを処理する必要がある場合は、[関数間の呼び出しSDK](https://intl.cloud.tencent.com/document/product/583/32747)をご参照ください。
3. **サブミット**をクリックすると、MPSトリガーの設定が完了します。



### 手順3：関数機能のテスト
1. **[MPSコンソール](https://console.cloud.tencent.com/mps)** にてMPSのビデオ処理ワークフローを実行します。
2. **[SCFコンソール](https://console.cloud.tencent.com/scf/list?rid=8&ns=default)**に切り替え、実行結果を表示します。
関数の詳細ページで**ログのクエリー**のタグを選択すると、出力されたログ情報を見ることができます。下図のとおりです。
3. [COSコンソール](https://console.cloud.tencent.com/cos5)に切り替え、データのダンプおよび加工結果を表示します。

>?自身のニーズに基づき、具体的なデータの加工処理方法を編集することができます。
