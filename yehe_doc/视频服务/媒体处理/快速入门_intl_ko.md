## 작업 시나리오

이 문서는 MPS를 빠르게 이해하고 시작할 수 있도록 안내합니다. 기본 단계는 다음과 같습니다:

## 작업 단계

### 1단계: 가입 및 로그인

1. [Signing Up](https://intl.cloud.tencent.com/document/product/378/17985) 및 실명 인증을 완료합니다.
2. Tencent Cloud 공식 홈페이지에서 **클라우드 서비스** > **비디오 서비스** > [**MPS**](https://console.cloud.tencent.com/mps) 클릭하여 MPS 콘솔로 이동합니다.

### 2단계: 권한 관리

MPS(Media Processing Service)는 COS(Cloud Object Storage) 버킷에서 비디오를 다운로드하고 트랜스 코딩 후 COS 버킷에 파일을 업로드하려면 COS에 대한 읽기 및 쓰기 액세스 권한이 필요합니다. 따라서 MPS에 COS 액세스 권한을 부여하려면 서비스 역할을 생성해야 합니다.

아직 액세스 권한을 부여하지 않은 경우 [MPS 콘솔](https://console.cloud.tencent.com/mps)로 이동하고, **CAM으로 이동**을 클릭하여 액세스 권한 부여 페이지로 이동합니다.
![img](https://qcloudimg.tencent-cloud.cn/raw/29d478d02a8cfcc701ef9ab67daaea38.png)

>? 액세스 권한을 부여하기 전에는 MPS 콘솔에서 추가 작업을 수행할 수 없습니다.

### 3단계: 템플릿 설정

MPS 프로세스에는 멀티미디어 트랜스코딩, 워터마크 추가, 스크린샷 등의 작업이 필요합니다. 다른 템플릿을 설정하여 다양한 작업 출력 및 작업 방법을 제어할 수 있습니다. 콘솔 템플릿 관리로 이동하여 설정할 수 있습니다.

### 4단계: 스키마 생성

스키마는 사전 설정된 프로세스와 단계에 따라 bucket에 새로 업로드된 미디어 파일을 자동으로 처리할 수 있도록 도와주며, 스키마에서 트랜스코딩 규칙, 스크린샷 규칙, 처리 프로세스 및 콜백 알림 등의 콘텐츠를 설정할 수 있습니다.

1. [MPS 콘솔](https://console.cloud.tencent.com/mps)에 로그인하고, **워크플로-스키마 관리** 페이지로 이동합니다.

2. **스키마 생성** 버튼을 클릭하여 스키마 생성 페이지로 이동하고 스키마 이름, 트리거 Bucket, 트리거 디렉터리, 출력 Bucket, 출력 디렉터리, 구성 항목 및 이벤트 알림을 설정합니다. 자세한 설정 방법은 [스키마 구성 안내](https://intl.cloud.tencent.com/document/product/1041/48780)를 참고하십시오.
![](https://qcloudimg.tencent-cloud.cn/raw/984a8ce5935f4e0263abcf1d10b55227.png)

워크플로 생성 페이지에서 설정해야 하는 정보는 다음과 같습니다.

| 항목       | 필수 입력 여부 | 설명                                                     |
| :----------- | :------- | :----------------------------------------------------------- |
| 스키마 이름 | Yes       | 최대 128자 중국어, 영어, 숫자, 언더바 및 하이픈 ‘(_-)’을 지원합니다. 예시: ‘MPS’ |
| 트리거 Bucket  | Yes       | 현재 APPID로 생성된 Bucket을 선택하십시오. 워크플로가 활성화되면 이 Bucket에 업로드된 비디오가 자동으로 처리됩니다. |
| 트리거 디렉터리     | No       | 슬래시‘(/)’로 끝나는 문자열. 비워 두면 선택한 트리거 Bucket 아래의 모든 디렉터리에 워크플로가 적용됩니다. |
| 출력 Bucket  | Yes       | 기본적으로 출력 Bucket은 트리거 Bucket과 동일합니다. 동일한 APPID에서 동일한 리전의 Bucket을 선택할 수도 있습니다. 워크플로가 실행된 후 처리된 비디오는 이 Bucket에 저장됩니다. |
| 출력 디렉터리     | No       | 슬래시(/)로 끝나는 문자열. 비어 있으면 출력 디렉터리가 트리거 디렉터리와 동일합니다. |
| 이벤트 알림 | No       | 기본적으로 비활성화되어 있습니다. 이벤트 알림 설정 방법에 대한 자세한 설명은 [콜백 설정](https://intl.cloud.tencent.com/document/product/1041/33482#recall)을 참고하십시오. TDMQ-CMQ 이벤트 알림을 활성화하려면 [TDMQ](https://console.cloud.tencent.com/tdmq/cmq-queue?rid=1)를 활성화하고 모델을 생성해야 합니다. CMQ 이벤트 알림이 활성화된 후 지정된 CMQ는 MPS 이벤트에 대한 알림을 수신합니다. |
| 구성 항목       | Yes       | 트랜스코딩, 스크린샷 촬영, 애니메이션 이미지 생성, 심사, 콘텐츠 인식 및 콘텐츠 분석에서 구성할 작업을 하나 이상 선택합니다. |

| 콜백 메소드  | 구성                                                     |
| :------------ | :----------------------------------------------------------- |
| TDMQ-CMQ 콜백 | TDMQ-CMQ 모델: 큐 모델 또는 주제 모델을 선택할 수 있으며, 기본은 큐 모델입니다. TDMQ-CMQ 영역: 광저우, 상하이, 베이징, 상하이 금융, 선전 금융, 중국홍콩, 청두, 북미 또는 미국 서부. 큐 이름/주제 이름: 사용자 정의 값입니다. |
| HTTP 콜백     | 알림 구성 API [TaskNotifyConfig](https://intl.cloud.tencent.com/document/product/1041/33690#TaskNotifyConfig)를 호출할 때, NotifyType을 URL로, NotifyUrl을 HTTP 콜백 주소로 설정합니다. |
| SCF 콜백      | [SCF 콘솔로 이동](https://console.cloud.tencent.com/scf/list-create?rid=1&ns=default&keyword=mps)을 클릭하여 SCF 콘솔에서 콜백을 구성합니다. 자세한 지침은 [비디오 작업 콜백 공지](https://intl.cloud.tencent.com/document/product/1041/40337)을 참고하십시오. SCF 콜백 구성은 모든 워크플로에 적용되며 하나의 워크플로에 의해 특별히 저장되지 않습니다. |

### 5단계: 스키마 활성화

1. 스키마 생성 후 ‘스키마가 성공적으로 생성되었습니다’라는 알림 메시지가 표시됩니다. 그리고 생성된 스키마를 관리할 수 있는 스키마 관리 목록 페이지로 자동으로 리디렉션합니다.
2. 스키마는 기본적으로 비활성화되어 있습니다. 워크플로를 활성화하려면 활성화 열에서 상태 버튼을 클릭합니다. 활성화된 후에만 트리거 Bucket에 업로드된 비디오에서 스키마가 자동으로 실행됩니다.

### 6단계: 작업 시작

현재 작업을 시작하는 데 지원되는 세 가지 방법: API 작업 시작 인터페이스를 호출하고, 바인딩된 스키마의 COS 디렉터리에 비디오 파일을 업로드하고, **작업 관리** > [**작업 생성**](https://console.cloud.tencent.com/mps/tasks/create)을 통해 수동으로 작업을 생성합니다.

- **수동으로 작업 생성:**
  1. [작업 관리](https://console.cloud.tencent.com/mps/tasks) 페이지로 이동합니다.
  2. [작업 생성](https://console.cloud.tencent.com/mps/tasks/create)을 클릭하여 작업 생성 페이지로 이동합니다.
  3. 처리할 파일과 출력 경로를 선택하고 트랜스 코딩 매개변수를 지정합니다.
- **COS 비디오 자동 트리거:**
  1. 워크플로 활성화 후, [COS 콘솔](https://console.cloud.tencent.com/cos5) 왼쪽 사이드바에서 **버킷 리스트**를 클릭하여 ‘버킷 리스트’ 페이지로 이동합니다.
  2. 워크플로에서 설정한 트리거 Bucket을 찾아 해당 버킷 이름을 클릭하면 ‘파일 목록’ 페이지로 들어가게 되며, 처리해야 하는 비디오 파일을 업로드하면 MPS가 워크플로 설정에 따라 새로 업로드된 비디오를 자동으로 처리합니다.

>? 워크플로의 자동 실행은 워크플로가 활성화된 후 트리거 Bucket에 새로 업로드된 비디오 파일에 대해서만 적용되며, 이전에 트리거 Bucket에 저장된 파일은 처리되지 않습니다.

### 7단계: 관리 작업

1. [작업 관리](https://console.cloud.tencent.com/mps/tasks) 페이지로 이동하여 시작한 모든 작업의 ​​목록을 확인합니다.
2. 작업 상태, 작업 ID 등을 통해 처리해야 할 작업을 필터링할 수 있으며, 세부 정보 펼치기를 클릭하면 서브 작업 자체 정보를 볼 수 있습니다. 동시에 재시작 버튼을 클릭하면 대기 중인 작업을 재시작하고, 원본 비디오를 재생하는 등의 작업이 가능합니다.
3. 서브 작업 리스트를 펼치면 서브 작업 관련 정보를 볼 수 있으며 서브 작업 파일 재생/보기, 서브 작업 출력 파일 다운로드, 서브 작업 세부 정보 보기 등의 작업을 지원합니다.
![img](https://qcloudimg.tencent-cloud.cn/raw/74e5076bc92486b61de0cce1283d6d58.png)