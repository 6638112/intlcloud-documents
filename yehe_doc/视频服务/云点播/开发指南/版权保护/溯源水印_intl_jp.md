有料ビデオプラットフォームが抱える最大の問題点は、一部の会員ユーザーが様々な方法でビデオをダウンロードし、他のプラットフォームに違法に配布して共有または販売することで、著作権者の利益を著しく損なうという点です。
このような著作権侵害における主な形式が、ビデオの不正録画です。不正録画者はスクリーンキャプチャソフトを利用して録画を行ったり、カメラで直接撮影したりするため、防ごうとしても防ぎきれません。
不正録画への対応として最も有効な方法の一つが、不正録画者を追跡し、他の手段を併用して権益を保護し、不正録画を行う者を震え上がらせ、失われた利益を回収することです。
VODのトレーサビリティウォーターマークによって、低コストと高セキュリティを同時に実現し、不正録画防止のためのトレーサビリティによる障壁を簡単に構築することができます。

## 従来のトレーサビリティウォーターマークの欠点

従来のビデオ不正録画防止の方法は、ビデオ画面に視聴者のユーザーIDを表示するものです。主に**一般的な画像・テキストウォーターマーク**と**再生側フローティングウォーターマーク**という2種類の方式があります。

<table>
   <tr>
      <th width="0px" style="text-align:center">一般的な画像・テキストウォーターマーク</td>
      <th width="0px" style="text-align:center">再生側フローティングウォーターマーク</td>
   </tr>
   <tr>
      <td><img src="https://qcloudimg.tencent-cloud.cn/raw/82766338aee9f4f9715427e337babd25.png" width=500>ビデオトランスコードの際に、ビデオ画面にエンコードされる画像またはテキストウォーターマークです。テキストの内容はユーザーIDです。
</td>
      <td><img src="https://qcloudimg.tencent-cloud.cn/raw/69dbaf292d144094854efca31e51d922.png" width=500>
			プレーヤーでの再生の際にビデオレイヤー上に表示されるウォーターマークです。通常は電光掲示板形式で画面上を移動します。</td>
   </tr>
</table>
これらの2種類のウォーターマークには、安全性の面とコスト面でそれぞれ次のような特徴があります。

| ウォーターマーク付与方式 | 安全性 | コスト |
| -- | -- | -- |
| 一般的な画像・テキストウォーターマーク | 高い：ウォーターマークはビデオにエンコードされており、除去できません | 高い：個別のユーザーIDウォーターマークごとに1回ずつトランスコードし、それぞれ保存する必要があります |
| 再生側フローティングウォーターマーク | やや低い：ウォーターマークはプレーヤーのカバーレイヤーに付与され、ビデオ内にはエンコードされていません | 低い：VODプレーヤーに内蔵することで実現できます |

このように、従来の一般的な画像・テキストウォーターマークと再生側フローティングウォーターマークでは、高い安全性と低コストを同時に満たすことはできません。

## VODトレーサビリティウォーターマーク

### 原理
<img src="https://qcloudimg.tencent-cloud.cn/raw/ccfa5b05ef291a3a115ca336e8a9cbab.jpg" width=971>

VODのトレーサビリティウォーターマークには、ABストリームをベースにしたテクノロジーが用いられています。その原理は次のとおりです。

* 元のビデオをトランスコードしてAストリームとBストリームを出力し、分割します（ABストリームの違いはウォーターマークの位置の違いです）。
* CDNによって各端末ユーザーに対し、唯一無二のABストリームの組み合わせを作成します。
* 不正録画されたビデオからウォーターマークのABシリアルを抽出し、ウォーターマーク内のユーザーIDを抽出します。

### メリット

ABストリームをベースにしたトレーサビリティウォーターマークは、低コストと高い安全性を同時に満たすことができます。

* 低コスト：ビデオをAストリームとBストリームにトランスコードするだけのため、2回分のトランスコードと保存コストのみで、数十億の視聴者のマーキングと追跡が実現できます。
* 高い安全性：ウォーターマークはビデオ画面にエンコードされているため、ビデオを移動させても画面内に付与されたウォーターマークを消すことはできません。

## 使用方法

### トレーサビリティウォーターマークの付与

コンソールまたはAPIなどの方式により、画像ウォーターマークのウォーターマークテンプレートを作成します（注意：ウォーターマークの位置は画面の上半分にする必要があります）。
[ProcessMeidaインターフェース](https://intl.cloud.tencent.com/document/product/266/34125)を呼び出し、ビデオへのトレーサビリティウォーターマーク付与タスクを開始します（ビデオの長さは320秒以上必要です）。
* トランスコードの出力にトレーサビリティウォーターマークを付与する場合は、MediaProcessTask.TranscodeTaskSet.TraceWatermark.DefinitionにウォーターマークテンプレートIDを渡します。
* アダプティブビットレートストリーミングへの出力にトレーサビリティウォーターマークを付与する場合は、MediaProcessTask.AdaptiveDynamicStreamingTaskSet.TraceWatermark.DefinitionにウォーターマークテンプレートIDを渡します。

### ビデオの再生

ご自身のすべての有料顧客に、固有の8桁16進数の整数を関連付ける必要があり、これをuidと呼びます。これ以降、uidは視聴者へのトレーサビリティの根拠となります。

* VODの[Super Player](https://intl.cloud.tencent.com/document/product/266/33977)または[Super Player Adapter](https://intl.cloud.tencent.com/document/product/266/42095)をご使用の場合、業務サーバーは再生リクエスト1回ごとに[Super Player署名](https://intl.cloud.tencent.com/document/product/266/38099)を配布する必要があります。[署名パラメータ](https://intl.cloud.tencent.com/document/product/266/38099#.E7.AD.BE.E5.90.8D.E5.8F.82.E6.95.B0) のuidには視聴者のuidを入力します。
* VODのプレーヤーを使用しない場合は、[Keyリンク不正アクセス防止](https://intl.cloud.tencent.com/document/product/266/33986)の使用ルールに従い、URLの中のQueryStringにuidパラメータを追加する必要があります。パラメータには視聴者のuidを入力します。

### ウォーターマークの抽出

ビデオが不正録画された場合は、[チケットを提出](https://console.cloud.tencent.com/workorder/category)して、不正録画されたビデオファイルおよびウォーターマークテンプレートIDを提供します。VODは不正録画されたビデオから視聴者（不正録画者）のuidを抽出し、追跡を行います。

## 操作手順
トレーサビリティウォーターマークの付与と、視聴者ID抽出の流れについて、以下の簡単な5ステップでご説明します。
[](id:step1)
### ステップ1：ウォーターマークテンプレートの作成
1. [VODコンソール](https://console.cloud.tencent.com/vod)にログインし、左側ナビゲーションバーで**ビデオ処理設定**>**テンプレート設定**を選択し、上部のメニューバーから**ウォーターマークテンプレート**に進み、**ウォーターマークテンプレートの作成**をクリックします。
2. **ウォーターマークのタイプ**は画像ウォーターマークを選択します。ウォーターマーク画像をアップロードした後、**作成ボタン**をクリックします（注意：ウォーターマークの位置は画面の上半分にする必要があります）。
3. ここで作成したウォーターマークテンプレートを見ることができます。ウォーターマークテンプレートIDを記録しておきます。

[](id:step2)
### ステップ2：ビデオのアップロード

1. VODコンソールのナビゲーションバーで、**メディア資産管理**>**オーディオビデオ管理**を選択し、**オーディオビデオのアップロード**をクリックし、ビデオをアップロードします（説明：アップロードするビデオの長さは6分以上とすることをお勧めします）。
2. ビデオのアップロード完了後、アップロードしたビデオのIDを記録します。

[](id:step3)
### ステップ3：トレーサビリティウォーターマークの付与

1. ビデオ処理の[インターフェースドキュメント](https://intl.cloud.tencent.com/document/product/266/34125)を参照し、[API Explorer](https://console.cloud.tencent.com/api/explorer)によってアダプティブビットレートストリーミングタスクを開始します。このうち、
 * FileIdには**[ステップ2](#step2)**でアップロードしたビデオのビデオIDを入力します。
 * MediaProcessTask.AdaptiveDynamicStreamingTaskSet.Definitionには10を入力します。これは10仕様のアダプティブビットレートストリーミングへのトランスコードであることを表します。
 * MediaProcessTask.AdaptiveDynamicStreamingTaskSet.TraceWatermark.Definitionには**[ステップ1](#step1)**で作成したウォーターマークテンプレートIDを入力します。
2. タスクの実行完了後、コンソールのナビゲーションバーから**メディア資産管理**>**オーディオビデオ管理**と進み、ビデオを見つけて**管理**をクリックし、**ABS生成テンプレートリスト**から10テンプレートのアダプティブビットレートストリーミングを見つけ、**アドレスをコピー**をクリックし、再生URLを記録します。

### ステップ4：再生と撮影

1. **[ステップ3](#step3)**で取得した再生URLにQueryStringを追加します。パラメータ名はuidとし、パラメータは任意の8桁の16進数の整数（例えば1234abcd）とします。`http://xxx.vod2.myqcloud.com/xxx/xxx/xxx.m3u8?uid=1234abcd`のようなURLを取得し、リンクをブラウザのアドレスに貼り付けて再生します。
2. 携帯電話を使用して、ブラウザで再生中のビデオを撮影し（不正録画行為の再現）、ビデオファイルとして保存します。

### ステップ5：ウォーターマークの抽出

VODに[チケットを提出](https://console.cloud.tencent.com/workorder/category)し、**ステップ4**で抽出したビデオ、**[ステップ1](#step1)**で作成したウォーターマークテンプレートIDをご提供いただければ、こちらでそのビデオを再生する際に使用されたuidを抽出し、撮影者のIDへのトレーサビリティを実現できます。

## 料金関連

トレーサビリティウォーターマークを使用すると、主に次の料金が発生します。

* トランスコード料金：ビデオにトレーサビリティウォーターマークを付与する際は、トランスコードまたはアダプティブビットレートストリーミングへのトランスコードが必要なため、トランスコード料金が発生します。
* ストレージ料金：トランスコードまたはアダプティブビットレートストリーミングへのトランスコード出力を行うと、ストレージスペースを占有するため、ストレージ料金が発生します。
* 抽出料金：不正録画が発生した場合、[チケットを提出](https://console.cloud.tencent.com/workorder/category)して、不正録画者のID抽出をVODに依頼する必要があるため、抽出のための料金が発生します。

上記の料金の具体的な価格については、[購入ガイド](https://intl.cloud.tencent.com/document/product/266/14666)をご参照ください。
