UGC（ユーザーにより制作されたコンテンツ）およびPGC（プロにより制作されたコンテンツ）は、ビデオ業界ではよく見られる2つのシナリオで、ビデオ共有者がビデオコンテンツを自由にアップロードおよび共有することができます。

しかし、サードパーティのビデオプラットフォームでは、Appの普通のユーザーになりすまして、自身のビデオをアップロードして、ビデオの再生URLを自身のプラットフォームに配置することがあります。こうすると、彼らはプラットフォームに「寄生」して、ビデオの保存と再生のアクセラレーションを「無償」で得ることができます。その結果、ビデオプラットフォームは他人のビデオの温床と見なされるため、「悪意のあるビデオホスティング 」と呼ばれています。

パラサイトが生成するストレージ、再生の帯域幅、トラフィックのすべての費用は、App開発者が負担する必要があり、これは甚大な経済的損失になります。

## 悪意あるビデオホスティング問題が発生する原因
### UGCおよびPGCプラットフォームの一般的な相互作用
<img src="https://main.qcloudimg.com/raw/86d03658c0d7ad57220ae27eaf59b9a2.png" width="400"><br>

>?図中の矢印の向きはネットワークのリクエスト方向を示します。

UGC（またはPGC）のビデオプラットフォームでは、コンテンツプロバイダ、コンテンツ消費者、VODと以下の方法で対話します（手順1～3は [クライアントからのアップロード](https://intl.cloud.tencent.com/document/product/266/33921)をご参照ください）。

1. Appバックエンドはコンテンツプロバイダを認証します。認証が通過した後、ビデオアップロード署名を配布します。 
2. コンテンツプロバイダは共有するコンテンツをVODにアップロードします。
3. VODは、アップロードされたビデオのfileIdおよび再生URLなどの関連情報をAppバックエンドに通知します。
4. コンテンツ消費者は、Appバックエンドからビデオ再生URLをリクエストします。
5. コンテンツ消費者は、再生URLを介してVODからビデオをアクセラレーション再生します。

### 悪意のあるユーザーがビデオホスティングを実現する手口
<img src="https://main.qcloudimg.com/raw/b0a347b6dc42f3438fca5bf08e46b9f0.png" width="500"><br>
>?図中の矢印の向きはネットワークのリクエスト方向を示します。

悪意のあるサードパーティのビデオプラットフォームは、Appプラットフォームの普通のユーザーになりすまします。
- 初めに、ビデオプロバイダとして自身のビデオをVODにアップロードします（ステップ1およびステップ2）。
- 次いで、今度は消費者としてAppプラットフォームからビデオの再生アドレスを取得します（ステップ4）。
- 最後に、悪意のあるプラットフォームのユーザーが、これらの再生アドレスを取得して（ステップ4）、VODを通じてこれらのビデオをアクセラレーション再生します（ステップ5）。

### 問題を引き起こす主要原因

悪意のあるユーザーが獲物を探してビデオホスティングする根本的な目的は、他人のCDN帯域幅リソース（ストレージリソースを使用しながら）を盗用することです。悪意のあるユーザーが付け入る可能性のある主要原因は以下のとおりです。

* ステップ4：悪意のあるプラットフォームは、無制限にAppから素早くビデオの再生URLを取得して、保存し自身の消費ユーザーに配信します。
* ステップ5：悪意のあるプラットフォームの消費ユーザーは、ビデオの再生URLを取得した後、無制限にビデオをアクセラレーション再生できます。

## 悪意のあるビデオホスティング防止プラン

悪意あるビデオホスティング問題の主な原因に直面してのキーポイントは以下のとおりです。

* ステップ4の**ビデオ再生URLを無制限に取得**の防止。
* ステップ5の**ビデオを無制限にアクセラレーション再生**の防止。

以下、ビデオ URLの**再生**および**取得**を制限する方法をそれぞれご紹介します。

### ビデオURLの再生制限

VODの[Keyホットリンク防止](https://intl.cloud.tencent.com/document/product/266/33986) は 、URLから再生できる端末の数を制限する機能を提供し、1個のビデオURLが任意の数のクライアントの端末に配布され再生されるのを防止します。

ビデオ再生URLへの制御を実現するために、コンソールでホットリンク防止を有効にする必要があります。そして、ステップ4では、AppバックエンドでKeyホットリンク防止生成規則に従う必要があり（「ビデオ再生アドレスでの最大再生可能IP数」の [例](https://intl.cloud.tencent.com/document/product/266/33986#.E7.A4.BA.E4.BE.8B2.EF.BC.9A.E8.A7.86.E9.A2.91.E6.92.AD.E6.94.BE.E5.9C.B0.E5.9D.80.E6.9C.80.E5.A4.9A.E5.8F.AF.E6.92.AD.E6.94.BE-ip-.E6.95.B0)をご参照ください）、ホットリンク防止を生成して、URLの有効時間および再生が許容されるIP数を制限します。

### ビデオURLの取得制限

ビデオのアクセラレーション再生を制限するだけでは、ビデオホスティングを防止するには不完全です。ステップ4では、悪意のあるプラットフォームは同一のビデオに対して大量の異なるホットリンク防止URLをリクエストできるため、その後、自身のプラットフォームのユーザーに異なるURLを配布して、再生できるIP数の制限を回避します。

このため、Appのバックエンドはステップ4でユーザーのIDを識別する必要があり、同一ユーザーが指定時間内に同じビデオ再生URLを取得する回数を頻繁に制御して、悪意のあるユーザーが短時間にビデオ再生アドレスを大量に取得できないようにします。


