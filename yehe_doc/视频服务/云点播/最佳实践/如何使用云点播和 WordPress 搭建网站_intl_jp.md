## 概要

WordPressは有名なオープンソースのブログフレームワーク、そしてコンテンツ管理システムです。開発者のウェブサイト構築へのハードルを大きく引き下げ、ウェブサイト構築の効率を上げることができます。WordPressが提供するデフォルトソリューションを使用すれば、小型のウェブサイトなら数分で実行が可能です。しかし、ネットワークの持続的な運営につれて、画像およびオーディオビデオなどのメディアファイルへのアクセス速度、およびサーバーの帯域幅とストレージ容量の増加により、サイトは次第に負荷に耐えられなくなっていきます。サイトにとって重要な地位を占めるこれらのメディアファイルを、どのようにして適切に扱うのかが、サイトを長期運営するにあたり、避けて通れない問題となります。

### サイト構築に、なぜVideo on Demand（VOD）を使用すべきなのか

WordPressのデフォルトソリューションを使用して構築したウェブサイトが長期運営に向かない主な理由は、メディアファイルを直接サイトのサーバーに保存すると、以下の問題が発生するためです。
<table selecttype="cells" ><colgroup><col  ><col  ></colgroup>
<tbody>
<tr  ><th style="width:10px">番号</td>
<th>詳細</td>
</tr>
<tr  ><td>1</td>
<td>ウェブページから直接サーバー上のメディアファイルにアクセスすると、ビデオラグおよび画像のロードが遅くなる問題がおこりがちです。</td>
</tr>
<tr  ><td>2</td>
<td>ウェブサイトからメディアファイルにアクセスすると、サーバーの帯域幅を占めるため、帯域幅がいっぱいになりがちです。</td>
</tr>
<tr  ><td>3</td>
<td>メディアファイルのサイズは一般的に大きいため、ウェブサイトのコンテンツが豊富になるにつれ、サーバーのストレージ容量がいっぱいになりやすくなります。</td>
</tr>
<tr  ><td>4</td>
<td>サイトのサーバーを移行する際、メディアファイルの移行は困難です。</td>
</tr>
</tbody>
</table>

VODは、オーディオビデオおよび画像などのメディアにストレージを提供します。トランスコーディングおよび配信と再生のアクセラレーション機能などのクラウドサービスでは、ウェブサイトの構築に、以下のサポートを行います。
<table selecttype="cells" ><colgroup><col  ><col  ></colgroup>
<tbody>
<tr  ><th style="width:10px">番号</td>
<th>詳細</td>
</tr>
<tr  ><td>1</td>
<td>アップロードおよびストレージです。プラグインあるいはSDKを用いて、ファイルをVODにアップロードすることができます。その後、サーバーのストレージ容量を占有しません。サーバー移行時に、ファイルを誤って削除してしまうなどの問題を回避できます。</td>
</tr>
<tr  ><td>2</td>
<td>アクセラレーションアクセスです。VODはファイルのCDNアドレスを提供します。オーディオビデオおよび画像へのアクセス時に、ラグ現象を起こしません。サーバーの帯域幅も占有しません。</td>
</tr>
</tbody>
</table>


このほか、VODはアクセス制御、メディア処理およびインテリジェント審査などの機能も提供します。詳細はVODの[機能の概要](https://intl.cloud.tencent.com/document/product/266/49084)をご参照ください。

### VODのWordPressプラグイン

VODは、[WordPressプラグイン](https://wordpress.org/plugins/tencentcloud-vod/)を提供します。このプラグインをインストールし、簡単な設定をするだけで[VODサブアプリケーション](https://intl.cloud.tencent.com/document/product/266/33987)にバインドし、WordPress上のメディアファイルをVODにホスティングできます。VODが提供するCDNアドレスで、あなたのウェブサイト上のファイルにアクセスできます。現在、プラグインには以下の機能があります。

- VODサブアプリケーションのバインド。
- WordPressの管理端末にビデオファイルをアップロードすれば、自動でVODのサブアプリケーションにアップロードできます。
- 記事あるいはページ上にビデオを挿入する際は、自動でVOD上のビデオアドレスを使用します。

## 準備作業
### 1. VODサブアプリケーションの作成

VODサブアプリケーションは、リソース隔離の実装をサポートします。例えば、異なるサイトのメディアファイルをそれぞれ異なるサブアプリケーションに割り当て、単独で管理ができます。作成方法の詳細については[サブアプリケーションのアクティブ化](https://intl.cloud.tencent.com/document/product/266/33987#.E5.BC.80.E9.80.9A.E5.AD.90.E5.BA.94.E7.94.A8)をご参照ください。

### 2. WordPressウェブサイトの構築
実際の状況に基づいてソリューションを選択し、WordPressウェブサイトを構築します。
<dx-tabs>
::: 方法1（推奨）
Tencent Cloud LighthouseあるいはCloud Virtual Machine（CVM）のWordPressアプリケーションイメージで迅速にサイトを構築します。
:::
::: 方法2
[WordPress公式サイト](https://cn.wordpress.org/download/) にて最新バージョンのWordPressをダウンロードできます。 [公式インストールガイド](https://wordpress.org/support/article/how-to-install-wordpress/) の手動インストールをご参照ください。
:::
</dx-tabs>


## 操作手順

### ステップ1：プラグインのインストール

<dx-tabs>
::: 方式1
オンラインでインストールします（推奨）。検索ボックスで**tencentcloud-vod**を検索し、**今すぐインストール > 開始**をクリックします。

![オンラインでインストール](https://qcloudimg.tencent-cloud.cn/raw/1dea0a047d5df7dc67eedb907dbaf586.png)
:::
::: 方式2
ご自身でダウンロードの上、インストールします。[ダウンロードリンク](https://github.com/Tencent-Cloud-Plugins/tencentcloud-wordpress-plugin-vod/releases/latest/download/tencentcloud-wordpress-plugin-vod.zip) をクリックして、最新バージョンのプラグイン圧縮パッケージを取得の上、**プラグインをアップロード > ファイルの選択 > 今すぐインストール > プラグインの開始**をクリックします。

![手動インストール](https://qcloudimg.tencent-cloud.cn/raw/3e16ee19f1dcf3a5734e67e293e72f2f.png)
:::
</dx-tabs>


### ステップ2：プラグインの設定

WordPress左側ナビゲーションバーの**Tencent Cloud設定 > [VOD](https://intl.cloud.tencent.com/document/product/266/33897)**をクリックすると、VODプラグインの設定ができます。


設定の説明は下表をご参照ください。

| **設定項目**           | **説明**                                                     |
| -------------------- | ------------------------------------------------------------ |
| カスタマイズキー           | このオプションをオンにしない場合、プラグインは**Tencent Cloud設定**で設定されたキーを使用します。つまり、その他Tencent Cloudプラグインと同じキーを共用します。オンにする場合は、下記で指定するキーを使用します。 |
| SecretId、SecretKey  | アクセスキー情報です。[Tencent Cloud APIキー](https://console.cloud.tencent.com/cam/capi)に進んで作成と取得を行うことができます。 |
| SubAppID             | VODのサブアプリケーションIDです。準備中の作成するサブアプリケーションIDを入力すれば完了です。もしくは、VODの[アプリケーション管理](https://console.cloud.tencent.com/vod/app-manage)からも照会できます。 |
| アダプティブビットレートストリーミング変換を開始するかどうか | オンにすると、アップロード時にビデオに対し、アダプティブビットレートストリーミング変換を行います。詳しくはVODの[アダプティブビットレートストリーミング](https://intl.cloud.tencent.com/document/product/266/49258)をご参照ください。 |

設定完了後に、**設定を保存**をクリックすれば完了です。

### ステップ3：オンデマンドビデオのアップロードと使用
1. VODプラグインをオンにして設定を完了した後に、メディア資源データベースおよび記事またはページ編集時にアップロードされたビデオファイルは、自動でVODにアップロードされます。
2. 記事編集時のアップロードを例とします。下図に示すとおり、記事に「ビデオブロック」を挿入後、**アップロード**をクリックし、ビデオファイルを選択してアップロードします。次に、記事の右上隅の「プレビュー」をクリックし、記事のプレビューページを確認します。ビデオのURLを確認することで、この時に使用されているファイルが、VOD上のビデオであることがわかります。
![](https://qcloudimg.tencent-cloud.cn/raw/0d5cd195f0d9db5c0e4cb9161601823f.png)
3. 下図に示すように、左側で使用しているのはサーバー上のビデオで、右側はVODです。再生サーバーのローカルビデオは、帯域幅制限とCDNアクセラレーションサービスが無いために頻繁にラグを起こします。VODを使用すれば、これらの問題を容易に解決できます。
![](https://qcloudimg.tencent-cloud.cn/raw/c336d83417e255868fe58338413a9325.gif)

## 拡張
### HTTPSの使用

VODはデフォルトでHTTPプロトコルを使用します。HTTPSを使用する場合は、VODコンソールにてサブアプリケーションを選択し、その後に**システム設定 > 配信と再生の設定 > デフォルト配信設定**を開くと、**デフォルト配信プロトコルタイプ**でHTTPSに変更できます。
