インテリジェントコールド化は、オンデマンドのメディア資産管理機能に依存しています。当社は、VODサービスを使用する開発者のストレージコストを削減するために、メディアライフサイクル管理機能をリリースしました。開発者は、自分のビジネスの特徴に応じてユーザーのストレージコストを効果的に削減し、オンデマンドファイルのストレージタイプを所定のポリシーに従って、標準ストレージから低頻度ストレージ、アーカイブストレージ、ディープアーカイブストレージに引き下げ、自分のメディアファイルをよりフレキシブルに管理できるようになります。

## シナリオ
- **ライブeコマース**：ネットワークライブストリーミングのサービスプロバイダは、中国文化部の[「インターネット取引監督管理弁法」](http://gkml.samr.gov.cn/nsjg/fgs/202103/t20210315_326936.html)の要件に基づいて、オンライン取引におけるライブストリーミングビデオの保存期間を、ライブストリーミングが終了した日から3年以上としています。ライブストリーミングビデオはVODに保存され、ストレージタイプは標準ストレージになります。ビデオの一部は再試聴されず（またはほとんど再試聴されず）、関連部門による審査にのみ用いられます。メディア資産のインテリジェントコールド化機能は、お客様がストレージコストを効果的に削減するお手伝いをします。
- **低頻度アクセスメディアのコールド化**：ビデオポータル、ストリーミングメディア、UGCコンテンツ管理プラットフォームや、ユーザーが頻繁にアクセスや視聴をしないメディアの場合、直接オフラインにすることはできず、ストレージコストも高くなります。VODのメディア資産のインテリジェントコールド化機能は、アクセス回数を通じてメディアファイルのコールド化を行い、ストレージコストを効果的に削減するとともに、低頻度の視聴の要件を満たすこともできます。
- **メディアアーカイブ**：ニュースメディア・ラジオ・テレビ業界の場合、メディアファイルは高い適時性を持っています。通常、このようなメディアは長期間履歴データとして保存され、後日必要になったときに再検索して視聴します。視聴の適時性の要件は高くなくなります。このようなシーンでは、メディアをアーカイブストレージまたはディープアーカイブストレージに変更して、ユーザーのストレージコストを削減することができます。

## 前提条件
1. Tencent Cloudアカウントを[登録](https://intl.cloud.tencent.com/register?&s_url=https%3A%2F%2Fcloud.tencent.com%2F)して[ログイン](https://intl.cloud.tencent.com/login?s_url=https%3A%2F%2Fcloud.tencent.com%2F)し、アカウントの実名認証を完了していること。
2. Tencent Cloud VODサービスがアクティブ化されました。まだアクティブ化されていない場合は、[VODサービス](https://console.cloud.tencent.com/vod/overview)に移動してアクティブ化してください。
3. ポリシーの作成を行います。詳細については、[メディア資産コールド化](https://intl.cloud.tencent.com/document/product/266/42092)をご参照ください。

## 利用説明
ユーザーは、メディア資産機能の理解を深め、使いやすくするため、[ストレージタイプ](#type)、[データの取得および取得モード](#retake)、[ポリシー管理](#strategy)といった概念を理解する必要があります。
### ストレージタイプ[](id:type)
ユーザーのメディアファイルがVODで保存されるときのストレージタイプです。VODは、標準ストレージ、低頻度ストレージ、アーカイブストレージ、ディープアーカイブストレージといったストレージタイプを提供します。その特性を次の表に示します。

| ストレージタイプ   | 標準ストレージ | 低頻度ストレージ | アーカイブストレージ  | ディープアーカイブストレージ   |
| ------ | ---- | ---- | ----- | -------- |
| VODデフォルト  | はい    | いいえ    | いいえ     | いいえ        |
| ストレージコスト  | 高い    | 中程度    | 低い     | 極めて低い       |
| アクセス性能  | 高い    | 低い    | アクセスサポートなし     | アクセスサポートなし       |
| データ取得料金 | なし    | なし    | あり | あり    |
| サポートリージョン   | すべて   | すべて   | すべて    | 北京、上海、重慶 |

標準ストレージは、VODのデフォルトのストレージタイプです。CSSレコーディングやさまざまなアップロード方法、MPSタスクによって発行されたファイルはすべて標準ストレージです。

| 属性 | 高から低への対比 |
|---------|---------|
| ストレージコスト | 標準ストレージ>低頻度ストレージ>アーカイブストレージ>ディープアーカイブストレージ |
| アクセスパフォーマンス | 標準ストレージ>低頻度ストレージ |
>?
>- アーカイブストレージとディープアーカイブストレージは直接アクセスをサポートしていないため、まず取得操作を行う必要があります。VODは、ユーザーによる**標準ストレージ**への取得のみをサポートします。
>- アクセスパフォーマンスは、ビデオを視聴する際の**最初の画面時間、ラグ率**などの指標に影響を与えるため、**頻繁にアクセスするオンラインビジネスの場合、ユーザーがストレージタイプを変更することはお勧めしません**。

VODは、さまざまなストレージタイプをサポートして変更を行います。許可されるストレージタイプの変更は次のとおりです。

| ソースストレージタイプ  | ターゲットストレージタイプ           |
| ------ | ---------------- |
| 標準ストレージ | 低頻度ストレージ、アーカイブストレージ、ディープアーカイブストレージ |
| 低頻度ストレージ   | 標準ストレージ、アーカイブストレージ、ディープアーカイブストレージ |
| アーカイブストレージ   | 標準ストレージ             |
| ディープアーカイブストレージ | 標準ストレージ             |
>?
>-アーカイブストレージとディープアーカイブストレージを標準ストレージ以外の他のストレージタイプに変更する場合は、まず標準ストレージに変更してから、最終的なターゲットストレージタイプに変更する必要があります。
>-ストレージタイプの変更は、FileIdを粒度とします。すなわち、オリジナルファイルとMPSファイルのストレージタイプは同じであり、FileId下の一部ファイルに対するストレージタイプの個別指定はサポートされていません。

### データの取得および取得モード[](id:retake)
#### データの取得
メディアをアーカイブストレージまたはディープアーカイブストレージに変更した場合、再生・MPSの開始などを含む、直接アクセスができなくなります。アクセスする必要がある場合は、上記で紹介したストレージタイプの変更操作を使用することができます。ただし、開発者が短時間でアクセスする必要があり、アクセスが終了した後も、メディアがアーカイブストレージまたはディープアーカイブストレージのステータスを維持できるように希望する場合は、上記の方法は適していません。このような場合、オンデマンドでデータの取得機能を提供しています。

VODは、アーカイブストレージとディープアーカイブストレージという2つの取得操作をサポートしています。取得には、永続的な取得と指定期間中の取得があります。

| アーカイブストレージ/ディープアーカイブストレージの操作 | ストレージタイプの変更   | 取得       |
| ------------------- | -------- | -------- |
| 適時性                 | 非同期       | 非同期       |
| モード                  | 超高速/標準/バッチ | 超高速/標準/バッチ |
| 有効期間                 | 永続的       | 指定期間     |
| レプリカの作成                | いいえ        | はい        |

1. 取得した後、VODは、ストレージタイプが標準ストレージであるメディアのレプリカを発行します。
2. 取得したレプリカには有効期間（単位は日数）があります。有効期間中はメディアへのアクセスが許可されます。有効期間が終了すると、レプリカは自動的にクリーンアップされ、それ以降はメディアへのアクセスは許可されなくなります。
3. レプリカの有効期間中は、対応する標準ストレージ料金が追加で発生します。
4. レプリカの有効期間中は取得操作を再度開始することはできません。

#### 取得モード
アーカイブストレージおよびディープアーカイブストレージに対するストレージタイプの変更や取得操作には、複数のモードがあります。それぞれのモードの最終的な効果は同じですが、速度と料金（取得料金）が異なります。

| 取得モード | アーカイブストレージ取得時の消費時間 | ディープアーカイブストレージ取得時の消費時間 |
| ---- | -------- | ---------- |
| 超高速モード | 5分      | サポートなし        |
| 標準モード | 5時間      | 24時間        |
| バッチモード | 12時間      | 48時間        |
>?
>- 1つのメディア（1つのFileIdで表されるもの）のストレージには多くのファイル（オリジナルファイル、トランスコードファイル、スクリーンキャプチャファイルなど）が含まれ、各ファイルの実際の解凍完了時間は前後する場合があります。VODは各ファイルの具体的な解凍完了状況を管理するのではなく、メディアを一体とみなして、解凍にかかる可能性のある最大時間によってメディアの解凍完了時間を一括計算しています。この時間より前に、メディア内のすべてのファイルが実際には解凍完了した場合でも、メディアは未解凍状態と表示され、アクセスは許可されません。
>- メディアが解凍済みと表示される時点は実際に解凍された時点より遅くなる場合があるため、メディアの解凍レプリカの利用可能時間は予想より短くなる場合があります。解凍後のレプリカの利用可能時間を十分に確保するため、ディープアーカイブストレージを解凍する際は有効期間をもう1日追加しておくことをお勧めします。

### ポリシー管理[](id:strategy)
VODは、開発者が大量のメディアのライフサイクルを一元管理しやすくするため、メディア資産情報とメディアファイル再生統計データを組み合わせて、ポリシーベースのインテリジェント管理システムを開発しました。

VODバックエンドは、管理タスクを毎日実行し、指定されたポリシーを満たすメディアのストレージタイプを変更します。
#### ポリシー機能
##### フィルタリングの組み合わせ
ポリシーによって、開発者は一連の条件を指定し、すべての条件を**同時に**満たすメディアのストレージタイプを変更することができます。具体的なフィルタリング条件は次のとおりです。
- ビデオメディア、オーディオメディア、画像メディアなど、メディアの種類をフィルタリング条件とします。
- メディアの作成日をフィルタリング条件とします。次のいくつかの形式があります。
 - 指定された日付より前に作成されたファイル。
 - 指定された日付より後に作成されたファイル。
 - 指定された2つの日付の間に作成されたファイル。
 - 指定された日数より前に作成されたファイル（現在の日付に応じて動的に変更されます）。
 - 作成時間は無制限です（すべてのメディアがこの条件を満たします）。
- メディアのカテゴリーIDをフィルタリング条件とします。複数のカテゴリーIDを同時に指定することも、制限を設定しないこともできます（すべてのメディアがこの条件を満たします）。
- メディアのソースタイプをフィルタリング条件とします。これには、CSSレコーディング、アップロード、ビデオ編集、その他などが含まれます。複数のソースタイプを同時に指定することも、制限を設定しないこともできます（すべてのメディアがこの条件を満たします）。
- メディアの最近の再生時間をフィルタリング条件とします。過去数日間に数回未満しか再生されていないメディアをフィルタリングします。また、制限を設定しないこともできます（すべてのメディアがこの条件を満たします）。

##### ポリシーの無効化
ポリシーが作成されると自動的に有効になり、開発者は必要に応じてポリシーを無効化することができます。無効化されたポリシーは、再び有効にされるまで、翌日から管理タスクにおいて無視されます。
>?ポリシーが無効化された後、そのポリシーがその当日の管理タスクで有効になる場合も、有効にならない場合もあります。

#### 制限
最大10件のポリシーを設定できます。
ポリシーの優先度を指定することはできません。1つのメディアが複数のポリシーに同時にヒットした場合、優先度はターゲットストレージタイプに応じて自動的に決定されます。高から低への優先度としては、ディープアーカイブストレージ>アーカイブストレージ>低頻度ストレージです。

## VODによるインテリジェントコールド化ポリシーの設定
### 手順1：コールド化ポリシーの作成
[VODコンソール](https://console.cloud.tencent.com/vod/media)（非管理者）の左側ナビゲーションバーで、【メディア資産管理】>【メディア資産コールド化】と選択し、【インテリジェントコールド化ポリシー】をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/8c2143b18f7b88b715b3881e25062e9b.png)

### 手順2：コールド化ポリシーの設定
![](https://qcloudimg.tencent-cloud.cn/raw/54b2b7b0bc76bea32f58bb347d7542b5.png)
ユーザーのニーズに応じてコールド化ポリシーを設定します。
例：図に示すように、30日以内にメディアのビデオ再生回数が300回未満の場合、低頻度のコールド化ポリシーがトリガーされます。VODは、すべてのルールを満たすメディアを選択してコールド化を行います。

### 手順3：設定の有効化の確認
![](https://qcloudimg.tencent-cloud.cn/raw/098381b8a25eb591445aefc642c5447e.png)
