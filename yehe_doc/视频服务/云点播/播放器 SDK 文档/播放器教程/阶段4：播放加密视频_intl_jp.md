## 学習目標

本段階のチュートリアルを学習すると、ビデオを暗号化し、プレーヤーを使用して暗号化後のビデオを再生する方法を理解、把握することができます。

お読みになる前に、プレーヤーガイドの[第1段階：プレーヤーを使用したビデオ再生](https://intl.cloud.tencent.com/document/product/266/38098)と[第2段階：リンク不正アクセス防止後のビデオ再生の有効化](https://intl.cloud.tencent.com/document/product/266/38292)の部分をすでに学習しているか確認してください。このチュートリアルでは、[第1段階](https://intl.cloud.tencent.com/document/product/266/38098)でアクティブ化したアカウントとアップロードしたビデオを使用して、[第2段階](https://intl.cloud.tencent.com/document/product/266/38292)に従ってリンク不正アクセス防止を有効にする必要があります。

[](id:step1)
## 手順1：ビデオの暗号化
1. VODコンソールにログインし、**メディア資産管理**>[**ビデオ管理**](https://console.cloud.tencent.com/vod/media)を選択し、処理するビデオ（FileId：528xxx3757278095）にチェックを入れて、**ビデオ処理**をクリックします。
2. ビデオ処理の画面で：
 - **処理タイプ**は**タスクストリーミング**を選択します。
 - **タスクフローのテンプレート**は**SimpleAesEncryptPreset**を選択します。
<img src="https://qcloudimg.tencent-cloud.cn/raw/810b84b193ad96be992810e3877b1ac7.png" width="" style="zoom:80%;" /><span>
>?
>- SimpleAesEncryptPresetはプリセットのタスクフローです。テンプレート12のアダプティブビットレートストリーム、テンプレート10のスクリーンキャプチャによるタイトル画像作成、テンプレート10のキャプチャしたスプライトイメージを使用します。
>- テンプレート12のアダプティブビットレートストリーミングはトランスコーディングして暗号化したマルチビットレートによる出力です。
3. **OK**をクリックし、[オーディオビデオ処理](https://console.cloud.tencent.com/vod/task)リストの「タスクステータス」が「処理中」から「完了」に変われば、ビデオの処理が完了したことを表します。
![](https://qcloudimg.tencent-cloud.cn/raw/da5e02a95cf19cae9146e009874ccf55.png)
4. ビデオの「操作」欄の下の**管理**をクリックし、管理画面に入ります：
 - 「基本情報」タブを選択すると、生成したカバー画像、および暗号化したアダプティブビットレートストリーミングの出力（テンプレートID：12）が表示されます。
 - 「スクリーンキャプチャ情報」タグを選択すると、生成したスプライトイメージ（テンプレートID：10）を見ることができます。

[](id:step2)
##  手順2：プレビューによる再生体験

前の手順で、ビデオをすでにアップロードし、ビデオに対する処理を行いました。ここでは、3種類の端末のプレーヤーを使用して、再生結果を素早く体験します。

1. **メディア資産管理**>[**メディア資産管理**](https://console.cloud.tencent.com/vod/media)を選択し、**ステップ1**でアップロードして処理したビデオを探し、「操作」バーの下にある**管理**をクリックし、**プレーヤープレビュー**を選択します。
2. **プレーヤー設定**はbasicDrmPresetを選択します。
<img src="https://qcloudimg.tencent-cloud.cn/raw/60418fcab52a70fc2fbcf7056f7929f2.png" width="622" />
>? basicDrmPresetはプリセットのプレーヤー設定で、テンプレート12を再生してアダプティブビットレートストリーミングに変換して出力する際や、テンプレート10でスプライトイメージをキャプチャして出力する際に使用します。
3. デフォルトの配信ドメイン名がリンク不正アクセス防止を有効にしているため、**再生制御**のタブは、プレビュー時のリンク不正アクセス防止の有効期限、トライアル視聴時間の長さなどの選定をサポートしています。ここではデフォルトのパラメータを維持できます（再生リンク不正アクセス防止の有効期限はデフォルトで1日で、トライアル視聴時間の長さ、最大再生可能IP数は記入不要です）。
 <img src="https://qcloudimg.tencent-cloud.cn/raw/5968a5d6428bff9c3e3e0e1d4ce7431e.png" width="622" />
4. **Webプレーヤー**の中で、プレーヤーの中央のボタンをクリックすると、Web端末での再生が体験できます。
<img src="https://main.qcloudimg.com/raw/976ec23a988bcb494c4b225e635a5dba.png" width="522" />
5. **モバイルプレイヤー**の中で、**QRコードをスキャンしてダウンロードする**をクリックして、「Tencent Cloud Toolkit」をインストールします。
<img src="https://qcloudimg.tencent-cloud.cn/raw/f0e72b414ee3dc8084dda39d8a5d5c91.png" width="522" />
6. 携帯電話でTencent Cloudツールキットを開き、**プレーヤー**を選択し、右上隅のスキャンコードをクリックすると、モバイル端末で再生を体験できます。
 <img src="https://qcloudimg.tencent-cloud.cn/raw/06e77f14c2e1020e8936ce1ab30a6ca3.png" width="422" />

[](id:step3)
## 手順3： Demoを使用して検証

暗号化したビデオを再生できるようにするには、プレーヤーで有効期間内の署名を使用する必要があります。以下、署名ツールを使用して素早く署名を発行する方法をご紹介します。

1. [プレーヤー - 署名発行ツール](https://vods.cloud.tencent.com/signature/super-player-sign.html)のページを開き、パラメータを入力します。
 - **ユーザーappId**：ビデオが属するappId：1400xxx357を入力します（サブアプリケーションが使用される場合は、サブアプリケーションのappIdを入力します）。
 - **ビデオfileId**：ビデオのFileId：528xxx3757278095を入力します。
 - **現在のUnixタイムスタンプ**：ツールが現在のUnix時間（1591756516）を自動的に生成しているため、記入不要です。
 -  **プレーヤー設定**：プリセットのプレーヤー設定名：basicDrmPresetを入力します。
 - **署名期限切れUnixタイムスタンプ**：署名自身の有効期限（未記入可、デフォルトでは1日後に期限切れ）。
 - **リンクの有効期限**：Keyリンク不正アクセス防止の有効期限。6時間後の16進数Unix時間：5ee09b44を入力します。
 - **リンク不正アクセス防止Key**：前に取得したリンク不正アクセス防止Key：2WExxx48eWを入力します。
>! basicDrmPresetはプリセットのプレーヤー設定で、テンプレート12を再生してアダプティブビットレートストリーミングに変換して出力する際や、テンプレート10でスプライトイメージをキャプチャして出力する際に使用します。
2. **署名の生成**をクリックします。生成した署名が**署名生成結果**のテキストボックスに表示されます。

プレーヤーの署名を取得した後、それぞれ、[Web](https://imgcache.qq.com/open/qcloud/video/tcplayer/examples/vod/tcplayer-vod-base.html)、[Android](https://github.com/LiteAVSDK/Player_Android)、[iOS](https://github.com/LiteAVSDK/Player_iOS)という3つの端末のプレーヤーDemoで検証を行えます。詳細については、Demoのソースコードをご参照ください。
>?コンソールの**メディア資産管理** >[**ビデオ管理**](https://console.cloud.tencent.com/vod/media)> **プレーヤープレビュー**では、プレビュービデオに対応するWebプレーヤーのソースコードを取得し、直接参照、使用することができます。
<img src="https://main.qcloudimg.com/raw/c5756910c7958aae198804c91b76a89e.png" width="500" />

## まとめ

このチュートリアルの学習を終えると、ビデオの暗号化の方法、およびプレーヤーを使用して暗号化後のビデオを再生する方法を理解できたことになります。
