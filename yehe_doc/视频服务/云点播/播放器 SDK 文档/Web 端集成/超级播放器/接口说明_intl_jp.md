
このドキュメントは、Tencent Cloud Web VODサービスの**Super Playerに関するパラメータおよびAPI**を紹介します。[使用ドキュメント](https://intl.cloud.tencent.com/document/product/266/33977)を併用してください。このドキュメントはJavascript言語に関する基礎的知識を持っている開発者に適します。

## 初期化パラメータ
プレーヤーの初期化には二つのパラメータが必要です。一つ目はプレーヤーコンテナID、二つ目は機能パラメータオブジェクトです。
```
var player = TCPlayer('player-container-id', options);
```

### optionsパラメータリスト
optionsオブジェクトに設定されるパラメータは次のとおりです。

| 名称    | タイプ                      | デフォルト値                        |説明 |
|------------|-----------------------------------|-----------------------------------|---------------------------------------|
|  appID|  String |   なし |必須。|
|  fileID|  String|なし|必須。|
|  width|  String/Number|  なし| プレーヤー領域の横幅サイズ（単位：ピクセル）。必要に応じて設定を行い、CSSでプレーヤーのサイズをコントロールできます。|
|  height |  String/Number|  なし|  プレーヤー領域の縦幅サイズ（単位：ピクセル）。必要に応じて設定を行い、CSSでプレーヤーのサイズをコントロールできます。|
|  controls|  Boolean|  true|  プレーヤーのコントロールバーを表示するかどうか。|
|  poster|  String|  なし|  タイトル画像の完全なアドレスを設定します（アップロードされたビデオのタイトル画像が生成された場合は、生成されたタイトル画像が優先して使用されます。詳細については[VOD - ビデオ管理](https://intl.cloud.tencent.com/document/product/266/33896)をご参照ください）。|
|  autoplay|  Boolean|  false|  自動再生かどうか。|
|  playbackRates|  Array| [0.5，1，1.25，1.5，2]|  変速再生倍率を設定するオプション。HTML5再生モードのみ有効です。|
|  loop|Boolean|  false|  ループ再生かどうか。|
|  muted|  Boolean|  false|  ミュート再生かどうか。|
|  preload|  String|  auto|  プリロードが必要かどうか。3つの属性"auto"、"meta"、"none"があります。モバイル端末はシステムの制限により、autoの設定は無効となります。|
|  swf|  String|  なし|  FlashプレーヤーのswfファイルのURL。|
|  posterImage|  Boolean|  true|  タイトル画像を表示するかどうか。|
|  bigPlayButton|  Boolean|  true|  中央揃え再生ボタンを表示するかどうか（ブラウザハイジャック埋め込みの再生ボタンは除去できない）。|
|  language|  String|  "zh-CN"|  言語を設定します。|
|  languages|  Object|  なし|  多言語辞書を設定します。|
|  controlBar|  Object|  なし|  コントロールバー属性のパラメータ組み合わせを設定します。詳細について後述します。|
|  plugins|  Object|  なし|  プラグイン機能属性のパラメータ組み合わせを設定します。詳細について後述します。|
|  hlsConfig|  Object|  なし|  hls.jsのスタートコンフィグレーションです。詳細については公式ドキュメント[hls.js](https://github.com/video-dev/hls.js/blob/master/docs/API.md#fine-tuning)をご参照ください。|

>! controls playbackRates loop preload posterImage これらのパラメータはブラウザハイジャック再生の状態下で無効となります。

#### controlBarパラメータリスト
controlBarパラメータはプレーヤーコントロールバーの機能設定に使用されます。サポートする属性は次のとおりです。

| 名称    | タイプ                      | デフォルト値                        |説明 |
|------------|-----------------------------------|-----------------------------------|---------------------------------------|
|  playToggle| Boolean|  true|  再生、一時停止の切り替えボタンを表示するかどうか。|
|  progressControl|  Boolean| true|  再生プログレスバーを表示するかどうか。|
|  volumePanel|  Boolean|  true|  ボリュームコントロールを表示するかどうか。|
|  currentTimeDisplay|  Boolean|  true|  ビデオの現在の時間を表示するかどうか。|
|  durationDisplay|  Boolean|  true|  ビデオの長さを表示するかどうか。|
|  timeDivider|  Boolean|  true|  時刻区切り記号を表示するかどうか。|
|  playbackRateMenuButton|  Boolean|  true|  再生レート選択ボタンを表示するかどうか。|
|  fullscreenToggle|  Boolean|  true|  全画面表示ボタンを表示するかどうか。|
|  QualitySwitcherMenuButton|  Boolean|  true|  解像度切り替えメニューを表示するかどうか。|

>! controlBarパラメータはブラウザハイジャック再生の状態下で無効となります。

#### pluginsプラグインパラメータリスト
pluginsパラメータはプレーヤープラグインの機能設定に使用されます。サポートする属性は次のとおりです。

| 名称    | タイプ                      | デフォルト値                        |説明 |
|------------|-----------------------------------|-----------------------------------|---------------------------------------|
|  ContinuePlay|  Object|  なし|  再生継続機能をコントロールします。サポートする属性：<br><li>auto：false（再生時に自動再生継続を実行するかどうか）。<br><li>text：「前回停止した位置」（注意内容）。<br><li>btnText：「再生し続ける」（ボタン内容）。<br>|

## オブジェクトメソッド
プレーヤーの初期化によってオブジェクトを返すメソッドリスト：

| 名称    | パラメータとタイプ                 | 戻り値とタイプ                        |説明 |
|------------|-----------------------------------|-----------------------------------|---------------------------------------|
|  ready(function)|  (Function)|  なし|  プレーヤー初期化完了後のコールバックを設定します。|
|  play()|  なし|  なし|  再生と再生の再開。|
|  pause()|  なし|  なし|  再生の一時停止。|
|  currentTime(seconds)|  (Number)|  (Number)|  現在の再生時間点を取得し、または再生時間点を設定します。この時間点はビデオの長さを超えてはならない。|
|  duration()|  なし|  (Number)|  ビデオの長さを取得します。|
|  volume(percent)|  (Number)[0，1][オプション]|  (Number)/設定すると何も返しません|  プレーヤーの音量を取得または設定します。|
|  poster(src)|  (String)|  (String)/設定すると何も返しません|  プレーヤータイトル画像を取得または設定します。|
|  requestFullscreen()|  なし|  なし|  全画面表示モードに入ります。|
|  exitFullscreen()|  なし|  なし|  全画面表示モードを終了します。|
|  isFullscreen()|  なし|  Boolean|  全画面表示モードに入っているかを返します。|
|  on(type，listerner)|  (String, Function)|  なし|  監視イベント。|
|  one(type，listerner)|  (String, Function)|  なし|  監視イベントです。イベント処理関数は最大1回実行します。|
|  off(type，listerner)|  (String, Function)|  なし|  イベントの監視を解除します。|
|  buffered()|  なし|  TimeRanges|  ビデオのバッファサイズ範囲を返します。|
|  bufferedPercent()|  なし|  値の範囲[0，1]|  ビデオの長さに占めているバッファサイズの割合を返します。|
|  width()|  (Number)[オプション]|  (Number)/設定すると何も返しません|  プレーヤー領域の横幅サイズを取得または設定します。CSSでプレーヤーサイズを設定する場合は、このメソッドは無効となります。|
|  height()|  (Number)[オプション]|  (Number)/設定すると何も返しません|  プレーヤー領域の縦幅サイズを取得または設定します。CSSでプレーヤーサイズを設定する場合は、このメソッドは無効となります。|
|  videoWidth()|  なし|  (Number)|  ビデオ解像度の横幅サイズを取得します。|
|  videoHeight()|  なし|  (Number)|  ビデオ解像度の縦幅サイズを取得します。|
|  dispose()|  なし|  なし|  プレーヤーを廃棄します。|

>! オブジェクトメソッドは同期的に呼び出すことができません。ready、on、one、offを除き、関連イベント（loadedmetadataなど）がトリガーされるまで呼び出すことができます。

## イベント
プレーヤーは返されたオブジェクトを初期化することでイベントを監視できます。以下に例を示します。
```
var player = TCPlayer('player-container-id', options);
// player.on(type, function);
player.on('error', function(error) {
   // ある処理をする
});
```
typeはイベントタイプです。サポートするイベントは次のとおりです。

| 名称           | 説明                                                         |
|------------|---------------------------------|
|  play|  再生が開始します。play()メソッドを呼び出し、またはautoplayがtrueと設定された状態で有効となる場合にトリガーされます。この場合、paused属性はfalseとなります。|
|  playing|  バッファリングによる一時停止または停止後、再生を再開するときにトリガーされます。paused属性はfalseとなります。通常、このイベントを使用してビデオの実際の再生をマークします。playイベントは再生の開始であり、画面はレンダリングされていません。|
|  loadstart|  データをロードするときにトリガーされます。|
|  durationchange|  ビデオの長さデータが変化するときにトリガーされます。|
|  loadedmetadata|  ロードされたビデオのmetadata。|
|  loadeddata|  現在のフレームのデータがロードされたがビデオの次のフレームを再生するためのデータが不十分の場合はこのイベントがトリガーされます。|
|  progress|  メディアデータを取得したときにトリガーされます。|
|  canplay|  プレーヤーがビデオを再生できるようになったときにトリガーされます。|
|  canplaythrough|  プレーヤーが一時停止せずにバッファリングできると予想された場合、指定したビデオを再生し続けるときにトリガーされます。|
|  error|  ビデオ再生にエラーが発生したときにトリガーされます。|
|  pause|  一時停止時にトリガーされます。|
|  ratechange|  再生レートが変化したときにトリガーされます。|
|  seeked|  指定した再生位置の検索が終了するときにトリガーされます。|
|  seeking|  指定した再生位置の検索が開始するときにトリガーされます。|
|  timeupdate|  現在の再生位置の変化は、currentTimeの変化があると理解してもよい。|
|  volumechange|  音量の設定またはmuted属性値の変化のときにトリガーされます。|
|  waiting|  再生を停止し、次のフレームの内容が使用できないときにトリガーされます。|
|  ended|  ビデオ再生が終了するときにトリガーされます。この際、currentTimeの値はメディアリソースの最大値と等しい。|
|  resolutionswitching|  解像度切り替え中。|
|  resolutionswitched|  解像度切り替え終了。|
|  fullscreenchange| 全画面表示状態の切り替え時にトリガーされます。|

## エラーコード
プレーヤーにerrorイベントがトリガーされるとき、監視関数がエラーコードを返します。ここで、3桁以上のエラーコードはメディアデータインタフェースのエラーコードです。エラーコードリスト：

| 名称                       |                                                                                        説明                                                                                        |
|------|----------------------------------------------|
| -1   | プレーヤーが使用できるビデオアドレスを検出できませんでした。                  |
| -2   | ビデオデータの取得はタイアウトでした。                               |
| 1    | ビデオデータのロード過程は中断しました。<br>考えられる原因：<br><li>ネットワーク中断。<br><li>ブラウザ異常中断。<br>対処方法：<br><li>ブラウザコンソールのネットワークリクエスト情報を調べ、ネットワークリクエストが正常であるか確認してください。<br><li>再生プロセスを繰り返します。                             |
| 2    | ネットワーク問題によってビデオロードに失敗しました。<br>考えられる原因：ネットワーク中断。<br>対処方法：<br><li>ブラウザコンソールのネットワークリクエスト情報を調べ、ネットワークリクエストが正常であるか確認してください。<br><li>再生プロセスを繰り返します。                     |
| 3    | ビデオのデコード時にエラーが発生しました。<br>考えられる原因：ビデオのデータ異常、デコーダのデコード異常。<br>対処方法：<br><li>トランスコードを再実行して再生します。トランスコードプロセスによる問題を除外します。<br><li>元のビデオが正常であるか確認してください。<br><li> 技術サポートに連絡し、トラブルシューティングのための再生パラメータを提供してください。                                |
| 4    | ビデオの形式がサポートされないか、またはサーバーやネットワークの問題によってロードできません。<br>考えられる原因：<br><li>ビデオデータが取得できないか、CDNリソースがないか、またはビデオデータが返されていません。<br><li>現在の再生環境でこのビデオ形式の再生がサポートされていません。<br>対処方法：<br><li>ブラウザコンソールネットワークリクエスト情報を調べ、ビデオデータリクエストが正常であるか確認してください。<br><li>使用ドキュメントに従ってビデオ形式に対応する再生スクリプトをロードしたか確認してください。<br><li>現在のブラウザとページ環境が再生するビデオ形式をサポートしているか確認してください。<br><li> 技術サポートに連絡し、トラブルシューティングのための再生パラメータを提供してください。     |
| 5    | ビデオの復号化時にエラーが発生しました。<br>考えられる原因：<br><li>復号化に使用されるキーが間違っています。<br><li>リクエストキーのインターフェース返しが異常です。<br><li>現在の再生環境でビデオの復号化機能がサポートされません。<br>対処方法：<br><li>キーが正しいか、キーインターフェースが正常に返すか確認してください。<br><li>技術サポートに連絡し、トラブルシューティングのための再生パラメータを提供してください。<br>                                  |
| 10   | オンデマンドメディアデータのインターフェースリクエストがタイムアウトしました。メディアデータを取得するときに、プレーヤーが3回リトライしても応答がない場合、このエラーがスローされます。<br>考えられる原因：<br><li>現在のネットワーク環境がメディアデータインターフェースを接続できないか、またはメディアデータインターフェースがハイジャックされています。<br><li>メディアデータのインターフェースが異常です。<br>対処方法：<br><li>当社が提供するDemoページを開き、正常に再生できるか確認してください。<br><li>技術サポートに連絡し、トラブルシューティングのための再生パラメータを提供してください。<br>                           |
| 11   | オンデマンドメディアデータインターフェースからデータが返されませんでした。メディアデータを取得するときに、プレーヤーが3回リトライしてもデータが返されない場合、このエラーがスローされます。<br>考えられる原因：<br><li>現在のネットワーク環境がメディアデータインターフェースを接続できないか、またはメディアデータインターフェースがハイジャックされています。<br><li>メディアデータのインターフェースが異常です。<br>対処方法：<br><li>当社が提供するDemoページを開き、正常に再生できるか確認してください。<br><li> 技術サポートに連絡し、トラブルシューティングのための再生パラメータを提供してください。<br>                        |
| 12   | オンデマンドメディアデータインターフェースから異常データが返されました。メディアデータを取得するとき、プレーヤーが3回リトライしても解析できないデータが返された場合、このエラーがスローされます。<br>考えられる原因：<br><li>現在のネットワーク環境がメディアデータインターフェースを接続できないか、またはメディアデータインターフェースがハイジャックされています。<br><li>再生パラメータが間違っているため、メディアデータインターフェースが処理できません。<br><li>メディアデータインターフェースが異常です。<br>対処方法：<br><li>当社が提供するDemoページを開き、正常に再生できるか確認してください。<br><li> 技術サポートに連絡し、トラブルシューティングのための再生パラメータを提供してください。<br>                   |
| 13   | プレーヤーは現在のプレーヤーで再生できるビデオデータを検出できませんでした。このビデオに対するトランスコード操作を実施してください。|
| 14   | HTML5 + hls.jsモードでhlsを再生するときにネットワーク異常が発生しました。異常はevent.sourceで確認できます。詳細についてはhls.jsの公式ドキュメント[Network Errors](https://github.com/video-dev/hls.js/blob/master/docs/API.md#network-errors)をご参照ください。|
| 15   | HTML5 + hls.js モードでhlsを再生するときにマルチメディア異常がが発生しました。異常はevent.sourceで確認できます。詳細についてはhls.jsの公式ドキュメント[Media Errors](https://github.com/video-dev/hls.js/blob/master/docs/API.md#media-errors)をご参照ください。   |
| 16   | HTML5 + hls.js モードでhlsを再生するときにマルチプレックスの異常が発生しました。異常はevent.sourceで確認できます。詳細についてはhls.jsの公式ドキュメント[Mux Errors](https://github.com/video-dev/hls.js/blob/master/docs/API.md#mux-errors)をご参照ください。     |
| 17   | HTML5 + hls.js モードでhlsを再生するときに他の異常が発生しました。異常はevent.sourceで確認できます。詳細についてはhls.jsの公式ドキュメント[Other Errors](https://github.com/video-dev/hls.js/blob/master/docs/API.md#other-errors)をご参照ください。     |
| 10008| メディアデータサービスに関連する再生パラメータのメディアデータが見つかりませんでした。リクエストパラメータappID fileIDが正しいか、対応するメディアデータが削除されたか確認してください。|
