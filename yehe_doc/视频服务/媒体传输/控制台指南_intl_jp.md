## 概要

Tencent CloudのStreamLinkは、安全かつ安定的なリアルタイム伝送機能を提供し、ビデオストリームメディアを高速、低遅延、安定的に伝送するという動画サプライヤーのニーズを満たします。StreamLinkコンソールはストリームディメンションをベースとして管理され、各ストリームはそれぞれ1つのストリームの送信リンクに対応しています。StreamLinkコンソールをベースとして、ビデオストリームを迅速かつ安定的に送信できると同時に、送信プロセスにおけるビデオストリームの品質をオールラウンドにモニタリングすることができます。

## 前提条件

- プッシュに用いられるIPアドレス。
- [メディア伝送コンソール](https://console.cloud.tencent.com/mdc/flow)にログインしました。

## 操作手順

### 1.   リージョンの選択

新しいストリームを作成する前に、作成する必要のある新しいストリーム送信リンクの起点を選択します。現在、華東、アジア、中国香港/中国マカオ/中国台湾（中国リージョン）、米国西部およびヨーロッパリージョンで複数のノードを選択できます。より多くのノードのデプロイとサポートが必要な場合は、[お問い合わせください](https://intl.cloud.tencent.com/contact-sales)。

![img](https://main.qcloudimg.com/raw/40f51b438e95684be5aa3a85293a612a.png)

### 2.   新しいストリームの作成

【ストリームの作成】をクリックして作成インターフェースに進み、以下の設定を行います。

1. 新しいストリームの基本情報を入力します。

- 入力ストリームの名称をカスタマイズします。
- 最大帯域幅を選択します。10Mbpsまたは20Mbpsを選択できます。

2. 入力ソースの情報を入力します。

- 入力ソース名称。
- 入力ソースのプロトコルタイプをSRT、RTMPまたはRTPから選択します。

>!
>- 入力ソースのプロトコルタイプとしてSRTを選択する場合は、遅延設定を構成する必要があります。 このパラメータは、Serveの送信/受信bufferのサイズに影響を与えます。ネットワークの状態が良くないときは、このパラメータを大きくすることをお勧めします。業務上のニーズに応じて遅延設定を入力できます。デフォルトは120msです。
>- 遅延設定では、作成後に指定されたIPアドレスに対してpingテストを実行し、最適な設定を決定してから変更を行うことができます。さらに、デフォルト値を直接使用して送信側の遅延設定を調整すれば、同様に目的を達成することができます。
>- StreamLinkは、SRTプロトコルの暗号化と復号の伝送をサポートしています。StreamLinkにプッシュするストリームが暗号化されたトランスポートストリームである場合は、【復号の設定】スイッチをオンにして復号キーを入力し、キーの長さを選択してアップストリームを復号することができます。
![img](https://main.qcloudimg.com/raw/612a69af560cc583b9e2a420f83db35d.png)

- 入力ソースのIPホワイトリスト（CIDR形式）を入力すると、ホワイトリスト内のIPのみがこのストリームへのプッシュを許可されます。
- ストリームの入力ソースの説明情報を設定することによって、さまざまな入力ソースを区別することもできます。

![img](https://main.qcloudimg.com/raw/9996153b4d81bff835b8a163366a9916.png)

設定の入力を完了したら、【作成】をクリックして新しいストリームの作成を完了します。

### 3.   ストリームの確認

ストリーム管理インターフェースでストリーム名をクリックし、ストリーム詳細インターフェースに進みます。ここでは、ストリームの基本情報、入力ソースの基本情報の確認、出力ノードの作成と設定、出力の詳細の確認、ログとヘルスデータの確認を行うことができます。

- #### 情報

ストリームID、ストリーム名、入力リージョン、ステータスおよび最大帯域幅など、ストリームの基本情報を確認できます。また、【編集】をクリックして、ストリーム名を変更することもできます。

![img](https://main.qcloudimg.com/raw/5ea936332f14daa6c2494a0e9077a825.png)

- #### 入力ソース

入力ソースの基本情報とプロトコルタイプを確認できます。 これには、入力ソースID、入力ソース名、マスタ・スレーブ入力アドレス、CIDR IPホワイトリストおよび入力ソースの説明が含まれます。また、【編集】をクリックして、入力情報を変更することもできます。

>! トランスポートストリームの出力ノードが設定されている場合、入力ソースタイプはサポートされません。

![img](https://main.qcloudimg.com/raw/74538cf1cd523d1a98d71531305c61c2.png)

- #### 出力

StreamLinkは、ワンフロー・複数出力という設定をサポートしています。1つのストリームの入力ソースについては、それぞれのリージョンで出力ノードを設定することができます。ここでは、すべての出力ノード情報を確認でき、また、出力ノードを作成/削除/編集することも可能です。

>! すでに開始され実行中のストリームの出力ノードを作成、編集および削除することはできません。

1. 出力ノードを作成するには、出力名、出力リージョン、出力プロトコルタイプSRT/RTMP/RTP、プライマリ/スタンバイ宛先IPアドレスとポートおよび出力の説明を入力する必要があります。

2. StreamLinkは、送信プロトコルのカプセル化形式の変換をサポートします。出力を作成するとき、出力するプロトコルのタイプを選択できます。SRT、RTMPおよびRTPをサポートしています。SRT出力プロトコルタイプを選択するときは、プライマリ/スタンバイ宛先IPアドレスとそのポートを入力する必要があります。また、業務上の実際のニーズに応じて遅延設定を入力できます。デフォルトは120msです。

3. 【確定】をクリックして、新規作成した出力ノードを保存します。

>?
>- 入力プロトコルがSRTの場合、出力プロトコルはRTPをサポートしません。
>- 出力ノードのプライマリストリームとバックアップストリームのチャネルは互いに独立しており、入力ソースのマスタ・スレーブチャネルに1対1で対応します。すなわち、ストリームのプライマリチャネルがプッシュしたストリームは、StreamLinkを介して送信された後、プライマリ宛先アドレスを介して出力されます。ストリームのスタンバイチャネルにプッシュされたストリームは、StreamLinkを介して送信された後、スタンバイ宛先アドレスを介して出力されます。両者は互いに独立しています。
>- プライマリ出力アドレスは入力必須、スタンバイ出力アドレスはオプションです。
>- SRTプロトコルの出力ストリームを暗号化する必要がある場合は、ここで【暗号化をオン】に設定し、暗号化鍵を入力して、キーの長さを選択できます。

![img](https://main.qcloudimg.com/raw/df0ba72d6c50b12fc37e2763513cf31f.png)

4. 名称、出力ID、出力リージョン、プロトコルタイプ、エクスポートIPアドレス、IP宛先アドレスなど、このストリームにあるすべての出力ノード情報を確認します。

![img](https://main.qcloudimg.com/raw/812429b52baa93b9b330a8b3b1104f2f.png)

5. 出力ノード情報の編集と削除をサポートします。出力ノードの名称、プライマリ/スタンバイ宛先IPアドレスとポートおよび出力の説明を変更することができます。**出力リージョンと出力プロトコルタイプの変更はサポートしていません**。

![img](https://main.qcloudimg.com/raw/9d41cc9228d856869827be032433e12d.png)

- #### ログ

ログモジュールで、アップおよびダウンリンクプロセスにおけるイベント情報を確認できます。【OK】をクリックし、ログイベント情報を生成します。 次の情報が含まれます。

- 時間：イベントが発生した時間。
- タイプ：入力-プライマリストリーム、入力-バックアップストリーム、出力-プライマリストリームおよび出力-バックアップストリームを含むイベントタイプ。 フィルタリングをサポートします。
- 入力/出力名：イベントを生成した入力/出力の名称。
- 情報：イベントの具体的な情報。

>?
>- タイムゾーンの調整を選択できます。デフォルトでは、ローカルタイムゾーンが選択されています。
>- ログデータは現在、5日以内で、タイムスパンは24時間以内のデータのクエリーのみをサポートしています。

![img](https://main.qcloudimg.com/raw/4418b689e88eb332b885677e43cbe5a6.png)

- #### ヘルス

ヘルスモジュールのソースと出力という2つの部分のアップストリームとダウンストリームプロセスにおいて、フローの品質をモニタリングできます。【プライマリ】/【スタンバイ】を選択して、プライマリ/スタンバイのソースまたは出力データを表示します。【OK】をクリックして関連データを生成します。次のデータが含まれます。

| モニタリングソース | 帯域幅            | ビデオ                      | オーディオ                    | SRTプロトコル指標               |                                   |                                                              |                        |
| ------------------ | ----------------- | --------------------------- | ----------------------------- | ------------------------------- | --------------------------------- | ------------------------------------------------------------ | ---------------------- |
| ビットレート       | フレームレート    | ビットレート                | フレームレート                | パケット損失率                  | 再送率                            | RTT                                                          | 破棄されたパケットの数 |
| ソース             | 入力/出力総帯域幅 | 入力/出力ビデオビットレート | 入力/出力ビデオフレームレート | 入力/出力オーディオビットレート | 入力/出力オーディオフレームレート | SRTプロトコル関連のパラメータ。SRTプロトコルが選択されている場合にのみ表示されます。 |                        |
| 出力               |                   |                             |                               |                                 |                                   |                                                              |                        |

>?
>- タイムゾーンの調整を選択できます。デフォルトでは、ローカルタイムゾーンが選択されています。
>- ヘルスデータは現在、5日以内で、タイムスパンは24時間以内のデータのクエリーのみをサポートしています。
>- ビデオ・オーディオのビットレートとフレームレートは右側で切り替えて、ビデオとオーディオのチャネルを選択できます。
>- プロトコルがSRTの場合、右側で切り替えて、パケット損失率/再送率/RTT/廃棄パケット数などの表示パラメータを選択できます。

![img](https://main.qcloudimg.com/raw/107263b0b3b1a1321222f891e24e136a.png)

![img](https://main.qcloudimg.com/raw/bc8dd565e63e74eb15e1f3868cdf9083.png)

### 4.   ストリームの開始/停止

ストリームと出力ノードの作成が完了して【開始】をクリックすると、ストリームを実行することができます。使用終了後、【停止】をクリックすれば、実行中のストリームを停止できます。

>! 出力ノードを作成していないストリームは開始できません。

![img](https://main.qcloudimg.com/raw/df397e7413a9d3bb91956de33f9c2130.png)

### 5.   ストリームの削除

ストリーム設定を削除する必要がある場合は、【削除】をクリックすると、そのストリームの設定情報を削除できます。

![img](https://main.qcloudimg.com/raw/c5d2f2a49521be8d02f0a8cb2bb805b9.png)