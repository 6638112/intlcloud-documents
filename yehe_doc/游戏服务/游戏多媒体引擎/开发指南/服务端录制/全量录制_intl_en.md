This document describes how to quickly integrate the **GME server-side recording** feature through full recording.



## Use Cases

GME provides **server-side recording** capabilities for voice chat audio streams to help you implement various scenarios, including content retention, management, and reproduction. In full recording mode, you can record all voice chat rooms in the application. In custom recording mode, you can record the specified room. In both recording modes, you can record the mixed stream by room or single stream by user. Recording files will be stored in **COS** under your account.


This document describes how to integrate **full recording**. To enable custom recording for your application, see [Custom Recording](https://www.tencentcloud.com/document/product/607/53748).

>! 
>- Using GME's server-side recording feature will incur recording service fees. Billing for this feature at Tencent Cloud International will officially start on April 1, 2023. Billing details will be announced in advance in [Purchase Guide](https://www.tencentcloud.com/document/product/607/50009).
>- Recording files will be stored in **COS** under your account, and **COS bills** will be generated based on your specific usage information such as storage volume, duration, and access frequency. For billing details, see [Billing Overview](https://www.tencentcloud.com/document/product/436/16871).

## Prerequisites

- **You have activated the voice chat service** as instructed in [Activating Services](https://www.tencentcloud.com/document/product/607/10782).
- **You have activated the server-side recording service.** Currently, this feature is only available to allowed users. To try it out, contact us to add you to the allowlist.
- **You have integrated the GME SDK**, including core APIs and voice chat APIs. For more information, see [Quick Integration of Native SDK](https://www.tencentcloud.com/document/product/607/40858), [Quick Integration of SDK for Unity](https://www.tencentcloud.com/document/product/607/44544), and [Quick Integration of SDK for Unreal Engine](https://www.tencentcloud.com/document/product/607/44545).


## Service Architecture
![](https://staticintl.cloudcachetci.com/yehe/backend-news/j2pg571_PRELIM__%E6%B8%B8%E6%88%8F%E5%A4%9A%E5%AA%92%E4%BD%93%E5%BC%95%E6%93%8E_%E4%BA%A7%E5%93%81%E7%9B%AE%E5%BD%95_%E4%B8%AD%E8%AF%91%E8%8B%B1_EN-US-1.png)

## Feature Overview
### 1. Recording scope

After full recording is enabled, all voice chat rooms will be recorded. You can specify only mixed-stream recording, only single-stream recording, or both.

### 2. Recording mechanism


#### Recording task start

- A recording task will start when the first user enters the room.

#### Recording task ending

- The recording task will end when the last user exits the room.

#### Recording task segmentation

- If a single audio file lasts two hours or longer, it will be segmented automatically.
- If a user turns off the mic, the user's single-stream recording will be segmented automatically. After a user turns on the mic, a new segment will be generated.
- If an ongoing recording task is interrupted due to an exception, a new segment will be generated after the task restarts automatically.


#### Recording task event notification

- A recording task event will be notified to the configured callback URL through the callback mechanism. If such an event occurs, you will receive a callback notification such as **Recording started**, **Recording stopped**, or **The recording file has been uploaded**.
- For the specific callback information, see [Recording Callback Description](https://www.tencentcloud.com/document/product/607/53749).



### 3. Storage location

With GME's server-side recording, recording files will be stored in the specified bucket in **COS** under your account. You need to specify the region of the bucket. For the available regions, see [Regions and Access Endpoints](https://www.tencentcloud.com/document/product/436/6224).


### 4. Recording file format

- .mp3


### 5. Recording file naming convention

- User single-stream recording files: bizid_roomid_userid/${task start time}_${id}_audio.mp3
- Room mixed-stream recording file: bizid_roomid/${taskid} _${task start time} _${id}_audio.mp3

 ***bizid***: GME application ID, which can be obtained in the [GME console](https://console.tencentcloud.com/gamegme).
 ***roomid***: Voice chat room ID, which is defined and passed in to the GME SDK when you use the voice chat service.
 ***userid***: Player ID, which is defined and passed in to the GME SDK when you use the voice chat service.
 ***taskid***: Recording task ID, which is generated by the GME recording service. Each recording task has a unique task ID.
 ***id***: Serial number of a recording task segment, which starts from `0`.



## Integration directions

<dx-steps>
-<dx-tag-link link="#StartRealTimeASR" tag="business side">Configure the recording service in the console</dx-tag-link>
-<dx-tag-link link="#callback" tag="business side">Receive the recording task callback (optional)</dx-tag-link> 
-<dx-tag-link link="#result" tag="business side">View/Manage recording files</dx-tag-link>
</dx-steps>


### Step 1. Configure the recording service in the console

- #### Activating/Deactivating the recording service

Log in to the [GME console](https://console.tencentcloud.com/gamegme), click **Service Management** on the left sidebar, locate the target application, click **Set** to enter the **Details** page, and click **Modify** in the **Voice Recording Service** section.

![](https://qcloudimg.tencent-cloud.cn/raw/9e2c89f462a81ba228c978cd725abf5a.png)

Select **Enable**.

When you activate the recording service for the first time, GME will request access to your **COS service**. You need to grant the access in the pop-up window to activate the server-side recording service.


![](https://qcloudimg.tencent-cloud.cn/raw/33407cf16b4ad310b65c4897ea766340.png)

- #### Configuring the recording file storage location

On the **Details** page, click **Modify** in the **Voice Recording Service** section and click **Bind** next to **Recording File Bucket**.
In the **Bind Bucket** pop-up window, you can bind an existing COS bucket (created in the [COS console](https://console.tencentcloud.com/cos/bucket) in advance) or create a bucket.

![](https://qcloudimg.tencent-cloud.cn/raw/c63e0fd24da877f5f79f49360f4ff9e1.png)

- #### Configuring the recording event callback (optional)
If you want to receive the event callbacks of the recording service, you can configure the callback URL. On the **Details** page, click **Modify** in the **Voice Recording Service** section and click **Modify** next to **Callback URL**. In the pop-up window, enter the URL for receiving callbacks. Currently, event callback messages are pushed only for the recording task completion status.

![](https://qcloudimg.tencent-cloud.cn/raw/92314d86dbf00e8cdafe6ac24d1c17b8.png)

- #### Configuring the recording scope
You can select **Custom recording** or **Full recording** for **Recording Scope**. Here, you need to select **Full recording** and specify whether to record single streams, mixed streams, or both.

After setting the above configuration items, click **Save**, and the recording service will be activated. If you no longer need the service, select **Disable** for the recording service in the console to avoid incurring additional fees.




### Step 2. Receive the recording task callback (optional)

If a callback URL is configured in **step 1**, you can receive recording task event callbacks.



### Step 3. View/Manage recording files

An audio file can be generated in several minutes after a recording task ends. You need to log in to the [COS console](https://console.tencentcloud.com/cos/bucket) to view and manage recording files.







