Tencent Cloud Game Server Engine（GSE）は、ステートフルゲームのデプロイとスケーリングのための専用ゲームサーバーホスティングサービスを提供します。サービス検出、効率的で柔軟なサーバースケーリング、最適なリソースのスケジューリングなどをサポートします。GSEは、開発者が運用・保守コストを削減しながら、マルチプレイヤーゲーム用の安定した低遅延のデプロイ環境を迅速に構築するのに役立ちます。Unreal、UnityゲームエンジンやC#、C++、およびgRPCをサポートする言語のサーバーフレームワークのデプロイと実行をサポートし、FPS、MOBA、ターン制ゲーム、MMORPG、テーブルゲームでのバトルサーバーやプッシュ通知などのデータを記憶する必要があるステートフルゲームに最適です。



## 製品アーキテクチャ 
GSEはゲームパッケージのための実行環境を提供しており、この環境ではサービスディスカバリ、スケーリング、マルチサイトデプロイ、最適なリソースのスケジューリングを実行することができます。開発者はサーバーフレームワーク中にGSEのServer SDKを統合し、クライアントはAPIを介してゲームサーバーをリクエストし、GSEはクライアントのアクセスに最適なゲームサーバーを返します。

![](https://main.qcloudimg.com/raw/363390d57a27cac0a9b8adc3d4935a2f.png)


## 製品の機能 

### プログラムのデプロイと更新 

#### プログラムのデプロイ
開発者はGSEを介してプログラムパッケージと依存パッケージをアップロードし、GSEはプログラムをサーバーフリート（fleet）にデプロイし、設定に基づき起動することができます。

#### ダウンタイムなしの更新
ゲームシナリオは一般的にダウンタイム更新をしますが、GSEはエイリアスメカニズムを提供し、ダウンタイムなしの更新を実現することができます。

#### A/B Test
簡単にA/B Testを実現、またはA/B Testを終了することができます。



### サーバーインスタンス管理 

#### 自動スケーリング 
- 1日周期で自動スケーリングを実行：GSEではサーバーインスタンスタイプとスケーリング範囲を設定することにより、インスタンスをこの範囲内でスケーリングすることができます。ゲームのアクセスには毎日ピーク時とオフピーク時があり、通常は午後と夜間時にサーバーインスタンス量のピークがあり、深夜0時を過ぎるとサーバーインスタンスの量は最小になります。GSEは毎日の各時刻でのサーバーアクセス数に基づき自動的にスケーリングします。 
- ステートフルスケールイン: GSEは、プロセスが実行されているインスタンスをスケールダウンしません。負荷の低下によってスケールインがトリガーされた場合、対象サーバーがスケールインされることがゲームプロセスに通知され、対象サーバーへの新しいゲームサーバーセッションの割り当てがブロックされますが、インスタンスが強制的にスケールインされてクライアントが接続できなくなることはありません。ゲームプロセスが終了コマンドを開始するのを待ってから、実際に停止プロセスをトリガーしてサーバーをリサイクルします。


#### マルチサイトデプロイ
GSEは、マルチサイトデプロイに対応し、複数のリージョンでサーバーフリートを構築して、サーバーフリートのキューを構築できます。キューがリクエストされると、システムは正常なリージョンのサーバーフリートを自動的に選択して、ゲームクライアントにアクセスさせ、開発者も手動でフリートの優先順位を調整することができます。特定のリージョンに障害が発生した場合、サービスは短時間のうちに他のリージョンに切り替えられます。

#### グローバルリリース 
GSEは上海、北米などのリージョンにデプロイされており、まもなくより多くのリージョンにデプロイされる予定です。


### プロセス管理 
#### プロセス起動  
GSEはページ設定のプロセス起動パス、起動パラメータ、許容並列プロセス数に応じて、プロセスを起動します。

#### プロセス準備完了  
プロセス起動後、APIを呼び出してGSEに通知し、プロセスの準備が完了すると、アクセスを受けることができます。

#### プロセスヘルスチェック  
GSEは定期的にプロセスのヘルスチェックを実行します。プロセスに不備がある場合は、プロセスをブロックし、そのプロセスが呼び出し側に割り当てられないようにします。

#### プロセスの終了  
- GSEがスケーリングを必要とするとき、またはヘルスチェックが失敗したときは、プロセスの終了を通知します。プロセスを終了するかどうか選択することができます。プロセスが直ちに終了しないとき、GSEはページ設定の保護ポリシーに基づきプロセスを処理します。
- プロセスは自分でAPIを呼び出してGSEに終了を通知することもできます。

### ゲームサーバーセッション管理
GSEはゲームサーバーセッションに対して管理と割り当てを実行します。サービスの観点から見ると、1つのゲームサーバーセッションは1つのゲームの対戦を表し、さらに1つのサービスを表します。バックエンドプログラムの観点からは、ゲームサーバーセッションは1つのプロセスに対応し、GSEは設定に従い事前にプロセスを開始します。通常、1つのプロセスが1つのゲームサーバーセッションに対応します。クライアントはTencent Cloud APIを介してクライアントにゲームサーバーセッションを割り当てるようリクエストし、GSEはゲームサーバーセッションをアイドルプロセスに割り当てます。

#### ゲームサーバーセッションの開始    
呼び出し側がゲームサーバーセッションをリクエストすると、GSEはアイドル状態の正常なプロセスを割り当て、ゲームサーバーセッションを開始します。

#### ゲームサーバーセッションの終了  
ゲームサーバーセッションにプレイヤーがいない場合、またはゲームサーバーセッションに異常がある場合、ゲームサーバーセッションは自動的に終了、または強制終了されます。トラブルシューティングを容易にするため、終了前にログが保存されます。

#### ゲームサーバーセッションの最寄り割り当て  
GSEは、ネットワークの遅延状況に応じて、プレイヤーに最も近いリージョンを選択して、プレイヤーに割り当てることができます。

#### 利用可能なゲームサーバーセッションの比率に基づいたサーバーのスケーリング  
ゲームサーバーフリートは、自動スケーリング条件としてゲームサーバーセッションバッファを設定できます。ゲームサーバーセッションバッファは、利用可能なゲームサーバーセッションの比率です。


### モニタリングとログ 
システムは、サーバーインスタンス（CVM）モニタリング、ゲームサーバーセッションモニタリングと操作ログを提供します。


### 関連機能

[ゲームプレイヤーマッチング（GPM）](https://intl.cloud.tencent.com/document/product/1072/38344)により、プレイヤーマッチング機能を実現することができます。GPMはフレキシブルで、強力なマッチング論理アルゴリズムを提供し、カスタム定義のマッチングルールをサポートしています。マッチングが完了すると自動的にプレイヤーの対局をGSEゲームサーバーキューに配置することができます。
