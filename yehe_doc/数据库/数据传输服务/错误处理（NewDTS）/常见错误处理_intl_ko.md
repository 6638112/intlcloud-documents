본 문서에서는 몇 가지 일반적인 오류와 해결 방법에 대해 설명합니다.

## 일반적인 MySQL 오류

데이터베이스 마이그레이션, 동기화 또는 구독 중 MySQL 시스템에서 보고되는 일반적인 오류와 해당 솔루션은 다음과 같습니다.

| **오류 코드** | **설명**                           | **시나리오**                 | **오류 메시지**                                                 | **분석 및 솔루션**                                           |
| ---------- | ---------------------------------------- | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1227       | 권한 문제                                 | 데이터 마이그레이션, 동기화 또는 구독 | Error 1227: Acess denied.                                    | **<li>오류 분석**<br>작업을 실행하는 계정에 원본 데이터에 연결할 수 있는 권한이 없습니다.<li>**솔루션**<br>작업을 실행하는 계정을 인증하십시오. |
| 1040       | 너무 많은 데이터베이스 연결                         | 데이터 마이그레이션 또는 동기화           | Error 1040: Too many connections.                            | **<li>오류 분석**<br>데이터베이스에 너무 많은 연결이 있습니다.<li>**솔루션**<br>원본 데이터베이스에 대한 최대 연결 수(`max_connections`)를 늘리거나 비즈니스 트래픽이 감소한 후 다시 작업을 수행합니다. |
| 1045       | 권한 문제                                 | 데이터 마이그레이션, 동기화 또는 구독 | Error 1045 (28000): Access denied for user '{{xx}}'@'{{xx}}' (using password: YES) | **<li>오류 분석**<br>작업을 실행하는 계정에 원본 또는 타깃 데이터베이스에 연결할 수 있는 권한이 없습니다.<li>**솔루션**<br>작업을 실행하는 계정에 권한을 부여합니다. |
| 1062       | 기본 키 충돌                             | 데이터 동기화                     | Error 1062: Duplicate entry '{{xx}}' for key 'PRIMARY', related tables: '{{xx}}'. | **<li>오류 분석**<br>데이터 동기화에서 **기본 키 충돌 해결**에 대해 **보고**를 선택하면 DTS는 원본 데이터베이스와 타깃 데이터베이스 간에 기본 키 충돌이 발생할 때 오류를 보고합니다.<li>**솔루션**<br>타깃 데이터베이스의 특정 테이블에서 기본 키를 수정하거나 삭제하고 작업을 다시 실행하십시오. |
| 1071       | 너무 긴 색인 필드                         | 데이터 마이그레이션 또는 동기화           | Error 1071 (42000): Specified key was too long; max key length is 767 bytes. | <li>**오류 분석**<br>기본적으로 InnoDB 엔진의 단일 필드 인덱스는 최대 767bytes, 즉 767/2&lt;384 필드 또는 767/3&lt;256 필드를 포함할 수 있습니다. GBK, UTF-8 및 utf8mb4_unicode_ci는 각각 2바이트, 3바이트 및 4바이트 문자 집합입니다.<br>MySQL 5.6 이상에서는 모든 MyISAM 테이블이 자동으로 InnoDB 테이블로 변환됩니다. 따라서 자체 구축 데이터베이스에 767bytes 이상을 포함하는 복합 인덱스 열이 있는 경우 자체 구축 데이터베이스에서 일반적으로 실행할 수 있는 동일한 테이블 생성 명령문이 MySQL 5.6 이상에서 제대로 실행될 수 없습니다.<br><li>**솔루션**<br>파일에서 비정상적인 행의 합성 인덱스 열 길이를 줄입니다. <br>예시: <br>`create table test(test varcahr(255) primary key)charset=utf8;` <br>-- 성공<br>`create table test(test varcahr(256) primary key)charset=utf8;` <br>-- 실패  |
| 1146       | 데이터 내보내기 중에 원본 데이터베이스에서 테이블 구조를 변경하는 DDL 문 실행 | 데이터 마이그레이션                     | Error 1146: Table '{{xx}}' doesn't exist on query. Default database: '{{xx}}'. | <li>**오류 분석**<br>1. 원본 또는 타깃 인스턴스가 격리되거나 비활성화됩니다. <br>2. 테이블 구조를 변경하는 DDL 문은 원본 데이터베이스에서 실행됩니다.<li>**솔루션**<br>원본 또는 타깃 데이터베이스에 해당 테이블이 있는지 확인하십시오. 지원을 위해 <a href="https://console.cloud.tencent.com/workorder/category">티켓 제출</a>하십시오. 그렇지 않은 경우 위의 요인으로 인해 오류가 발생했는지 확인하고 태스크를 다시 생성하십시오. |
| 1213       | 원본 및 타깃 데이터베이스에 대한 이중 쓰기로 인해 교착 상태 발생                 | 데이터 동기화                     | Error 1213: Deadlock found when trying to get lock; try restarting transaction, related tables: '{{xx}}'. | <li>**오류 분석**<br>타깃 데이터베이스에서 DTS가 수행한 쓰기 작업이 사용자가 수행한 쓰기 작업과 충돌하여 교착 상태가 발생합니다. <li>**솔루션**<br>1. 교착 상태 프로세스를 종료하고 작업을 다시 생성합니다. <br>2. 인스턴스에서 UPDATE 작업에 대한 잠금 로직을 제어하고, 테이블에 인덱스를 추가하고, 잠금 오버헤드를 줄이기 위해 가능한 한 행 잠금을 사용하는 것이 좋습니다. |
| 1236       | 원본 데이터베이스 binlog 문제                     | 데이터 마이그레이션, 동기화 또는 구독 | Error 1236 (HY000): Cannot replicate because the master purged required binary logs. Replicate the missing transactions from elsewhere, or provision a new slave from backup…… | <li>**오류 분석**<br>원본 데이터베이스의 binlog 보존 기간이 짧기 때문에 binlog가 이미 지워졌거나 DTS가 데이터를 풀링할 때 잘못된 위치에 있습니다. <li>**솔루션**<br>원본 데이터베이스에 설정된 binlog 보유 기간(`expire_logs_days`)이 비즈니스 요구 사항을 충족하는지 확인하십시오. 하루 이상으로 설정하고 작업을 다시 생성하는 것이 좋습니다. |
| 1414       | 데이터 내보내기 동안 원본 데이터베이스에서 테이블 구조를 변경하는 DDL 문 실행 | 데이터 마이그레이션                     | Error 1414: Table definition has changed, please retry transanction. | <li>**오류 분석**<br>테이블 구조를 변경하는 DDL 문은 원본 데이터베이스에서 데이터를 내보내는 동안 실행할 수 없습니다. 그렇지 않으면 오류가 보고됩니다.<br><li>**솔루션**</li>마이그레이션 작업을 다시 생성하십시오. |

## 일반적인 DTS 오류

데이터베이스 마이그레이션, 동기화 또는 구독 중 DTS 시스템에서 보고되는 일반적인 오류와 해당 솔루션은 다음과 같습니다.

| **오류 설명**                                  | **시나리오**                 | **오류 메시지**                                                 | **분석 및 솔루션**                                           |
| --------------------------------------------- | ---------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 원본 데이터베이스에 느린 SQL 문이 있으므로 테이블 잠금 실패 | 데이터 마이그레이션 또는 동기화           | Find Resumable Error, src db has long query sql, fix it and try it later. | **<li>오류 분석**<br>원본 데이터베이스에 느린 SQL 문이 있는 경우 원본 데이터베이스 비즈니스가 영향을 받는 것을 방지하기 위해 DTS는 테이블을 잠그고 데이터를 내보내기 전에 느린 SQL 문의 실행이 완료될 때까지 기다려야 합니다. 기본 잠금 시간은 60초이며, 그 이후에는 테이블 잠금이 실패하고 작업이 오류를 보고합니다. <li>**솔루션**<br>원본 데이터베이스에서 느린 SQL 문을 처리하거나 실행이 완료된 후 작업을 다시 생성합니다. |
| 데이터베이스에 연결할 수 없음                                | 데이터 마이그레이션, 동기화 또는 구독 | dial tcp {{*}}: connect: connection refused.                 | **<li>오류 분석**<br>원본 또는 타깃 데이터베이스는 작업 실행 중 격리되거나 비활성화되어 DTS에서 연결할 수 없습니다.<li>**솔루션**<br>원본 또는 타깃 데이터베이스 상태를 확인하고 태스크를 다시 작성하십시오. |
| Binlog 매개변수가 형식 요구사항을 충족하지 않음                     | 데이터 마이그레이션, 동기화 또는 구독 | <ul><li>Statement binlog format unsupported:{{xx}}.<li>binlog must ROW format, but MIXED now.<li>binlog row before/after image not full, missing column {{xx}}, binlog posistion:{{xx}}, gtid:{{*}}. </ul> | **<li>오류 분석**<br>원본 데이터베이스의 `binlog_format` 및 `binlog_row_image` 매개변수를 각각 `ROW` 및 `FULL`로 설정해야 합니다. 수정된 매개변수는 스레드가 재시작 되어야만 적용됩니다.<br><li>**솔루션**<br>[Binlog 매개변수 확인](https://intl.cloud.tencent.com/document/product/571/42559)에 안내된 대로 오류 메시지에 따라 매개변수를 수정하고 태스크를 다시 생성합니다. |

