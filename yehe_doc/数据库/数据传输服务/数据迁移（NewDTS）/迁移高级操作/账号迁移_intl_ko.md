
## 작업 시나리오
본문은 원본 데이터베이스에서 대상 데이터베이스로 사용자 정보를 마이그레이션하는 방법을 설명합니다.
>?현재 지원되는 계정 마이그레이션 시나리오에는 MySQL > MySQL, MySQL > TDSQL-C 데이터 마이그레이션이 있습니다.


## 주의 사항
1. 계정 마이그레이션 중에 DTS는 원본 데이터베이스의 계정 정보를 확인하고 요구 사항을 충족하는 계정을 마이그레이션합니다. DTS는 부적격 계정을 마이그레이션하지 않거나 더 적은 권한으로 마이그레이션합니다. 계정 확인 결과는 다음과 같을 수 있습니다.
   - **전체 마이그레이션**: 계정 정보가 확인 요구 사항을 완전히 충족하며 정상적으로 마이그레이션할 수 있습니다.  
   - **더 적은 권한으로 마이그레이션**: 일부 권한이 확인 요구 사항을 충족하는 경우 충족된 권한만 마이그레이션되고 요구 사항을 충족하지 않는 권한은 마이그레이션되지 않습니다.   
     - DTS는 데이터베이스 및 전역에서만 권한 마이그레이션을 지원하지만 테이블, 저장 프로시저 또는 열과 같은 다른 레벨은 지원하지 않습니다. 예를 들어 원본 데이터베이스의 계정에 데이터베이스와 테이블 레벨 모두에서 권한이 있는 경우 데이터베이스 레벨의 권한만 대상 데이터베이스로 마이그레이션됩니다.    
     - 마이그레이션 작업을 실행하는 계정이 대상 데이터베이스에서 동일한 권한을 가지고 있지 않은 경우 해당 권한은 마이그레이션할 수 없습니다(데이터베이스 및 전역 레벨에만 해당). 예를 들어 대상 데이터베이스에 삭제 권한이 없으면 원본 데이터베이스 계정의 삭제 권한을 마이그레이션할 수 없습니다.
   - **마이그레이션 불가**: 계정 정보가 요구 사항을 충족하지 않아 마이그레이션할 수 없습니다. 자세한 내용은 [제한](#1)을 참고하십시오.
2. 원본 데이터베이스와 대상 데이터베이스에 동일한 계정이 있는 경우 DTS는 대상 데이터베이스의 계정 정보를 원본 데이터베이스의 계정 정보로 덮어씁니다.
   - 원본 데이터베이스의 계정이 대상 데이터베이스의 계정과 user, host는 동일하지만(마이그레이션 작업을 실행하는 계정 제외) 비밀번호가 다른 경우, 계정 마이그레이션 후 대상 데이터베이스의 계정 비밀번호를 원본 데이터베이스의 계정 비밀번호로 덮어씁니다.
   - 원본 데이터베이스에서 마이그레이션할 계정이 마이그레이션 작업을 실행하는 계정과 동일한 정보를 가지고 있는 경우 원본 데이터베이스 계정의 다음 속성이 대상 데이터베이스의 속성을 덮어쓰고 마이그레이션 작업의 성능에 영향을 미칠 수 있습니다. MAX_QUERIES_PER_HOUR, MAX_UPDATES_PER_HOUR, MAX_CONNECTIONS_PER_HOUR, MAX_USER_CONNECTIONS, PASSWORD EXPIRE 및 ACCOUNT LOCK.
   - 원본 데이터베이스에서 마이그레이션할 계정이 마이그레이션 작업을 수행하는 계정과 user/host가 동일하지만 비밀번호가 다른 경우 확인 작업 중에 오류가 보고됩니다. 이 경우 마이그레이션 작업을 다시 실행하기 전에 비밀번호를 동일한 비밀번호로 변경해야 합니다.
3. 계정 마이그레이션은 데이터베이스/테이블 매핑의 영향을 받지 않습니다.

## [제한](id:1)
1. "replicator", "aurora", "aurora_proxy", "root", "aliyun_root"와 같은 Alibaba Cloud 인스턴스의 시스템 계정은 마이그레이션할 수 없습니다.  
2. Alibaba Cloud 인스턴스에서 계정을 마이그레이션할 때 DTS는 먼저 mysql.user 테이블에서 사용자 데이터를 가져옵니다. mysql.user 테이블이 존재하지 않으면 DTS는 mysql.user_view에서 데이터를 가져옵니다. mysql.user_view에 비밀번호 열이 없으면 계정을 마이그레이션할 수 없습니다. 
3. MySQL 8.0에 대한 특별 제한입니다.
   - 원본 데이터베이스가 MySQL 8.0인 경우 SYSTEM_USER 권한이 있는 계정은 마이그레이션할 수 없습니다.    
   - 대상 데이터베이스가 MySQL 8.0이고 원본 데이터베이스에 마이그레이션할 계정의 저장 프로시저가 있는 계정이 있는 경우 DTS는 현재 저장 프로시저를 마이그레이션할 수 없으므로 CREATE USER 문에 대해 오류가 보고됩니다. 이 경우 먼저 대상 데이터베이스에서 계정을 삭제하고 마이그레이션 작업을 다시 수행해야 합니다.
   - 대상 데이터베이스가 MySQL 8.0이고 원본 데이터베이스에서 마이그레이션할 계정에 SYSTEM_USER 권한이 있지만 마이그레이션 작업을 수행하는 계정에 없는 경우 원본 데이터베이스 계정을 마이그레이션할 수 없습니다.
4. 대상 데이터베이스가 MySQL 5.5 또는 5.6이고 마이그레이션 작업을 실행하는 계정에 with grant option 권한이 없으면 계정 마이그레이션이 지원되지 않습니다.
5. 원본 데이터베이스에서 생성된 역할은 사용자로 마이그레이션됩니다. 그러나 역할 권한이 있는 사용자는 마이그레이션되지 않습니다.
6. mysql과 같은 시스템 계정은 마이그레이션할 수 없습니다. 
7. Proxy User는 마이그레이션할 수 없습니다.
8. 원본 데이터베이스의 계정에 16진수 0x00 기호와 같은 특수 기호가 포함된 경우 계정 마이그레이션 작업에서 오류를 보고할 수 있습니다.

## 작업 단계
1. [데이터 마이그레이션 작업](https://console.cloud.tencent.com/dts/migration)의 **마이그레이션 옵션 설정 및 마이그레이션 객체 선택** 페이지에서 **계정 마이그레이션**을 선택합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/825a6f6d1d25e8a52590ca3edcba1a9e.png)
2. 확인 작업은 원본 데이터베이스의 계정 정보를 확인하고 적격 계정을 마이그레이션합니다.
3. **자세히 보기**를 클릭하면 계정 마이그레이션 결과를 자세히 볼 수 있습니다.
 - 전체 마이그레이션: 계정이 확인 요구 사항을 충족하며 정상적으로 마이그레이션될 수 있습니다.  
 - 더 적은 권한으로 마이그레이션: 일부 권한이 확인 요구 사항을 충족하는 경우 충족된 권한만 마이그레이션됩니다.
 - 마이그레이션 불가: 계정이 확인 요구 사항을 충족하지 않아 마이그레이션할 수 없습니다. 가능한 원인은 다음과 같습니다.
    - 계정이 Alibaba Cloud 데이터베이스의 시스템 사용자이거나 사용자 계정 및 비밀번호 정보를 얻을 수 없습니다.
    - 원본 데이터베이스가 MySQL 8.0이고 계정에 SYSTEM_USER 권한이 있거나 계정에 SYSTEM_USER 권한이 있지만 마이그레이션 작업을 실행하는 계정에는 없습니다.
    - 대상 데이터베이스가 MySQL 5.5 또는 5.6이지만 마이그레이션 작업을 실행하는 계정에 grant 권한이 없습니다.
    - 계정이 mysql, sqlserver, orcal과 같은 시스템 계정입니다. 
    - 계정이 Proxy User입니다.
    - DTS 파싱 실패 등의 시스템 문제가 발생합니다.

