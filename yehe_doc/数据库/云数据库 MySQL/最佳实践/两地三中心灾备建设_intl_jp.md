このドキュメントは、アベイラビリティーゾーン間のインスタンスデプロイとリモートでのディザスタリカバリインスタンスの構築により、2リージョン3センターのアーキテクチャ構築を実現することについてご説明します。

## 2リージョン3センターのアーキテクチャ構築
![](https://qcloudimg.tencent-cloud.cn/raw/1ad2c4f70918774892a6b453c80d3186.png)
- 同都市の2センター：
リージョンAの3区とリージョンAの5区から同都市の2センターを構成し、データベースを保護するためにリージョンAの3区がサーバーダウンの後にリージョンAの5区に切り替えることができます。
- 2リージョン：
リージョンAとリージョンBから2地域を構成し、リージョンAの3区、5区のデータセンターがすべてダウンした後、業務もリージョンBのデータセンターに切り替えることができます。

## アベイラビリティーゾーン間のデプロイ
TencentDB for MySQLは、アベイラビリティーゾーン間のデプロイをサポートし、シングルアベイラビリティーゾーンとマルチアベイラビリティーゾーンのデプロイ方式よりも高いディザーストリカバリー能力を備え、データベースを保護することで、データベースインスタンスに障害が発生したり、アベイラビリティーゾーンが中断されたりすると、データセンターレベルの障害から保護されます。

TencentDB for MySQLのマルチアベイラビリティーゾーンデプロイにより、データベースインスタンスのために高可用性及びフェイルオーバーのサポートを提供しています。マルチアベイラビリティーゾーンは単一利用可能ゾーンの上、同じリージョンの複数の単一利用可能ゾーンを物理的ゾーンに組み合わせることです。
![](https://qcloudimg.tencent-cloud.cn/raw/d36cb036272104a4be5e763ce38a82e2.png)

### 前提条件
- インスタンスステータスが実行中であること。
- インスタンスのあるリージョンに2つ以上のアベイラビリティーゾーンが含まれること。
- デプロイするアベイラビリティーゾーンが十分のコンピューティングリソースがあること。

### サポートするリージョンとアベイラビリティーゾーン
TencentDB for MySQLのマルチアベイラビリティーゾーンのデプロイは、現在広州、上海、南京、北京、成都、重慶、香港、シンガポール、ジャカルタ、バンコク、ムンバイ、ソウル、東京、バージニア、フランクフルトをサポートします。対応する都市がサポートするマスター/スレーブのアベイラビリティーゾーンの選択範囲は、[TencentDB for MySQLの購入ページ](https://buy.Intl.cloud.tencent.com/cdb)のマスター/スレーブのアベイラビリティーゾーンの掲示を基準とします。
- この機能についてはサポートするリージョンとアベイラビリティーゾーンの充実が進んでいます。
- 業務の必要があれば、[チケットを提出](https://console.cloud.tencent.com/workorder/category)しで他のリージョンとアベイラビリティーゾーンのデプロイを申請することができます。

### 料金説明
本機能は無料です。インスタンスをシングルアベイラビリティーゾーンからマルチアベイラビリティーゾーンへ移行したとしても、料金はかかりません。

## リモートディザスタリカバリインスタンス
サービスの継続提供、データの信頼性または監視の必要性が高いシナリオの場合、TencentDB for MySQLは、リージョンをまたがるディザスタリカバリインスタンスを提供し、ユーザーの低コストでのサービスの継続提供能力を引き上げながら、データの信頼性を向上させるお手伝いをします。
リモートディザスタリカバリインスタンスが独立したデータベース接続アドレスを提供し、ディザスタリカバリインスタンスは最寄りへのアクセス、データ分析などのシナリオのための読取アクセス機能を提供することができ、デバイスの冗長性コストは低く、プライマリ/セカンダリの高可用性アーキテクチャを使用することにより、データベースの単一障害点リスクを回避します。
![](https://qcloudimg.tencent-cloud.cn/raw/bf639c6f2d80718b2c272cfc0008be54.png)

### 料金説明
ディザスタリカバリインスタンスとマスタインスタンスが同じです。

## TencentDB for MySQLのインスタンスのために2リージョン3センターアーキテクチャを構築する
### 手順1：アベイラビリティーゾーン間のデプロイを設定する
#### インスタンスを購入するときに、インスタンスのためにアベイラビリティーゾーンデプロイを選択する
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb/)にログインし、インスタンスリストで**新規作成**をクリックして、購買ページに進みます。
2. 購入ページで、適切なサポートありリージョンを選択した後、**スレーブアベイラビリティーゾーン**オプションからマスターアベイラビリティーゾーンとは異なるものを選択します。
>?マスターマシンとスレーブマシンが異なるアベイラビリティーゾーンにある場合、ネットワークの同期遅延が2～3ms増加する可能性があります。
>
![](https://qcloudimg.tencent-cloud.cn/raw/1713bdbe69eae9890560c36283cd52ef.png)
3. 誤りのないことを確認したら、**今すぐ購入**をクリックして、支払いを完了すると、**インスタンス詳細ページ > 可用性情報**でこのインスタンスのマスター/スレーブアベイラビリティーゾーンを確認できます。

#### インスタンスが作成され、シングルアベイラビリティーゾーンがマルチアベイラビリティーゾーンに変更した
1. [MySQL コンソール](https://console.cloud.tencent.com/cdb/)にログインします。
2. インスタンスリストで、アベイラビリティーゾーンを変更する必要があるインスタンスIDまたは**操作**列の**管理**をクリックし、インスタンス詳細ページに進みます。
3. インスタンス詳細ページの**可用性情報 > デプロイ方式**で、**アベイラビリティーゾーンの変更**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/c0e598dbb2c9459397f62f155b2d7413.png)
4. ポップアップ表示されたダイアログボックスで、マルチアベイラビリティーゾーンのデプロイを**はい**にして、スタンバイデータベースのアベイラビリティーを選択し、**提出**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/8730f424e5a67407cc6f966d774f92cf.png)

### ステップ2：リモートディザスタリカバリインスタンスの設定
>?ディザスタリカバリインスタンスを購入するには、メモリ1GB、ハードディスク50GB以上の仕様で、かつMySQL 5.6およびそれ以降のバージョン、InnoDBエンジンの高可用版マスターインスタンスが必要です。マスターインスタンスがこの仕様よりも低い場合は、まずマスターインスタンスの仕様をアップグレードしてください。また、マスターインスタンスでGTID機能が有効になっている必要があります。

#### 2.1 ディザスタリカバリインスタンスの作成
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb/)にログインし、インスタンスリストでインスタンスIDまたは**操作**カラムの**管理**をクリックして、詳細ページに進みます。
2. インスタンス詳細ページの基本情報にて、GTID機能が有効であることを確認し、インスタンスアーキテクチャ図で**ディザスタリカバリインスタンスの追加**をクリックして、ディザスタリカバリインスタンスの購入ページに進みます。
![](https://qcloudimg.tencent-cloud.cn/raw/45177bca4dd63114c97eee5a45ab72b9.png)
3. 購入ページで、ディザスタリカバリインスタンスの課金モード、リージョン、同期ポリシーなどの基本情報を設定します。
 - 同期ポリシーが**すぐに同期**の場合、データはディザスタリカバリインスタンスが作成された直後に同期されます。
 - 同期ポリシーが**作成後に同期**の場合、ディザスタリカバリインスタンスの作成完了後、ディザスタリカバリ同期リンクを設定してください。操作の詳細については、以下の[同期リンクの作成](#cjtblj)をご参照ください。
>?
>- 時間の作成はデータ量の影響を受けます。その間のマスターインスタンスのコンソール操作はロックされますので、適切に調整してください。
>- 現在、インスタンス全体のデータ同期のみをサポートしています。ディスク容量を十分に確保してください。
>- マスターインスタンスのステータスが実行中であり、アップ/ダウングレードや再起動などの実行関連の変更タスクの実行がないことを確認してください。そうでない場合、同期タスクは失敗する可能性があります。  
4. 誤りのないことを確認したら、**今すぐ購入**をクリックすると、ディザスタリカバリインスタンスが出荷されます。
5. インスタンスリストに戻り、インスタンスの状態が**実行中**になれば、それ以降の操作に進むことができます。

## 2リージョン3センターのアーキテクチャの確認
構成完了後、データベースのデプロイ方式は、次のような2リージョン3センターアーキテクチャが表示されます。
![](https://qcloudimg.tencent-cloud.cn/raw/4e541bac303a064366b980080d6178aa.png)