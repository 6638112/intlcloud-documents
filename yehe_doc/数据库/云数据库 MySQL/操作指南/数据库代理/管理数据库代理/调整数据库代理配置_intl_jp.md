データベースプロキシを有効化すると、データベースプロキシの設定を調整したり、コンソールを介してデータベースプロキシのプロキシ仕様、アベイラビリティーゾーン、およびノード数を変更したりできます。この文書では、データベースプロキシ設定を調整する方法について説明します。

##  前提条件
[データベースプロキシのアクティブ化](https://intl.cloud.tencent.com/document/product/236/42052)が完了していること。

## 注意事項
- 設定を変更する時、データベースプロキシの新しいバージョンがあれば、設定変更中にデータベースプロキシは自動的にバージョンアップを実行します。
-　選択したデータベースプロキシがマスターインスタンスと同じアベイラビリティーゾーンに属しない場合、データベースプロキシ経由で接続すれば、書き込みパフォーマンスが低下する可能性があります。
- 計算後に必要なプロキシノードの数が購入の上限を超える場合、より仕様の高いプロキシを選択することをお勧めします。
- リージョン内のリソースが十分な場合、最大3つのアベイラビリティーゾーンを選択でき、少なくとも1つのアベイラビリティーゾーン（最初の行にあるアベイラビリティーゾーン）を確保する必要があります。

##　影響範囲
設定の変更によって、接続瞬断などの影響が発生する場合があります。具体的には、以下の変更可能な項目とその影響をご参照ください。
**シナリオ1：プロキシ仕様を変更しますが、アベイラビリティーゾーンとノード数を変更しません**。

<table>
<thead><tr><th>プロキシ仕様</th><th>アベイラビリティーゾーン</th><th>ノード数</th><th>CLB方法</th><th>切り替え時間</th><th>影響</th></tr></thead>
<tbody>
<tr>
<td rowspan="4">アップグレードまたはダウングレード</td><td rowspan="4">変更しない</td><td rowspan="4">変更しない</td><td rowspan="2">自動</td><td>メンテナンス中</td><td rowspan="4">秒レベルの瞬断が発生するため、サービスに再接続メカニズムがあることを確認してください。</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
</tbody></table>	

**シナリオ2：ノード数を変更しますが、プロキシ仕様とアベイラビリティーゾーンを変更しません**。
<table>
<thead><tr><th>プロキシ仕様</th><th>アベイラビリティーゾーン</th><th>ノード数</th><th>CLB方法</th><th>切り替え時間</th><th>影響</th></tr></thead>
<tbody>
<tr>
<td rowspan="7">変更しない</td><td rowspan="7">変更しない</td><td rowspan="3">増加</td><td rowspan="2">自動</td><td>メンテナンス中</td><td rowspan="2">秒レベルの瞬断が発生するため、サービスに再接続メカニズムがあることを確認してください。</td></tr>
<td>アップグレード完了時</td></tr>
<td>手動</td><td>-</td><td>接続の瞬断は発生しません。</td></tr>
<td rowspan="4">減少</td><td rowspan="2">自動</td><td>メンテナンス中</td><td rowspan="4">秒レベルの瞬断が発生するため、サービスに再接続メカニズムがあることを確認してください。</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
</tbody></table>

**シナリオ3：プロキシ仕様を変更しませんが、アベイラビリティーゾーンとノード数を変更します**。
<table>
<thead><tr><th>プロキシ仕様</th><th>アベイラビリティーゾーン</th><th>ノード数</th><th>CLB方法</th><th>切り替え時間</th><th>影響</th></tr></thead>
<tbody>
<tr>
<td rowspan="23">変更しない</td><td rowspan="7">増加</td><td rowspan="3">増加</td><td rowspan="2">自動</td><td>メンテナンス中</td><td rowspan="2">秒レベルの瞬断が発生するため、サービスに再接続メカニズムがあることを確認してください。</td></tr>
<td>アップグレード完了時</td></tr>
<td>手動</td><td>-</td><td>接続の瞬断は発生しません。</td></tr>
<td rowspan="4">減少</td><td rowspan="2">自動</td><td>メンテナンス中</td><td rowspan="20">秒レベルの瞬断が発生するため、サービスに再接続メカニズムがあることを確認してください。</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="8">減少</td><td rowspan="4">増加</td><td rowspan="2">自動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="4">減少</td><td rowspan="2">自動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="8">変更</td><td rowspan="4">増加</td><td rowspan="2">自動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="4">減少</td><td rowspan="2">自動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
<td rowspan="2">手動</td><td>メンテナンス中</td></tr>
<td>アップグレード完了時</td></tr>
</tbody></table>

## 操作手順
1. [MySQL コンソール](https://console.cloud.tencent.com/cdb)にログインし、上側でリージョンを選択して、対象インスタンスIDをクリックすると、インスタンス管理画面が表示されます。
2. インスタンス管理画面で、**データベースプロキシ**を選択します。
3. データベースプロキシページの**概要**ページで、**基本情報** > **ノード数**の横にある**設定を調整**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/f558c0dfbaa3f7686f397751749319ed.png)
4. ポップアップするダイアログボックスで、必要に応じてデータベースプロキシの関連設定（プロキシ仕様、アベイラビリティーゾーン、およびノード数）を変更し、**確定**をクリックします。
![](https://qcloudimg.tencent-cloud.cn/raw/efe6bb6da5af0df4a90cf52a6ed4486e.png)
5. データベースプロキシページの**基本情報**で、タスクの状態が**アップグレード中**から**動作中**になると、設定の調整が完了します。
>?
>- アップグレード完了時に切り替えることを選択した場合、設定変更完了後に、システムは自動的に新しい設定を適用します。
>- メンテナンス中に切り替えることを選択した場合、設定調整完了後に、システムは、指定されたメンテナンス期間中に新しい設定を反映します。
>- メンテナンス中に切り替えることを選択したが、業務のため前もって切り替える必要がある場合、設定変更完了後に、データベースプロキシ画面から**概要** > **基本情報** > **状態 / タスク**の順に選択し、アップグレード完了後に**今すぐ実行する**をクリックします。
>- 設定の調整後に負荷再分散を手動で再度行うことを選択した場合、設定調整完了後に、データベースプロキシページの**概要** > **接続アドレス**で負荷再分散を手動で操作できます。

