
ここでは、TencentDB for MySQLコンソールを介してデータベースプロキシを有効化する方法をご紹介します。

[データベースプロキシ](https://intl.cloud.tencent.com/document/product/236/42048)はクラウドデータベースサービスとアプリケーションサービスの間に位置するネットワークプロキシサービスであり、アプリケーションサービスがデータベースにアクセスする際に、すべてのリクエストをプロキシするために用いられます。データベースプロキシは自動読取/書き込み分離、コネクションプール、コネクション保持などの高度な機能を提供し、可用性が高く、高性能で、運用・保守性を持ち、使いやすくシンプルであるなどの特徴があります。

##  前提条件
- インスタンスのステータスは実行中で、インスタンスは2ノードまたは3ノードのアーキテクチャです。
- インスタンスは、シングルアベイラビリティーゾーンにデプロイされています。

## 注意事項
- データベースプロキシによって現在サポートされているリージョン：
  - 北京（1、2、4区を除く）、上海（1区を除く）、広州（1、2区を除く）、成都、重慶、南京、中国香港（1区を除く）。
  - 東京（1区を除く）、バンコク（1区を除く）、バージニア（1区を除く）、シリコンバレー（1区を除く）、ムンバイ（1区を除く）、ソウル（1区を除く）、シンガポール（1、2区を除く）。
- データベースプロキシが現在サポートするバージョン：2ノード、3ノードのMySQL 5.7（カーネルマイナーバージョンは20201230以降）、2ノード、3ノードのMySQL 8.0（カーネルマイナーバージョンは20211130以降）。マスターインスタンスのカーネルマイナーバージョンのアップグレードは、関連する読取専用インスタンスとディザスタリカバリインスタンスも同時にアップグレードします。[カーネルマイナーバージョンのアップグレード](https://intl.cloud.tencent.com/document/product/236/36816)をご参照ください。

## 操作手順
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストで、プロキシの有効化が必要なマスターインスタンスを選択し、インスタンスIDまたは**操作**の列の**管理**をクリックし、インスタンス管理ページに進みます。
2. インスタンス管理ページで、**データベースプロキシ**ページを選択し、**今すぐ有効化**をクリックします。
![](https://main.qcloudimg.com/raw/46d9e9b30975b51bee00a16c64f31c8b.png)
3. ポップアップしたダイアログボックスで、仕様ノードを選択し、**OK**をクリックし、ページを更新します。
    - ネットワークタイプ：VPCのみをサポートします。デフォルトではマスターインスタンスと一致します。
    - 代理仕様：2コア4000MBメモリ、4コア8000MBメモリ、8コア16000MBメモリ。
    - ノードの個数：プロキシノードの個数。推奨プロキシ個数は、マスターインスタンスと読取専用インスタンスのCPUコア数合計の1/8（切り上げ）です。例えば、マスターインスタンスが4コアのCPUで、読取専用インスタンスが8コアのCPUの場合、推奨プロキシ数＝(4+8)/8 ≒2となります。
    - コネクションプールステータス：コネクションプールの詳しい紹介については、[コネクションプール概要](https://intl.cloud.tencent.com/document/product/236/45622)をご参照ください。
    - セキュリティグループ：重要なネットワークセキュリティ隔離手段であり、必要に応じて既存のセキュリティグループまたはセキュリティグループの新規作成を選択することができます。
<img src="https://main.qcloudimg.com/raw/a3d8fafb1930d0298deb9cf2f08e706c.png"  style="zoom:90%;"> 
4. アクティブ化成功後、データベースプロキシページで基本情報の確認、プロキシノードの管理を行うことができます。また接続アドレスの項目でもデータベースプロキシアドレス、ネットワークのタイプの変更および備考の追加を行うことができます。
>?
>- プロキシノードリストの**接続数**を確認するか、各プロキシノードのパフォーマンス監視を確認することで、各ノードへのアクセスが偏っているかどうかを判断することができます。各プロキシノードへの接続数が偏っている場合、**リロードバランシング**をクリックして接続を分散させることができます。
>- リロードバランシングはプロキシノードの再起動をトリガーし、再起動中は一時的にサービスが利用できなくなります。 オフピーク時にサービスを再起動することをお勧めします。業務に再接続メカニズムが備わっていることを確認してください。
>
![](https://main.qcloudimg.com/raw/083d38858367fd7fe65e90fb92210178.png)

