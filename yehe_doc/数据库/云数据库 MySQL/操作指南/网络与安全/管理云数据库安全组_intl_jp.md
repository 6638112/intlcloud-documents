## 概要
[セキュリティグループ](https://intl.cloud.tencent.com/document/product/213/12452) は、フィルタリング機能を備えた仮想ファイアウォールであり、単一または複数のTencentDBインスタンスのネットワークアクセス制御を設定するために使用されます。これはTencent Cloudが提供するネットワークセキュリティ分離の重要な手段です。セキュリティグループはロジカルなグループであり、同一リージョン内で同一のネットワークセキュリティ分離要件を持つTencentDBインスタンスを同一のセキュリティグループに追加できます。TencentDBはCVMなどとセキュリティグループリストを共有し、セキュリティグループ内でルールに基づいて一致します。具体的なルールと制限については [セキュリティグループの概要](https://intl.cloud.tencent.com/document/product/215/38750)をご参照ください。

>?
>- TencentDB for MySQLセキュリティグループは現在、VPCとパブリックネットワークのネットワークアクセス制御のみをサポートしており、クラシックネットワークのネットワーク制御はサポートしていません。
>- フランクフルト、シリコンバレー、シンガポールのインスタンスに関連付けられているセキュリティグループは、現在、パブリックネットワークアクセス制御をサポートしていません。
>- クラウドデータベースは自発的にトラフィックをアウトバウンドしていないことから、アウトバウンドルールはクラウドデータベースに対して有効になりません。
>- TencentDB for MySQLのセキュリティグループはマスターインスタンス、読み取り専用インスタンス、ディザスタリカバリインスタンスをサポートしています。
>- TencentDB for MySQL単一ノード - ベーシック版はセキュリティグループに対応していません。


## クラウドデータベースのためにセキュリティグループを設定
### 手順1：セキュリティグループの作成
1. [CVMコンソール](https://console.cloud.tencent.com/cvm/securitygroup)にログインします。
2. 左側のサイドバーで**Security Group**を選択し、リージョンを選択して、**New**をクリックします。
3. 表示されるダイアログボックスで、次の項目を構成してから**OK**をクリックします。
 - テンプレート：セキュリティグループ内のデータベースインスタンスがデプロイする必要のあるサービスを基に、適切なテンプレートを選択し、セキュリティグループルールの構成を簡素化します。次の表に示すとおりです。
<table>
	<tr><th>テンプレート</th><th>説明</th><th>説明</th></tr>
	<tr><td>すべてのポートを開く</td><td>すべてのポートが開いています。セキュリティ上の問題が発生する可能性があります。</td><td>-</td></tr>
	<tr><td>ポート22、80、443、3389とICMPプロトコルを開く</td><td>デフォルトでは、ポート22、80、443、3389とICMPプロトコルをインターネットに開きます。すべてのポートはプライベートネットワークに開かれています。</td><td>このテンプレートはクラウドデータベースに対して無効です。</td></tr>
	<tr><td>カスタム</td><td>セキュリティグループを作成してから、カスタムルールを追加できます。操作の詳細は次の「セキュリティグループルールの追加」</a>をご参照ください。</td><td>-</rd></tr>
</table>
 - 名前：セキュリティグループの名前。
 - 所属プロジェクト：デフォルトでは**デフォルトプロジェクト**を選択します。その他のプロジェクトを選択することもできます。
 - 備考：カスタム。セキュリティグループの簡単な説明。


### 手順2：セキュリティグループルールの追加
1. [Security Group](https://console.cloud.tencent.com/cvm/securitygroup)ページで、ルールを設定するセキュリティグループを見つけて、**Operation**列の**Modify Rule**をクリックします。
2. セキュリティグループルールページで、**Inbound rule** > **Add Rule**をクリックします。
3. 表示されるダイアログボックスで、ルールを設定します。
 - Type：デフォルトで**Custom**を選択します。その他のシステムルールテンプレートを選択することもできます。MySQL(3306) テンプレートを選択することをお勧めします。
 - Source ：トラフィックソース（インバウンドルール） またはターゲット（アウトバウンドルール）。次のオプションから1つ選択してください。
<table>
	<tr><th>ソースまたはターゲット</th><th>説明</th></tr>
	<tr><td>単一のIPv4アドレスまたはIPv4アドレス範囲</td><td>CIDR表記を使用します（例：<code>203.0.113.0</code>、<code>203.0.113.0/24</code>または<code>0.0.0.0/0</code>。そのうち、<code>0.0.0.0/0</code>はすべてのIPv4アドレスが一致することを示します）。</td></tr>
	<tr><td>単一のIPv6アドレスまたはIPv6アドレス範囲</td><td>CIDR表記を使用します（例：<code>FF05::B5</code>、<code>FF05:B5::/60</code>、<code>::/0</code>または<code>0::0/0</code>。そのうち、<code>::/0</code>または<code>0::0/0</code>はすべてのIPv6アドレスが一致することを示します）。</td></tr>
	<tr><td>セキュリティグループIDの引用。次のセキュリティグループのIDを引用できます：<ul  style="margin: 0;"><li>セキュリティグループ ID</li><li>その他のセキュリティグループ</li></ul>
</td><td><ul  style="margin: 0;"><li>現在のセキュリティグループは、セキュリティグループに関連付けられているCVMを表します。</li><li>その他のセキュリティグループは、同じリージョン内の同じプロジェクトの下にある別のセキュリティグループIDを表します。</li></ul>　　
</td></tr>
	<tr><td><a href="https://intl.cloud.tencent.com/document/product/215/31867">パラメーターテンプレート</a>内のIPアドレスオブジェクトまたはIPアドレスグループオブジェクトを引用します。</td><td>-</td></tr>
</table>
 - プロトコルポート：プロトコルタイプとポート範囲を入力するか、 [パラメータテンプレート](https://intl.cloud.tencent.com/document/product/215/31867)のプロトコルポートまたはプロトコルポートグループを引用できます。
>!TencentDB for MySQLに接続するには、そのポートを開く必要があります。[TencentDB for MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストでインスタンスIDをクリックして、インスタンスの詳細ページでそのポート番号を表示できます。
>![](https://main.qcloudimg.com/raw/9f471c644eb9a5aa86bd092fdebd0255.png)
>
>- TencentDB for MySQLは、デフォルトでプライベートネットワークポート3306を使用し、ポートのカスタマイズをサポートします。デフォルトのポート番号が変更された場合は、セキュリティグループで新しいポートを開く必要があります。
>- TencentDB for MySQLは、デフォルトでパブリックネットワークポート60719を使用します。TencentDB for MySQLパブリックネットワークアクセスを有効にすると、セキュリティグループによって制御されるため、ポート60719と3306の両方を開く必要があります。
>- TencentDB for MySQLコンソールのセキュリティグループページで設定されたセキュリティグループルールは、プライベートネットワークアドレスとパブリックネットワークアドレス（有効な場合）の両方に対して有効になります。
>
 - ポリシー：許可または拒否。デフォルトでは**許可**が選択されています。
    - 許可：このポートへのトラフィックが許可されます。
    - 拒否：データパケットは応答なしで破棄されます。
 - 備考：カスタム。ルールの簡単な説明。
4. **完了**をクリックします。

#### 事例
**シナリオ：**1つのTencentDB for MySQLインスタンスを作成し、CVMインスタンスからTencentDB for MySQLにアクセスしたい。
**解決策：**セキュリティグループルールを追加する場合は、**タイプ**からMySQL(3306)を選択して、ポート3306を開きます。
必要に応じて、すべてのIPまたは指定したIP（IPセグメント）を開いて、CVMを介してTencentDB for MySQLにアクセスできるIPソースを設定します。

| インバウンドまたはアウトバウンド | タイプ | ソース | プロトコルポート | ポリシー |
|---------|---------|---------|---------|---------|
| インバウンド | MySQL(3306)  | すべてのIP：0.0.0.0/0<br>指定IP：指定したIP またはIPセグメントを入力 | TCP:3306 | 許可 |


### 手順3：セキュリティグループの設定
セキュリティグループは、Tencent Cloudが提供するインスタンスレベルのファイアウォールで、インバウンドトラフィックとアウトバウンドトラフィックをコントロールします。インスタンスの購入時にセキュリティグループを関連付けるか、インスタンスの購入後にコンソールでセキュリティグループを関連付けることもできます。

>!現在、TencentDB for MySQLのセキュリティグループは、**Virtual Private Cloudクラウドデータベース**の設定のみをサポートします。

1. [TencentDB for MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストでインスタンスIDをクリックして、インスタンス管理ページに進みます。
2. インスタンス管理ページで、**Security Group**タブを選択し、**Configure Security Group**をクリックします。
3. 表示されるダイアログボックスで、関連付けるセキュリティグループを選択し、**OK**をクリックします。 

## セキュリティグループルールのインポート
1. [Security Group](https://console.cloud.tencent.com/cvm/securitygroup)ページで、必要なセキュリティグループを選択し、セキュリティグループのID/名前をクリックします。　
2. インバウンド/アウトバウンドルールタブで、**Import Rule**をクリックします。
3. 表示されるダイアログボックスで、編集済みのインバウンド/アウトバウンドルールテンプレートファイルを選択して、**Import**をクリックします。
>? 既存のルールはインポート後のルールに上書きされます。新しいルールをインポートする前に既存のルールをエクスポートすることをお勧めします。

## セキュリティグループのクローン作成
1. [Security Group](https://console.cloud.tencent.com/cvm/securitygroup)ページで、目的のセキュリティグループを見つけ、**Operation**列の**More** > ** Clone**をクリックします。
2. 表示されるダイアログボックスで、ターゲットリージョンとターゲットプロジェクトを選択し、新しいセキュリティグループ名を入力して、**OK**をクリックします。新しいセキュリティグループをCVMインスタンスに関連付ける必要がある場合は、セキュリティグループ内のCVMインスタンスを管理してください。

## セキュリティグループの削除
1. [Security Group](https://console.cloud.tencent.com/cvm/securitygroup)ページで、削除するセキュリティグループを選択して、**Operation**列の**More** > ** Delete**をクリックします。
2. 表示されるダイアログボックスで、**OK**をクリックします。現在のセキュリティグループがCVMインスタンスに関連付けられている場合は、削除する前に関連付けを解除する必要があります。

