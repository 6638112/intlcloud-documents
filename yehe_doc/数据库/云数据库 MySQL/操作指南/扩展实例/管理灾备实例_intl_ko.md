## 작업 시나리오
끊김 없는 서비스와 높은 데이터 신뢰성이 요구되거나 관리 감독이 필요한 시나리오를 위해 TencentDB for MySQL는 리전 간 재해 복구 인스턴스를 제공하여 저렴한 비용으로 서비스 연속성과 데이터 신뢰성을 확보할 수 있게 도와줍니다.
>?재해 복구 인스턴스 요금과 마스터 인스턴스에 대한 내용은 [제품 가격](https://buy.cloud.tencent.com/price/cdb)을 참고하십시오.

#### 기능 특징
- 독립된 데이터베이스 연결 주소를 제공합니다. 재해 복구 인스턴스는 읽기 액세스 기능을 제공할 수 있으며 근거리 액세스, 데이터 분석 등 시나리오에 사용되어 디바이스 이중화 비용을 절감할 수 있습니다.    
- 가용성 높은 마스터/슬레이브 아키텍처로 데이터베이스 단일 노드 구성으로 인한 리스크를 예방할 수 있습니다.
- 재해 복구 인스턴스는 내부 네트워크 전용선을 통해 동기화하여 동기화 딜레이 시간을 줄이고 안정성을 높일 수 있으며 외부 네트워크보다 우수한 품질의 동기화 링크를 제공합니다. 
- 현재는 프로모션 기간으로 전용선 트래픽을 무상으로 이용할 수 있습니다. 상용화 후 요금 부과 시 별도로 공지합니다. 

#### 작동 원리
- Tencent CDB를 재해 복구 데이터베이스로 사용하는 시나리오에서 재해 복구 인스턴스는 마스터 인스턴스 데이터베이스를 복사한 백업입니다.  
- 마스터 인스턴스에 변화가 발생하면 기록이 수정된 Log 정보는 재해 복구 인스턴스에 복사된 후 로그 리플레이를 통해 데이터가 동기화됩니다. 
- 마스터 인스턴스에 장애가 발생하면 몇 초 내에 재해 복구 인스턴스가 활성화되며 읽기/쓰기 기능이 완전히 복구됩니다.  

## 기능 제한
- 1GB 메모리, 50GB 디스크 및 그 이상의 사양과 더불어 MySQL 5.6 이상 버전 및 InnoDB 엔진 고가용성 버전의 마스터 인스턴스만 재해 복구 인스턴스를 구매할 수 있습니다. 마스터 인스턴스의 사양이 낮을 경우, 먼저 사양을 업그레이드하고 GTID 기능을 사전에 활성화하십시오. 
>?GTID를 활성화하지 않은 경우, [콘솔](https://console.cloud.tencent.com/cdb/) 인스턴스 상세 페이지에서 활성화할 수 있습니다. GTID 활성화는 시간이 많이 소요되며 인스턴스 연결이 몇 초 정도 끊길 수 있습니다. 피크 시간대를 피해 작업하시고 데이터베이스 액세스의 재연결 메커니즘을 확보할 것을 권장합니다. 
- 재해 복구 인스턴스의 최저 사양은 1GB 메모리, 50GB 디스크이며, 마스터 인스턴스에 사용된 스토리지 사양의 1.1배 이상이어야 합니다.
- 한 개의 마스터 인스턴스는 최대 한 개의 재해 복구 인스턴스를 생성할 수 있습니다. 격리 상태 중에는 재해 복구 인스턴스를 재생성할 수 없습니다.  
- 현재 재해 복구 인스턴스의 미지원 기능: 마이그레이션, 롤백, SQL 작업, 매개변수 설정, 문자 세트 변경, 계정 관리, 포트 변경, 데이터 가져오기, 로그 롤백, 읽기 전용 인스턴스 기능.

## 작업 절차
### 재해 복구 인스턴스 생성
#### 1단계: 재해 복구 인스턴스 생성
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 후, 인스턴스 리스트에서 인스턴스 ID 또는 '작업' 열의 [관리]를 클릭하여 상세 페이지로 이동합니다.
2. 인스턴스 상세 페이지의 기본 정보에서 GTID 기능이 활성화 되어 있는지 확인하고, 인스턴스 아키텍처에서 [재해 복구 인스턴스 추가]를 클릭하여 재해 복구 인스턴스 구매 페이지로 이동합니다. 
![](https://main.qcloudimg.com/raw/d41ae3d97935763b180f2e8a26cb2364.png)
3. 구매 페이지에서 재해 복구 인스턴스의 ‘과금 모드’, ‘리전’, ‘동기화 정책’ 등 기본 정보를 설정합니다. 
 - 동기화 정책이 ‘즉시 동기화’일 경우 재해 복구 인스턴스를 생성하면 데이터가 바로 동기화됩니다. 
 - 동기화 정책이 ‘생성 후 동기화’일 경우, 재해 복구 인스턴스를 생성한 후 재해 복구 동기화 링크를 설정해야 합니다. 자세한 내용은 다음 [동기화 링크 생성]을 참고하십시오.(#cjtblj).
>?
>- 데이터 양에 따라 생성 시간이 달라질 수 있습니다. 생성 중에는 마스터 인스턴스의 콘솔 작업이 잠금 상태가 되니 작업 시 주의하십시오.   
>- 현재 전체 인스턴스 데이터 동기화만 지원합니다. 디스크 용량이 충분한지 확인하십시오.  
>- 마스터 인스턴스 상태가 실행 중이고 다운그레이드, 재시작 등 다른 실행 관련 변경 작업을 진행하고 있지 않은지 확인하십시오. 그렇지 않을 경우 동기화 작업이 정상적으로 수행될 수 없습니다.   
4. 오류가 없음을 확인한 후, [즉시 구매]를 클릭하고 재해 복구 인스턴스가 발송되길 기다리십시오. 
5. 인스턴스 리스트로 되돌아갑니다. 인스턴스 상태가 '실행 중'으로 변경되면, 후속 작업을 진행할 수 있습니다.

#### [2단계: 동기화 링크 생성(옵션)](id:cjtblj)
>? 구매 시 ‘동기화 정책’을 ‘생성 후 동기화’로 선택한 경우, 재해 복구 인스턴스가 생성된 후 재해 복구 동기화 링크를 설정하여 원격 재해 복구를 구현할 수 있습니다. 

1. 마스터 인스턴스의 인스턴스 상세 페이지에서 재해 복구 인스턴스의 동기화 상태를 조회할 수 있습니다. [동기화 작업 생성]을 클릭하면 재해 복구 인스턴스에 마스터 인스턴스의 내부 네트워크와 동기화 링크를 생성합니다. 
![](https://main.qcloudimg.com/raw/f2f941ccf588d54cb2687cc0a9d0a961.png)
2. 작업 이름을 작성하고 소스 라이브러리 정보 및 객체 라이브러리 정보를 확인한 후, [저장 및 다음 단계]를 클릭합니다. 
![](https://main.qcloudimg.com/raw/5a2b3ef40de69af903cc60396d8f1a84.png)
3. 동기화할 객체를 선택합니다. 전체 인스턴스 동기화 또는 일부 DB 테이블만 동기화를 지원합니다. 현재 동기화 유형 선택 기능은 지원하지 않습니다. 
![](https://main.qcloudimg.com/raw/ac3f2db7c68f708ac07bb597a420ae83.png)
4. [저장 및 인증]을 클릭하면 [인증 작업]으로 이동합니다. 인증 완료 후, [작업 실행]을 클릭하면 MySQL의 ‘재해 복구 동기화’ 페이지에서 작업 상세 내용을 확인할 수 있습니다.    
![](https://main.qcloudimg.com/raw/4cc319646447bb20a5a76982a0783a49.png)

### 재해 복구 인스턴스 관리
- **재해 복구 인스턴스 조회**
재해 복구 인스턴스는 소속 리전에서 조회할 수 있으며 인스턴스 리스트에서 해당 리전의 전체 재해 복구 인스턴스를 필터링할 수 있습니다. 
![](https://main.qcloudimg.com/raw/1ade1aa59f7c5cd74b2cf30299d31cac.png)
- **종속 관계 확인**
각 재해 복구 인스턴스 또는 마스터 인스턴스 우측의 이미지를 클릭하면 종속 관계를 확인할 수 있습니다. 
![](https://main.qcloudimg.com/raw/4b98a6b2831c027af52a37050aa16f2d.png)
![](https://main.qcloudimg.com/raw/f08c6d3dd53a40ea544bdadc9e111ee8.png)
- **동기화 딜레이 조회**
재해 복구 인스턴스의 인스턴스 상세 페이지 상단에서 마스터 인스턴스와 재해 복구 인스턴스 간의 동기화 딜레이를 확인할 수 있습니다. 
![](https://main.qcloudimg.com/raw/d06a9c821f5ebd04173ee6e453ef5ef2.png)
- **재해 복구 인스턴스 기능**
재해 복구 인스턴스는 인스턴스 세부 사항, 인스턴스 모니터링, 백업 관리, 로그 슬로우 쿼리 기능을 제공합니다.  
 
### 재해 복구 인스턴스를 마스터 인스턴스로 업그레이드
재해 복구 인스턴스를 마스터 인스턴스로 전환해야 할 경우 콘솔에서 자체적으로 전환할 수 있습니다. 
1. [인스턴스 리스트](https://console.cloud.tencent.com/cdb)에서 마스터 인스턴스로 업그레이드할 재해 복구 인스턴스를 선택한 후, 인스턴스 ID를 클릭하면 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 우측 상단의 [마스터 인스턴스로 전환]을 클릭하면 재해 복구 인스턴스가 마스터 인스턴스로 업그레이드됩니다. 전환 후에는 기존 마스터 인스턴스와의 동기화 연결이 끊어지고 인스턴스 데이터베이스의 데이터 입력 기능과 MySQL 기능이 복구됩니다.   
>! 동기화 연결이 끊어지면 재연결할 수 없습니다. 작업 시 주의하십시오.
> 
![](https://main.qcloudimg.com/raw/c4e1517d56c630ff845c89060402e657.png)

