TencentDB for MySQLでは、バックアップの保存コストを削減するために、コールドバックアップへのダウングレードをサポートしています。このドキュメントでは、コールドバックアップへのダウングレードの概要と設定について説明します。
>?
>-　コールドバックアップへのダウングレードでは無料スペースを使用できません。
>-　アーカイブストレージ機能は現在オープンしていませんので、しばらくお待ちください。

## 概要
**コールドバックアップへのダウングレード**：生成されたバックアップファイル（データバックアップファイルとbinlogバックアップファイルを含む）のストレージタイプを変換し、コストを削減します。TencentDB for MySQLは、設定したコールドバックアップへのダウングレードルールに基づいて、設定時間が経過すると自動的にバックアップファイルのストレージタイプを変換します。

**自動バックアップ>バックアップ保持時間を設定した**後、バックアップファイルはバックアップポリシーに従って保存されます。設定された保持時間内において、**コールドバックアップへのダウングレード**を使用すると、バックアップファイルを生成してからN日（設定可能）後のバックアップを標準ストレージにダウングレードし、さらに、バックアップファイルが生成してからX日（設定可能）後のバックアップをアーカイブストレージにダウングレードすることができます。これをコールドバックアップへのダウングレードと呼びます。

**バックアップファイルのストレージタイプの定義**
- 標準ストレージ：ロールバックとクローンのような頻繁にアクセス・使用するビジネスシーンに適しています。空き容量を占有せず、プライベートネットワーク経由のダウンロードのみをサポートします。
- アーカイブストレージ：アクセス頻度の低いビジネスシーンに適しています。アーカイブストレージには最低180日の保持時間が必要で、ダウンロードはサポートされていません。

## 機能説明
- バックアップファイルを生成してから指定した日数が経過すると、標準ストレージにダウングレードするように設定できます。指定した日数の最小値は30日とし、最大値は設定されたバックアップ保持時間を超えないように設定できます。
- バックアップファイルを生成してから指定した日数が経過するとアーカイブストレージにダウングレードするように設定できます。指定した日数の最小値は180日とし、最大値は設定したバックアップ保持時間とします。
- バックアップストレージタイプの変換は、ホットからコールド（通常ストレージ＞標準ストレージ＞アーカイブストレージ）までで、その逆はできません。
- コールドバックアップへのダウングレードのための保持時間を設定すると、ダウンコールドポリシーは（GMT+8）翌日の0時から実行されます。ルールが設定された後のバックアップについて、ライフサイクルタスクは非同期で実行されるため、通常は翌日の24時までに実行が完了します。経過時間はバックアップファイルをダンプした更新日時を基準に計算します。
- コールドバックアップへのダウングレードはデータファイルのバックアップとbinlogファイルのバックアップで個別に設定されます。
- コールドバックアップへのダウングレードは定期保持を使用できます。

## 課金説明
コールドバックアップへのダウングレード後の料金価格は低くなり、ストレージコストを削減させます。料金の詳細については、[コールドバックアップへのダウングレード料金の説明](https://intl.cloud.tencent.com/document/product/236/32344)をご参照ください。

##　コールドバックアップへのダウングレードポリシーの説明
1. バックアップ保持時間が30日以下の場合、コールドバックアップへのダウングレードを設定できません。バックアップ保持時間を30日より大きく設定してください。
![](https://staticintl.cloudcachetci.com/yehe/backend-news/6zQ3891_1.png)
5. コールドバックアップへのダウングレードルールを選択すると有効になります。選択しないと、必要なストレージにダウングレードしません。

##　コードバックアップへのダウングレード設定
1. [MySQLコンソール](https://console.cloud.tencent.com/cdb)にログインし、インスタンスリストのページでインスタンスIDをクリックすると、管理ページに進み、**バックアップと復元** > **自動バックアップの設定**を選択します。
![](https://staticintl.cloudcachetci.com/yehe/backend-news/mAch593_2.png)
2. 表示されたバックアップ設定ダイアログで必要に応じてバックアップ保持時間とサイクルを設定した後、またはログバックアップの保持時間を設定した後、適切なコールドバックアップへのダウングレードポリシーを選択し、日数を指定します。
![](https://staticintl.cloudcachetci.com/yehe/backend-news/QXbQ741_3.png)
3. バックアップスペースの料金に関する説明を読んでチェックを入れ、**OK**をクリックします。

##　コールドバックアップへのダウングレード設定の例
**例1：通常バックアップ+コールドバックアップへのダウングレード設定**
**背景**
企業Aは広州地域にTencentDB for MySQLのインスタンスを持っています。そのデータのバックアップ保持時間は200日で、通常のバックアップサイクルは毎週月曜日、水曜日、金曜日、日曜日とし、2022年12月31日にコールドバックアップへのダウングレードポリシーを設定しました。バックアップファイルを生成してから90日後に標準ストレージにダウングレードし、180日後にアーカイブストレージにダウングレードします。
**コールドバックアップへのダウングレード予想**
- コールドバックアップへのダウングレードポリシーが有効になる時間：2023年1月1日0時から24時までです。
- 既存のバックアップファイル：2023年1月1日を開始日として、生成してから90日以上経過する既存のバックアップファイルは標準ストレージに、180日以上経過する既存のバックアップファイルはアーカイブストレージにダウングレードします。
- 増分バックアップファイル：2023年1月1日を開始日として、新たに生成してから90日以上経過すると標準ストレージに、180日以上経過するとアーカイブストレージにダウングレードします。

**例2：定期バックアップ+コールドバックアップへのダウングレード設定**
**背景**
企業Bは広州地域にTencentDB for MySQLのインスタンスを持っています。データのバックアップ保存時間は365日とし、通常のバックアップサイクルは月曜日、水曜日、金曜日、日曜日で、定期バックアップ保持時間は365日とし、毎月1つのバックアップファイルが定期的に作成され、2023年1月31日にコールドバックアップへのダウングレードポリシーを設定しました。バックアップファイルを生成してから90日後に標準ストレージに、180日後にアーカイブストレージにダウングレードします。
**コールドバックアップへのダウングレード予想**

- コールドバックアップへのダウングレードポリシーが有効になる時間：2023年2月1日0時から24時までです。
- バックアップファイル：2023年2月1日を開始日として、生成してから90日以上経過する既存のバックアップファイルは標準ストレージに、180日以上経過する既存のバックアップファイルはアーカイブストレージにダウングレードします。
- 増分バックアップファイル：2023年2月1日を開始日として、新たに生成してからバックアップファイルは90日以上経過すると標準ストレージに、180日以上経過するとアーカイブストレージにダウングレードします。
次の図に示すバックアップ保持計画では新しく作成された各バックアップファイルがコールドバックアップへのダウングレードポリシーで設定された時間通りにダウングレードします。またデータバックアップのダウングレードはホットからコールドまでです。
![](https://staticintl.cloudcachetci.com/yehe/backend-news/EGDL442_4.png)
