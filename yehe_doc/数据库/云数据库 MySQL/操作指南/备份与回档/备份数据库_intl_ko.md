데이터 손실 또는 손상에 대비해 자동/수동 백업 방식으로 데이터베이스를 백업할 수 있습니다.

## 백업 개요
### 백업 방식
TencentDB for MySQL의 이중 노드와 3중 노드 모두 **자동 백업**, **수동 백업** 두 가지 방식의 데이터베이스 백업을 지원합니다.

### 백업 유형
TencentDB for MySQL의 이중 노드와 3중 노드는 두 가지 백업 유형을 지원합니다.
- **물리적 콜드 백업**, 물리 데이터 풀 복제(자동 백업과 수동 백업 모두 지원)
- **로직 콜드 백업**, SQL 명령 백업(수동 백업 지원)
>?
>- 물리적 백업 복구 방식은 xbstream으로 패킷을 해제해야 합니다. 자세한 내용은 [물리적 백업으로 데이터베이스 복구](https://intl.cloud.tencent.com/document/product/236/31910)를 참조 바랍니다.
>- 낱개 인스턴스의 테이블 수량은 100만을 초과하면 백업에 실패할 수 있습니다. 데이터 모니터링에도 영향을 미칠 수 있으므로 테이블 수량을 합리한 수준으로 적용해주시고, 낱개 인스턴스 테이블 수량은 100만이상을 넘지 않도록 제어하십시오.
>- Memory 엔진 테이블의 데이터는 메모리에 저장되므로 Memory 엔진 테이블은 물리적 콜드 백업을 할 수 없습니다. 데이터 손실을 피하기 위해 Memory 엔진 테이블을 InnoDB 테이블로 전환하시기를 권장합니다.
>- 인스턴스에 기본 키가 없는 테이블이 대량으로 존재할 경우 백업에 실패할 수 있으며 인스턴스의 고가용성에도 영향을 미칠 수 있으므로 기본 키가 없는 테이블에 기본 키 혹은 2단계 인덱스를 생성하시기 바랍니다.

| 물리적 콜드 백업의 장점 | 로직 콜드 백업의 단점 |
|---------|---------|
| <li>백업 속도가 빠릅니다.<li>스트리밍 백업과 압축 해제를 지원합니다.<li>백업 성공률이 높습니다.<li>백업이 쉽고 효율적입니다.<li>백업을 기반으로 커플링 작업 시 RO 추가, 재해 복구 추가 등이 더 빨라집니다.<li>물리적 콜드 백업이 완료되는 평균시간은 로직 콜드 백업의 1/8 수준입니다.<li>물리적 콜드 백업 가져오기 속도가 로직 콜드 백업보다 약 10배 빠릅니다.| <li>복구 시 SQL을 실행하고 인덱스를 생성해야 하며, 복구 시간이 길어집니다.<li>백업 속도가 느립니다. 데이터양이 많을 경우 속도가 더 느려집니다.<li>백업하는 과정에서 인스턴스에 부하를 주며, 프라이머리-세컨더리의 딜레이가 증가될 수 있습니다.<li>부동 소수점의 정밀도 메시지를 손실할 수 있습니다.<li>다양한 요인(에러 뷰 등)으로 백업에 실패할 수 있습니다.<li>백업을 기반으로 커플링 작업을 진행하며 RO 추가, 재해 복구 추가 등의 작업이 느려질 수 있습니다.</li> |

### 백업 오브젝트
| 데이터 백업 | 로그 백업 |
|---------|---------|
| MySQL 이중 노드, 3중 노드: <li>자동 백업은 모든 물리 백업을 지원합니다. <li>수동 백업은 모든 물리 백업과 로직 백업, 모든 단일 DB와 테이블의 로직 백업을 지원합니다.<li>자동 백업과 수동 백업 모두 압축 및 다운로드를 지원합니다. | 데이터베이스의 binlog 로그 파일 백업은 MySQL 이중 노드와 3중 노드를 지원합니다: <li>로그 파일은 인스턴스의 백업 용량을 차지합니다. <li>로그 파일은 다운로드할 수 있으나 압축할 수 없습니다. <li>로그 파일 보관 기간을 설정할 수 있습니다.</li>|

## 주의 사항
- 2019년 02월 26일부터 TencentDB for MySQL의 자동 백업은 물리적 콜드 백업만 지원합니다. 자동 백업 설정은 기본적으로 물리적 콜드 백업으로 적용되며, 더는 로직 콜드 백업은 제공되지 않습니다. 인벤토리를 로직 콜드 백업으로 자동 백업한 인스턴스는 차츰 물리적 콜드 백업으로 자동 교체됩니다.
해당 교체 작업은 서비스 액세스에 영향을 미치지 않지만, 자동 백업을 선호하는 사용자의 스타일에 영향을 미칠 수 있습니다. 로직 백업을 원하시면 [TencentDB for MySQL 콘솔](https://console.cloud.tencent.com/cdb)에서 수동 백업 모드를 사용하거나 [API 호출](https://intl.cloud.tencent.com/document/product/236/15844)을 통해 로직 백업을 생성할 수 있습니다.
- 인스턴스 백업 파일은 백업 용량을 차지하므로 합리적으로 사용하시기 바라며, 무료 한도를 초과한 백업 용량은 요금이 부과됩니다. 자세한 내용은 [백업 용량 요금 설명](https://intl.cloud.tencent.com/document/product/236/32344)을 참조하십시오.
- 서비스의 낮은 피크타임에 백업해주시기 바랍니다.
- 백업이 필요한 파일은 보류기간을 초과하여 삭제되는 경우가 없도록, 필요한 백업 파일을 빠른 기간내에 로컬에 다운로드하시기 바랍니다.
- 백업 기간에 테이블 잠금으로 백업이 실패하는 경우가 없도록 확보하고자 DDL 조작을 금지합니다. 
- 단일 노드의 MySQL 인스턴스는 데이터베이스 백업을 지원하지 않습니다.

## MySQL 데이터 자동 백업
### 자동 백업 설정
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인한 뒤 인스턴스 리스트에서 인스턴스 ID를 클릭하고, 관리 페이지로 이동하여 **백업 복구** > **자동 백업 설정**을 선택합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/da6aad42478cbbddba52d02b1d677238.png)
2. 백업 설정 팝업 창에서, 각 백업 매개변수를 선택하고 **확인**을 클릭합니다. 매개변수 설명은 다음과 같습니다.
>?
> - [롤백 기능](https://intl.cloud.tencent.com/document/product/236/7276)은 백업 주기와 백업 보관일 내의 데이터 백업 + 로그 백업(binlog)을 기반으로 합니다. 자동 백업의 빈도수와 보관일 단축은 인스턴스 데이터의 롤백 시간 범위에 영향을 미치므로, 백업 설정의 밸런스를 적절히 조절하시기 바랍니다.
> 예를 들어 백업 주기가 월요일, 목요일이고 보관 기간이 7일로 설정된 경우, 7일 이내(데이터 백업 및 로그에 실제 저장 시간 백업)의 임의 시점으로 롤백할 수 있습니다.
> - 자동 백업은 수동으로 삭제할 수 없으며, 백업 보관 기간을 설정할 수 있습니다. 기간 만료 후에는 자동으로 삭제됩니다.
> - 데이터 백업 및 로그 백업 보관 일수를 늘리면 백업 공간에 대한 추가 요금이 발생할 수 있습니다.
> - 로그 백업의 보관 일수를 줄이면 인스턴스의 데이터 롤백 기간에 영향을 미칠 수 있습니다.

자동 백업 설정에서 데이터 백업 설정은 정기 보관 정책 활성화를 지원하며, 다음은 정기 백업 및 정기 백업 활성화에 대한 파라미터 설정 방법에 대한 설명입니다.
>!정기 백업 보관 시간은 일반 백업에 대해 설정된 보관 시간보다 클 수 있습니다.
>

### 일반 백업 설정 설명
| 매개변수     | 설명 |
|---------|---------|
| 백업 시작 시간 | <li>기본 백업 시간은 시스템이 자동 할당한 백업 시작 시간입니다.<li>시간 구간을 사용자가 지정할 수 있으며 비즈니스 양이 많지 않은 시기로 설정하시기를 권장합니다. 백업 시작 시간은 백업이 시작되는 시간으로, 백업이 종료되는 시간이 아닙니다.<br>예를 들어, 02:00-06:00를 선택하면 시스템은 02:00-06:00 시간 내에서 임의의 시간에 백업을 시작하며, 구체적인 시작 시간은 백그라운드 백업 정책과 백업 시스템의 상황에 따라 다를 수 있습니다.</br> |
| 데이터 백업 보관 기간 | 데이터 백업 파일은 7일(기본값) ~ 1830일 동안 보관할 수 있습니다. 백업 세트는 만료 후 자동으로 삭제됩니다. |
| 백업 주기 | 데이터 안전을 위해, 일주일에 최소 2회 백업하도록 설정하시기 바랍니다. |
| 로그 백업 보관 기간 | 로그 백업 파일은 7일(기본값) ~ 1830일 동안 보관할 수 있습니다. 백업 세트는 만료 후 자동으로 삭제됩니다. |

![](https://qcloudimg.tencent-cloud.cn/raw/9c018f548a012b427daf0227f2a93642.png)

### 정기 백업 설정 활성화
| 매개변수     | 설명 |
|---------|---------|
| 백업 시작 시간 | <li>기본 백업 시간은 시스템이 자동 할당한 백업 시작 시간입니다.<li>시간 구간을 사용자가 지정할 수 있으며 비즈니스 양이 많지 않은 시기로 설정하시기를 권장합니다. 백업 시작 시간은 백업이 시작되는 시간으로, 백업이 종료되는 시간이 아닙니다.<br>예를 들어, 02:00-06:00를 선택하면 시스템은 02:00-06:00 시간 내에서 임의의 시간에 백업을 시작하며, 구체적인 시작 시간은 백그라운드 백업 정책과 백업 시스템의 상황에 따라 다를 수 있습니다.</br> |
| 데이터 백업 보관 기간 | 데이터 백업 파일은 7일(기본값) ~ 1830일 동안 보관할 수 있습니다. 백업 세트는 만료 후 자동으로 삭제됩니다. |
| 백업 주기 | 데이터 안전을 위해, 일주일에 최소 2회 백업하도록 설정하시기 바랍니다. |
| 주기적인 백업 보관 기간 | 데이터 백업 파일은 90일 ~ 3650일 (기본값:1080일)동안 보관할 수 있습니다. 백업 세트는 보관 기간이 지나면 자동으로 삭제됩니다. |
| 정기 백업 보관 정책 | 월별, 분기별 또는 연간 기준으로 보관할 백업 수 설정을 지원합니다. |
| 시작 시간 | 백업 정기 보관 주기의 시작 시간입니다. |
| 로그 백업 보관 시간 | 로그 백업 파일은 7일(기본값) ~ 1830일 동안 보관할 수 있습니다. 백업 세트는 만료 후 자동으로 삭제됩니다. |

![](https://qcloudimg.tencent-cloud.cn/raw/78c89e11aa7acab08de33b2f609fc56e.png)

### 보관 계획 조회
백업 설정에서 정기 백업 보관 정책을 선택한 후 **보관 계획 보기**를 클릭하여 미리 볼 수 있습니다.
![](https://qcloudimg.tencent-cloud.cn/raw/9b7c21feff9bf1409c80f745fbf1d370.png)
- 파란색으로 표시된 날짜는 일반 백업 날짜를 나타냅니다.
- 빨간색으로 표시된 날짜는 정기 백업 날짜를 나타냅니다.
- 일반 백업 또는 정기 백업을 클릭하여 해당 날짜의 색상 표시를 숨길 수 있으므로 미리 보기가 편리합니다.
- 백업 계획 미리 보기는 시작 날짜로부터 향후 1년의 백업 상황입니다(참고용).

데모1: 백업 주기는 월요일, 수요일, 금요일, 일요일입니다. 2022년 1월 11일부터 매월 1개의 백업을 유지합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/9815814482b467916689b36d7f7b523b.png)
데모2: 백업 주기는 월요일, 수요일, 금요일입니다. 2022년 1월 11일부터 분기당 3개의 백업을 유지합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/9815814482b467916689b36d7f7b523b.png)
데모3: 정기 백업만 표시합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/ec59982c8f84ae59e652f5efdfb65996.png)


## [MySQL 데이터 수동 백업](id:manual-backup)
수동 백업 기능을 통해 사용자는 스스로 백업 작업을 시작할 수 있습니다.
>?
>- 수동 백업은 전체 물리적 콜드 백업, 전체 로직 콜드 백업과 단일 라이브러리 테이블 로직 콜드 백업을 지원합니다.
>- 수동 백업 기능을 사용하면 백업 리스트에서 파일을 수동으로 삭제하여 백업 공간을 확보함으로써 용량 낭비를 막을 수 있습니다. 수동으로 삭제하지 않으면 데이터베이스 인스턴스가 완전 삭제 될 때까지 영구 보관됩니다.
>- 인스턴스가 그 날의 자동 백업 작업을 실행하는 동안에는 수동 백업을 시작할 수 없습니다.
>
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb) 로그인 후, 인스턴스 리스트에서 인스턴스 ID를 클릭하여 관리 페이지로 이동한 후 **백업 복구** > **수동 백업**을 선택합니다.
2. 백업 설정 팝업 창에서 백업 모드와 객체를 선택하고 비고명을 입력한 후 **확인**을 클릭합니다.
![](https://main.qcloudimg.com/raw/a16e644f51756b6a98597945e45329cd.png)
>?로직 백업에서 단일 라이브러리 백업 혹은 단일 테이블을 백업하려면 왼쪽의 **테이블 선택**에서 백업할 데이터베이스 혹은 데이터 테이블을 체크하고, 데이터베이스 혹은 테이블을 오른쪽 리스트에 추가합니다. 데이터베이스가 아직 없다면, 먼저 데이터베이스 혹은 테이블을 생성하시기 바랍니다.
>
![](https://main.qcloudimg.com/raw/76924e2c76ac348b68ed113d679d6907.png)

## FAQ
#### 1. 백업 보관 기간이 만료된 백업 파일을 다운로드하거나 복원할 수 있나요?
만료된 백업 세트는 자동으로 삭제되며 다운로드 및 복원할 수 없습니다.
- 필요에 따라 백업 보관 기간을 적절하게 설정하거나 [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에서 백업 파일을 로컬에 다운로드하시길 권장합니다.
- 콘솔에서 인스턴스 데이터를 수동으로 백업할 수 있습니다. 수동 백업 파일은 영구 저장됩니다.
>?수동 백업도 백업 용량을 차지합니다. 추가 요금이 부과되지 않도록 백업 용량을 합리적으로 사용하시기 바랍니다.

#### 2. 백업을 수동으로 삭제할 수 있나요?
- 자동 백업은 수동으로 삭제할 수 없으며, 백업 보관 기간을 설정할 수 있습니다. 기간 만료 후에는 자동으로 삭제됩니다. 
- 수동 백업은 [MySQL 콘솔](https://console.cloud.tencent.com/cdb)의 백업 리스트에서 수동으로 삭제할 수 있으며, 수동으로 삭제하지 않는 한 영구적으로 보관합니다.

#### 3. 데이터 백업과 로그 백업을 비활성화할 수 있나요?
비활성화는 불가능합니다. 그러나 [MySQL 콘솔](https://console.cloud.tencent.com/cdb)에서 백업 빈도를 줄이고, 사용하지 않는 수동 백업 데이터를 삭제하여 백업 공간 점유량을 줄일 수 있습니다.

#### 4. 어떻게 하면 백업 용량 요금을 절약할 수 있나요?
- 더 이상 사용하지 않는 수동 백업 데이터를 삭제합니다. 수동 백업은 [MySQL 콘솔](https://console.cloud.tencent.com/cdb)의 인스턴스 관리 페이지 > 백업 복구 페이지에서 삭제할 수 있습니다. 
- 비핵심 작업 데이터의 자동 백업 빈도를 낮춥니다. 콘솔에서 백업 주기 및 백업 보관 기간을 변경할 수 있으며, 백업은 1주에 최소 2회 이상 진행합니다.
>?[롤백 기능](https://intl.cloud.tencent.com/document/product/236/7276)은 백업 주기와 백업 보관일 내의 데이터 백업+로그 백업(binlog)을 기반으로 합니다. 자동 백업의 빈도수와 보관일 단축은 인스턴스 데이터의 롤백 시간 범위에 영향을 미치므로, 백업 설정의 밸런스를 적절히 조절하시기 바랍니다.
>
- 비핵심 비즈니스의 데이터 백업 및 로그 백업 보관 기간을 줄입니다. 백업 유지 기간은 7일이며 대부분 시나리오의 요구사항을 충족합니다.

| 비즈니스 시나리오             | 백업 유지 기간                                                 |
| -------------------- | ------------------------------------------------------------ |
| 핵심 서비스             | 7일 - 1830일 추천                                              |
| 비핵심, 비데이터류 비즈니스 | 7일 추천                                                      |
| 아카이브 비즈니스             | 데이터 백업 유지 기간은 7일을 권장합니다. 실제 비즈니스 니즈에 따라 수동으로 데이터를 백업하고 사용 완료 즉시 삭제합니다. |
| 테스트 비즈니스             | 데이터 백업 유지 기간은 7일을 권장합니다. 실제 비즈니스 니즈에 따라 수동으로 데이터를 백업하고 사용 완료 즉시 삭제합니다. |
