## 작업 시나리오
TencentDB for MySQL은 사용자의 데이터를 수정하지 않습니다. 개인적인 이유로 손상된 데이터는 자체적으로 롤백을 통해 복구할 수 있습니다. 데이터 백업 및 binlog 백업을 기반으로 Tencent Cloud의 데이터베이스 또는 테이블을 롤백하는 롤백 기능이 제공되며, 실시간 데이터 롤백이 지원됩니다.

TencentDB for MySQL 롤백 기능은 주기적 이미지와 실시간 트랜잭션을 재구성함으로써 데이터베이스 또는 테이블을 지정된 시점으로 롤백할 수 있으며 모든 데이터의 타임 슬라이스가 동일하도록 보장됩니다. 원본 인스턴스에서 새로운 데이터베이스나 테이블이 생성되며, 이 과정에서 원본 데이터베이스나 테이블에 정상적으로 접근할 수 있습니다. 롤백이 완료되면 새 데이터베이스와 원본 데이터베이스 또는 테이블을 모두 볼 수 있습니다.

## 기능 원리
롤백 기능은 `콜드 데이터 백업 + 해당 binlog 백업`을 기반으로 데이터베이스 또는 테이블을 지정된 시점으로 롤백할 수 있습니다.
![](https://main.qcloudimg.com/raw/56699dba58319c212d93c38c6adabbae.png)

1. MySQL 복제본에서 데이터를 내보내고 매일 콜드 백업 시스템으로 가져옵니다.
2. 데이터베이스 또는 테이블을 롤백하려면 롤백 시스템에서 임시 롤백 인스턴스를 요청합니다. 콜드 백업 시스템에서 콜드 데이터를 내보내고 임시 롤백 인스턴스로 가져옵니다(가져온 데이터 유형은 롤백 방법에 따라 다름).
3. 롤백 인스턴스와 MySQL 원본 인스턴스 간에 원본-복제본 관계를 설정하고 롤백 시간을 설정하고 롤백할 데이터베이스 또는 테이블을 지정합니다.
4. 롤백 데이터베이스 또는 테이블을 MySQL 원본 인스턴스에 복제합니다.

## 기능 제한
- 클라우드 디스크 버전의 단일 노드 인스턴스는 롤백할 수 없습니다.
- 원본 인스턴스만 롤백할 수 있습니다. 읽기 전용 또는 재해 복구 인스턴스는 롤백할 수 없습니다.
- 지정된 데이터베이스 또는 테이블만 롤백할 수 있습니다. 롤백 후 데이터베이스 또는 테이블은 이름이 바뀌고 원본 인스턴스에 복제됩니다.
- MySQL 5.6, 5.7, 8.0 버전은 롤백을 지원하므로, MySQL 5.5는 빠른 시일 내에 상위 버전으로 업그레이드하는 것이 좋습니다. 업그레이드는 [데이터베이스 엔진 업그레이드](https://intl.cloud.tencent.com/document/product/236/8126)를 참고하십시오.

## 주의 사항
- 롤백 기능은 자동 백업을 위해 설정한 백업 주기 및 보관 일수를 따르며, 데이터 백업을 기반으로 한 데이터 롤백과 구성된 보관일과 백업 주기를 기반으로 하는 binlog 백업을 가능하게 합니다. 백업 주기 설정은 [데이터베이스 백업](https://intl.cloud.tencent.com/document/product/236/37796)을 참고하십시오. MySQL 데이터 보안을 위해 자동 백업 주기를 주 2회 이상으로 설정하십시오.
- 정액 과금제 인스턴스가 만료되지 않았지만 계정이 연체된 경우 백업 서비스는 롤백이 비활성화된 상태로 다운그레이드됩니다. 롤백하려면 계정 잔액을 충전하십시오.
- 롤백할 데이터베이스 또는 테이블이 존재하지 않거나 삭제된 경우, 콘솔에서 롤백을 수행하기 전에 먼저 TencentDB 인스턴스에 로그인하여 생성해야 합니다.
- 롤백 전 콜드 백업에 테이블이 포함되어 있지 않으면 롤백에 실패합니다.

## 작업 단계
1. [TencentDB for MySQL 콘솔](https://console.cloud.tencent.com/cdb)에 로그인하여 인스턴스 목록에서 롤백할 인스턴스를 하나 이상 선택한 후 **더 보기** > **롤백**을 선택합니다.
>?
>- 하나의 인스턴스에서만 롤백을 수행하려면 인스턴스 관리 페이지로 이동하여 오른쪽 상단의 **롤백**을 클릭하여도 됩니다.
>- 동일한 APPID에서 한 번에 최대 5개의 롤백 작업을 시작할 수 있습니다.
>
![](https://qcloudimg.tencent-cloud.cn/raw/6adc4d0454725e4491cc82eecb930242.png)
2. 롤백 페이지에서 원본 데이터베이스 테이블을 선택하고 **다음: 롤백 시간 및 데이터베이스 테이블 이름 설정**을 클릭합니다.
   - 일반 모드: 인스턴스의 전체 백업을 가져오고 선택한 데이터베이스 또는 테이블을 롤백합니다. 이 롤백 모드는 느리지만 제한이 없습니다.
   - 고속 모드: 전체 백업 및 데이터베이스 수준 binlog를 가져옵니다. 데이터베이스 간 작업의 경우 연결된 데이터베이스를 동시에 선택하지 않으면 롤백이 실패할 수 있습니다.
   - 초고속 모드: 전체 백업 및 테이블 수준 binlog를 가져옵니다. 테이블 간의 작업의 경우 연결된 테이블을 동시에 선택하지 않으면 롤백이 실패할 수 있습니다.
>?
>- 이름에 숫자, 문자, 언더바 또는 그 조합이 포함된 테이블만 롤백할 수 있으며 이름에 특수 기호가 포함된 테이블은 지원되지 않습니다.
>- 지정된 테이블이 있는 롤백 모드에서 동일한 인스턴스에 있는 최대 500개의 데이터베이스 또는 테이블을 한 번에 롤백할 수 있습니다.
>- 롤백이 binlog 실행 중 다른 데이터베이스 또는 테이블에 대한 복합 작업을 포함하는 경우 SQL 문이 실패할 수 있습니다.
>- 롤백에 binlogs 추적 중 테이블의 외래 키 및 기타 제약 조건이 포함되는 경우 SQL 문이 실패할 수 있습니다.
>
![](https://main.qcloudimg.com/raw/6cb2fa4d3e8b0d795bd5bf19f8d69d86.png)
3. 롤백 이후의 테이블 이름과 롤백 시간을 설정하고 **롤백**을 클릭합니다.
>?
>- 각 인스턴스당 하나의 롤백 시간만 설정할 수 있습니다.
> - 일괄 롤백 시간을 설정을 선택하면 모든 데이터베이스 또는 테이블이 지정된 시간에 롤백됩니다.
> - 단일 테이블 롤백 시간 설정을 선택하면 테이블이 해당 롤백 시간에 롤백됩니다.
>- 롤백 이후의 데이터베이스 또는 테이블 이름은 최대 64자, 영어, 숫자 또는 기호(.-\_$)를 포함할 수 있습니다.
>
![](https://qcloudimg.tencent-cloud.cn/raw/3004d1ee48b2a7afc4c95a40bd728612.png)
4. 제출 후 **작업 로그** > **롤백 로그**로 이동하여 롤백 진행 상황을 확인합니다. 롤백 로그를 실시간으로 보려면 **자세히 보기**를 클릭하십시오.
![](https://main.qcloudimg.com/raw/b5206b3c23d532553fb54dfc4fe7bfd0.png)
5. 롤백이 완료된 후 **데이터베이스 관리** > **데이터베이스 목록**을 선택하면 기존 인스턴스에서 롤백된 새 테이블을 볼 수 있습니다.
![](https://main.qcloudimg.com/raw/9b939d9a6a7da59092df0051f452b5cd.png)







