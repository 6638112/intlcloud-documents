## ユースケース
サービスの継続提供、データの信頼性または監視の必要性が高いシナリオの場合、TencentDB for MySQLは、リージョンをまたがるディザスタリカバリインスタンスを提供し、ユーザーの低コストでのサービスの継続提供能力を引き上げながら、データの信頼性を向上させるお手伝いをします。
>?ディザスタリカバリインスタンスはメインインスタンスと同じ料金体系です、詳細については、[製品の定価](https://buy.intl.cloud.tencent.com/price/cdb)をご参照ください。

#### 機能の特徴
- 独立したデータベース接続アドレスを提供します。ディザスタリカバリインスタンスは読み取りアクセス機能を提供して、最寄りサーバーへのアクセス、データ分析などのシナリオに用いて、デバイスの冗長化コストを引き下げます。
- プライマリ/スタンバイの高可用性アーキテクチャを使用することで、データベースのシングルポイントによるリスクを回避しました。
- ディザスタリカバリインスタンスは、プライベートネットワークの専用回線を介して同期され、同期遅延が少なく、高い安定性を持ち、同期リンクの品質はパブリックネットワークよりもはるかに優れています。
- 現在プロモーション期間中のため、専用回線のトラフィック料金は無料です。商品化により課金が開始される時期については、別途お知らせします。

#### 動作原理
- Tencent Cloudのクラウドデータベースがディザスタリカバリデータベースとして使用されるシナリオでは、ディザスタリカバリインスタンスは、マスターインスタンスデータベースのレプリケーションバックアップです。
- マスターインスタンスが変更されると、変更されたLog情報の記録がディザスタリカバリインスタンスにコピーされ、ログの再生がデータの同期を実現するために使用されます。
- マスターインスタンスに障害が発生した場合、ディザスタリカバリインスタンスを数秒以内にアクティブ化して、完全な読み取りおよび書き込み機能を回復させられます。

## 機能の制限について
- メモリ1GB、ハードディスク50GB以上の仕様で、かつMySQL 5.6およびそれ以降のバージョン、ディザスタリカバリインスタンスを購入するためのInnoDBエンジンの高可用版マスターインスタンスのみをサポートします。マスターインスタンスがこの仕様よりも低い場合は、まずマスターインスタンスの仕様をアップグレードしてください。また、マスターインスタンスでGTID機能が有効になっている必要があります。
>?GTIDが有効になっていない場合は、[コンソール](https://console.cloud.tencent.com/cdb/)のインスタンス詳細ページからGTIDを有効にすることができます。GTIDを有効にするプロセスには時間がかかり、インスタンスには数秒間の瞬断が生じます。ビジネスピークから外れた時期に操作し、データベースにアクセスするプログラムに再接続メカニズムを追加することをお勧めします。
- ディザスタリカバリインスタンスの最低仕様は、メモリ1GB、ハードディスク50GB、マスターインスタンスの使用済みストレージ仕様の1.1倍以上である必要があります。
- マスターインスタンスは、最大1つのディザスタリカバリインスタンスを作成できます。ディザスタリカバリインスタンスが隔離状態にある間は、それ以上ディザスタリカバリインスタンスを作成することはできません。
- ディザスタリカバリインスタンスは現在、プロジェクトの移行、ロールバック、SQL操作、文字セットの変更、アカウント管理、ポートの変更、データインポート、ロールバックログ、読み取り専用インスタンス機能をサポートしません。

## ディザスタリカバリインスタンスの作成
#### 手順1：ディザスタリカバリインスタンスの作成
1. [TencentDB for MySQLコンソール](https://console.cloud.tencent.com/cdb/)にログインし、インスタンスリストでインスタンスIDまたは**操作**カラムの**管理**をクリックして、詳細ページに進みます。
2. インスタンス詳細ページの基本情報にて、GTID機能が有効であることを確認し、インスタンスアーキテクチャ図で**ディザスタリカバリインスタンスの追加**をクリックして、ディザスタリカバリインスタンスの購入ページに進みます。
![](https://qcloudimg.tencent-cloud.cn/raw/3535c0274c3dfa18134ccc735edd0f46.png)
3. 購入ページにて、ディザスタリカバリインスタンスの**料金モード**、**リージョン**、**同期ポリシー**等の基本情報を設定します。
 - 同期ポリシーが**すぐに同期**の場合、データはディザスタリカバリインスタンスが作成された直後に同期されます。
4. 誤りのないことを確認したら、**今すぐ購入**をクリックすると、ディザスタリカバリインスタンスが出荷されます。
5. インスタンスリストに戻り、インスタンスの状態が**実行中**になれば、それ以降の操作に進むことができます。

## ディザスタリカバリインスタンスの管理
- **ディザスタリカバリインスタンスの確認**
ディザスタリカバリインスタンスは、所在リージョンで確認でき、インスタンスリストからそのリージョンのすべてのディザスタリカバリインスタンスをフィルタリングすることができます。
![](https://qcloudimg.tencent-cloud.cn/raw/096486c7562d5385bfd50a187f85b307.png)
- **従属関係の確認**
各ディザスタリカバリインスタンスまたはマスターインスタンスの右側にあるアイコンをクリックして、従属関係を確認します。
![](https://qcloudimg.tencent-cloud.cn/raw/89d342733d4c2264dd5dc00a1c7d4143.png)
- **同期遅延の確認**
マスターインスタンスとディザスタリカバリインスタンス間の同期遅延は、ディザスタリカバリインスタンスのインスタンス詳細ページの上部で確認できます。
![](https://qcloudimg.tencent-cloud.cn/raw/053c38735dd3dd5b7e46d5c82687dd09.png)
- **ディザスタリカバリインスタンス機能**
ディザスタリカバリインスタンスはインスタンス詳細、インスタンス監視、データベース管理、セキュリティグループ、バックアップ復元などの機能を提供します。

## ディザスタリカバリインスタンスのマスターインスタンスへのアップグレード
ディザスタリカバリインスタンスをマスターインスタンスに切り替える必要がある場合は、コンソールでディザスタリカバリインスタンスをマスターインスタンスに自発的に切り替えることができます。
>!
>- ディザスタリカバリインスタンスをマスターインスタンスにアップグレードすると、ディザスタリカバリインスタンスが新しいマスターインスタンスとして動作し、新しいマスターインスタンスのアクセスアドレスが変更され、業務側で新しいアクセスアドレスを再設定してください。また、元のマスターインスタンスは既存の業務を実行しません。
>- ディザスタリカバリインスタンスはマスターインスタンスとして切り替えられると、元のマスターインスタンスとの同期接続が切断します。同期接続が切断した後は再接続できませんので、慎重に操作してください。
>
1. [インスタンスリスト](https://console.cloud.tencent.com/cdb)で、マスターインスタンスにアップグレードする必要があるディザスタリカバリインスタンスを選択して、インスタンスIDをクリックし、インスタンス管理ページに進みます。
2. インスタンス管理ページで、右上にある**マスターインスタンスへの切り替え**をクリックすると、ディザスタリカバリインスタンスをマスターインスタンスにアップグレードできます。切り替え後、元のマスターインスタンスとの同期接続が切断され、インスタンスデータベースのデータ書き込み機能とMySQLの全機能がリカバーされます。
![](https://qcloudimg.tencent-cloud.cn/raw/5eb3f1f08b46d4c20ab3b4038309ab03.png)
