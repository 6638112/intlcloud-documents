
## 작업 시나리오
TencentDB for MySQL은 1개 또는 다수의 읽기 전용 인스턴스로 구성된 읽기 전용 인스턴스 RO그룹 생성을 지원합니다. 읽기/쓰기 분리와 원 프라이머리 멀티 세컨더리 응용 시나리오에 적용되어 사용자의 데이터베이스 읽기 부하 성능을 대폭 강화할 수 있습니다.

RO그룹은 읽기 전용 인스턴스의 집합으로, 하나의 RO그룹은 하나의 주소를 공유하고, 동시에 그룹 중 읽기 전용 인스턴스의 가중치를 설정하여 트래픽 CLB, 딜레이 제거 설정 등을 할 수 있습니다. 사용자는 필요에 따라 RO 그룹을 배포할 수 있으며, 동시에 상응하는 읽기 요청을 일정 규칙에 따라 읽기 전용 인스턴스로 발송할 수 있습니다. 다수의 읽기 전용 인스턴스를 동일한 RO그룹에 설정하면 재해 복구를 할 수 있습니다.  

## 전제 조건
- 읽기 전용 인스턴스를 생성하기 전에 먼저 CDB 프라이머리 인스턴스를 생성해야 합니다. 자세한 내용은 [구매 가이드](https://intl.cloud.tencent.com/document/product/236/5160)를 참고 바랍니다.
- TencentDB for MySQL을 사용하기 전에 데이터베이스 초기화를 해야 합니다. 자세한 내용은 [MySQL 데이터베이스 초기화](/doc/product/236/3128)를 참고 바랍니다.

## 작업 단계
### 읽기 전용 인스턴스 RO그룹 생성
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb/ ) 로그인 후, 인스턴스 리스트에서 인스턴스 ID 또는 **작업**열의 **관리**를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 상세 페이지에서 **인스턴스 아키텍처**중의 **읽기 전용 인스턴스 추가**를 클릭하거나 읽기 전용 인스턴스 페이지에서 **생성**을 클릭하여 구매 페이지로 이동합니다. 
![](https://main.qcloudimg.com/raw/83e817ae1b9205d6cdf061684f7d3c12.png)
![](https://qcloudimg.tencent-cloud.cn/raw/c4f55da8d715d578c9a4041ee232bef8.png)
3. 구매 페이지에서 읽기 전용 인스턴스에 상응하는 설정을 선택하고, 착오가 없는지 확인한 뒤 **즉시 구매**를 클릭합니다.
 - **RO그룹 지정**: **RO그룹 생성**을 선택한 뒤, 다수의 인스턴스를 한 번에 구매하시면 선택한 RO그룹으로 할당됩니다. 가중치 할당 방식은 시스템 자동 할당으로 기본 설정되어 있습니다. 
 - **RO그룹 이름 설정**: 이름은 중복 가능하며 60자 미만의 중국어, 영어, 숫자, `-`, `_`, `.`를 지원합니다.
 - **딜레이 초과 제거**: 제거 정책 실행 여부. 제거된 인스턴스 가중치는 0으로 자동 설정됩니다. 
 읽기 전용 인스턴스의 딜레이가 임계값을 초과하여 제거 되면 사용자에게 알람이 발송됩니다. (읽기 전용 인스턴스 제거 알람과 알람 수신 객체 설정은 [알람 기능](https://intl.cloud.tencent.com/document/product/236/8457)을 참고 바랍니다) 또한 인스턴스 상태가 서비스 중지 동기화되며, 가중치는 0이 됩니다. 읽기 전용 인스턴스 딜레이 시간이 임계값보다 작아질 경우, 다시 RO그룹에 추가 됩니다. 
 동시에, 인스턴스 딜레이 초과 제거 기능 활성화 여부와 상관 없이 읽기 전용 인스턴스의 장애가 제거된 후 복구된 인스턴스도 다시 RO그룹에 추가됩니다. 
 - **딜레이 임계값**: 읽기 전용 인스턴스를 위한 딜레이 제한 초과 임계값 설정. 임계값을 초과한 읽기 전용 인스턴스는 RO그룹에서 제거됩니다.
 - **최소 보관 인스턴스 수**: 그룹 내에서 보장되어야 하는 인스턴스 하한치로, 현재 읽기 전용 인스턴스 수가 해당 하한치와 같거나 적고, 딜레이 시간이 임계값을 초과하면 현재의 읽기 전용 인스턴스는 제거되지 않습니다.
 -**읽기 가중치 할당**: 시스템 자동 분할
 -**과금 방식**: 읽기 전용 인스턴스는 현재 종량제 과금 방식만 지원합니다.
![](https://main.qcloudimg.com/raw/a8f80ce3f01cbaa1847978bec455aa0d.png)
 - **리전**: 기본값은 프라이머리 인스턴스와 동일하며 선택 불가합니다.
 - **데이터베이스 버전**: 기본 버전은 프라이머리 인스턴스 버전과 동일합니다.
 - **아키텍처**: 단일 노드. 단일 노드 아키텍처는 가성비가 좋지만 단일 읽기 전용 인스턴스에는 단일 장애점이 있으므로 가용성을 보장하기 위해 가용성이 필요한 비즈니스 RO 그룹에서 읽기 전용 인스턴스를 2개 이상 구매하는 것이 좋습니다.
 - **데이터 복사 방식**: 기본적으로 프라이머리 인스턴스와 동일합니다.
 - **가용존**: 해당 리전에 여러 개의 가용존이 있는 경우 읽기 전용 인스턴스는 가용존을 선택할 수 있습니다.
>?딜레이의 경우, 리전 내 교차 가용존 네트워크는 수 밀리초, 리전 간 네트워크는 수십 밀리초, 중국 본토 외 리전은 100 밀리초 이상입니다. 신중하게 선택하시기 바랍니다.
5. 인스턴스 리스트에서 인스턴트 상태가 **발송 중**에서 **실행 중**으로 전환되면 읽기 전용 인스턴스 생성이 완료된 것입니다.

### 읽기 전용 인스턴스 RO그룹 설정
읽기 전용 RO그룹의 설정 인터페이스에서 읽기 전용 RO그룹 ID, 이름, 인스턴스 딜레이 복사, 딜레이 시간, 인스턴스 딜레이 시간 초과 제거, 딜레이 임계값, 최소 보관 인스턴스, 읽기 가중치 등 기본 정보를 설정할 수 있습니다.
>?
>- RO그룹 내에서 읽기 전용 인스턴스는 다른 규격을 사용할 수 있으며, 읽기 트래픽 가중치를 설정할 수 있습니다.
>- 동일한 RO그룹 내에서 읽기 전용 인스턴스는 서로 다른 만료 시간과 과금 방식을 지원합니다.
>- 딜레이 복사를 활성화하면 RO 그룹의 모든 RO 인스턴스에 적용되며, RO 인스턴스의 복사 상태는 변경되지 않습니다.
>- 딜레이 복사가 활성화되면 딜레이 시간 옵션이 나타납니다.
>
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb/ )에 로그인한 후, 인스턴스 리스트에서 프라이머리 인스턴스 ID를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 **읽기 전용 인스턴스** 페이지를 선택하고 RO그룹 열에서 **설정**을 클릭하여 RO그룹 설정 페이지로 이동합니다. 
![](https://main.qcloudimg.com/raw/f03a6fc7e5460181e1e933157b4922cb.png)
3. RO그룹 설정 페이지에서 RO그룹 정보를 설정하고 **확인**을 클릭합니다. 
   - **인스턴스 딜레이 복사**: 딜레이 복사 설정 및 딜레이 동안 지정된 시간 또는 GTID(글로벌 트랜잭션 식별자)로의 복구 실행을 선택하여 데이터의 효율적인 롤백 및 빠른 장애 역추적을 구현할 수 있습니다.
   - **딜레이 시간**: 읽기 전용 인스턴스와 프라이머리 인스턴스 간의 복사 딜레이 시간으로, 설정 범위는 1 - 259200초입니다.
   - **인스턴스 딜레이 초과 제거**: 제거 정책 실행 여부. 제거된 인스턴스의 가중치는 0으로 자동 설정됩니다. 읽기 전용 인스턴스의 딜레이가 임계치를 초과하여 제거되면 사용자에게 알람이 발송됩니다. 읽기 전용 인스턴스 제거 알람과 알람 수신 객체 설정은 [알람 기능](https://intl.cloud.tencent.com/document/product/236/8457)을 참고 바랍니다. 
   - **딜레이 임계값**: 읽기 전용 인스턴스를 위한 딜레이 제한 초과 임계값 설정. 임계값을 초과한 읽기 전용 인스턴스는 RO그룹에서 제거됩니다.
   - **최소 보관 인스턴스 수**: 그룹 내에서 보장되어야 하는 인스턴스 하한치로, 현재 읽기 전용 인스턴스 수가 해당 하한치와 같거나 적고, 딜레이 시간이 임계값을 초과하면 현재의 읽기 전용 인스턴스는 제거되지 않습니다.
   - **읽기 가중치 할당**: RO그룹은 시스템 가중치 자동 할당과 사용자 정의 가중치, 두 종류의 가중치 설정 방식을 지원합니다. 가중치 입력 범위는 0 - 100이며, 반드시 정수여야 합니다. 이중 노드, 삼중 노드 버전 MySQL 인스턴스의 읽기 가중치 값의 시스템 자동 설정 리스트는 아래와 같습니다.
<table>
<thead><tr>
<th>인스턴스 메모리 사양(MB)</th>
<th>1000</th><th>2000</th><th>4000</th><th>8000</th><th>12000</th><th>16000</th><th>24000</th><th>32000</th><th>48000</th><th>64000</th><th>96000</th><th>128000</th><th>244000</th><th>488000</th>
</tr></thead>
<tbody><tr>
<td>가중치</td>
<td>1</td><td>1</td><td>2</td><td>2</td><td>4</td><td>4</td><td>8</td><td>8</td><td>10</td><td>12</td><td>14</td><td>16</td><td>26</td><td>50</td></tr>
</tbody></table>
 - **부하 리밸런싱**:
    - 부하 리밸런싱을 비활성화하면 가중치 수정 시 신규 부하에만 적용되고, 기존 장기간 연결로 액세스했던 읽기 전용 인스턴스를 바꾸지 않아 데이터베이스가 끊기지 않습니다.
    - 부하 리밸런싱을 활성화하면 데이터베이스 연결이 몇 초간 끊어졌다 다시 연결될 수 있습니다. 새로 추가한 연결은 설정한 가중치 균형에 따라 부하됩니다.
<img src="https://main.qcloudimg.com/raw/94a42aa7ed813d8ba68560c40749998f.png"  style="zoom:55%;">


### 읽기 전용 인스턴스 RO그룹 폐기와 삭제
>?
>
>- RO그룹은 수동 삭제 기능을 제공하지 않습니다.
- RO그룹은 그룹 내의 마지막 읽기 전용 인스턴스가 완전히 폐기되면 자동 삭제됩니다.
- 빈 RO그룹 보관은 지원하지 않습니다.
>
1. [MySQL 콘솔](https://console.cloud.tencent.com/cdb/ )에 로그인한 후, 인스턴스 리스트에서 프라이머리 인스턴스 ID를 클릭하여 인스턴스 관리 페이지로 이동합니다.
2. 인스턴스 관리 페이지에서 **읽기 전용 인스턴스** 페이지를 선택하고, 오른쪽 **작업** 열에서 **폐기/반품**을 클릭합니다.
![](https://qcloudimg.tencent-cloud.cn/raw/ef06e1a956370519e0c0b652b8a07c72.png)
3. 팝업 창에서 **폐기 규칙**을 읽고 동의한 후 **즉시 폐기**를 클릭합니다.

