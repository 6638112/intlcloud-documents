## 기능 소개
TXSQL은 트랜잭션 직접 잠금 충돌을 자동으로 감지하고 트랜잭션의 우선 순위에 따라 트랜잭션 스케쥴링을 할 수 있는 새로운 트랜잭션 스케줄링 알고리즘(Contention-Aware Transaction Scheduling, CATS)을 추가합니다.
MySQL의 기존 동시 트랜잭션은 FIFO(First-In-First-Out) 규칙을 사용하여 트랜잭션 실행 순서를 결정하며, CATS 트랜잭션 스케줄링 알고리즘의 주요 원칙은 트랜잭션의 잠금 상태를 기반으로 동시 트랜잭션의 충돌을 판별하는 것입니다. 그리고 트랜잭션 실행의 우선 순위를 결정한 다음 우선 순위에 따라 트랜잭션의 실행 순서를 정렬하여 시스템 트랜잭션 처리의 처리량을 향상시킵니다.

## 지원 버전
- 커널 버전 MySQL 5.7 20190230 이상
- 커널 버전 MySQL 8.0 20200630 이상

## 적용 시나리오
높은 동시성과 심각한 잠금 충돌이 있는 시나리오에 주로 적합합니다.

## 성능 데이터
높은 동시성과 심각한 잠금 충돌이 있는 시나리오에서 TPS 성능은 50% 이상 향상될 수 있습니다.

- 테스트 방법: sysbench-oltp_read_write 시나리오(RR 격리 수준, 10MB 데이터가 있는 8개 테이블, pareto 랜덤 모드)
- 테스트 환경: 32코어 128GB 온라인 인스턴스

| 스레드 수 | FCFS(FIFO) | CATS  | 성능 향상 |
| :----- | :--------- | :---- | :------- |
| 128    | 11999      | 12005 | 0%       |
| 256    | 6609       | 10137 | 53%      |
| 512    | 3453       | 9365  | 171%     |
| 1024   | 2196       | 7015  | 219%     |

## 사용 설명
MySQL 5.7 버전은 전역 매개변수 innodb_trx_schedule_algorithm을 통해 트랜잭션 스케줄링 알고리즘을 지정할 수 있으며, 이 매개변수의 기본값은 auto입니다.
그 중 세 가지 알고리즘이 있습니다.
- auto: 자동, 현재 시스템 상태에 따라 자동으로 조정됩니다. 잠금 대기 스레드 수가 32개를 초과하면 CATS 스케줄링 알고리즘이 채택되고, 그렇지 않으면 FCFS 알고리즘이 채택됩니다.
- fcfs: 선착순 알고리즘입니다.
- cats: 충돌 인식 스케줄링 알고리즘입니다.


| 매개변수 이름                        | 동적 | 유형   | 기본 | 매개변수 값 범위       | 설명             |
| ----------------------------- | ---- | ------ | ---- | ---------------- | ---------------- |
| innodb_trx_schedule_algorithm | yes  | string | auto | [auto,fcfs,cats] | 트랜잭션 대기 스케줄링 알고리즘 |

MySQL 8.0 버전은 항상 auto 알고리즘을 사용하며 설정할 수 없습니다.

