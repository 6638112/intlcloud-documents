## 機能の説明
この機能は主にデータファイルの大きなテーブルを削除し、IOのジッターを防止するために用いられます。

DROP TABLEは、元のデータベースファイル（.ibd）を新しい臨時ファイルに再命名して、成功が返されます。臨時ファイルはinnodb-async-drop-tmp-dirにより指定されるディレクトリに保存され、バックグラウンドでバッチでtruncateします。truncateされるファイルサイズはinnodb-async-truncate-sizeによって制御されます。テーブルの非同期削除機能の有効化はinnodb-async-drop-tmp-dirパラメータによって制御されます。NULLでなければ有効化します。

この機能はユーザーにより操作する必要はなく、カーネルにより自動的に実行されます。テーブル削除の際に、他のディレクトリでテーブルのデータファイルにハード接続を作成することで実現できます。drop table実行後，このファイルのハード接続のみが削除されます。その後、バックグラウンドスレッドのスキャンによってハード接続のディレクトリの中に削除すべきファイルがあると分かり次第、先ほどdropされたテーブルデータファイルをバックグラウンドで自動的にtruncateします。

## サポートするバージョン
カーネルバージョン MySQL 5.6 20190203およびそれ以降
カーネルバージョン MySQL 5.7 20190203およびそれ以降
カーネルバージョン MySQL 8.0 20200630およびそれ以降

## ユースケース
この機能は大規模のテーブルデータファイルの削除に適しています。

## 使用の説明
Innodb_async_truncate_work_enabledをONに設定すると、DROP TABLEが非同期モードに変更されます。デフォルトではOFFになっています。
臨時ファイルはinnodb_async_drop_tmp_dirrにより指定されるディレクトリに保存されます。truncateされるファイルのサイズはinnodb_async_truncate_sizeによって制御されます。

| パラメータ名                             | 状態 | タイプ   | デフォルト値 | パラメータ値範囲                        | 説明                            |
| ---------------------------------- | ---- | ------ | ---- | ------------------------- | ------------------------------ |
| innodb_async_truncate_work_enabled | Yes  | string |  OFF   | ON/OFF      | 大規模テーブルの非同期削除の有効化有無          |
| innodb_async_truncate_size         | Yes  | int    | 5.7、20210630以前のバージョンでは、デフォルト値は128<br>5.7、20211030以降のバージョンでは、デフォルト値は64  | 5.7、20210630以前のバージョンでは、範囲は128MB - 2048MB<br>5.7、20211030以降のバージョンでは、範囲は16MB - 256MB | 非同期DROP TABLEのバックグラウンドでのtruncateファイルサイズ、単位はMB |
