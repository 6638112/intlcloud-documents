
## ログの確認
1.[MySQLコンソール](https://console.cloud.tencent.com/dls/mysql)、[TDSQL-C for MySQLコンソール](https://console.cloud.tencent.com/dls/cynosdb/instance) または[MongoDBコンソール](https://console.cloud.tencent.com/dls/mongodb)にログインし、左側ナビゲーションバーで**データベース監査**をクリックし、上側でリージョンを選択して、**監査ログ**画面をクリックします。
2. **監査ログ**画面の監査インスタンスから、監査機能が有効になっているデータベースインスタンスを選択して、対応するSQL監査ログを確認します。または、**監査インスタンス**画面で、監査機能が有効になっているインスタンスのIDをクリックし、**監査ログ**画面に遷移して対応するログを確認します。
>?監査ログはミリ秒で表示できるようになりました。これにより、SQLに対するより正確なソートとトラブルシューティングが可能になります。

### ツールリスト
![](https://qcloudimg.tencent-cloud.cn/raw/a285a1b3e7e1dba10b34127448f9c0f3.png)
 - **時間ボックス**で時間帯を選択すると、選択した時間帯に関する監査効果を確認できます。
>?検索する時間帯を選択するとき、データがある任意の時間帯を検索できます。検索結果は最大で最初の60000件が表示されます。
 - **テキストボックス**でキーとなるタグ（SQLコマンド、クライアントIP、データベース名、ユーザーアカウント、SQLタイプ、ポリシー名、実行時間、影響行数、リターン行数など）を選択して検索を行うと、関連する監査結果を確認できます。
  - キーとなるタグを複数入力して検索するとき、エンターキーでキーとなるタグを区切ります。
  - IPアドレスを検索する場合、`*`を条件として指定し絞り込むことができます。例えば、`クライアントIP: 9.223.23.2*`を検索した場合、9.223.23.2で始まるIPアドレスが合致します。
  - キーとなるタグ「SQLコマンド」を選択した場合、「,(コンマ)」、スペースを使用し、複数の条件を指定して検索することができます。また、「|」を使用して検索することも可能で、任意の条件に合致すると返されます。
>?SQLコマンドのフィールドを絞り込む場合、「*」はあいまい一致を意味しません。SQL コマンドのフィールドに対する検索は全部あいまい検索です。
>

### ログリスト
- リストの**SQLタイプ**の中で、SQLタイプで絞り込む場合、複数のSQLタイプを指定して絞り込むことが可能です。
- **リターン行数**フィールドは、SQLが返す行数を表し、主にSELECTタイプのSQLの影響を判断することに用います。
 ![](https://qcloudimg.tencent-cloud.cn/raw/8a035147191070ae4789aec12e67faf1.png)

## SQL監査フィールド
### TencentDB for MySQL/TDSQL-C for MySQLの監査フィールド
TencentDB for MySQL、TDSQL-C for MySQLの監査ログは以下のフィールドをサポートします。[MySQLコンソール](https://console.cloud.tencent.com/dls/mysql)、[TDSQL-C for MySQLコンソール](https://console.cloud.tencent.com/dls/cynosdb/instance) の**監査ログ**画面で以下のアイコンをクリックして、完全なSQL監査ログを取得、確認できます。
![](https://qcloudimg.tencent-cloud.cn/raw/40f34d23921fb707599548204d0dda6a.png)

| 番号 | フィールド名        | フィールドの定義                                                     | 備考                                         |
| ---- | ------------- | ------------------------------------------------------------ | -------------------------------------- |
| 1    | host          | クライアントIP                                                     |   -                                           |
| 2    | dbname        | データベース名                                                     |  -                                            |
| 3    | user          | ユーザー名                                                       |      -                                        |
| 4    | sql           | SQLステートメント                                                      |    -                                          |
| 5    | sqlType       | SQLステートメントのタイプ                                                  |   -                                           |
| 6    | errCode       | エラーコード                                                       | 0は成功を表す                                    |
| 7    | affectRows    | 影響を受ける行数                                                     |     -                                         |
| 8    | checkRows     | スキャン行数                                                     |     -                                         |
| 9    | sentRows      | リターン行数                                                     |    -                                          |
| 10   | threadId      | スレッドID                                                       |       -                                       |
| 11   | ruleNum       | 監査ルール番号                                                   |     -                                         |
| 12   | policyName    | 監査ポリシー名                                                   |    -                                          |
| 13   | instanceName  | インスタンス名                                                       |    -                                          |
| 14   | timestamp     | 開始時間（秒）                                               |   -                                           |
| 15   | nsTime        | 開始時間（ナノ秒の精度）、timestampと組み合わせてたナノ秒までの開始時間 | 例 timestamp.nsTime 1577953020.887984015 |
| 16   | execTime      | 実行時間（ミリ秒）                                            |    -                                          |
| 17   | cpuTime       | CPU時間（マイクロ秒）                                              |     -                                         |
| 18   | lockWaitTime  | ロック待機時間（マイクロ秒）                                           |    -                                          |
| 19   | ioWaitTime    | IO待ち時間（マイクロ秒）                                           |     -                                         |
| 20   | trxLivingTime | トランザクション実行時間（マイクロ秒）                                   |      -                                        |


