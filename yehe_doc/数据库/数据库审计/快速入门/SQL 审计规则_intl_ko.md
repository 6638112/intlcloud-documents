
## 규칙 내용
지원하는 설정은 다음과 같습니다. 
클라이언트 IP, 데이터베이스 계정, 데이터베이스 이름, [포함, 불포함] 방식의 매칭을 지원합니다.

전수 감사 규칙은 특수 규칙으로, 활성화하면 모든 명령을 감사합니다.

## 규칙 연산
- 모든 규칙 내부의 유형은 조건 추가 제한 관계로 and (&&) 관계입니다.
- 규칙과 규칙 간에는 or (||) 관계입니다.
모든 인스턴스는 하나 혹은 다수의 감사 규칙을 지정할 수 있으며 어느 한 규칙에만 부합해도 감사가 진행됩니다. 예를 들어 A 규칙으로 user1의 실행 시간이 1초와 같거나 이상인 작업만 감사하도록 지정하고 B 규칙으로 user1과  실행 시간이 &lt; 1인 명령을 감사하라고 한 경우, 결국 user1의 모든 명령에 감사가 진행됩니다.

## 규칙 상세 설명
클라이언트 IP, 데이터베이스 계정, 데이터베이스 이름이 [포함, 불포함]을 지원하는 것과 관련하여 한 번에 하나의 오퍼레이터 설정만 가능합니다.

#### 데이터베이스 이름 관련 설명
다음 테이블 객체 유형의 명령에 해당하는 경우:
```
SQLCOM_SELECT, SQLCOM_CREATE_TABLE, SQLCOM_CREATE_INDEX, SQLCOM_ALTER_TABLE,
SQLCOM_UPDATE, SQLCOM_INSERT, SQLCOM_INSERT_SELECT, SQLCOM_DELETE, SQLCOM_TRUNCATE, SQLCOM_DROP_TABLE
```
이런 유형의 동작에 있어서 데이터베이스 이름은 명령 중 실제 작업하는 데이터베이스 이름을 기준으로 합니다. 예를 들어 현재 use db3인 경우 명령어는 다음과 같습니다.
```
select *from db1.test,db2.test;
```
db1과 db2를 타깃 라이브러리로 하여 규칙 판단을 하고 규칙에 db1 CFA 설정이 있다면 감사를 진행합니다. db3 CFA 설정이 있다 해도 감사를 진행하지 않습니다.
상기 테이블 객체 유형의 명령이 아닌 경우, 현재 use 라이브러리를 타깃 라이브러리로 인식하고 판단합니다. 현재 라이브러리가 use db1이고 실행 명령이 `show databases`인 경우, 현재 라이브러리 db1을 타깃 라이브러리로 하여 규칙 판단을 하며 규칙에 db1 CFA 설정이 있다면 감사를 진행합니다.

## 특이 사항
포함, 불포함은 하나의 값만 쓸 수 있습니다. 여러 값을 쓸 경우 하나의 열로 인식되어 매칭 오류가 발생할 수 있습니다.


