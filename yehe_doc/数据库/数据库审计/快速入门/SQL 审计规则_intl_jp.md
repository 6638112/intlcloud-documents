
## ルールの内容
以下のタイプの設定をサポートします：
クライアントIP、データベースアカウント、データベース名。「含む、含まない」のマッチングをサポートします。

全量監査ルールは特殊なルールで、有効にするとすべてのステートメントを監査します。

## ルールの演算
- 各ルール内の異なるタイプは追加の制限条件関係、すなわちAND (&&)関係になります。
- ルールとルールの間はOR (||)関係です。
各インスタンスには1つまたは複数の監査ルールを指定でき、どれか1つのルールに当てはまれば、監査を行う必要があります。 例えば、ルールAがuser1の実行時間≧1秒の操作のみを監査すると指定し、ルールBがuser1ならびに実行時間&lt;1のステートメントを監査する場合、最終的にはuser1のすべてのステートメントについて監査する必要があります。

## ルールの詳細説明
クライアントIP、データベースアカウント、データベース名は「含む、含まない」演算をサポートします。1回で1つの演算子だけを設定できます。

#### データベース名についての説明
ステートメントが以下のテーブルオブジェクトタイプの場合：
```
SQLCOM_SELECT, SQLCOM_CREATE_TABLE, SQLCOM_CREATE_INDEX, SQLCOM_ALTER_TABLE,
SQLCOM_UPDATE, SQLCOM_INSERT, SQLCOM_INSERT_SELECT, SQLCOM_DELETE, SQLCOM_TRUNCATE, SQLCOM_DROP_TABLE
```
このタイプの動作について、データベース名はステートメントの中で実際に操作されるデータベースの名前に基づきます。例えば、現在のデータベースがuse db3で、ステートメントが以下の場合：
```
select *from db1.test,db2.test;
```
このとき、db1とdb2がターゲットデータベースとして判断され、db1のデータベースを監査するようにルール設定されている場合は監査され、db3のデータベースを監査するようにルール設定されている場合は監査されないことになります。
ステートメントが上記のようなテーブルオブジェクトタイプでない場合は、現在useのデータベースがターゲットとして判断されます。現在のデータベースがuse db1で、実行ステートメントが`show databases`の場合、現在のデータベースdb1がターゲットとして判断され、db1を監査するようにルール設定されている場合は監査されます。

## 特記事項
「含む」と「含まない」は1つの値だけを指定できます。複数設定した場合、文字列とみなされ、マッチングが正しく行われません。


