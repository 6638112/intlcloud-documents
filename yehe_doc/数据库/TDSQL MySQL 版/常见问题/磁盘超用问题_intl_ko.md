## 디스크 과사용 잠금 개요
2020년 08월 03일 부터 TDSQL for MySQL은 데이터 손실을 방지하기 위해 디스크 사용률이 150% 이상인 인스턴스를 잠금 처리합니다. 잠긴 디스크는 쓸 수 없습니다. 인스턴스의 저장 공간을 정리하고 과도하게 사용할 위험이 있는 디스크를 미리 정리하거나 확장하십시오.

#### 디스크 공간 사용량
- 데이터 공간: 데이터가 차지하는 공간.
- 시스템 파일 공간: 시스템 테이블 스페이스 파일, redolog, undolog, 임시 파일이 차지하는 공간.
>?Tencent Cloud는 binlog를 위한 공간을 무료로 제공하므로 binlog는 구입한 디스크 공간을 차지하지 않습니다.
 
## 디스크 과사용의 원인
다음은 디스크 과사용의 원인이 될 수 있습니다.
- 너무 많은 데이터: 비즈니스가 확장됨에 따라 새로운 데이터가 지속적으로 삽입되어 데이터 공간이 증가합니다.

- 임시 파일이 너무 큼: order by 또는 group by 및 alter table 문이 실행되는 복잡한 쿼리 문을 실행할 때 임시 테이블이 생성됩니다. 작은 임시 테이블은 메모리에 저장되고 큰 임시 테이블은 디스크에 저장됩니다.
- 시스템 파일이 너무 큼: 데이터베이스 설치 중 일부 시스템 파일은 정상 작동을 유지하기 위해 초기화됩니다. 장기간 트랜잭션을 제출하지 않고 많은 UPDATE, INSERT, DELETE 작업을 수행하면 로그 기록 트랜잭션 정보가 너무 클 수 있습니다.

## 해결 방법
디스크가 과도하게 사용된 경우 다음과 같이 원인을 식별하고 문제를 해결하는 것이 좋습니다.
- 데이터가 너무 많은 공간을 차지하는 경우 더 이상 사용하지 않는 레거시 테이블을 삭제하여 공간을 확보할 수 있습니다. [콘솔](https://console.cloud.tencent.com/dcdb)에서 인스턴스 디스크 사양을 확장할 수도 있습니다. 확장이 완료된 후 인스턴스를 읽고 쓸 수 있습니다.

- 임시 파일이 너무 많은 공간을 차지하는 경우 애플리케이션에 대한 쿼리 문장을 기준으로 정렬 또는 그룹화를 최적화하고 해당 문장의 SQL 최적화를 수행할 수 있으며, 실행 시간이 오래 걸리는 세션 및 트랜잭션을 모니터링하고 지웁니다. 이렇게 하면 임시 파일 수가 줄어듭니다.
- 시스템 파일이 너무 많은 공간을 차지하는 경우 기존 확장 쿼리로 인해 ibdata1 파일의 크기가 너무 클 수 있습니다. 시스템 파일 중복을 줄이기 위해 실행 시간이 오래 걸리는 트랜잭션과 세션을 모니터링하고 지웁니다.
