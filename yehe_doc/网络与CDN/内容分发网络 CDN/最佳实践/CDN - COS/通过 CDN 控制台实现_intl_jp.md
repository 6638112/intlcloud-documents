<style> 
table th:nth-of-type(1) { width:18%; } 
table th:nth-of-type(2){ width:82%; } 
</style>

本ドキュメントでは、CDNアクセラレーションCOSを使用する全体的な操作フローと具体的な操作方法を詳しく説明します。

## 前提条件

1. Tencent Cloudのアカウント登録を完了し、実名認証します。
2. COSバケットを作成します。詳細については、[バケットの作成](https://intl.cloud.tencent.com/document/product/436/13309)をご参照ください。

## 操作ガイド

### ドメイン名の追加

[CDNコンソール](https://console.cloud.tencent.com/cdn)にログインし、左側ナビゲーションバーで**ドメイン名管理**をクリックして管理ページに進み、**ドメイン名の追加**をクリックします。
### COSをオリジンサーバーとして選択

#### その1：ドメイン名の設定

ドメイン名にアクセラレーションする必要のあるリージョン、自身のサービスドメイン名を追加し、プロジェクト、アクセラレーションタイプ、IPv6アクセスを有効化するかどうか及びタグを選択します。


**設定項目の詳細説明：**

| 設定項目   | 説明                                                     |
| :------- | :----------------------------------------------------------- |
| アクセラレーションリージョン | 中国本土：グローバルユーザーからのアクセスは、中国本土のアクセラレーションノードにスケジューリングされてサービスを提供します。 <br/>中国本土以外：グローバルユーザーからのアクセスは、中国本土以外のアクセラレーションノードにスケジューリングされてサービスを提供します。 <br/>グローバル：グローバルユーザーからのアクセスは、最も近いノードにスケジューリングされてサービスを提供します。 <br/><br/>**注意事項：**中国本土と中国本土以外のアクセラレーションサービスは別々で課金されます。課金ポリシーはこちら[クリックして確認]（https://intl.cloud.tencent.com/document/product/228/2949）。|
| アクセラレーションドメイン名 | 1. ドメイン名の長さは81文字以内です。 <br/>2. 中国本土のドメイン名は工信部にてICP登録済みのものとします。 <br/>3.ドメイン名`a.test.com`、`a.b.test.com`などの形式のサブドメイン名または`*.test.com`、`*.a.test.com`形式の汎用ドメイン名をサポートします。 <br/>4. ドメイン名が汎用ドメイン名である場合、または他のユーザーによってアクセスされている場合は、[所有権の検証](https://intl.cloud.tencent.com/document/product/228/5734)を行う必要があります。<br/><br/>**注意事項：** <br/>1. 汎用ドメイン名にアクセスした後、そのサブドメイン名または第2レベル汎用ドメイン名については、他のアカウントでのアクセスは現在サポートされていません。<br/>2. `*.test.com`と`*.a.test.com`の同時アクセスは、現在サポートされていません。<br/>3.現在、アンダーバーを含むドメイン名と中国語ドメイン名のpunycodeコードへのアクセスをサポートしています。<br>　• 中国本土の中国語ドメイン名はまず中国語の形式で関連の登録を行う必要があります。　<br>　• 「中国語.ドメイン名」などの中国語ドメイン名は、サードパーティのツールで「xn--fiq228c.xn--eqrt2g」に変換した後、アクセスすることができます。　<br/>　• 「test_qq.tencent.cloud」などのアンダーバーを含むドメイン名は、直接追加することができます。<br/>4. ドメイン名が悪意のあるドメイン名やハイリスクのドメイン名である場合は、アクセスできません。詳細については、 [使用制限](https://intl.cloud.tencent.com/document/product/228/32981)をご参照ください。 |
| 所属プロジェクト | プロジェクトは、Tencent Cloudのすべてのクラウド製品の共有リソースセットの概念です。[プロジェクト管理](https://console.cloud.tencent.com/project)ページでプロジェクト関連の操作を実行できます。（任意）|
｜アクセラレーションタイプ| Tencent Cloud CDNでは、異なるサービスタイプに相応しいアクセラレーションパフォーマンスの最適化が行われています。<br/>より良いアクセラレーション効果を得るには、ご自分のサービスに近いサービスタイプを選択することをお勧めします。<br/><br/>静的アクセラレーション：電子商取引、Webサイト、ゲーム画像系の小規模リソースアクセラレーションシナリオに適しています。 <br/>ダウンロードアクセラレーション：ゲームのインストールパッケージ、音声・動画ソースファイルのダウンロード、携帯電話のファームウェア配布などのダウンロードシナリオに適しています。<br/>ストリーミングメディアVODのアクセラレーション：eラーニング、オンライン動画オンデマンドなどに適しています。|
| IPv6アクセス | IPv6アクセス：ノードはデフォルトでIPv4アクセスをサポートしており、有効化するとIPv6アクセスをサポートします。<br /><br/>**注意事項：** 中国本土のみIPv6をサポートします。（任意） |
| タグ     | さまざまな次元からリソースのカテゴリー管理を行うために用います。既存のタグが要件を満たさない場合は、コンソールの[タグの管理](https://console.cloud.tencent.com/tag/taglist)に移動してください。（任意） |

#### その2：オリジンサーバーの設定

サービスオリジンサーバー関連情報を設定します。CDNノードはキャッシュにリソースがない場合、オリジンサーバーに戻って取り出してキャッシュします。


1. **ドメイン名設定**内の**オリジンサーバータイプ**で選択：COSオリジン（即ち、Cloud Object Storage）。
2. オリジンサーバーのサポート状況に応じて、back-to-originリクエストプロトコルを選択します。
3. オリジンサーバーアドレス内で対応する**バケット**を選択します。
4. **プライベートバケットアクセス**を有効化すると、COS-bucket権限管理にアクセスして先にCDNサービスの権限承認を受ける必要があります。権限承認を確認した後、手動で有効化できます。
5. back-to-origin HOST デフォルトは、変更する必要はありません。

#### その3：サービスの設定

ノードアクセラレーションサービス関連の設定を行います。


**設定項目の詳細説明：**

| 設定項目   | 説明                                                     |
| :------- | :----------------------------------------------------------- |
| パラメータ無視 | ノードがリソースをキャッシュするには、Key-Valueマッピングに従います。ここでのKeyはリソースURLです。<br/> パラメータの無視を有効にすると、KeyはURLの「?」以降のパラメータを無視してマッピングします。<br/> パラメータの無視を有効にしないと、Keyは完全なリソースURLになります。<br/> 静的アクセラレーションタイプは、デフォルトでは無効になっており、ダウンロードおよびストリーミングメディアVODアクセラレーションタイプは、デフォルトでは有効になっています。|
| Back-to-Origin of Range | back-to-origin時にパート化するかどうかを設定します。有効化するにはオリジンサーバーがパート化をサポートしている必要があります。オリジンサーバータイプがCOSオリジンサーバーである場合は、Back-to-Origin of Rangeがデフォルトで有効になります。 |
| キャッシュルール | ノードのキャッシュ有効期限の設定について、すべてのファイルのキャッシュ有効期限はデフォルトで30日です。設定されたノードのキャッシュ有効期限は最長有効期限であり、ノードのストレージリソースの影響を受けます。実際のキャッシュ時間は、状況に応じて決まります。<br />クライアントはリソースタイプに応じて異なる時間のキャッシュ設定を行います。 |

**ドメイン名の追加**ページのすべての設定を入力後、**送信を確認**をクリックし、ドメイン名追加操作を完了します。ドメイン名の設定をネットワーク全体のノードに配信するには約5～10分かかります。しばらくお待ちください。

### 最終ステップ：CNAMEの設定

ドメイン名の追加が完了した後、**ドメイン名管理**ページで、CDNがドメイン名に割り当てたアクセラレーションCNAMEを確認することができます。


アクセスドメイン名のDNSサービスプロバイダー（Dnspodなど）に接続し、このドメイン名にそのCNAMEレコードを追加して**DNS設定を有効化すると**、アクセラレーションサービスが実行可能になります。詳細については、[CNAMEの設定](https://intl.cloud.tencent.com/document/product/228/3121)をご参照ください 。

## 推奨設定

1. 設定完了後、COS下のリソースファイルに対してプリフェッチを行います。事前に静的リソースをCDNアクセラレーションノードにプリフェッチし、オリジンサーバーのストレスを軽減してレスポンスとダウンロードの速度を向上させます。詳細については、<a href="https://intl.cloud.tencent.com/document/product/228/39000">キャッシュプリフェッチ</a>をご参照ください。
2. クロスドメインのヘッダーパラメーターを設定します。リソースのクロスドメイン権限に関する問題を解決する場合、詳細は<a href="https://intl.cloud.tencent.com/document/product/228/35320">HTTPレスポンスヘッダーの設定</a>をご参照ください。
3. クライアントオリジンサーバーのリソースが変更済みの場合、キャッシュを更新してからプリフェッチを行うことを推奨します。詳細は<a href="https://intl.cloud.tencent.com/document/product/228/6299">キャッシュ更新</a>をご参照ください。
