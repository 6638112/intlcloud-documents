스트레스 테스트에 대한 고객 경험을 바탕으로 본문은 스트레스 테스트의 일반적인 성능 문제를 요약하고 문제 해결 솔루션과 제안을 제공합니다.

## 스트레스 테스트 FAQ

### 1. 리얼 서버에서 공중망 액세스가 활성화되어 있지 않음
CVM 구매 시 공중망 액세스가 활성화되지 않은 경우 공중망 CLB가 CVM 인스턴스에 마운트될 때 포워딩이 실패할 수 있습니다.
### 2. 리얼 서버의 대역폭 부족
리얼 서버의 대역폭이 낮으면 임계값을 초과하면 패킷을 CLB로 반환할 수 없습니다. CLB는 클라이언트에 504 또는 502 오류를 반환합니다.
### 3. 클라이언트 포트 부족 
클라이언트 수가 너무 적거나 클라이언트 포트 범위가 너무 좁으면 클라이언트 포트가 부족하여 연결이 설정되지 않습니다. 또한 지속 연결이 설정되었을 때 keep_alive 값이 0보다 크면 연결이 지속적으로 포트를 사용하므로 사용 가능한 클라이언트 포트 수가 줄어듭니다.
### 4. 리얼 서버에 의존하는 애플리케이션에 성능 문제 발생
요청이 CLB를 통해 리얼 서버에 도달한 후 리얼 서버의 로드는 정상입니다. 그러나 리얼 서버의 애플리케이션은 데이터베이스와 같은 다른 애플리케이션에도 의존하기 때문에 데이터베이스의 성능 문제도 스트레스 테스트 성능에 영향을 줄 수 있습니다.
### 5. 리얼 서버 비정상
리얼 서버의 상태는 스트레스 테스트에서 무시될 수 있습니다. 리얼 서버에 상태 확인 실패 또는 상태 확인 상태가 불안정한 경우(빠른 변경으로 인해 좋은 경우도 있고 나쁜 경우도 있음) 스트레스 테스트의 성능이 저하될 수 있습니다.
### 6. CLB에 대해 세션 지속성을 활성화하면 리얼 서버 간에 트래픽이 고르지 않게 분산됨
CLB에 대해 세션 지속성이 활성화된 후 요청이 고정된 리얼 서버에 배포될 수 있습니다. 트래픽 분포가 고르지 않게 되어 스트레스 테스트의 성능에 영향을 줍니다. 스트레스 테스트 중에는 세션 지속성을 비활성화하는 것이 좋습니다.

## 스트레스 테스트를 위한 제안
>!다음 구성은 CLB 스트레스 테스트에만 사용됩니다. 프로덕션 환경에 필요하지 않습니다.

- CLB의 포워딩 기능을 스트레스 테스트할 때 비지속 연결을 사용하는 것이 좋습니다.
세션 지속성 기능에 대한 검증을 제외하고 스트레스 테스트는 일반적으로 CLB의 포워딩 기능을 검증하기 위해 설계됩니다. 따라서 비지속 연결을 사용하여 CLB와 리얼 서버의 처리 능력을 테스트할 수 있습니다.
- 대역폭 상한 및 지속 연결 서비스와 같은 CLB의 처리량 테스트를 스트레스 테스트하기 위해 지속 연결을 사용하는 것이 좋습니다.
스트레스 테스트 툴의 초과 시간을 작은 값으로 조정하는 것이 좋습니다. 그렇지 않으면 타임아웃 기간이 증가할 때 평균 응답 시간이 증가하여 스트레스 수준에 도달했는지 여부를 신속하게 판단할 수 없습니다.
- I/O, DB 등의 애플리케이션 로직으로 인한 손실을 방지하기 위해 리얼 서버에서 제공하는 정적 웹사이트를 스트레스 테스트용으로 사용할 것을 권장합니다.
- 리스너에 대한 세션 지속성을 비활성화합니다. 그렇지 않으면 스트레스가 특정 리얼 서버에 집중됩니다. 스트레스 성능이 만족스럽지 않은 경우 CLB에서 리얼 서버의 모니터링 데이터를 확인하여 트래픽이 고르게 분산되었는지 확인할 수 있습니다.
- 상태 확인 중에 생성되는 리얼 서버에 대한 액세스 요청을 줄이기 위해 리스너에 대한 상태 확인을 비활성화합니다.
- 스트레스 테스트를 위해 여러 client(> 5)를 사용합니다. 분산된 원본 IP는 실제 온라인 조건을 더 잘 시뮬레이션할 수 있습니다.
