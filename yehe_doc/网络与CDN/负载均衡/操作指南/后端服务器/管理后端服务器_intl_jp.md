CLBは正常に動作しているバックエンドサーバーインスタンスにリクエストをルーティングします。CLBを初めて使用する際または業務上のニーズに応じてバックエンドサーバーの数を追加または削除したい場合は、このガイドに従って操作することができます。

## 前提条件
CLBインスタンスを作成し、リスナーを設定済みであること。詳細については、[CLBクイックスタート](https://intl.cloud.tencent.com/document/product/214/8975)をご参照ください。
## 操作手順
### CLBバックエンドCVMの追加
>?
>- CLBインスタンスがある自動スケーリンググループに関連付けられている場合、このグループのCVMがCLBのバックエンドCVMに自動的に追加されます。自動スケーリンググループからあるCVMインスタンスが削除されると、このCVMインスタンスはCLBのバックエンドCVMからも自動的に削除されます。
>- APIを使用してCLBにバックエンドサーバーを追加したい場合は、[バックエンドサーバーのCLBへのバインド](https://intl.cloud.tencent.com/document/api/214/1265)インターフェースの説明をご参照ください。
>- アカウントタイプが従来型アカウントタイプであり、かつインスタンスのキャリアタイプがチャイナモバイル、チャイナテレコムまたはチャイナユニコムの場合は、ネットワーク課金モデルがトラフィック課金および共有帯域幅パッケージのCVMに限りバインドできます。アカウントタイプの詳細については[アカウントタイプの判断](https://intl.cloud.tencent.com/document/product/684/15246)を、キャリアタイプの詳細については[キャリアタイプ](https://intl.cloud.tencent.com/document/product/214/13629)をそれぞれご参照ください。
>
1. [CLBコンソール](https://console.cloud.tencent.com/loadbalance)にログインします。
2. 「インスタンス管理」ページの「CLB」タブで、目的のCLBインスタンスの右側にある操作列の**リスナーの設定**をクリックします。
3. リスナー設定モジュールで、バックエンドCVMをバインドしたいリスナーを選択します。
 - **HTTP/HTTPSリスナー**[](id:http)
	 1. HTTP/HTTPSリスナーエリアで、目的のリスナーの左側にある+をクリックします。
	 ![](https://main.qcloudimg.com/raw/5c123efc112957e25f51ab2f8a753063.png)
	 2. 表示されたドメイン名の左側にある+をクリックします。
	 ![](https://main.qcloudimg.com/raw/816b003603e735d3d4f21e8891d9e279.png)
	 3. 表示されたURLパスを選択し、**バインド**をクリックします。
![](https://main.qcloudimg.com/raw/05f2041acaced53d2ae8bc24a2f0662b.png)
 - **TCP/UDP/TCP SSLリスナー**
TCP/UDP/TCP SSLリスナーモジュールの左側のリストから、バインドしたいバックエンドCVMのリスナーを選択し、**バインド**をクリックします。
![](https://main.qcloudimg.com/raw/7dc44fc32104e533b512ab6c0b616e21.png)
4. CLBインスタンスにバックエンドサービスをバインドします。[](id:CLB)
	- **方法1**：「バックエンドサービスのバインド」ポップアップボックスで**CVM**をクリックし、関連付けたいCVM（複数選択可）を選択し、関連のCVMの、転送を希望するポートと重みを入力します。詳細については、[サーバーの一般的なポート](https://intl.cloud.tencent.com/document/product/213/12451)をご参照ください。その後、**OK**をクリックします。
>?
>- 「バックエンドサービスのバインド」ポップアップボックスには、同一のリージョン、同一のネットワーク環境の、隔離されていない、期限切れではない、帯域幅（ピーク値）が0ではない、選択可能なCVMのみが表示されます。
>- 複数のバックエンドサーバーをバインドする場合、CLBはHashアルゴリズムによってトラフィックを転送することで負荷分散の役割を果たします。
>- 重みが高いほど、転送されるリクエストの数は多くなります。デフォルトは10、設定可能範囲は0～100です。 重みを0に設定すると、そのサーバーは新しいリクエストを受信しなくなります。セッション維持を有効にしていると、バックエンドサーバーのリクエストが不均一になる可能性があります。詳細については、[バランシングアルゴリズムの選択と重みの設定の例](https://intl.cloud.tencent.com/document/product/214/5371)をご参照ください。
>
 ![](https://main.qcloudimg.com/raw/a7f71557ff1812f777c9e989b916049f.png)
	- **方法2**：サーバーを一括でバインドし、かつあらかじめ設定したポート値と一致させたい場合は、「バックエンドサービスのバインド」ポップアップボックスで**CVM**をクリックし、デフォルトのポート値を入力し（ポートの選択については[サーバーの一般的なポート](https://intl.cloud.tencent.com/document/product/213/12451)をご参照ください）、関連のサーバーにチェックを入れて重み値を設定し、**OK**をクリックします。
![](https://main.qcloudimg.com/raw/118bfbab842d72e990d9ffe08c6379ff.png)



### CLBバックエンドサーバーの重みの変更
CVMに転送されるリクエストの相対数はバックエンドサーバーの重みによって決まります。バックエンドCVMをバインドする際に、重みの情報をあらかじめ設定する必要があります。次は「HTTP/HTTPSリスナー」を例に（TCP/UDP/TCP SSLリスナーの変更方法も同様です）、CLBバックエンドサーバーの重みを変更する方法についてご説明します。
>?
>- APIを使用してCLBバックエンドサーバーの重みを変更したい場合は、[CLBバックエンドサーバーの重みの変更](https://intl.cloud.tencent.com/document/api/214/1264)インターフェースの説明をご参照ください。
>- CLBバックエンドサーバーの重みに関するその他の情報については、[CLBのポーリング方式](https://intl.cloud.tencent.com/document/product/214/6153)をご参照ください。
>
1. [CLBコンソール](https://console.cloud.tencent.com/loadbalance)にログインします。
2. 「インスタンス管理」ページの「CLB」タブで、目的のCLBインスタンスの右側にある操作列の**リスナーの設定**をクリックします。
3. HTTP/HTTPSリスナーモジュールの左側のリストで、インスタンスとリスナーのルールを表示し、URLパスを選択します。
![](https://main.qcloudimg.com/raw/06d500104032de3edda51bdc368b0c4b.png)
4. HTTP/HTTPSリスナーモジュールの右側のサーバーリストで、関連のサーバーの重みを変更します。
>?重みが高いほど、転送されるリクエストの数は多くなります。デフォルトは10、設定可能範囲は0～100です。 重みを0に設定すると、そのサーバーは新しいリクエストを受信しなくなります。セッション維持を有効にしていると、バックエンドサーバーのリクエストが不均一になる可能性があります。詳細については、[バランシングアルゴリズムの選択と重みの設定の例](https://intl.cloud.tencent.com/document/product/214/5371)をご参照ください。
>
	- **方法1**：あるサーバーの重みを単独で変更します。
		1. 重みを変更したいサーバーを見つけ、対応する重みの上にマウスを合わせ、編集ボタン<img src="https://main.qcloudimg.com/raw/4aae0dbec227f8fc18b4a35acf560f62.png" style="margin:0;">をクリックします。
		![](https://main.qcloudimg.com/raw/519a69a1fab550879e92cdfc159a8fa1.png)
		2. 「重みの変更」ポップアップウィンドウに変更後の重み値を入力し、**送信**をクリックします。
	- **方法2**：いくつかのサーバーの重みを一括変更します。
>?一括変更後のサーバーの重みはすべて同じになります。
>
		1.サーバーの前にあるチェックボックスをクリックして複数のサーバーを選択し、リストの上方で**重みの変更**をクリックします。
		![](https://main.qcloudimg.com/raw/09fdd5cb7a49f80bdc088632d7249f1e.png)
		2. 「重みの変更」ポップアップウィンドウに変更後の重み値を入力し、**送信**をクリックします。



### CLBバックエンドサーバーポートの変更
CLBコンソールはバックエンドサーバーポートの変更をサポートしています。次は「HTTP/HTTPSリスナー」を例に（TCP/UDP/TCP SSLリスナーの変更方法も同様です）、CLBバックエンドサーバーのポートを変更する方法についてご説明します。
>?APIを使用してCLBバックエンドサーバーポートを変更したい場合は、[リスナーにバインドしたバックエンドマシンのポートの変更](https://intl.cloud.tencent.com/document/product/214/33812)インターフェースの説明をご参照ください。
>
1. [CLBコンソール](https://console.cloud.tencent.com/loadbalance)にログインします。
2. 「インスタンス管理」ページの「CLB」タブで、目的のCLBインスタンスの右側にある操作列の**リスナーの設定**をクリックします。
3. HTTP/HTTPSリスナーモジュールの左側のリストで、インスタンスとリスナーのルールを表示し、URLパスを選択します。
![](https://main.qcloudimg.com/raw/06d500104032de3edda51bdc368b0c4b.png)
4. HTTP/HTTPSリスナーモジュール右側のサーバーリストで、関連のサーバーポートを変更します。ポートの選択については、[サーバーの一般的なポート](https://intl.cloud.tencent.com/document/product/213/12451)をご参照ください。
	- **方法1**：あるサーバーのポートを単独で変更します。
		1. ポートを変更したいサーバーを見つけ、対応するポートの上にマウスを合わせ、編集ボタン<img src="https://main.qcloudimg.com/raw/4aae0dbec227f8fc18b4a35acf560f62.png" style="margin:0;">をクリックします。
		![](https://main.qcloudimg.com/raw/923c439bedc4af2e6129d8ada459a1c5.png)
		2. 「ポートの変更」ポップアップウィンドウに変更後のポート値を入力し、**送信**をクリックします。
	- **方法2**：いくつかのサーバーのポートを一括変更します。
>?一括変更後のサーバーポートはすべて同じになります。
>
	1.サーバーの前にあるチェックボックスをクリックして複数のサーバーを選択し、リストの上方で**ポートの変更**をクリックします。
	![](https://main.qcloudimg.com/raw/07d40e5fcf1111a9141be83e41f67797.png)
	2. 「ポートの変更」ポップアップウィンドウに変更後のポート値を入力し、**送信**をクリックします。



### CLBバックエンドサーバーのバインド解除
CLBコンソールはバインド済みのバックエンドサーバーのバインド解除をサポートしています。次は「HTTP/HTTPSリスナー」を例に（TCP/UDP/TCP SSLリスナーのバインド解除方法も同様です）、バインド済みのCLBバックエンドサーバーのバインドを解除する方法についてご説明します。
>?
>- バックエンドサーバーのバインドを解除すると、CLBインスタンスとCVMインスタンスとの関連付けが解除され、CLBからのリクエスト転送はその時点で停止します。
>- バックエンドサーバーのバインドを解除しても、CVMのライフサイクルには影響はありません。再度バックエンドサーバークラスターに追加することもできます。
>- APIを使用してCLBバックエンドサーバーのバインドを解除したい場合は、[CLBリスナーとバックエンドサービスのバインド解除](https://intl.cloud.tencent.com/document/product/214/33832)インターフェースの説明をご参照ください。
>
1. [CLBコンソール](https://console.cloud.tencent.com/loadbalance)にログインします。
2. 「インスタンス管理」ページの「CLB」タブで、目的のCLBインスタンスの右側にある操作列の**リスナーの設定**をクリックします。
4. HTTP/HTTPSリスナーモジュールの左側のリストで、インスタンスとリスナーのルールを表示し、URLパスを選択します。
![](https://main.qcloudimg.com/raw/06d500104032de3edda51bdc368b0c4b.png)
5. HTTP/HTTPSリスナーモジュールの右側のサーバーリストで、バインド済みのバックエンドサーバーのバインドを解除します。
	- **方法1**：あるサーバーのバインドを単独で解除します。
		1. バインドを解除したいサーバーを見つけ、その右側の操作バーで**バインド解除**をクリックします。
		![](https://main.qcloudimg.com/raw/c995daabbf0b6a710b21389b17b7760b.png)
		2. 「バインド解除」ポップアップウィンドウでバインドを解除するサービスを確認し、**送信**をクリックします。
	- **方法2**：いくつかのサーバーのバインドを一括解除します。
		1.サーバーの前にあるチェックボックスをクリックして複数のサーバーを選択し、リストの上方で**バインド解除**をクリックします。
		![](https://main.qcloudimg.com/raw/b397ef434ce42cfaa9a48b9f4f08f09f.png)
		2. 「バインド解除」ポップアップウィンドウでバインドを解除するサービスを確認し、**送信**をクリックします。

