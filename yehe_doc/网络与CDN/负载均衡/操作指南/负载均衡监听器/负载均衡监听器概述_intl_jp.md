CLBインスタンスを作成後、インスタンスにリスナーを設定する必要があります。リスナーはCLBインスタンス上のリクエストを監視し、バランシングポリシーに基づいてトラフィックをバックエンドサーバーに振り分ける役割を担います。

CLBリスナーには次の設定が必要です。
1. リスニングプロトコルおよびリスニングポート。CLBのリスニングポートはフロントエンドポートとも呼ばれ、リクエストを受信してバックエンドサーバーに転送するためのポートとして用いられます。
2. リスニングポリシー。バランシングポリシー、[セッション維持](https://intl.cloud.tencent.com/document/product/214/6154)など。
3. [ヘルスチェック](https://intl.cloud.tencent.com/document/product/214/6097)ポリシー。
4. バインドするバックエンドサービス。バックエンドサーバーのIPおよびポートを設定する必要があります。サービスポートはバックエンドポートとも呼ばれ、バックエンドサービスがリクエストを受信するためのポートとして用いられます。

## サポートするプロトコルタイプ
CLBリスナーはCLBインスタンス上のレイヤー4およびレイヤー7リクエストを監視し、これらのリクエストをバックエンドサーバーに振り分けることができ、その後バックエンドサーバーがリクエストを処理します。レイヤー4およびレイヤー7CLBの主な違いは、ユーザーのリクエストに対しロードバランシングを行う際に、トラフィックの転送をレイヤー4プロトコルとレイヤー7プロトコルのどちらに基づいて行うかという点にあります。例えば、TCP、UDPなどのレイヤー4プロトコルリクエストに対してはレイヤー4CLBが、HTTP、HTTPSなどのレイヤー7プロトコルリクエストに対してはレイヤー7CLBがそれぞれ用いられます。
- レイヤー4プロトコル：トランスポート層プロトコルです。主にVIP + Portによってリクエストを受信し、トラフィックをバックエンドサーバーに分配します。
- レイヤー7プロトコル：アプリケーション層プロトコルです。URL、HTTPヘッダーなどのアプリケーション層情報に基づいてトラフィックを振り分けます。

レイヤー4リスナーを使用する（レイヤー4プロトコルを使用して転送する）場合、CLBインスタンスはリスニングポート上にバックエンドインスタンスとのTCP接続を確立し、リクエストをバックエンドサーバーに直接転送します。このプロセスではデータパケットの変更が何も行われないため（パススルーモード） 、転送効率が非常に高くなります。

Tencent Cloud CLBは次のプロトコルによるリクエスト転送をサポートしています。
- TCP（トランスポート層）
- UDP（トランスポート層）
- TCP SSL（トランスポート層）
- QUIC（トランスポート層）
- HTTP（アプリケーション層）
- HTTPS（アプリケーション層）
>? TCP SSLリスナーは現在パブリックネットワークCLBのみサポートしています（プライベートネットワークはサポートしていません）。


<table>
<thead>
<tr>
<th width="12%">プロトコルのカテゴリー</th>
<th width="12%">プロトコル</th>
<th width="40%">説明</th>
<th width="36%">ユースケース</th>
</tr>
<tr>
<td rowspan="4">レイヤー4プロトコル</td>
<td>TCP</td>
<td>コネクション型の、信頼性の高いトランスポート層プロトコル<li>送信元と送信先で3ウェイハンドシェイクを行って接続を確立してからデータを伝送します</li><li>クライアントIP（ソースIP）ベースのセッション維持をサポートします</li><li>ネットワーク層でクライアントIPを確認できます</li><li>サーバーがクライアントIPを直接取得できます</li></td>
<td>信頼性およびデータの正確性に対する要件が高く、ファイル伝送、メール送受信、リモートログインなど、伝送速度に対する要件が比較的低いシーンに適しています。<br>詳細については<a href="https://intl.cloud.tencent.com/document/product/214/32517">TCPリスナーの設定</a>をご参照ください。</td>
</tr>
<tr>
<td>UDP</td>
<td>コネクションレス型のトランスポート層プロトコル<li>送信元と送信先で接続を確立せず、接続状態を維持する必要がありません</li><li>UDPの各接続はポイントツーポイントのみ可能です</li><li>1対1、1対複数、複数対1の相互通信をサポートしています</li><li>クライアントIP（ソースIP）ベースのセッション維持をサポートします</li><li>サーバーがクライアントIPを直接取得できます</li></td>
<td>インスタントメッセージ、オンラインビデオなど、伝送効率に対する要件が高く、正確性に対する要件が比較的低いシーンに適しています。<br>詳細については<a href="https://intl.cloud.tencent.com/document/product/214/32518">UDPリスナーの設定</a>をご参照ください。</td>
</tr>
<tr>
<td>TCP SSL</td>
<td>安全なTCP <li>TCP SSLリスナーは証明書の設定をサポートし、権限のないアクセスを阻止します</li><li>一元化された証明書管理サービスによって、CLBで復号操作を完了できます</li><li>単方向認証と双方向認証をサポートしています</li><li>サーバーがクライアントIPを直接取得できます</li></td>
<td>TCPプロトコルの下でのセキュリティ要件が非常に高いシーンに適しています。TCPベースのカスタムプロトコルをサポートしています。<br>詳細については<a href="https://intl.cloud.tencent.com/document/product/214/32519">TCP SSLリスナーの設定</a>をご参照ください。</td>
</tr>
<tr>
<td>QUIC </td>
<td>UDPのマルチパス通信プロトコルをベースにしています。<li>UDP上でデータの信頼性の高い伝送、セキュリティおよびHTTP2を実現し、TCP + TLS + HTTP2と同等の効果を有します。</li><li>QIUC接続では、IPやポートにどのような変化があっても接続の中断や再接続が起こらないため、シームレスなコネクションマイグレーションが実現できます。</li></td>
<td>オーディオビデオ業務、ゲーム業務などでネットワークに変化が生じる場合、例えば4GネットワークとWi-Fiネットワークを頻繁に切り替える場合など、中断せずスムーズに接続を移行したいシーンに適しています。<br>詳細については<a href="https://intl.cloud.tencent.com/document/product/214/44832">QUICリスナーの設定</a>をご参照ください。</td>
</tr>
<tr>
<td rowspan="2">レイヤー7プロトコル</td>
<td>HTTP</td>
<td>アプリケーション層プロトコル<li>リクエストのドメイン名およびURLに基づく転送をサポートしています</li><li>Cookieベースのセッション維持をサポートしています</li></td>
<td>WebアプリケーションやAppサービスなど、リクエストの内容を認識する必要があるアプリケーションに適しています。<br>詳細については<a href="https://intl.cloud.tencent.com/document/product/214/32515">HTTPリスナーの設定</a>をご参照ください。</td>
</tr>
<tr>
<td>HTTPS</td>
<td>暗号化されたアプリケーション層プロトコル<li>リクエストのドメイン名およびURLに基づく転送をサポートしています</li><li>Cookieベースのセッション維持をサポートしています</li><li>一元化された証明書管理サービスによって、CLBで復号操作を完了できます</li><li>単方向認証と双方向認証をサポートしています</li></td>
<td>暗号化通信が必要なHTTPアプリケーションに適しています。<br>詳細については<a href="https://intl.cloud.tencent.com/document/product/214/32516">HTTPSリスナーの設定</a>をご参照ください。</td>
</tr>
</tbody></table>

## ポートの設定
<table>
<thead>
<tr>
<th width="16%">ポートタイプ</th>
<th>説明</th>
<th width="50%">制限</th>
</tr>
</thead>
<tbody><tr>
<td>リスニングポート（フロントエンドポート）</td>
<td>リスニングポートとは、CLBがリクエストを受信してバックエンドサーバーにリクエストを転送するためのポートです。<br/>1～65535番ポートにCLBを設定することができます。例えば、21（FTP）、25（SMTP）、80（HTTP）、443（HTTPS）などです。</td>
<td><ul>同一のCLBインスタンス内では次のようになります。<li>UDPタイプのプロトコルとTCPタイプのプロトコルのリスニングポートは重複させることができます。例えば、リスナーTCP:80とリスナーUDP:80を同時に作成することができます。</li><li>同一のタイプのプロトコルでは、リスニングポートは重複してはなりません。TCP/TCP SSL/HTTP/HTTPSはいずれもTCPタイプです。例えば、リスナーTCP:80とリスナーHTTP:80は同時に作成できません。</li></ul></td>
</tr>
<tr>
<td>サービスポート（バックエンドポート）</td>
<td>サービスポートとはCVMがサービスを提供するためのポートであり、CLBからのトラフィックを受信して処理します。<br/>1つのCLBインスタンスにおいて、同一のCLBリスニングポートが複数のCVMの複数のポートにトラフィックを転送することができます。</td>
<td><ul>同一のCLBインスタンス内では次のようになります。<li>異なるリスニングプロトコルのサービスポートは重複させることができます。例えば、リスナーHTTP:80とリスナーHTTPS:443は、同一のCVMの同一のポートに同時にバインドすることができます。</li><li>同一のタイプのリスニングプロトコルでは、同一のバックエンドサービスポートには1つのリスナーのみバインドできます。すなわち、4つ組（VIP、リスニングプロトコル、バックエンドサービスプライベートIP、バックエンドサービスポート）が一意である必要があります。</li></ul></td>
</tr>
</tbody></table>



## 関連ドキュメント
[使用上の制約](https://intl.cloud.tencent.com/document/product/214/6187)
