> *IT Network System Administration Module B -- Windows Environment*
>
> Submitted by: Doug Warden (CA) Alan Au (MO) Jaeha Lee (KR) Troy Pretty (AU) AnggaFriyanto (ID)
>
> Hamed Kargarzadeh (IR) Atsuya Kamioka (JP) Stefan Wachter (LI) Abdu Aziz Al Abri (OM)
>
> WSC2019\_TP39\_ModuleB\_pre\_EN

# Contents

[Contents 2](#contents)

[Introduction to Test Project 3](#introduction-to-test-project)

[Contents 3](#contents-1)

[Description of project and tasks 4](#description-of-project-and-tasks)

[Part 1. Intranet 4](#part-1.-intranet)

[Part 2. Virtualized Server Farm 6](#part-2.-virtualized-server-farm)

[Part 3. Perimeter and Internet 8](#part-3.-perimeter-and-internet)

[Instructions to the Competitor 12](#instructions-to-the-competitor)

[Equipment, machinery, installations and materials required 12](#equipment-machinery-installations-and-materials-required)

# Introduction to Test Project

## Contents

> This Test Project proposal consists of the following documentation/files:


1.  WSC2019\_TP39\_PRE\_EN.docx

2.  WSC2019\_TP39\_Module\_B\_Users.xlsx

3.  profileXML.ps1

4.  profileXML.xml

5.  Import-BulkUserFromCsv.ps1

6.  HTML.zip

> You are the IT consultant responsible for Skill39. Use the password \"Pa\$\$worD\"(without quotes) when no specific password has given. Use the password \"Skills39\" for local accounts.
>
> You have inherited a Windows Domain with some users and configurations already set up but have decided to perform further tasks to improve the network. You will need to host a number of websites securely for people inside and outside the domain to access. In order to do this, you have decided to provide a high availability system based on Hyper-V amongst other improvements. You will use this Hyper-V infrastructure to improve the server infrastructure in the existing domain. Please follow the instructions that follow to complete the project.

# Description of project and tasks

## Part 1. Intranet

> You need to upgrade the infrastructure in the network to the existing domain. Some machines will need to be installed from scratch, some machines will exist in a BASE condition (installed, updated, sysprepped and generalized to save time, but still require all other configuration), and some will be completely pre-installed and already configured. Examine the diagrams at the end of this project and the VM Configuration Table for clarification. Some of the tasks will need to be completed after all of the infrastructure and servers have been added, be sure to return to the earlier tasks to make sure you have completed all requirements.

### DC1-- Preinstalled and Preconfigured

> Configure existing machine to match the requirements

-   This server is pre-configured as the domain controller of wsc2019.ru.

-   Configure Active Directory.

    -   Fix the PowerShell script and import users from included excel file supplied from USB. Accounts should be enabled, have the properties listed in the spreadsheet including group membership, and NOT be required to change password at first login.

-   Configure DNS service.

    -   Create all appropriate A records for all servers on 201.98.23.0/24 subnet.

    -   Create all appropriate CNAME records according to the tasks.

    -    A record of 201.98.23.101

    -    adfs

    -    CNAME record of dc2.wsc2019.ru:

    -     work

    -    CNAME records of web.wsc2019.ru:

    -    csweb, www, intra, extra

    -   Configure root hint as \"ns.msftncsi.com\" and remove other root hints.

    -   Create a reverse lookup zone creating PTR records for all servers.

-   Configure DHCP service.

    -   Configure failover scope with DC2 once it is installed. Set DC1 as the active server.

    -   Total scope Range: 201.98.23.51 - 201.98.23.75

    -   Give DC1 70% of this scope to DC1, and the rest to DC2

    -   Configure the failover to use Hot Standby mode

    -   Scope Options

    -    DNS: 201.98.23.1, 201.98.23.101, Gateway: 201.98.23.254

-   Configure Network Policy Server to authorize network access for VPN-connected users.

    -   Users in the Competitor group are not allowed to connect to VPN server.

    -   Agents and Experts can use VPN connection by username and password.

-   Add WDS service for future Hyper-V server deployments

    -   Users running WDS should have an option for installing a Windows 2016 server with either a GUI or Non- GUI interface.

    -   Deploy the WEB Virtual Machines in the Hyper-V server cluster once it is created via WDS.

-   Configure and apply the following group policies:

    -   Disable \"first sign-on animation\" on each domain-joined client.

    -   Change Power settings so machines do not go to sleep for each domain-joined client.

    -   Create a GPO which is applied to all machines so that the firewall is modified to allow ping traffic between machines.

    -   Automatically issue a certificate for the \"Manager\" group members.

    -   The work folder must be automatically connected when \"Experts\" group members logged on.

-   Create and share a C:\\backups folder as \\\\DC1\\Backups\\

    -   Create a backup job to backup all users home folders located on DC2 at 4 PM daily.

    -   Make sure the backup job is written to the event log.

### CERT

> Configure to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Configure the Certification Authority service.

    -   Use certificate issued from \"ISP-CA\".

    -   Common Name: \"WSC2019-CA\"

    -   Enable extensions for CDP and AIA URL through HTTP.

    -   URL for CDP: • URL for CDP: <http://cert.wsc2019.ru/CertEnroll/>\<CaName\>\<CRLNameSuffix\>\<DeltaCRLAllowed\>.crl URL for AIA: • URL for AIA: <http://cert.wsc2019.ru/CertEnroll/>\<ServerDNSName\>\_\<CaName\>\<CertificateName\>.crt Create these templates:

    -    \"\_RU\_Manager\"

    -    For users in the \"Manager\" group.

    -   \"\_RU\_Server\"

    -   To provide a certificate for servers/services inwsc2019.ru domain.

    -   \"\_External\_Client\"

    -   To provide a certificate for computers on the Internet.

    -   Enable key-based renewal.

    -    Enable certificate manager approval to issue a certificate.

### DC2

> Configure to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Configure this server as a second domain controller for the wsc2019.ru domain.

-   Configure DNS service.

    -   The records of Active Directory-Integrated zones should be replicated.

-   Configure DHCP service.

    -   Configure failover scope - refer to the description for DC1.

-   Configure Active Directory Federation Service.

    -   This server provides federation service.

    -   URL: \"https://adfs.wsc2019.ru\"

    -   Display Name: \"WSC2019-Kazan Single Sign-On\"

-   Add three extra 10G drives

-   Format the attached disks with NTFS into a single RAID 5 array (G:\\) and enable de-duplication on this volume.

-   Create file share for user\'s home drives.

    -   Access URL: dc2.wsc2019.ru\\homes

    -   Local path: \"G:\\homes\\\"

-   Configure Work Folders.

    -   Access URL: https://work.wsc2019.ru/

    -   Local path: \"G:\\work\\\"

-   Create a file share for each group.

    -   Access URL: dc2.wsc2019.ru\\WSC

    -   Local path: \"G:\\WSC\\\"

    -   Create three subfolders and configure access control:

        -    Junior Skills

            -   Allow read-only access for users who have \"Junior\" as the job title.

            -   Allow full access to the users who are also part of the \"WSJ\" organizational unit and also belong to the \"Manager\" group.

        -    Secret Challenges

            -    Allow access only for \"Agent\" group.

            -    This folder should be hidden for the user who has insufficient permission.

        -    Public

        -   Allow read-only access for domain users.

        -    Create a file share for local path G:\\witness and share it as \\\\DC2\\witness.

### INTCLIENT -- BASE Install

> Configure to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Join to wsc2019.ru domain.

-   Use this machine to:

    -   Test access to Manager/Intranet/Extranet websites.

    -   Test GPOs.

    -   Test home and Work Folders.

    -   Ensuring users have been imported correctly.

## Part 2. Virtualized Server Farm

> You have completed the core domain infrastructure configuration. You now need to configure your virtualized server farm to provide further infrastructure and application services through a high-availability configuration. Follow the instructions given to complete the task.

### Storage -- BASE INSTALL

> Configure to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   IP Address: 10.0.0.10

-   Configure the iSCSI target.

    -   Add new disk of 200 G for storing the virtual machines.

        -    Format disk using ReFS and mount as \"E:\\\" drive.

    -   Create 100GB of iSCSI virtual disk \"E:\\iSCSIVirtualDisks\\WSC2019-VM.vhdx\".

### Configure the target name as \"WSC2019-TGT\".

-   Create an SMB based witness disk on DC2 on \\\\DC2\\witness.

### HYPERV1 and HYPERV2

> Install HyperV1 with physical attributes that match HyperV2 and configure both Hyper-V servers to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Configure iSCSI Initiator.

    -   Connect iSCSI disk \"WSC2019-VM\" and create ReFS partition using maximum available size.

    -   Mount the volume as \"V:\\\" drive.

-   Configure Failover Cluster.

    -   Name: HYPERV-CLUS

    -   IP address: 201.98.23.200

    -   Create role \"WSC2019-Infra\" contains the virtual machines.

    -   Set affinity so that WSC2019-Infra role runs in HYPERV1 unless it fails.

### Web

> Install to cluster via WDS Deployment and Configure

-   If you are unable to configure or get the WDS to work, you may install this machine manually inside the Hyper-V cluster or, if the Hyper-V is not working, you may install it as a separate VM.

    -   Remote administration of IIS on a core server is tricky, the intention is that you can configure the various websites on this server using PowerShell, if you are unable to do this with PowerShell or setup remote configuration, you may set this up as a server with a Desktop Experience, doing this as a core server is a single aspect of the marking scheme.

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Install and configure IIS and its websites using given HTML files. (from USB)

    -   Use a single certificate that only has [\"w](http://www.wsc2019.ru/)w[w.wsc2019.ru](http://www.wsc2019.ru/)\" as a common name.

    -   Configure the \"Default Web Site\" as described below.

        -   Path for website root: \"C:\\inetpub\\intranet\\\".

        -    Enable Windows Internal authentication.

            -    Use certificate authentication for \"/manager/\" subdirectory.

    -   Create \"https://extra.wsc2019.ru\" website with the name \"Extranet\".

        -   Path for website root: \"C:\\inetpub\\extranet\\\".

        -   Enable ADFS web authentication via the Web Application Proxy for clients on the Internet.

    -   Create \"https://[www.wsc2019.ru\"w](http://www.wsc2019.ru/)ebsite with the name \"Public\".

        -   Path for website root: \"C:\\inetpub\\internet\\\".

-   Configure Certificate Enrolment Web Service (CES) and Certificate Enrolment Policy Web Service (CEP).

    -   URL: \"https://csweb.wsc2019.ru\" for both CES and CEP.

    -   Computers that are not in wsc2019.ru domain should be able to get a certificate through this server.

    -   Authentication should be done by username and password.

    -   Friendly Name: \"WSC2019 Enrollment Policy\"

    -   Make only \"\_External\_Client\" template visible.

-   Configure IP Address and Domain Restrictions.

    -   The \"https://intra.wsc2019.ru\" website can be accessible from: 201.98.23.0/24, 192.168.219.0/24

## Part 3. Perimeter and Internet

> You need to build a web application proxy and remote access service that allows you to use the internal resources of the domain outside the domain. Follow the instructions to complete the task.

### FIREWALL -- BASE

> Configure to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Enable routing.

-   Configure DNS server for the public Internet.

    -   Create primary zone \"wsc2019.ru\" and add these A records of 201.98.22.100.

        -   ns, vpn, csweb, extra, work.

    -   Add an A record [\"w](http://www.wsc2019.ru/)w[w.wsc2019.ru\"](http://www.wsc2019.ru/) of 201.98.23.103

    -   SOA record of the \"wsc2019.ru\" should be \"ns.wsc2019.ru\".

-   Configure Routing and Remote Access Service.

    -   Users and computers on the Internet should be able to establish VPN connection to this server.

    -   IKEv2 clients can connect to the intranet through this server.

    -   Authorize VPN access through the NPS.

    -   IP address pool for remote access clients: 192.168.219.1 - 192.168.219.254

-   Configure the Web Application Proxy.

    -   Clients on the Internet should be able to:

        -   Access \"https://extra.wsc2019.ru\" website after passing the ADFS web authentication.

        -   Access \"https://csweb.wsc2019.ru\" to reach to the Certification Enrolment Policy and Certification Enrolment Service.

        -   Access \"https://work.wsc2019.ru\" to use work folders for each user.

        -    Configure firewall rules to prevent unauthorized access.

        -   Allow HTTPS traffic from 201.98.22.0/24 to 201.98.23.103.

        -   Block any other traffics sourced from 201.98.22.0/24 to 201.98.23.0/24.

### REMCLIENT - BASE

> Configure to match the following requirements

-   Rename, and Set IP address according to configuration table and network diagram at end of project.

-   Join in wsc2019.ru domain through VPN.

-   Configure the Always-on VPN/Device tunnel.

    -   Domain users should be able to log in via this tunnel.

    -   Only the dc1 and dc2 can be accessed through this tunnel (not other servers/resources).

-   Deploy App-triggered VPN.

-   Create an IKEv2 VPN connection named \"AppVPN\" for \"Managers\" group members only that automatically connects to \"vpn.wsc2019.ru\" when a member of the Managers group runs Internet Explorer.\"

-   After connection to the VPN, the user should have access to all resources of the intranet.

-   Use bitlocker to encrypt the drive of REMCLIENT. Save the bitlocker recovery key to your USB.

### PUBCLIENT -- NOT INSTALLED

> Install/Configure

-   Install, rename, and set IP address according to configuration table and network diagram at end of project.

-   Do not join this client to the domain.

-   Set the firewall on this machine to allow inbound and outbound "ping" traffic.

-   Set the power settings to "never sleep".

-   Test Work Folders service is available via \"https://work.wsc2019.ru\".

    -   ADFS web authentication should be work.

    -   Work Folders should be accessible and writable.

-   This client should be able to receive a certificate from CES.

    -   Create a local Enrolment Policy.

    -   Get a certificate contains CN=PUBCLIENT from CES.

-   Create an IKEv2connection \"WSC2019-VPN\" for test purpose and make don\'t remember credential.

### INET -- Preconfigured

> Verify configuration if required

-   This machine is preconfigured for your use, if you wish to, you may re-install and configure this machine to these specifications.

-   Host NCSI website.

    -   Clients on the Internet should indicate network connection as the \"Internet\".

-   Configure DNS server.

    -   Create zones and records for NCSI.

    -   Add an A record \"cs.msftncsi.com\" of 201.98.22.1.

    -   Add an A record \"ns.msftncsi.com\" of 201.98.22.1.

    -   SOA record of the \"msftncsi.com\" should be \"ns.msftncsi.com\".

    -   Create a root zone(.) to simulate the root DNS server.

        -   Create appropriate delegations to resolve DNS records.

-   Configure DHCP service.

    -   Range: 201.98.22.151 - 201.98.22.175

    -   DNS: 201.98.22.1

    -   Gateway: 201.98.22.100

-   Configure the Certification Authority.

    -   Common name: ISP-CA

    -   Enable extensions for CDP and AIA URL through HTTP.

        -   URL for CDP: <http://cs.msftncsi.com/CertEnroll/ISP-CA.crl>

        -   URL for AIA: <http://cs.msftncsi.com/CertEnroll/ISP-CA.crt>

    -   Issue certificate request for WSC2019-CA.

### Configuration Table


|  **Hostname** | **Operation System**       | **Domain** | **IP Address(es)** |  **Preinstalled**     |
|-|-|-|-|-|
|  DC1          | Windows Server 2016Desktop | WSC2019.RU | 201.98.23.1        |  Yes - Configured     |
|  DC2          | Windows Server 2016Core    | WSC2019.RU | 201.98.23.101      |  BASE                 |
|  CERT         | Windows Server 2016Desktop | WSC2019.RU | 201.98.23.100      |  BASE                 |
|  INTCLIENT    | Windows 10 Enterprise      | WSC2019.RU | DHCP               |  BASE                 |
|  HYPERV1      | Windows Server 2016Core    | WSC2019.RU | 201.98.23.10 <br>10.0.0.1        | > No -- manual install |
|  HYPERV2      | Windows Server 2016Desktop | WSC2019.RU | 201.98.23.20 <br>10.0.0.2       | > BASE                 |
| STORAGE      | Windows Server 2016Desktop | WORKGROUP  | 10.0.0.10          | BASE                 |
| WEB          | Windows Server 2016Core    | WSC2019.RU | 201.98.23.103      |  No-WDS Deployment    |
|  FIREWALL     | Windows Server 2016Desktop | WORKGROUP  | 201.98.23.254 <br>201.98.22.100     | > BASE                 |
|  REMCLIENT    | Windows 10 Enterprise      | WSC2019.RU | DHCP               |  BASE                 |
|  PUBCLIENT    | Windows 10 Enterprise      | WORKGROUP  | DHCP               |  No                   |
|  INET         | Windows Server 2016Desktop | WORKGROUP  | 201.98.22.1        |  Yes - Configured     |

> Machines indicated as being preinstalled with \"**Yes**\" will have the operating system installed.
>
> Machines indicated as being preinstalled with \"**Yes - Configured**\" will have the operating system installed and pre-configured for Competitor use. Competitors may need to do further configuration to match the specifications laid out in this document.
>
> Machines indicated as "**BASE**" are standard installs which have been sysprepped and generalized to save installation time across the project, they will still need to be configured.

# Instructions to the Competitor

-   Do not bring any materials with you to the competition.

-   Mobile phones are not to be used.

-   Do not disclose any competition material / information to any person during each day's competition.

-   Read the whole competition script prior to you starting work.

-   Be aware different tasks attract a percentage of the overall mark. Plan your time carefully.

-   If your virtual machines spontaneously turn off, run slmgr /rearm command with the administrator credentials

# Equipment, machinery, installations and materials required

### Standard/Administration-PC

-   Intel i5 processor

-   16GB RAM

-   500GB SSD-Drive

-   1x24 inch LED-Monitors

-   US Keyboard

-   Mouse

> ![](media/image3.jpeg){width="6.67869094488189in" height="4.559583333333333in"}
>
> ![](media/image4.jpeg){width="6.653094925634296in" height="4.625in"}
